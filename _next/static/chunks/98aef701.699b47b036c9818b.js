"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[890],{6396:function(e,n,N){let B;N.d(n,{ZP:function(){return ty}});var et,ei,eo,el=N(7294),eu=N(3454),ec=N(1876).Buffer,ef={exports:{}},eh={};ef.exports=function(){if(ei)return eh;ei=1;var e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),N=Object.prototype.hasOwnProperty,B=el.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,et={key:!0,ref:!0,__self:!0,__source:!0};function i(n,ei,eo){var el,eu={},ec=null,ef=null;for(el in void 0!==eo&&(ec=""+eo),void 0!==ei.key&&(ec=""+ei.key),void 0!==ei.ref&&(ef=ei.ref),ei)N.call(ei,el)&&!et.hasOwnProperty(el)&&(eu[el]=ei[el]);if(n&&n.defaultProps)for(el in ei=n.defaultProps)void 0===eu[el]&&(eu[el]=ei[el]);return{$$typeof:e,type:n,key:ec,ref:ef,props:eu,_owner:B.current}}return eh.Fragment=n,eh.jsx=i,eh.jsxs=i,eh}();var ep=ef.exports;let ed=["saveState","loadState","inputs"];let Ha=class Ha{constructor(e,n){this._fun=e,this._context=n}saveState(){return void 0!==this._context.saveState?this._context.saveState():{}}loadState(e){void 0!==this._context.loadState&&this._context.loadState(e)}inputs(e){return void 0!==this._context.inputs?this._context.inputs(e):{}}};var e_=function(e){var n={};function t(N){if(n[N])return n[N].exports;var B=n[N]={i:N,l:!1,exports:{}};return e[N].call(B.exports,B,B.exports,t),B.l=!0,B.exports}return t.m=e,t.c=n,t.d=function(e,n,N){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:N})},t.r=function(e){"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n||4&n&&"object"==typeof e&&e&&e.__esModule)return e;var N=Object.create(null);if(t.r(N),Object.defineProperty(N,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var B in e)t.d(N,B,(function(n){return e[n]}).bind(null,B));return N},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=34)}([function(e,n,N){/**
  @license MIT
  
  Copyright © 2017-2018 Benoit Giannangeli
  Copyright © 2017-2018 Daurnimator
  Copyright © 1994–2017 Lua.org, PUC-Rio.
  */let B=N(5);e.exports.FENGARI_AUTHORS=B.FENGARI_AUTHORS,e.exports.FENGARI_COPYRIGHT=B.FENGARI_COPYRIGHT,e.exports.FENGARI_RELEASE=B.FENGARI_RELEASE,e.exports.FENGARI_VERSION=B.FENGARI_VERSION,e.exports.FENGARI_VERSION_MAJOR=B.FENGARI_VERSION_MAJOR,e.exports.FENGARI_VERSION_MINOR=B.FENGARI_VERSION_MINOR,e.exports.FENGARI_VERSION_NUM=B.FENGARI_VERSION_NUM,e.exports.FENGARI_VERSION_RELEASE=B.FENGARI_VERSION_RELEASE,e.exports.luastring_eq=B.luastring_eq,e.exports.luastring_indexOf=B.luastring_indexOf,e.exports.luastring_of=B.luastring_of,e.exports.to_jsstring=B.to_jsstring,e.exports.to_luastring=B.to_luastring,e.exports.to_uristring=B.to_uristring;let et=N(3),ei=N(2),eo=N(7),el=N(17);e.exports.luaconf=et,e.exports.lua=ei,e.exports.lauxlib=eo,e.exports.lualib=el},function(e,n,N){let B,et,ei;if(B="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e){let n=0,N=e.length,B=new Uint8Array(N);for(;N>n;)B[n]=e[n++];return B},"function"==typeof new Uint8Array().indexOf)et=function(e,n,N){return e.indexOf(n,N)};else{let e=[].indexOf;if(0!==e.call(new Uint8Array(1),0))throw Error("missing .indexOf");et=function(n,N,B){return e.call(n,N,B)}}ei="function"==typeof Uint8Array.of?Uint8Array.of.bind(Uint8Array):function(){return B(arguments)};let i=function(e){return e instanceof Uint8Array},eo="cannot convert invalid utf8 to javascript string",el=";,/?:@&=+$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,-_.!~*'()#".split("").reduce(function(e,n){return e[n.charCodeAt(0)]=!0,e},{}),eu={},w=function(e,n){if("string"!=typeof e)throw TypeError("to_luastring expects a javascript string");if(n){let n=eu[e];if(i(n))return n}let N=e.length,et=Array(N),ei=0;for(let n=0;n<N;++n){let B=e.charCodeAt(n);if(B<=127)et[ei++]=B;else if(B<=2047)et[ei++]=192|B>>6,et[ei++]=128|63&B;else{if(B>=55296&&B<=56319&&n+1<N){let N=e.charCodeAt(n+1);N>=56320&&N<=57343&&(n++,B=1024*(B-55296)+N+9216)}B<=65535?et[ei++]=224|B>>12:(et[ei++]=240|B>>18,et[ei++]=128|B>>12&63),et[ei++]=128|B>>6&63,et[ei++]=128|63&B}}return et=B(et),n&&(eu[e]=et),et};e.exports.luastring_from=B,e.exports.luastring_indexOf=et,e.exports.luastring_of=ei,e.exports.is_luastring=i,e.exports.luastring_eq=function(e,n){if(e!==n){let N=e.length;if(N!==n.length)return!1;for(let B=0;B<N;B++)if(e[B]!==n[B])return!1}return!0},e.exports.to_jsstring=function(e,n,N,B){if(!i(e))throw TypeError("to_jsstring expects a Uint8Array");N=void 0===N?e.length:Math.min(e.length,N);let et="";for(let ei=void 0!==n?n:0;ei<N;){let n=e[ei++];if(n<128)et+=String.fromCharCode(n);else if(n<194||n>244){if(!B)throw RangeError(eo);et+="�"}else if(n<=223){if(ei>=N){if(!B)throw RangeError(eo);et+="�";continue}let el=e[ei++];if((192&el)!=128){if(!B)throw RangeError(eo);et+="�";continue}et+=String.fromCharCode(((31&n)<<6)+(63&el))}else if(n<=239){if(ei+1>=N){if(!B)throw RangeError(eo);et+="�";continue}let el=e[ei++];if((192&el)!=128){if(!B)throw RangeError(eo);et+="�";continue}let eu=e[ei++];if((192&eu)!=128){if(!B)throw RangeError(eo);et+="�";continue}let ec=((15&n)<<12)+((63&el)<<6)+(63&eu);ec<=65535?et+=String.fromCharCode(ec):et+=String.fromCharCode(55296+((ec-=65536)>>10),ec%1024+56320)}else{if(ei+2>=N){if(!B)throw RangeError(eo);et+="�";continue}let el=e[ei++];if((192&el)!=128){if(!B)throw RangeError(eo);et+="�";continue}let eu=e[ei++];if((192&eu)!=128){if(!B)throw RangeError(eo);et+="�";continue}let ec=e[ei++];if((192&ec)!=128){if(!B)throw RangeError(eo);et+="�";continue}let ef=((7&n)<<18)+((63&el)<<12)+((63&eu)<<6)+(63&ec);et+=String.fromCharCode(55296+((ef-=65536)>>10),ef%1024+56320)}}return et},e.exports.to_uristring=function(e){if(!i(e))throw TypeError("to_uristring expects a Uint8Array");let n="";for(let N=0;N<e.length;N++){let B=e[N];el[B]?n+=String.fromCharCode(B):n+="%"+(B<16?"0":"")+B.toString(16)}return n},e.exports.to_luastring=w,e.exports.from_userstring=function(e){if(!i(e)){if("string"!=typeof e)throw TypeError("expects an array of bytes or javascript string");e=w(e)}return e};let ec=w("\x1bLua");e.exports.LUA_SIGNATURE=ec,e.exports.LUA_VERSION_MAJOR="5",e.exports.LUA_VERSION_MINOR="3",e.exports.LUA_VERSION_NUM=503,e.exports.LUA_VERSION_RELEASE="4",e.exports.LUA_VERSION="Lua 5.3",e.exports.LUA_RELEASE="Lua 5.3.4",e.exports.LUA_COPYRIGHT="Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio",e.exports.LUA_AUTHORS="R. Ierusalimschy, L. H. de Figueiredo, W. Celes";let ef={LUA_TNONE:-1,LUA_TNIL:0,LUA_TBOOLEAN:1,LUA_TLIGHTUSERDATA:2,LUA_TNUMBER:3,LUA_TSTRING:4,LUA_TTABLE:5,LUA_TFUNCTION:6,LUA_TUSERDATA:7,LUA_TTHREAD:8,LUA_NUMTAGS:9};ef.LUA_TSHRSTR=0|ef.LUA_TSTRING,ef.LUA_TLNGSTR=16|ef.LUA_TSTRING,ef.LUA_TNUMFLT=0|ef.LUA_TNUMBER,ef.LUA_TNUMINT=16|ef.LUA_TNUMBER,ef.LUA_TLCL=0|ef.LUA_TFUNCTION,ef.LUA_TLCF=16|ef.LUA_TFUNCTION,ef.LUA_TCCL=32|ef.LUA_TFUNCTION;let{LUAI_MAXSTACK:eh}=N(3),ep=-eh-1e3;e.exports.LUA_HOOKCALL=0,e.exports.LUA_HOOKCOUNT=3,e.exports.LUA_HOOKLINE=2,e.exports.LUA_HOOKRET=1,e.exports.LUA_HOOKTAILCALL=4,e.exports.LUA_MASKCALL=1,e.exports.LUA_MASKCOUNT=8,e.exports.LUA_MASKLINE=4,e.exports.LUA_MASKRET=2,e.exports.LUA_MINSTACK=20,e.exports.LUA_MULTRET=-1,e.exports.LUA_OPADD=0,e.exports.LUA_OPBAND=7,e.exports.LUA_OPBNOT=13,e.exports.LUA_OPBOR=8,e.exports.LUA_OPBXOR=9,e.exports.LUA_OPDIV=5,e.exports.LUA_OPEQ=0,e.exports.LUA_OPIDIV=6,e.exports.LUA_OPLE=2,e.exports.LUA_OPLT=1,e.exports.LUA_OPMOD=3,e.exports.LUA_OPMUL=2,e.exports.LUA_OPPOW=4,e.exports.LUA_OPSHL=10,e.exports.LUA_OPSHR=11,e.exports.LUA_OPSUB=1,e.exports.LUA_OPUNM=12,e.exports.LUA_REGISTRYINDEX=ep,e.exports.LUA_RIDX_GLOBALS=2,e.exports.LUA_RIDX_LAST=2,e.exports.LUA_RIDX_MAINTHREAD=1,e.exports.constant_types=ef,e.exports.lua_Debug=class{constructor(){this.event=NaN,this.name=null,this.namewhat=null,this.what=null,this.source=null,this.currentline=NaN,this.linedefined=NaN,this.lastlinedefined=NaN,this.nups=NaN,this.nparams=NaN,this.isvararg=NaN,this.istailcall=NaN,this.short_src=null,this.i_ci=null}},e.exports.lua_upvalueindex=function(e){return ep-e},e.exports.thread_status={LUA_OK:0,LUA_YIELD:1,LUA_ERRRUN:2,LUA_ERRSYNTAX:3,LUA_ERRMEM:4,LUA_ERRGCMM:5,LUA_ERRERR:6}},function(e,n,N){let B=N(1),et=N(18),ei=N(11),eo=N(8),el=N(12);e.exports.LUA_AUTHORS=B.LUA_AUTHORS,e.exports.LUA_COPYRIGHT=B.LUA_COPYRIGHT,e.exports.LUA_ERRERR=B.thread_status.LUA_ERRERR,e.exports.LUA_ERRGCMM=B.thread_status.LUA_ERRGCMM,e.exports.LUA_ERRMEM=B.thread_status.LUA_ERRMEM,e.exports.LUA_ERRRUN=B.thread_status.LUA_ERRRUN,e.exports.LUA_ERRSYNTAX=B.thread_status.LUA_ERRSYNTAX,e.exports.LUA_HOOKCALL=B.LUA_HOOKCALL,e.exports.LUA_HOOKCOUNT=B.LUA_HOOKCOUNT,e.exports.LUA_HOOKLINE=B.LUA_HOOKLINE,e.exports.LUA_HOOKRET=B.LUA_HOOKRET,e.exports.LUA_HOOKTAILCALL=B.LUA_HOOKTAILCALL,e.exports.LUA_MASKCALL=B.LUA_MASKCALL,e.exports.LUA_MASKCOUNT=B.LUA_MASKCOUNT,e.exports.LUA_MASKLINE=B.LUA_MASKLINE,e.exports.LUA_MASKRET=B.LUA_MASKRET,e.exports.LUA_MINSTACK=B.LUA_MINSTACK,e.exports.LUA_MULTRET=B.LUA_MULTRET,e.exports.LUA_NUMTAGS=B.constant_types.LUA_NUMTAGS,e.exports.LUA_OK=B.thread_status.LUA_OK,e.exports.LUA_OPADD=B.LUA_OPADD,e.exports.LUA_OPBAND=B.LUA_OPBAND,e.exports.LUA_OPBNOT=B.LUA_OPBNOT,e.exports.LUA_OPBOR=B.LUA_OPBOR,e.exports.LUA_OPBXOR=B.LUA_OPBXOR,e.exports.LUA_OPDIV=B.LUA_OPDIV,e.exports.LUA_OPEQ=B.LUA_OPEQ,e.exports.LUA_OPIDIV=B.LUA_OPIDIV,e.exports.LUA_OPLE=B.LUA_OPLE,e.exports.LUA_OPLT=B.LUA_OPLT,e.exports.LUA_OPMOD=B.LUA_OPMOD,e.exports.LUA_OPMUL=B.LUA_OPMUL,e.exports.LUA_OPPOW=B.LUA_OPPOW,e.exports.LUA_OPSHL=B.LUA_OPSHL,e.exports.LUA_OPSHR=B.LUA_OPSHR,e.exports.LUA_OPSUB=B.LUA_OPSUB,e.exports.LUA_OPUNM=B.LUA_OPUNM,e.exports.LUA_REGISTRYINDEX=B.LUA_REGISTRYINDEX,e.exports.LUA_RELEASE=B.LUA_RELEASE,e.exports.LUA_RIDX_GLOBALS=B.LUA_RIDX_GLOBALS,e.exports.LUA_RIDX_LAST=B.LUA_RIDX_LAST,e.exports.LUA_RIDX_MAINTHREAD=B.LUA_RIDX_MAINTHREAD,e.exports.LUA_SIGNATURE=B.LUA_SIGNATURE,e.exports.LUA_TNONE=B.constant_types.LUA_TNONE,e.exports.LUA_TNIL=B.constant_types.LUA_TNIL,e.exports.LUA_TBOOLEAN=B.constant_types.LUA_TBOOLEAN,e.exports.LUA_TLIGHTUSERDATA=B.constant_types.LUA_TLIGHTUSERDATA,e.exports.LUA_TNUMBER=B.constant_types.LUA_TNUMBER,e.exports.LUA_TSTRING=B.constant_types.LUA_TSTRING,e.exports.LUA_TTABLE=B.constant_types.LUA_TTABLE,e.exports.LUA_TFUNCTION=B.constant_types.LUA_TFUNCTION,e.exports.LUA_TUSERDATA=B.constant_types.LUA_TUSERDATA,e.exports.LUA_TTHREAD=B.constant_types.LUA_TTHREAD,e.exports.LUA_VERSION=B.LUA_VERSION,e.exports.LUA_VERSION_MAJOR=B.LUA_VERSION_MAJOR,e.exports.LUA_VERSION_MINOR=B.LUA_VERSION_MINOR,e.exports.LUA_VERSION_NUM=B.LUA_VERSION_NUM,e.exports.LUA_VERSION_RELEASE=B.LUA_VERSION_RELEASE,e.exports.LUA_YIELD=B.thread_status.LUA_YIELD,e.exports.lua_Debug=B.lua_Debug,e.exports.lua_upvalueindex=B.lua_upvalueindex,e.exports.lua_absindex=et.lua_absindex,e.exports.lua_arith=et.lua_arith,e.exports.lua_atpanic=et.lua_atpanic,e.exports.lua_atnativeerror=et.lua_atnativeerror,e.exports.lua_call=et.lua_call,e.exports.lua_callk=et.lua_callk,e.exports.lua_checkstack=et.lua_checkstack,e.exports.lua_close=el.lua_close,e.exports.lua_compare=et.lua_compare,e.exports.lua_concat=et.lua_concat,e.exports.lua_copy=et.lua_copy,e.exports.lua_createtable=et.lua_createtable,e.exports.lua_dump=et.lua_dump,e.exports.lua_error=et.lua_error,e.exports.lua_gc=et.lua_gc,e.exports.lua_getallocf=et.lua_getallocf,e.exports.lua_getextraspace=et.lua_getextraspace,e.exports.lua_getfield=et.lua_getfield,e.exports.lua_getglobal=et.lua_getglobal,e.exports.lua_gethook=ei.lua_gethook,e.exports.lua_gethookcount=ei.lua_gethookcount,e.exports.lua_gethookmask=ei.lua_gethookmask,e.exports.lua_geti=et.lua_geti,e.exports.lua_getinfo=ei.lua_getinfo,e.exports.lua_getlocal=ei.lua_getlocal,e.exports.lua_getmetatable=et.lua_getmetatable,e.exports.lua_getstack=ei.lua_getstack,e.exports.lua_gettable=et.lua_gettable,e.exports.lua_gettop=et.lua_gettop,e.exports.lua_getupvalue=et.lua_getupvalue,e.exports.lua_getuservalue=et.lua_getuservalue,e.exports.lua_insert=et.lua_insert,e.exports.lua_isboolean=et.lua_isboolean,e.exports.lua_iscfunction=et.lua_iscfunction,e.exports.lua_isfunction=et.lua_isfunction,e.exports.lua_isinteger=et.lua_isinteger,e.exports.lua_islightuserdata=et.lua_islightuserdata,e.exports.lua_isnil=et.lua_isnil,e.exports.lua_isnone=et.lua_isnone,e.exports.lua_isnoneornil=et.lua_isnoneornil,e.exports.lua_isnumber=et.lua_isnumber,e.exports.lua_isproxy=et.lua_isproxy,e.exports.lua_isstring=et.lua_isstring,e.exports.lua_istable=et.lua_istable,e.exports.lua_isthread=et.lua_isthread,e.exports.lua_isuserdata=et.lua_isuserdata,e.exports.lua_isyieldable=eo.lua_isyieldable,e.exports.lua_len=et.lua_len,e.exports.lua_load=et.lua_load,e.exports.lua_newstate=el.lua_newstate,e.exports.lua_newtable=et.lua_newtable,e.exports.lua_newthread=el.lua_newthread,e.exports.lua_newuserdata=et.lua_newuserdata,e.exports.lua_next=et.lua_next,e.exports.lua_pcall=et.lua_pcall,e.exports.lua_pcallk=et.lua_pcallk,e.exports.lua_pop=et.lua_pop,e.exports.lua_pushboolean=et.lua_pushboolean,e.exports.lua_pushcclosure=et.lua_pushcclosure,e.exports.lua_pushcfunction=et.lua_pushcfunction,e.exports.lua_pushfstring=et.lua_pushfstring,e.exports.lua_pushglobaltable=et.lua_pushglobaltable,e.exports.lua_pushinteger=et.lua_pushinteger,e.exports.lua_pushjsclosure=et.lua_pushjsclosure,e.exports.lua_pushjsfunction=et.lua_pushjsfunction,e.exports.lua_pushlightuserdata=et.lua_pushlightuserdata,e.exports.lua_pushliteral=et.lua_pushliteral,e.exports.lua_pushlstring=et.lua_pushlstring,e.exports.lua_pushnil=et.lua_pushnil,e.exports.lua_pushnumber=et.lua_pushnumber,e.exports.lua_pushstring=et.lua_pushstring,e.exports.lua_pushthread=et.lua_pushthread,e.exports.lua_pushvalue=et.lua_pushvalue,e.exports.lua_pushvfstring=et.lua_pushvfstring,e.exports.lua_rawequal=et.lua_rawequal,e.exports.lua_rawget=et.lua_rawget,e.exports.lua_rawgeti=et.lua_rawgeti,e.exports.lua_rawgetp=et.lua_rawgetp,e.exports.lua_rawlen=et.lua_rawlen,e.exports.lua_rawset=et.lua_rawset,e.exports.lua_rawseti=et.lua_rawseti,e.exports.lua_rawsetp=et.lua_rawsetp,e.exports.lua_register=et.lua_register,e.exports.lua_remove=et.lua_remove,e.exports.lua_replace=et.lua_replace,e.exports.lua_resume=eo.lua_resume,e.exports.lua_rotate=et.lua_rotate,e.exports.lua_setallof=eo.lua_setallof,e.exports.lua_setfield=et.lua_setfield,e.exports.lua_setglobal=et.lua_setglobal,e.exports.lua_sethook=ei.lua_sethook,e.exports.lua_seti=et.lua_seti,e.exports.lua_setlocal=ei.lua_setlocal,e.exports.lua_setmetatable=et.lua_setmetatable,e.exports.lua_settable=et.lua_settable,e.exports.lua_settop=et.lua_settop,e.exports.lua_setupvalue=et.lua_setupvalue,e.exports.lua_setuservalue=et.lua_setuservalue,e.exports.lua_status=et.lua_status,e.exports.lua_stringtonumber=et.lua_stringtonumber,e.exports.lua_toboolean=et.lua_toboolean,e.exports.lua_todataview=et.lua_todataview,e.exports.lua_tointeger=et.lua_tointeger,e.exports.lua_tointegerx=et.lua_tointegerx,e.exports.lua_tojsstring=et.lua_tojsstring,e.exports.lua_tolstring=et.lua_tolstring,e.exports.lua_tonumber=et.lua_tonumber,e.exports.lua_tonumberx=et.lua_tonumberx,e.exports.lua_topointer=et.lua_topointer,e.exports.lua_toproxy=et.lua_toproxy,e.exports.lua_tostring=et.lua_tostring,e.exports.lua_tothread=et.lua_tothread,e.exports.lua_touserdata=et.lua_touserdata,e.exports.lua_type=et.lua_type,e.exports.lua_typename=et.lua_typename,e.exports.lua_upvalueid=et.lua_upvalueid,e.exports.lua_upvaluejoin=et.lua_upvaluejoin,e.exports.lua_version=et.lua_version,e.exports.lua_xmove=et.lua_xmove,e.exports.lua_yield=eo.lua_yield,e.exports.lua_yieldk=eo.lua_yieldk,e.exports.lua_tocfunction=et.lua_tocfunction},function(e,n,N){let B={},{LUA_VERSION_MAJOR:et,LUA_VERSION_MINOR:ei,to_luastring:eo}=N(1);e.exports.LUA_PATH_SEP=";",e.exports.LUA_PATH_MARK="?",e.exports.LUA_EXEC_DIR="!";let el=et+"."+ei;e.exports.LUA_VDIR=el;{e.exports.LUA_DIRSEP="/";let n="./lua/"+el+"/";e.exports.LUA_LDIR=n,e.exports.LUA_JSDIR=n;let N=eo(n+"?.lua;"+n+"?/init.lua;./?.lua;./?/init.lua");e.exports.LUA_PATH_DEFAULT=N;let B=eo(n+"?.js;"+n+"loadall.js;./?.js");e.exports.LUA_JSPATH_DEFAULT=B}let eu=B.LUA_COMPAT_FLOATSTRING||!1,ec=B.LUAI_MAXSTACK||1e6,ef=B.LUA_IDSIZE||59,eh=B.LUAL_BUFFERSIZE||8192,L=function(e,n){for(var N=Math.min(3,Math.ceil(Math.abs(n)/1023)),B=e,et=0;et<N;et++)B*=Math.pow(2,Math.floor((n+et)/N));return B};e.exports.LUAI_MAXSTACK=ec,e.exports.LUA_COMPAT_FLOATSTRING=eu,e.exports.LUA_IDSIZE=ef,e.exports.LUA_INTEGER_FMT="%d",e.exports.LUA_INTEGER_FRMLEN="",e.exports.LUA_MAXINTEGER=2147483647,e.exports.LUA_MININTEGER=-2147483648,e.exports.LUA_NUMBER_FMT="%.14g",e.exports.LUA_NUMBER_FRMLEN="",e.exports.LUAL_BUFFERSIZE=eh,e.exports.frexp=function(e){if(0===e)return[e,0];var n=new DataView(new ArrayBuffer(8));n.setFloat64(0,e);var N=n.getUint32(0)>>>20&2047;0===N&&(n.setFloat64(0,18446744073709552e3*e),N=(n.getUint32(0)>>>20&2047)-64);var B=N-1022;return[L(e,-B),B]},e.exports.ldexp=L,e.exports.lua_getlocaledecpoint=function(){return 46},e.exports.lua_integer2str=function(e){return String(e)},e.exports.lua_number2str=function(e){return String(Number(e.toPrecision(14)))},e.exports.lua_numbertointeger=function(e){return e>=-2147483648&&e<2147483648&&e},e.exports.luai_apicheck=function(e,n){if(!n)throw Error(n)}},function(e,n,N){let{luai_apicheck:B}=N(3),s=function(e){if(!e)throw Error("assertion failed")};e.exports.lua_assert=s,e.exports.luai_apicheck=B||function(e,n){return s(n)},e.exports.api_check=function(e,n,N){return B(e,n&&N)},e.exports.LUAI_MAXCCALLS=200,e.exports.LUA_MINBUFFER=32,e.exports.luai_nummod=function(e,n,N){let B=n%N;return B*N<0&&(B+=N),B},e.exports.MAX_INT=2147483647,e.exports.MIN_INT=-2147483648},function(e,n,N){let B=N(1),et=`Fengari 0.1.4  Copyright (C) 2017-2018 B. Giannangeli, Daurnimator
Based on: `+B.LUA_COPYRIGHT;e.exports.FENGARI_AUTHORS="B. Giannangeli, Daurnimator",e.exports.FENGARI_COPYRIGHT=et,e.exports.FENGARI_RELEASE="Fengari 0.1.4",e.exports.FENGARI_VERSION="Fengari 0.1",e.exports.FENGARI_VERSION_MAJOR="0",e.exports.FENGARI_VERSION_MINOR="1",e.exports.FENGARI_VERSION_NUM=1,e.exports.FENGARI_VERSION_RELEASE="4",e.exports.is_luastring=B.is_luastring,e.exports.luastring_eq=B.luastring_eq,e.exports.luastring_from=B.luastring_from,e.exports.luastring_indexOf=B.luastring_indexOf,e.exports.luastring_of=B.luastring_of,e.exports.to_jsstring=B.to_jsstring,e.exports.to_luastring=B.to_luastring,e.exports.to_uristring=B.to_uristring,e.exports.from_userstring=B.from_userstring},function(e,n,N){let{LUA_OPADD:B,LUA_OPBAND:et,LUA_OPBNOT:ei,LUA_OPBOR:eo,LUA_OPBXOR:el,LUA_OPDIV:eu,LUA_OPIDIV:ec,LUA_OPMOD:ef,LUA_OPMUL:eh,LUA_OPPOW:ep,LUA_OPSHL:ed,LUA_OPSHR:e_,LUA_OPSUB:eg,LUA_OPUNM:em,constant_types:{LUA_NUMTAGS:eb,LUA_TBOOLEAN:ey,LUA_TCCL:ev,LUA_TFUNCTION:ek,LUA_TLCF:eA,LUA_TLCL:eL,LUA_TLIGHTUSERDATA:ex,LUA_TLNGSTR:ew,LUA_TNIL:eT,LUA_TNUMBER:eO,LUA_TNUMFLT:eE,LUA_TNUMINT:eS,LUA_TSHRSTR:eN,LUA_TSTRING:eI,LUA_TTABLE:eR,LUA_TTHREAD:eU,LUA_TUSERDATA:eC},from_userstring:eM,luastring_indexOf:eP,luastring_of:eD,to_jsstring:eB,to_luastring:eK}=N(1),{lisdigit:eG,lisprint:eV,lisspace:eF,lisxdigit:ez}=N(22),ej=N(11),eH=N(8),e$=N(12),{luaS_bless:eX,luaS_new:eq}=N(10),eW=N(9),{LUA_COMPAT_FLOATSTRING:eZ,ldexp:eY,lua_integer2str:eJ,lua_number2str:eQ}=N(3),e0=N(15),{MAX_INT:e1,luai_nummod:e2,lua_assert:e3}=N(4),e5=N(14),e4=eb+1;let ce=class ce{constructor(e,n){this.type=e,this.value=n}ttype(){return 63&this.type}ttnov(){return 15&this.type}checktag(e){return this.type===e}checktype(e){return this.ttnov()===e}ttisnumber(){return this.checktype(eO)}ttisfloat(){return this.checktag(eE)}ttisinteger(){return this.checktag(eS)}ttisnil(){return this.checktag(eT)}ttisboolean(){return this.checktag(ey)}ttislightuserdata(){return this.checktag(ex)}ttisstring(){return this.checktype(eI)}ttisshrstring(){return this.checktag(eN)}ttislngstring(){return this.checktag(ew)}ttistable(){return this.checktag(eR)}ttisfunction(){return this.checktype(ek)}ttisclosure(){return(31&this.type)===ek}ttisCclosure(){return this.checktag(ev)}ttisLclosure(){return this.checktag(eL)}ttislcf(){return this.checktag(eA)}ttisfulluserdata(){return this.checktag(eC)}ttisthread(){return this.checktag(eU)}ttisdeadkey(){return this.checktag(e4)}l_isfalse(){return this.ttisnil()||this.ttisboolean()&&!1===this.value}setfltvalue(e){this.type=eE,this.value=e}chgfltvalue(e){e3(this.type==eE),this.value=e}setivalue(e){this.type=eS,this.value=e}chgivalue(e){e3(this.type==eS),this.value=e}setnilvalue(){this.type=eT,this.value=null}setfvalue(e){this.type=eA,this.value=e}setpvalue(e){this.type=ex,this.value=e}setbvalue(e){this.type=ey,this.value=e}setsvalue(e){this.type=ew,this.value=e}setuvalue(e){this.type=eC,this.value=e}setthvalue(e){this.type=eU,this.value=e}setclLvalue(e){this.type=eL,this.value=e}setclCvalue(e){this.type=ev,this.value=e}sethvalue(e){this.type=eR,this.value=e}setdeadvalue(){this.type=e4,this.value=null}setfrom(e){this.type=e.type,this.value=e.value}tsvalue(){return e3(this.ttisstring()),this.value}svalue(){return this.tsvalue().getstr()}vslen(){return this.tsvalue().tsslen()}jsstring(e,n){return eB(this.svalue(),e,n,!0)}};let Ne=function(e,n,N){e.stack[n].setsvalue(N)},e8=new ce(eT,null);Object.freeze(e8),e.exports.luaO_nilobject=e8;let nt=class nt{constructor(e,n){this.id=e.l_G.id_counter++,this.p=null,this.nupvalues=n,this.upvals=Array(n)}};let dt=class dt{constructor(e,n,N){for(this.id=e.l_G.id_counter++,this.f=n,this.nupvalues=N,this.upvalue=Array(N);N--;)this.upvalue[N]=new ce(eT,null)}};let xt=class xt{constructor(e,n){this.id=e.l_G.id_counter++,this.metatable=null,this.uservalue=new ce(eT,null),this.len=n,this.data=Object.create(null)}};let e6=eK("..."),e9=eK('[string "'),e7=eK('"]'),Be=function(e){return eG(e)?e-48:(223&e)-55},De=function(e,n){let N=1;if(e3(n<=1114111),n<128)e[7]=n;else{let B=63;do e[8-N++]=128|63&n,n>>=6,B>>=1;while(n>B);e[8-N]=~B<<1|n}return N},Fe=function(e,n){let N="x"===n?function(e){let n,N=0,B=0,et=0,ei=0,eo=0,el=!1;for(;eF(e[N]);)N++;if(((n=45===e[N])||43===e[N])&&N++,48!==e[N]||120!==e[N+1]&&88!==e[N+1])return null;for(N+=2;;N++)if(46===e[N]){if(el)break;el=!0}else{if(!ez(e[N]))break;0===et&&48===e[N]?ei++:++et<=30?B=16*B+Be(e[N]):eo++,el&&eo--}if(ei+et===0)return null;if(eo*=4,112===e[N]||80===e[N]){let n,B=0;if(((n=45===e[++N])||43===e[N])&&N++,!eG(e[N]))return null;for(;eG(e[N]);)B=10*B+e[N++]-48;n&&(B=-B),eo+=B}return n&&(B=-B),{n:eY(B,eo),i:N}}(e):function(e){try{e=eB(e)}catch{return null}let n=/^[\t\v\f \n\r]*[+-]?(?:[0-9]+\.?[0-9]*|\.[0-9]*)(?:[eE][+-]?[0-9]+)?/.exec(e);if(!n)return null;let N=parseFloat(n[0]);return isNaN(N)?null:{n:N,i:n[0].length}}(e);if(null===N)return null;for(;eF(e[N.i]);)N.i++;return N.i===e.length||0===e[N.i]?N:null},ti=[46,120,88,110,78],to={46:".",120:"x",88:"x",110:"n",78:"n"},tl=Math.floor(e1/10),tu=e1%10,vt=function(e,n){let N;if(n.ttisinteger())N=eK(eJ(n.value));else{let e=eQ(n.value);!eZ&&/^[-0123456789]+$/.test(e)&&(e+=".0"),N=eK(e)}n.setsvalue(eX(e,N))},yt=function(e,n){eH.luaD_inctop(e),Ne(e,e.top-1,eq(e,n))},Rt=function(e,n,N){let B,et=0,ei=0,eo=0;for(;-1!=(B=eP(n,37,ei));){switch(yt(e,n.subarray(ei,B)),n[B+1]){case 115:{let n=N[eo++];if(null===n)n=eK("(null)",!0);else{let e=eP(n=eM(n),0);-1!==e&&(n=n.subarray(0,e))}yt(e,n);break}case 99:{let n=N[eo++];eV(n)?yt(e,eD(n)):lt(e,eK("<\\%d>",!0),n);break}case 100:case 73:eH.luaD_inctop(e),e.stack[e.top-1].setivalue(N[eo++]),vt(e,e.stack[e.top-1]);break;case 102:eH.luaD_inctop(e),e.stack[e.top-1].setfltvalue(N[eo++]),vt(e,e.stack[e.top-1]);break;case 112:{let n=N[eo++];if(n instanceof e$.lua_State||n instanceof eW.Table||n instanceof xt||n instanceof nt||n instanceof dt)yt(e,eK("0x"+n.id.toString(16)));else switch(typeof n){case"undefined":yt(e,eK("undefined"));break;case"number":yt(e,eK("Number("+n+")"));break;case"string":yt(e,eK("String("+JSON.stringify(n)+")"));break;case"boolean":yt(e,eK(n?"Boolean(true)":"Boolean(false)"));break;case"object":if(null===n){yt(e,eK("null"));break}case"function":{let N=e.l_G.ids.get(n);N||(N=e.l_G.id_counter++,e.l_G.ids.set(n,N)),yt(e,eK("0x"+N.toString(16)));break}default:yt(e,eK("<id NYI>"))}break}case 85:{let n=new Uint8Array(8),B=De(n,N[eo++]);yt(e,n.subarray(8-B));break}case 37:yt(e,eK("%",!0));break;default:ej.luaG_runerror(e,eK("invalid option '%%%c' to 'lua_pushfstring'"),n[B+1])}et+=2,ei=B+2}return eH.luaD_checkstack(e,1),yt(e,n.subarray(ei)),et>0&&e0.luaV_concat(e,et+1),e.stack[e.top-1].svalue()},lt=function(e,n,...N){return Rt(e,n,N)},pt=function(e,n,N,eu){switch(n){case B:return N+eu|0;case eg:return N-eu|0;case eh:return e0.luaV_imul(N,eu);case ef:return e0.luaV_mod(e,N,eu);case ec:return e0.luaV_div(e,N,eu);case et:return N&eu;case eo:return N|eu;case el:return N^eu;case ed:return e0.luaV_shiftl(N,eu);case e_:return e0.luaV_shiftl(N,-eu);case em:return 0-N|0;case ei:return -1^N;default:e3(0)}},At=function(e,n,N,et){switch(n){case B:return N+et;case eg:return N-et;case eh:return N*et;case eu:return N/et;case ep:return Math.pow(N,et);case ec:return Math.floor(N/et);case em:return-N;case ef:return e2(e,N,et);default:e3(0)}};e.exports.CClosure=dt,e.exports.LClosure=nt,e.exports.LUA_TDEADKEY=e4,e.exports.LUA_TPROTO=eb,e.exports.LocVar=class{constructor(){this.varname=null,this.startpc=NaN,this.endpc=NaN}},e.exports.TValue=ce,e.exports.Udata=xt,e.exports.UTF8BUFFSZ=8,e.exports.luaO_arith=function(e,n,N,ec,ef){let eh="number"==typeof ef?e.stack[ef]:ef;switch(n){case et:case eo:case el:case ed:case e_:case ei:{let B,et;if(!1!==(B=e0.tointeger(N))&&!1!==(et=e0.tointeger(ec)))return void eh.setivalue(pt(e,n,B,et));break}case eu:case ep:{let B,et;if(!1!==(B=e0.tonumber(N))&&!1!==(et=e0.tonumber(ec)))return void eh.setfltvalue(At(e,n,B,et));break}default:{let B,et;if(N.ttisinteger()&&ec.ttisinteger())return void eh.setivalue(pt(e,n,N.value,ec.value));if(!1!==(B=e0.tonumber(N))&&!1!==(et=e0.tonumber(ec)))return void eh.setfltvalue(At(e,n,B,et))}}e3(null!==e),e5.luaT_trybinTM(e,N,ec,ef,n-B+e5.TMS.TM_ADD)},e.exports.luaO_chunkid=function(e,n){let N,B=e.length;if(61===e[0])B<n?(N=new Uint8Array(B-1)).set(e.subarray(1)):(N=new Uint8Array(n)).set(e.subarray(1,n+1));else if(64===e[0])B<=n?(N=new Uint8Array(B-1)).set(e.subarray(1)):((N=new Uint8Array(n)).set(e6),n-=e6.length,N.set(e.subarray(B-n),e6.length));else{N=new Uint8Array(n);let et=eP(e,10);N.set(e9);let ei=e9.length;B<(n-=e9.length+e6.length+e7.length)&&-1===et?(N.set(e,ei),ei+=e.length):(-1!==et&&(B=et),B>n&&(B=n),N.set(e.subarray(0,B),ei),ei+=B,N.set(e6,ei),ei+=e6.length),N.set(e7,ei),ei+=e7.length,N=N.subarray(0,ei)}return N},e.exports.luaO_hexavalue=Be,e.exports.luaO_int2fb=function(e){let n=0;if(e<8)return e;for(;e>=128;)e=e+15>>4,n+=4;for(;e>=16;)e=e+1>>1,n++;return n+1<<3|e-8},e.exports.luaO_pushfstring=lt,e.exports.luaO_pushvfstring=Rt,e.exports.luaO_str2num=function(e,n){let N=function(e){let n,N=0,B=0,et=!0;for(;eF(e[N]);)N++;if(((n=45===e[N])||43===e[N])&&N++,48!==e[N]||120!==e[N+1]&&88!==e[N+1])for(;N<e.length&&eG(e[N]);N++){let ei=e[N]-48;if(B>=tl&&(B>tl||ei>tu+n))return null;B=10*B+ei|0,et=!1}else for(N+=2;N<e.length&&ez(e[N]);N++)B=16*B+Be(e[N])|0,et=!1;for(;N<e.length&&eF(e[N]);)N++;return et||N!==e.length&&0!==e[N]?null:{n:0|(n?-B:B),i:N}}(e);return null!==N?(n.setivalue(N.n),N.i+1):null!==(N=function(e){let n=e.length,N=0;for(let B=0;B<n;B++){let n=e[B];if(-1!==ti.indexOf(n)){N=n;break}}let B=to[N];return"n"===B?null:Fe(e,B)}(e))?(n.setfltvalue(N.n),N.i+1):0},e.exports.luaO_tostring=vt,e.exports.luaO_utf8esc=De,e.exports.numarith=At,e.exports.pushobj2s=function(e,n){e.stack[e.top++]=new ce(n.type,n.value)},e.exports.pushsvalue2s=function(e,n){e.stack[e.top++]=new ce(ew,n)},e.exports.setobjs2s=function(e,n,N){e.stack[n].setfrom(e.stack[N])},e.exports.setobj2s=function(e,n,N){e.stack[n].setfrom(N)},e.exports.setsvalue2s=Ne},function(e,n,N){let B,et;let{LUAL_BUFFERSIZE:ei}=N(3),{LUA_ERRERR:eo,LUA_MULTRET:el,LUA_REGISTRYINDEX:eu,LUA_SIGNATURE:ec,LUA_TBOOLEAN:ef,LUA_TLIGHTUSERDATA:eh,LUA_TNIL:ep,LUA_TNONE:ed,LUA_TNUMBER:e_,LUA_TSTRING:eg,LUA_TTABLE:em,LUA_VERSION_NUM:eb,lua_Debug:ey,lua_absindex:ev,lua_atpanic:ek,lua_call:eA,lua_checkstack:eL,lua_concat:ex,lua_copy:ew,lua_createtable:eT,lua_error:eO,lua_getfield:eE,lua_getinfo:eS,lua_getmetatable:eN,lua_getstack:eI,lua_gettop:eR,lua_insert:eU,lua_isinteger:eC,lua_isnil:eM,lua_isnumber:eP,lua_isstring:eD,lua_istable:eB,lua_len:eK,lua_load:eG,lua_newstate:eV,lua_newtable:eF,lua_next:ez,lua_pcall:ej,lua_pop:eH,lua_pushboolean:e$,lua_pushcclosure:eX,lua_pushcfunction:eq,lua_pushfstring:eW,lua_pushinteger:eZ,lua_pushliteral:eY,lua_pushlstring:eJ,lua_pushnil:eQ,lua_pushstring:e0,lua_pushvalue:e1,lua_pushvfstring:e2,lua_rawequal:e3,lua_rawget:e5,lua_rawgeti:e4,lua_rawlen:e8,lua_rawseti:e6,lua_remove:e9,lua_setfield:e7,lua_setglobal:ti,lua_setmetatable:to,lua_settop:tl,lua_toboolean:tu,lua_tointeger:tc,lua_tointegerx:tf,lua_tojsstring:th,lua_tolstring:tp,lua_tonumber:td,lua_tonumberx:t_,lua_topointer:tg,lua_tostring:tm,lua_touserdata:tb,lua_type:ty,lua_typename:tv,lua_version:tk}=N(2),{from_userstring:tA,luastring_eq:tL,to_luastring:tx,to_uristring:tw}=N(5),tT=eo+1,tO=tx("_LOADED"),tE=tx("_PRELOAD"),tS=tx("FILE*"),tN=tx("__name"),tI=tx("__tostring"),tR=new Uint8Array(0);let U=class U{constructor(){this.L=null,this.b=tR,this.n=0}};let pe=function(e,n,N){if(0===N||!eB(e,-1))return 0;for(eQ(e);ez(e,-2);){if(ty(e,-2)===eg){if(e3(e,n,-1))return eH(e,1),1;if(pe(e,n,N-1))return e9(e,-2),eY(e,"."),eU(e,-2),ex(e,3),1}eH(e,1)}return 0},Ke=function(e,n){let N=eR(e);if(eS(e,tx("f"),n),eE(e,eu,tO),pe(e,N+1,2)){let n=tm(e,-1);return 95===n[0]&&71===n[1]&&46===n[2]&&(e0(e,n.subarray(3)),e9(e,-2)),ew(e,-1,N+1),eH(e,2),1}return tl(e,N),0},Qe=function(e,n){Ke(e,n)?(eW(e,tx("function '%s'"),tm(e,-1)),e9(e,-2)):0!==n.namewhat.length?eW(e,tx("%s '%s'"),n.namewhat,n.name):n.what&&109===n.what[0]?eY(e,"main chunk"):n.what&&76===n.what[0]?eW(e,tx("function <%s:%d>"),n.short_src,n.linedefined):eY(e,"?")},kt=function(e){throw Error("PANIC: unprotected error in call to Lua API ("+th(e,-1)+")")},J=function(e,n,N){let B=new ey;return eI(e,0,B)?(eS(e,tx("n"),B),tL(B.namewhat,tx("method"))&&0==--n?V(e,tx("calling '%s' on bad self (%s)"),B.name,N):(null===B.name&&(B.name=Ke(e,B)?tm(e,-1):tx("?")),V(e,tx("bad argument #%d to '%s' (%s)"),n,B.name,N))):V(e,tx("bad argument #%d (%s)"),n,N)},Z=function(e,n,N){let B;B=Xe(e,n,tN)===eg?tm(e,-1):ty(e,n)===eh?tx("light userdata",!0):ct(e,n);let et=eW(e,tx("%s expected, got %s"),N,B);return J(e,n,et)},ke=function(e,n){let N=new ey;eI(e,n,N)&&(eS(e,tx("Sl",!0),N),N.currentline>0)?eW(e,tx("%s:%d: "),N.short_src,N.currentline):e0(e,tx(""))},V=function(e,n,...N){return ke(e,1),e2(e,n,N),ex(e,2),eO(e)},Te=function(e,n,N,B){if(n)return e$(e,1),1;{let n,et;return eQ(e),B?(n=B.message,et=-B.errno):(n="Success",et=0),N?eW(e,tx("%s: %s"),N,tx(n)):e0(e,tx(n)),eZ(e,et),3}},fe=function(e,n){return eE(e,eu,n)},Me=function(e,n,N){let B=tb(e,n);return null!==B&&eN(e,n)?(fe(e,N),e3(e,-1,-2)||(B=null),eH(e,2),B):null},tt=function(e,n,N){Z(e,n,tv(e,N))},ct=function(e,n){return tv(e,ty(e,n))},at=function(e,n){let N=tp(e,n);return null!=N||tt(e,n,eg),N},Ct=function(e,n,N){return 0>=ty(e,n)?null===N?null:tA(N):at(e,n)},Et=function(e,n){let N=t_(e,n);return!1===N&&tt(e,n,e_),N},wt=function(e,n){let N=tf(e,n);return!1===N&&(eP(e,n)?J(e,n,tx("number has no integer representation",!0)):tt(e,n,e_)),N},Bt=function(e,n){let N=e.n+n;if(e.b.length<N){let n=Math.max(2*e.b.length,N),B=new Uint8Array(n);B.set(e.b),e.b=B}return e.b.subarray(e.n,N)},Mt=function(e,n){n.L=e,n.b=tR},Zt=function(e,n,N){N>0&&(n=tA(n),Bt(e,N).set(n.subarray(0,N)),Xt(e,N))},Dt=function(e,n){Zt(e,n=tA(n),n.length)},qt=function(e){eJ(e.L,e.b,e.n),e.n=0,e.b=tR},Xt=function(e,n){e.n+=n},j=function(e,n,N,B){return 0>=ty(e,N)?B:n(e,N)},Le=function(e,n){let N=n.string;return n.string=null,N},Ye=function(e,n,N,B,et){return eG(e,Le,{string:n},B,et)},Je=function(e,n,N,B){return Ye(e,n,0,B,null)},ot=function(e,n){return Je(e,n,n.length,n)},Xe=function(e,n,N){if(eN(e,n)){e0(e,N);let n=e5(e,-2);return n===ep?eH(e,2):e9(e,-2),n}return ep},qe=function(e,n,N){return n=ev(e,n),Xe(e,n,N)!==ep&&(e1(e,n),eA(e,1,1),!0)},tU=tx("%I"),tC=tx("%f"),ht=function(e,n,N){var B=N>>>0,et=n.length,ei=e.length+1-et;e:for(;B<ei;B++){for(let N=0;N<et;N++)if(e[B+N]!==n[N])continue e;return B}return -1},k=function(e,n,N){return eE(e,n,N)===em||(eH(e,1),n=ev(e,n),eF(e),e1(e,-1),e7(e,n,N),!1)},se=function(e,n,N){for(let B in re(e,N,tx("too many upvalues",!0)),n){for(let n=0;n<N;n++)e1(e,-N);eX(e,n[B],N),e7(e,-(N+2),tx(B))}eH(e,N)},re=function(e,n,N){eL(e,n)||(N?V(e,tx("stack overflow (%s)"),N):V(e,tx("stack overflow",!0)))},Ee=function(e,n,N,B){let et=B.message,ei=tm(e,N).subarray(1);return eW(e,tx("cannot %s %s: %s"),tx(n),ei,tx(et)),e9(e,N),tT},tM=[239,187,191],ft=function(e){let n=function(e){let n;e.n=0;let N=0;do{if(null===(n=B(e))||n!==tM[N])return n;N++,e.buff[e.n++]=n}while(N<tM.length);return e.n=0,B(e)}(e);if(35===n){do n=B(e);while(n&&10!==n);return{skipped:!0,c:B(e)}}return{skipped:!1,c:n}};{let P=class P{constructor(){this.n=NaN,this.f=null,this.buff=new Uint8Array(1024),this.pos=0,this.err=void 0}};let ne=function(e,n){if(null!==n.f&&n.n>0){let e=n.n;return n.n=0,n.f=n.f.subarray(n.pos),n.buff.subarray(0,e)}let N=n.f;return n.f=null,N};B=function(e){return e.pos<e.f.length?e.f[e.pos++]:null},et=function(e,n,N){let B=new P,et=eR(e)+1;if(null===n)throw Error("Can't read stdin in the browser");{eW(e,tx("@%s"),n);let N=tw(n),ei=new XMLHttpRequest;if(ei.open("GET",N,!1),typeof window>"u"&&(ei.responseType="arraybuffer"),ei.send(),!(ei.status>=200&&ei.status<=299))return B.err=ei.status,Ee(e,"open",et,{message:`${ei.status}: ${ei.statusText}`});"string"==typeof ei.response?B.f=tx(ei.response):B.f=new Uint8Array(ei.response)}let ei=ft(B);ei.c===ec[0]&&n||ei.skipped&&(B.buff[B.n++]=10),null!==ei.c&&(B.buff[B.n++]=ei.c);let eo=eG(e,ne,B,tm(e,-1),N),el=B.err;return el?(tl(e,et),Ee(e,"read",et,el)):(e9(e,et),eo)}}let Lt=function(e,n){return et(e,n,null)},Ut=function(e,n,N){let B=tk(e);72!=N&&V(e,tx("core and library have incompatible numeric types")),B!=tk(null)?V(e,tx("multiple Lua VMs detected")):B!==n&&V(e,tx("version mismatch: app. needs %f, Lua core provides %f"),n,B)};e.exports.LUA_ERRFILE=tT,e.exports.LUA_FILEHANDLE=tS,e.exports.LUA_LOADED_TABLE=tO,e.exports.LUA_NOREF=-2,e.exports.LUA_PRELOAD_TABLE=tE,e.exports.LUA_REFNIL=-1,e.exports.luaL_Buffer=U,e.exports.luaL_addchar=function(e,n){Bt(e,1),e.b[e.n++]=n},e.exports.luaL_addlstring=Zt,e.exports.luaL_addsize=Xt,e.exports.luaL_addstring=Dt,e.exports.luaL_addvalue=function(e){let n=e.L,N=tm(n,-1);Zt(e,N,N.length),eH(n,1)},e.exports.luaL_argcheck=function(e,n,N,B){n||J(e,N,B)},e.exports.luaL_argerror=J,e.exports.luaL_buffinit=Mt,e.exports.luaL_buffinitsize=function(e,n,N){return Mt(e,n),Bt(n,N)},e.exports.luaL_callmeta=qe,e.exports.luaL_checkany=function(e,n){ty(e,n)===ed&&J(e,n,tx("value expected",!0))},e.exports.luaL_checkinteger=wt,e.exports.luaL_checklstring=at,e.exports.luaL_checknumber=Et,e.exports.luaL_checkoption=function(e,n,N,B){let et=null!==N?Ct(e,n,N):at(e,n);for(let e=0;B[e];e++)if(tL(B[e],et))return e;return J(e,n,eW(e,tx("invalid option '%s'"),et))},e.exports.luaL_checkstack=re,e.exports.luaL_checkstring=at,e.exports.luaL_checktype=function(e,n,N){ty(e,n)!==N&&tt(e,n,N)},e.exports.luaL_checkudata=function(e,n,N){let B=Me(e,n,N);return null===B&&Z(e,n,N),B},e.exports.luaL_checkversion=function(e){Ut(e,eb,72)},e.exports.luaL_checkversion_=Ut,e.exports.luaL_dofile=function(e,n){return Lt(e,n)||ej(e,0,el,0)},e.exports.luaL_dostring=function(e,n){return ot(e,n)||ej(e,0,el,0)},e.exports.luaL_error=V,e.exports.luaL_execresult=function(e,n){let N,B;if(null===n)return e$(e,1),eY(e,"exit"),eZ(e,0),3;if(n.status)N="exit",B=n.status;else{if(!n.signal)return Te(e,0,null,n);N="signal",B=n.signal}return eQ(e),eY(e,N),eZ(e,B),3},e.exports.luaL_fileresult=Te,e.exports.luaL_getmetafield=Xe,e.exports.luaL_getmetatable=fe,e.exports.luaL_getsubtable=k,e.exports.luaL_gsub=function(e,n,N,B){let et,ei=new U;for(Mt(e,ei);(et=ht(n,N))>=0;)Zt(ei,n,et),Dt(ei,B),n=n.subarray(et+N.length);return Dt(ei,n),qt(ei),tm(e,-1)},e.exports.luaL_len=function(e,n){eK(e,n);let N=tf(e,-1);return!1===N&&V(e,tx("object length is not an integer",!0)),eH(e,1),N},e.exports.luaL_loadbuffer=Je,e.exports.luaL_loadbufferx=Ye,e.exports.luaL_loadfile=Lt,e.exports.luaL_loadfilex=et,e.exports.luaL_loadstring=ot,e.exports.luaL_newlib=function(e,n){eT(e),se(e,n,0)},e.exports.luaL_newlibtable=function(e){eT(e)},e.exports.luaL_newmetatable=function(e,n){return fe(e,n)!==ep?0:(eH(e,1),eT(e,0,2),e0(e,n),e7(e,-2,tN),e1(e,-1),e7(e,eu,n),1)},e.exports.luaL_newstate=function(){let e=eV();return e&&ek(e,kt),e},e.exports.luaL_opt=j,e.exports.luaL_optinteger=function(e,n,N){return j(e,wt,n,N)},e.exports.luaL_optlstring=Ct,e.exports.luaL_optnumber=function(e,n,N){return j(e,Et,n,N)},e.exports.luaL_optstring=Ct,e.exports.luaL_prepbuffer=function(e){return Bt(e,ei)},e.exports.luaL_prepbuffsize=Bt,e.exports.luaL_pushresult=qt,e.exports.luaL_pushresultsize=function(e,n){Xt(e,n),qt(e)},e.exports.luaL_ref=function(e,n){let N;return eM(e,-1)?(eH(e,1),-1):(n=ev(e,n),e4(e,n,0),N=tc(e,-1),eH(e,1),0!==N?(e4(e,n,N),e6(e,n,0)):N=e8(e,n)+1,e6(e,n,N),N)},e.exports.luaL_requiref=function(e,n,N,B){k(e,eu,tO),eE(e,-1,n),tu(e,-1)||(eH(e,1),eq(e,N),e0(e,n),eA(e,1,1),e1(e,-1),e7(e,-3,n)),e9(e,-2),B&&(e1(e,-1),ti(e,n))},e.exports.luaL_setfuncs=se,e.exports.luaL_setmetatable=function(e,n){fe(e,n),to(e,-2)},e.exports.luaL_testudata=Me,e.exports.luaL_tolstring=function(e,n){if(qe(e,n,tI))eD(e,-1)||V(e,tx("'__tostring' must return a string"));else switch(ty(e,n)){case e_:eC(e,n)?eW(e,tU,tc(e,n)):eW(e,tC,td(e,n));break;case eg:e1(e,n);break;case ef:eY(e,tu(e,n)?"true":"false");break;case ep:eY(e,"nil");break;default:{let N=Xe(e,n,tN),B=N===eg?tm(e,-1):ct(e,n);eW(e,tx("%s: %p"),B,tg(e,n)),N!==ep&&e9(e,-2)}}return tp(e,-1)},e.exports.luaL_traceback=function(e,n,N,B){let et=new ey,ei=eR(e),eo=function(e){let n=new ey,N=1,B=1;for(;eI(e,B,n);)N=B,B*=2;for(;N<B;){let et=Math.floor((N+B)/2);eI(e,et,n)?N=et+1:B=et}return B-1}(n),el=eo-B>21?10:-1;for(N&&eW(e,tx(`%s
`),N),re(e,10,null),eY(e,"stack traceback:");eI(n,B++,et);)0==el--?(eY(e,`
	...`),B=eo-11+1):(eS(n,tx("Slnt",!0),et),eW(e,tx(`
	%s:`),et.short_src),et.currentline>0&&eY(e,`${et.currentline}:`),eY(e," in "),Qe(e,et),et.istailcall&&eY(e,`
	(...tail calls..)`),ex(e,eR(e)-ei));ex(e,eR(e)-ei)},e.exports.luaL_typename=ct,e.exports.luaL_unref=function(e,n,N){N>=0&&(n=ev(e,n),e4(e,n,0),e6(e,n,N),eZ(e,N),e6(e,n,0))},e.exports.luaL_where=ke,e.exports.lua_writestringerror=function(){for(let e=0;e<arguments.length;e++){let n=arguments[e];do{let e=/([^\n]*)\n?([\d\D]*)/.exec(n);console.error(e[1]),n=e[2]}while(""!==n)}}},function(e,n,N){let{LUA_HOOKCALL:B,LUA_HOOKRET:et,LUA_HOOKTAILCALL:ei,LUA_MASKCALL:eo,LUA_MASKLINE:el,LUA_MASKRET:eu,LUA_MINSTACK:ec,LUA_MULTRET:ef,LUA_SIGNATURE:eh,constant_types:{LUA_TCCL:ep,LUA_TLCF:ed,LUA_TLCL:e_,LUA_TNIL:eg},thread_status:{LUA_ERRMEM:em,LUA_ERRERR:eb,LUA_ERRRUN:ey,LUA_ERRSYNTAX:ev,LUA_OK:ek,LUA_YIELD:eA},lua_Debug:eL,luastring_indexOf:ex,to_luastring:ew}=N(1),eT=N(18),eO=N(11),eE=N(13),{api_check:eS,lua_assert:eN,LUAI_MAXCCALLS:eI}=N(4),eR=N(6),eU=N(16),eC=N(23),eM=N(12),{luaS_newliteral:eP}=N(10),eD=N(14),{LUAI_MAXSTACK:eB}=N(3),eK=N(36),eG=N(15),{MBuffer:eV}=N(19),Ue=function(e,n){if(e.top<n)for(;e.top<n;)e.stack[e.top++]=new eR.TValue(eg,null);else for(;e.top>n;)delete e.stack[--e.top]},He=function(e,n,N){let B=e.top;for(;e.top<N+1;)e.stack[e.top++]=new eR.TValue(eg,null);switch(n){case em:eR.setsvalue2s(e,N,eP(e,"not enough memory"));break;case eb:eR.setsvalue2s(e,N,eP(e,"error in error handling"));break;default:eR.setobjs2s(e,N,B-1)}for(;e.top>N+1;)delete e.stack[--e.top]},eF=eB+200,Ze=function(e,n){eN(n<=eB||n==eF),eN(e.stack_last==e.stack.length-eM.EXTRA_STACK),e.stack.length=n,e.stack_last=n-eM.EXTRA_STACK},ae=function(e,n){let N=e.stack.length;if(N>eB)q(e,eb);else{let B=e.top+n+eM.EXTRA_STACK,et=2*N;et>eB&&(et=eB),et<B&&(et=B),et>eB?(Ze(e,eF),eO.luaG_runerror(e,ew("stack overflow",!0))):Ze(e,et)}},le=function(e,n){e.stack_last-e.top<=n&&ae(e,n)},Pe=function(e){let n=function(e){let n=e.top;for(let N=e.ci;null!==N;N=N.previous)n<N.top&&(n=N.top);return eN(n<=e.stack_last),n+1}(e),N=n+Math.floor(n/8)+2*eM.EXTRA_STACK;N>eB&&(N=eB),e.stack.length>eB&&eM.luaE_freeCI(e),n<=eB-eM.EXTRA_STACK&&N<e.stack.length&&Ze(e,N)},xe=function(e,n,N){let et=e.stack[n];switch(et.type){case ep:case ed:{let ei=et.type===ep?et.value.f:et.value;le(e,ec);let el=eM.luaE_extendCI(e);el.funcOff=n,el.nresults=N,el.func=et,el.top=e.top+ec,eN(el.top<=e.stack_last),el.callstatus=0,e.hookmask&eo&&ge(e,B,-1);let eu=ei(e);if("number"!=typeof eu||eu<0||(0|eu)!==eu)throw Error("invalid return value from JS function (expected integer)");return eT.api_checknelems(e,eu),Ge(e,el,e.top-eu,eu),!0}case e_:{let B,ei=et.value.p,el=e.top-n-1,eu=ei.maxstacksize;if(le(e,eu),ei.is_vararg)B=A(e,ei,el);else{for(;el<ei.numparams;el++)e.stack[e.top++]=new eR.TValue(eg,null);B=n+1}let ec=eM.luaE_extendCI(e);return ec.funcOff=n,ec.nresults=N,ec.func=et,ec.l_base=B,ec.top=B+eu,Ue(e,ec.top),ec.l_code=ei.code,ec.l_savedpc=0,ec.callstatus=eM.CIST_LUA,e.hookmask&eo&&te(e,ec),!1}default:return le(e,1),S(e,n,et),xe(e,n,N)}},Ge=function(e,n,N,B){let ei=n.nresults;e.hookmask&(eu|el)&&(e.hookmask&eu&&ge(e,et,-1),e.oldpc=n.previous.l_savedpc);let eo=n.funcOff;return e.ci=n.previous,e.ci.next=null,g(e,N,eo,B,ei)},g=function(e,n,N,B,et){switch(et){case 0:break;case 1:0===B?e.stack[N].setnilvalue():eR.setobjs2s(e,N,n);break;case ef:for(let et=0;et<B;et++)eR.setobjs2s(e,N+et,n+et);for(let n=e.top;n>=N+B;n--)delete e.stack[n];return e.top=N+B,!1;default:{let ei;if(et<=B)for(ei=0;ei<et;ei++)eR.setobjs2s(e,N+ei,n+ei);else{for(ei=0;ei<B;ei++)eR.setobjs2s(e,N+ei,n+ei);for(;ei<et;ei++)N+ei>=e.top?e.stack[N+ei]=new eR.TValue(eg,null):e.stack[N+ei].setnilvalue()}}}let ei=N+et;for(let n=e.top;n>=ei;n--)delete e.stack[n];return e.top=ei,!0},ge=function(e,n,N){let B=e.hook;if(B&&e.allowhook){let et=e.ci,ei=e.top,eo=et.top,el=new eL;el.event=n,el.currentline=N,el.i_ci=et,le(e,ec),et.top=e.top+ec,eN(et.top<=e.stack_last),e.allowhook=0,et.callstatus|=eM.CIST_HOOKED,B(e,el),eN(!e.allowhook),e.allowhook=1,et.top=eo,Ue(e,ei),et.callstatus&=~eM.CIST_HOOKED}},te=function(e,n){let N=B;n.l_savedpc++,n.previous.callstatus&eM.CIST_LUA&&n.previous.l_code[n.previous.l_savedpc-1].opcode==eU.OpCodesI.OP_TAILCALL&&(n.callstatus|=eM.CIST_TAIL,N=ei),ge(e,N,-1),n.l_savedpc--},A=function(e,n,N){let B,et=n.numparams,ei=e.top-N,eo=e.top;for(B=0;B<et&&B<N;B++)eR.pushobj2s(e,e.stack[ei+B]),e.stack[ei+B].setnilvalue();for(;B<et;B++)e.stack[e.top++]=new eR.TValue(eg,null);return eo},S=function(e,n,N){let B=eD.luaT_gettmbyobj(e,N,eD.TMS.TM_CALL);B.ttisfunction(B)||eO.luaG_typeerror(e,N,ew("call",!0)),eR.pushobj2s(e,e.stack[e.top-1]);for(let N=e.top-2;N>n;N--)eR.setobjs2s(e,N,N-1);eR.setobj2s(e,n,B)},v=function(e,n,N){++e.nCcalls>=eI&&(e.nCcalls===eI?eO.luaG_runerror(e,ew("JS stack overflow",!0)):e.nCcalls>=eI+(eI>>3)&&q(e,eb)),xe(e,n,N)||eG.luaV_execute(e),e.nCcalls--},q=function(e,n){if(e.errorJmp)throw e.errorJmp.status=n,e.errorJmp;{let N=e.l_G;if(e.status=n,!N.mainthread.errorJmp){let B=N.panic;throw B&&(He(e,n,e.top),e.ci.top<e.top&&(e.ci.top=e.top),B(e)),Error(`Aborted ${n}`)}N.mainthread.stack[N.mainthread.top++]=e.stack[e.top-1],q(N.mainthread,n)}},oe=function(e,n,N){let B=e.nCcalls,et={status:ek,previous:e.errorJmp};e.errorJmp=et;try{n(e,N)}catch(n){if(et.status===ek){let N=e.l_G.atnativeerror;if(N)try{if(et.status=ek,eT.lua_pushcfunction(e,N),eT.lua_pushlightuserdata(e,n),xt(e,e.top-2,1),0!==e.errfunc){let n=e.errfunc;eR.pushobj2s(e,e.stack[e.top-1]),eR.setobjs2s(e,e.top-2,n),xt(e,e.top-2,1)}et.status=ey}catch{et.status===ek&&(et.status=-1)}else et.status=-1}}return e.errorJmp=et.previous,e.nCcalls=B,et.status},O=function(e,n){let N=e.ci;eN(null!==N.c_k&&0===e.nny),eN(N.callstatus&eM.CIST_YPCALL||n===eA),N.callstatus&eM.CIST_YPCALL&&(N.callstatus&=~eM.CIST_YPCALL,e.errfunc=N.c_old_errfunc),N.nresults===ef&&e.ci.top<e.top&&(e.ci.top=e.top);let B=(0,N.c_k)(e,n,N.c_ctx);eT.api_checknelems(e,B),Ge(e,N,e.top-B,B)},ee=function(e,n){for(null!==n&&O(e,n);e.ci!==e.base_ci;)e.ci.callstatus&eM.CIST_LUA?(eG.luaV_finishOp(e),eG.luaV_execute(e)):O(e,eA)},ce=function(e,n){let N=function(e){for(let n=e.ci;null!==n;n=n.previous)if(n.callstatus&eM.CIST_YPCALL)return n;return null}(e);if(null===N)return 0;let B=N.extra;return eE.luaF_close(e,B),He(e,n,B),e.ci=N,e.allowhook=N.callstatus&eM.CIST_OAH,e.nny=0,Pe(e),e.errfunc=N.c_old_errfunc,1},Ne=function(e,n,N){let B=eP(e,n);if(0===N)eR.pushsvalue2s(e,B),eS(e,e.top<=e.ci.top,"stack overflow");else{for(let n=1;n<N;n++)delete e.stack[--e.top];eR.setsvalue2s(e,e.top-1,B)}return ey},$e=function(e,n){let N=e.top-n,B=e.ci;e.status===ek?xe(e,N-1,ef)||eG.luaV_execute(e):(eN(e.status===eA),e.status=ek,B.funcOff=B.extra,B.func=e.stack[B.funcOff],B.callstatus&eM.CIST_LUA?eG.luaV_execute(e):(null!==B.c_k&&(n=B.c_k(e,eA,B.c_ctx),eT.api_checknelems(e,n),N=e.top-n),Ge(e,B,N,n)),ee(e,null))},nt=function(e,n,N,B){let et=e.ci;return eT.api_checknelems(e,n),e.nny>0&&(e!==e.l_G.mainthread?eO.luaG_runerror(e,ew("attempt to yield across a JS-call boundary",!0)):eO.luaG_runerror(e,ew("attempt to yield from outside a coroutine",!0))),e.status=eA,et.extra=et.funcOff,et.callstatus&eM.CIST_LUA?eS(e,null===B,"hooks cannot continue after yielding"):(et.c_k=B,null!==B&&(et.c_ctx=N),et.funcOff=e.top-n-1,et.func=e.stack[et.funcOff],q(e,eA)),eN(et.callstatus&eM.CIST_HOOKED),0},dt=function(e,n,N,B,et){let ei=e.ci,eo=e.allowhook,el=e.nny,eu=e.errfunc;e.errfunc=et;let ec=oe(e,n,N);return ec!==ek&&(eE.luaF_close(e,B),He(e,ec,B),e.ci=ei,e.allowhook=eo,e.nny=el,Pe(e)),e.errfunc=eu,ec},xt=function(e,n,N){e.nny++,v(e,n,N),e.nny--},Ot=function(e,n,N){n&&-1===ex(n,N[0])&&(eR.luaO_pushfstring(e,ew("attempt to load a %s chunk (mode is '%s')"),N,n),q(e,ev))},St=function(e,n){let N,B=n.z.zgetc();B===eh[0]?(Ot(e,n.mode,ew("binary",!0)),N=eK.luaU_undump(e,n.z,n.name)):(Ot(e,n.mode,ew("text",!0)),N=eC.luaY_parser(e,n.z,n.buff,n.dyd,n.name,B)),eN(N.nupvalues===N.p.upvalues.length),eE.luaF_initupvals(e,N)};e.exports.adjust_top=Ue,e.exports.luaD_call=v,e.exports.luaD_callnoyield=xt,e.exports.luaD_checkstack=le,e.exports.luaD_growstack=ae,e.exports.luaD_hook=ge,e.exports.luaD_inctop=function(e){le(e,1),e.stack[e.top++]=new eR.TValue(eg,null)},e.exports.luaD_pcall=dt,e.exports.luaD_poscall=Ge,e.exports.luaD_precall=xe,e.exports.luaD_protectedparser=function(e,n,N,B){let et=new class{constructor(e,n,N){this.z=e,this.buff=new eV,this.dyd=new eC.Dyndata,this.mode=N,this.name=n}}(n,N,B);e.nny++;let ei=dt(e,St,et,e.top,e.errfunc);return e.nny--,ei},e.exports.luaD_rawrunprotected=oe,e.exports.luaD_reallocstack=Ze,e.exports.luaD_throw=q,e.exports.lua_isyieldable=function(e){return 0===e.nny},e.exports.lua_resume=function(e,n,N){let B=e.nny;if(e.status===ek){if(e.ci!==e.base_ci)return Ne(e,"cannot resume non-suspended coroutine",N)}else if(e.status!==eA)return Ne(e,"cannot resume dead coroutine",N);if(e.nCcalls=n?n.nCcalls+1:1,e.nCcalls>=eI)return Ne(e,"JS stack overflow",N);e.nny=0,eT.api_checknelems(e,e.status===ek?N+1:N);let et=oe(e,$e,N);if(-1===et)et=ey;else{for(;et>eA&&ce(e,et);)et=oe(e,ee,et);et>eA?(e.status=et,He(e,et,e.top),e.ci.top=e.top):eN(et===e.status)}return e.nny=B,e.nCcalls--,eN(e.nCcalls===(n?n.nCcalls:0)),et},e.exports.lua_yield=function(e,n){nt(e,n,0,null)},e.exports.lua_yieldk=nt},function(e,n,N){let{constant_types:{LUA_TBOOLEAN:B,LUA_TCCL:et,LUA_TLCF:ei,LUA_TLCL:eo,LUA_TLIGHTUSERDATA:el,LUA_TLNGSTR:eu,LUA_TNIL:ec,LUA_TNUMFLT:ef,LUA_TNUMINT:eh,LUA_TSHRSTR:ep,LUA_TTABLE:ed,LUA_TTHREAD:e_,LUA_TUSERDATA:eg},to_luastring:em}=N(1),{lua_assert:eb}=N(4),ey=N(11),ev=N(6),{luaS_hashlongstr:ek,TString:eA}=N(10),eL=N(12),ex=new WeakMap,H=function(e){let n=ex.get(e);return n||(n={},ex.set(e,n)),n},$=function(e,n){switch(n.type){case ec:return ey.luaG_runerror(e,em("table index is nil",!0));case ef:if(isNaN(n.value))return ey.luaG_runerror(e,em("table index is NaN",!0));case eh:case B:case ed:case eo:case ei:case et:case eg:case e_:return n.value;case ep:case eu:return ek(n.tsvalue());case el:{let N=n.value;switch(typeof N){case"string":return"*"+N;case"number":return"#"+N;case"boolean":return N?"?true":"?false";case"function":return H(N);case"object":if(N instanceof eL.lua_State&&N.l_G===e.l_G||N instanceof Q||N instanceof ev.Udata||N instanceof ev.LClosure||N instanceof ev.CClosure)return H(N);default:return N}}default:throw Error("unknown key type: "+n.type)}};let Q=class Q{constructor(e){this.id=e.l_G.id_counter++,this.strong=new Map,this.dead_strong=new Map,this.dead_weak=void 0,this.f=void 0,this.l=void 0,this.metatable=null,this.flags=-1}};let he=function(e,n,N,B){e.dead_strong.clear(),e.dead_weak=void 0;let et=null,ei={key:N,value:B,p:et=e.l,n:void 0};e.f||(e.f=ei),et&&(et.n=ei),e.strong.set(n,ei),e.l=ei},F=function(e,n){let N=e.strong.get(n);if(N){N.key.setdeadvalue(),N.value=void 0;let B=N.n,et=N.p;N.p=void 0,et&&(et.n=B),B&&(B.p=et),e.f===N&&(e.f=B),e.l===N&&(e.l=et),e.strong.delete(n),("object"==typeof n?null!==n:"function"==typeof n)?(e.dead_weak||(e.dead_weak=new WeakMap),e.dead_weak.set(n,N)):e.dead_strong.set(n,N)}},ie=function(e,n){let N=e.strong.get(n);return N?N.value:ev.luaO_nilobject},y=function(e,n){return eb("number"==typeof n&&(0|n)===n),ie(e,n)};e.exports.invalidateTMcache=function(e){e.flags=0},e.exports.luaH_get=function(e,n,N){return eb(N instanceof ev.TValue),N.ttisnil()||N.ttisfloat()&&isNaN(N.value)?ev.luaO_nilobject:ie(n,$(e,N))},e.exports.luaH_getint=y,e.exports.luaH_getn=function(e){let n=0,N=e.strong.size+1;for(;N-n>1;){let B=Math.floor((n+N)/2);y(e,B).ttisnil()?N=B:n=B}return n},e.exports.luaH_getstr=function(e,n){return eb(n instanceof eA),ie(e,ek(n))},e.exports.luaH_setfrom=function(e,n,N,B){eb(N instanceof ev.TValue);let et=$(e,N);if(B.ttisnil())return void F(n,et);let ei=n.strong.get(et);if(ei)ei.value.setfrom(B);else{let e=N.value;he(n,et,N.ttisfloat()&&(0|e)===e?new ev.TValue(eh,e):new ev.TValue(N.type,e),new ev.TValue(B.type,B.value))}},e.exports.luaH_setint=function(e,n,N){if(eb("number"==typeof n&&(0|n)===n&&N instanceof ev.TValue),N.ttisnil())return void F(e,n);let B=e.strong.get(n);if(B)B.value.setfrom(N);else{let B=new ev.TValue(eh,n);he(e,n,B,new ev.TValue(N.type,N.value))}},e.exports.luaH_new=function(e){return new Q(e)},e.exports.luaH_next=function(e,n,N){let B,et=e.stack[N];if(et.type===ec){if(!(B=n.f))return!1}else{let N=$(e,et);if(B=n.strong.get(N)){if(!(B=B.n))return!1}else{if(!(B=n.dead_weak&&n.dead_weak.get(N)||n.dead_strong.get(N)))return ey.luaG_runerror(e,em("invalid key to 'next'"));do if(!(B=B.n))return!1;while(B.key.ttisdeadkey())}}return ev.setobj2s(e,N,B.key),ev.setobj2s(e,N+1,B.value),!0},e.exports.Table=Q},function(e,n,N){let{is_luastring:B,luastring_eq:et,luastring_from:ei,to_luastring:eo}=N(1),{lua_assert:el}=N(4);let u=class u{constructor(e,n){this.hash=null,this.realstring=n}getstr(){return this.realstring}tsslen(){return this.realstring.length}};let h=function(e){el(B(e));let n=e.length,N="|";for(let B=0;B<n;B++)N+=e[B].toString(16);return N},w=function(e,n){return el(n instanceof Uint8Array),new u(e,n)};e.exports.luaS_eqlngstr=function(e,n){return el(e instanceof u),el(n instanceof u),e==n||et(e.realstring,n.realstring)},e.exports.luaS_hash=h,e.exports.luaS_hashlongstr=function(e){return el(e instanceof u),null===e.hash&&(e.hash=h(e.getstr())),e.hash},e.exports.luaS_bless=w,e.exports.luaS_new=function(e,n){return w(e,ei(n))},e.exports.luaS_newliteral=function(e,n){return w(e,eo(n))},e.exports.TString=u},function(e,n,N){let{LUA_HOOKCOUNT:B,LUA_HOOKLINE:et,LUA_MASKCOUNT:ei,LUA_MASKLINE:eo,constant_types:{LUA_TBOOLEAN:el,LUA_TNIL:eu,LUA_TTABLE:ec},thread_status:{LUA_ERRRUN:ef,LUA_YIELD:eh},from_userstring:ep,luastring_eq:ed,luastring_indexOf:e_,to_luastring:eg}=N(1),{api_check:em,lua_assert:eb}=N(4),{LUA_IDSIZE:ey}=N(3),ev=N(18),ek=N(8),eA=N(13),eL=N(20),ex=N(6),ew=N(16),eT=N(12),eO=N(9),eE=N(14),eS=N(15),ie=function(e){return eb(e.callstatus&eT.CIST_LUA),e.l_savedpc-1},y=function(e){return 0!==e.func.value.p.lineinfo.length?e.func.value.p.lineinfo[ie(e)]:-1},Y=function(e){if(e.status===eh){let n=e.ci,N=n.funcOff;n.func=e.stack[n.extra],n.funcOff=n.extra,n.extra=N}},de=function(e,n){eb(n<e.upvalues.length);let N=e.upvalues[n].name;return null===N?eg("?",!0):N.getstr()},_e=function(e,n,N){let B,et=null;if(n.callstatus&eT.CIST_LUA){if(N<0){var ei;let e;return ei=-N,e=n.func.value.p.numparams,ei>=n.l_base-n.funcOff-e?null:{pos:n.funcOff+e+ei,name:eg("(*vararg)",!0)}}B=n.l_base,et=eA.luaF_getlocalname(n.func.value.p,N,ie(n))}else B=n.funcOff+1;if(null===et){if(!((n===e.ci?e.top:n.next.funcOff)-B>=N&&N>0))return null;et=eg("(*temporary)",!0)}return{pos:B+(N-1),name:et}},me=function(e,n){if(null===n||n instanceof ex.CClosure)e.source=eg("=[JS]",!0),e.linedefined=-1,e.lastlinedefined=-1,e.what=eg("J",!0);else{let N=n.p;e.source=N.source?N.source.getstr():eg("=?",!0),e.linedefined=N.linedefined,e.lastlinedefined=N.lastlinedefined,e.what=0===e.linedefined?eg("main",!0):eg("Lua",!0)}e.short_src=ex.luaO_chunkid(e.source,ey)},ve=function(e,n){let N={name:null,funcname:null};return null===n?null:n.callstatus&eT.CIST_FIN?(N.name=eg("__gc",!0),N.funcname=eg("metamethod",!0),N):!(n.callstatus&eT.CIST_TAIL)&&n.previous.callstatus&eT.CIST_LUA?ye(e,n.previous):null},z=function(e,n,N){let B={name:null,funcname:null};if(ew.ISK(N)){let n=e.k[ew.INDEXK(N)];if(n.ttisstring())return B.name=n.svalue(),B}else{let B=C(e,n,N);if(B&&99===B.funcname[0])return B}return B.name=eg("?",!0),B},I=function(e,n){return e<n?-1:e},C=function(e,n,N){let B={name:eA.luaF_getlocalname(e,N+1,n),funcname:null};if(B.name)return B.funcname=eg("local",!0),B;let et=function(e,n,N){let B=-1,et=0,ei=ew.OpCodesI;for(let eo=0;eo<n;eo++){let el=e.code[eo],eu=el.A;switch(el.opcode){case ei.OP_LOADNIL:{let e=el.B;eu<=N&&N<=eu+e&&(B=I(eo,et));break}case ei.OP_TFORCALL:N>=eu+2&&(B=I(eo,et));break;case ei.OP_CALL:case ei.OP_TAILCALL:N>=eu&&(B=I(eo,et));break;case ei.OP_JMP:{let e=eo+1+el.sBx;eo<e&&e<=n&&e>et&&(et=e);break}default:ew.testAMode(el.opcode)&&N===eu&&(B=I(eo,et))}}return B}(e,n,N),ei=ew.OpCodesI;if(-1!==et){let n=e.code[et];switch(n.opcode){case ei.OP_MOVE:{let N=n.B;if(N<n.A)return C(e,et,N);break}case ei.OP_GETTABUP:case ei.OP_GETTABLE:{let N=n.C,eo=n.B,el=n.opcode===ei.OP_GETTABLE?eA.luaF_getlocalname(e,eo+1,et):de(e,eo);return B.name=z(e,et,N).name,B.funcname=el&&ed(el,eL.LUA_ENV)?eg("global",!0):eg("field",!0),B}case ei.OP_GETUPVAL:return B.name=de(e,n.B),B.funcname=eg("upvalue",!0),B;case ei.OP_LOADK:case ei.OP_LOADKX:{let N=n.opcode===ei.OP_LOADK?n.Bx:e.code[et+1].Ax;if(e.k[N].ttisstring())return B.name=e.k[N].svalue(),B.funcname=eg("constant",!0),B;break}case ei.OP_SELF:{let N=n.C;return B.name=z(e,et,N).name,B.funcname=eg("method",!0),B}}}return null},ye=function(e,n){let N={name:null,funcname:null},B=0,et=n.func.value.p,ei=ie(n),eo=et.code[ei],el=ew.OpCodesI;if(n.callstatus&eT.CIST_HOOKED)return N.name=eg("?",!0),N.funcname=eg("hook",!0),N;switch(eo.opcode){case el.OP_CALL:case el.OP_TAILCALL:return C(et,ei,eo.A);case el.OP_TFORCALL:return N.name=eg("for iterator",!0),N.funcname=eg("for iterator",!0),N;case el.OP_SELF:case el.OP_GETTABUP:case el.OP_GETTABLE:B=eE.TMS.TM_INDEX;break;case el.OP_SETTABUP:case el.OP_SETTABLE:B=eE.TMS.TM_NEWINDEX;break;case el.OP_ADD:B=eE.TMS.TM_ADD;break;case el.OP_SUB:B=eE.TMS.TM_SUB;break;case el.OP_MUL:B=eE.TMS.TM_MUL;break;case el.OP_MOD:B=eE.TMS.TM_MOD;break;case el.OP_POW:B=eE.TMS.TM_POW;break;case el.OP_DIV:B=eE.TMS.TM_DIV;break;case el.OP_IDIV:B=eE.TMS.TM_IDIV;break;case el.OP_BAND:B=eE.TMS.TM_BAND;break;case el.OP_BOR:B=eE.TMS.TM_BOR;break;case el.OP_BXOR:B=eE.TMS.TM_BXOR;break;case el.OP_SHL:B=eE.TMS.TM_SHL;break;case el.OP_SHR:B=eE.TMS.TM_SHR;break;case el.OP_UNM:B=eE.TMS.TM_UNM;break;case el.OP_BNOT:B=eE.TMS.TM_BNOT;break;case el.OP_LEN:B=eE.TMS.TM_LEN;break;case el.OP_CONCAT:B=eE.TMS.TM_CONCAT;break;case el.OP_EQ:B=eE.TMS.TM_EQ;break;case el.OP_LT:B=eE.TMS.TM_LT;break;case el.OP_LE:B=eE.TMS.TM_LE;break;default:return null}return N.name=e.l_G.tmname[B].getstr(),N.funcname=eg("metamethod",!0),N},be=function(e,n){let N=e.ci,B=null;if(N.callstatus&eT.CIST_LUA){B=function(e,n,N){let B=n.func.value;for(let e=0;e<B.nupvalues;e++)if(B.upvals[e]===N)return{name:de(B.p,e),funcname:eg("upvalue",!0)};return null}(0,N,n);let et=function(e,n,N){for(let B=n.l_base;B<n.top;B++)if(e.stack[B]===N)return B;return!1}(e,N,n);!B&&et&&(B=C(N.func.value.p,ie(N),et-N.l_base))}return B?ex.luaO_pushfstring(e,eg(" (%s '%s')",!0),B.funcname,B.name):eg("",!0)},Ue=function(e,n,N){let B=eE.luaT_objtypename(e,n);st(e,eg("attempt to %s a %s value%s",!0),N,B,be(e,n))},He=function(e,n,N,B){let et;return et=N?ex.luaO_chunkid(N.getstr(),ey):eg("?",!0),ex.luaO_pushfstring(e,eg("%s:%d: %s",!0),et,B,n)},st=function(e,n,...N){let B=e.ci,et=ex.luaO_pushvfstring(e,n,N);B.callstatus&eT.CIST_LUA&&He(e,et,B.func.value.p.source,y(B)),Ze(e)},Ze=function(e){if(0!==e.errfunc){let n=e.errfunc;ex.pushobj2s(e,e.stack[e.top-1]),ex.setobjs2s(e,e.top-2,n),ek.luaD_callnoyield(e,e.top-2,1)}ek.luaD_throw(e,ef)};e.exports.luaG_addinfo=He,e.exports.luaG_concaterror=function(e,n,N){(n.ttisstring()||eS.cvt2str(n))&&(n=N),Ue(e,n,eg("concatenate",!0))},e.exports.luaG_errormsg=Ze,e.exports.luaG_opinterror=function(e,n,N,B){!1===eS.tonumber(n)&&(N=n),Ue(e,N,B)},e.exports.luaG_ordererror=function(e,n,N){let B=eE.luaT_objtypename(e,n),et=eE.luaT_objtypename(e,N);ed(B,et)?st(e,eg("attempt to compare two %s values",!0),B):st(e,eg("attempt to compare %s with %s",!0),B,et)},e.exports.luaG_runerror=st,e.exports.luaG_tointerror=function(e,n,N){!1===eS.tointeger(n)&&(N=n),st(e,eg("number%s has no integer representation",!0),be(e,N))},e.exports.luaG_traceexec=function(e){let n=e.ci,N=e.hookmask,el=0==--e.hookcount&&N&ei;if(el)e.hookcount=e.basehookcount;else if(!(N&eo))return;if(n.callstatus&eT.CIST_HOOKYIELD)n.callstatus&=~eT.CIST_HOOKYIELD;else{if(el&&ek.luaD_hook(e,B,-1),N&eo){let N=n.func.value.p,B=n.l_savedpc-1,ei=0!==N.lineinfo.length?N.lineinfo[B]:-1;(0===B||n.l_savedpc<=e.oldpc||ei!==(0!==N.lineinfo.length?N.lineinfo[e.oldpc-1]:-1))&&ek.luaD_hook(e,et,ei)}e.oldpc=n.l_savedpc,e.status===eh&&(el&&(e.hookcount=1),n.l_savedpc--,n.callstatus|=eT.CIST_HOOKYIELD,n.funcOff=e.top-1,n.func=e.stack[n.funcOff],ek.luaD_throw(e,eh))}},e.exports.luaG_typeerror=Ue,e.exports.lua_gethook=function(e){return e.hook},e.exports.lua_gethookcount=function(e){return e.basehookcount},e.exports.lua_gethookmask=function(e){return e.hookmask},e.exports.lua_getinfo=function(e,n,N){let B,et,ei,eo;return n=ep(n),Y(e),62===n[0]?(ei=null,eo=e.stack[e.top-1],em(e,eo.ttisfunction(),"function expected"),n=n.subarray(1),e.top--):(eo=(ei=N.i_ci).func,eb(ei.func.ttisfunction())),B=function(e,n,N,B,et){let ei=1;for(;n.length>0;n=n.subarray(1))switch(n[0]){case 83:me(N,B);break;case 108:N.currentline=et&&et.callstatus&eT.CIST_LUA?y(et):-1;break;case 117:N.nups=null===B?0:B.nupvalues,null===B||B instanceof ex.CClosure?(N.isvararg=!0,N.nparams=0):(N.isvararg=B.p.is_vararg,N.nparams=B.p.numparams);break;case 116:N.istailcall=et?et.callstatus&eT.CIST_TAIL:0;break;case 110:{let n=ve(e,et);null===n?(N.namewhat=eg("",!0),N.name=null):(N.namewhat=n.funcname,N.name=n.name);break}case 76:case 102:break;default:ei=0}return ei}(e,n,N,et=eo.ttisclosure()?eo.value:null,ei),e_(n,102)>=0&&(ex.pushobj2s(e,eo),em(e,e.top<=e.ci.top,"stack overflow")),Y(e),e_(n,76)>=0&&function(e,n){if(null===n||n instanceof ex.CClosure)e.stack[e.top]=new ex.TValue(eu,null),ev.api_incr_top(e);else{let N=n.p.lineinfo,B=eO.luaH_new(e);e.stack[e.top]=new ex.TValue(ec,B),ev.api_incr_top(e);let et=new ex.TValue(el,!0);for(let e=0;e<N.length;e++)eO.luaH_setint(B,N[e],et)}}(e,et),B},e.exports.lua_getlocal=function(e,n,N){let B;if(Y(e),null===n)B=e.stack[e.top-1].ttisLclosure()?eA.luaF_getlocalname(e.stack[e.top-1].value.p,N,0):null;else{let et=_e(e,n.i_ci,N);et?(B=et.name,ex.pushobj2s(e,e.stack[et.pos]),em(e,e.top<=e.ci.top,"stack overflow")):B=null}return Y(e),B},e.exports.lua_getstack=function(e,n,N){let B,et;if(n<0)return 0;for(B=e.ci;n>0&&B!==e.base_ci;B=B.previous)n--;return 0===n&&B!==e.base_ci?(et=1,N.i_ci=B):et=0,et},e.exports.lua_sethook=function(e,n,N,B){null!==n&&0!==N||(N=0,n=null),e.ci.callstatus&eT.CIST_LUA&&(e.oldpc=e.ci.l_savedpc),e.hook=n,e.basehookcount=B,e.hookcount=e.basehookcount,e.hookmask=N},e.exports.lua_setlocal=function(e,n,N){let B;Y(e);let et=_e(e,n.i_ci,N);return et?(B=et.name,ex.setobjs2s(e,et.pos,e.top-1),delete e.stack[--e.top]):B=null,Y(e),B}},function(e,n,N){let{LUA_MINSTACK:B,LUA_RIDX_GLOBALS:et,LUA_RIDX_MAINTHREAD:ei,constant_types:{LUA_NUMTAGS:eo,LUA_TNIL:el,LUA_TTABLE:eu,LUA_TTHREAD:ec},thread_status:{LUA_OK:ef}}=N(1),eh=N(6),ep=N(8),ed=N(18),e_=N(9),eg=N(14),em=2*B;let b=class b{constructor(){this.func=null,this.funcOff=NaN,this.top=NaN,this.previous=null,this.next=null,this.l_base=NaN,this.l_code=null,this.l_savedpc=NaN,this.c_k=null,this.c_old_errfunc=null,this.c_ctx=null,this.nresults=NaN,this.callstatus=NaN}};let R=class R{constructor(e){this.id=e.id_counter++,this.base_ci=new b,this.top=NaN,this.stack_last=NaN,this.oldpc=NaN,this.l_G=e,this.stack=null,this.ci=null,this.errorJmp=null,this.nCcalls=0,this.hook=null,this.hookmask=0,this.basehookcount=0,this.allowhook=1,this.hookcount=this.basehookcount,this.nny=1,this.status=ef,this.errfunc=0}};let M=function(e){e.ci.next=null},K=function(e,n){e.stack=Array(em),e.top=0,e.stack_last=em-5;let N=e.base_ci;N.next=N.previous=null,N.callstatus=0,N.funcOff=e.top,N.func=e.stack[e.top],e.stack[e.top++]=new eh.TValue(el,null),N.top=e.top+B,e.ci=N},G=function(e){e.ci=e.base_ci,M(e),e.stack=null},W=function(e){let n,N=e.l_G;K(e),n=e_.luaH_new(e),N.l_registry.sethvalue(n),e_.luaH_setint(n,ei,new eh.TValue(ec,e)),e_.luaH_setint(n,et,new eh.TValue(eu,e_.luaH_new(e))),eg.luaT_init(e),N.version=ed.lua_version(null)};e.exports.lua_State=R,e.exports.CallInfo=b,e.exports.CIST_OAH=1,e.exports.CIST_LUA=2,e.exports.CIST_HOOKED=4,e.exports.CIST_FRESH=8,e.exports.CIST_YPCALL=16,e.exports.CIST_TAIL=32,e.exports.CIST_HOOKYIELD=64,e.exports.CIST_LEQ=128,e.exports.CIST_FIN=256,e.exports.EXTRA_STACK=5,e.exports.lua_close=function(e){G(e=e.l_G.mainthread)},e.exports.lua_newstate=function(){let e=new class{constructor(){this.id_counter=1,this.ids=new WeakMap,this.mainthread=null,this.l_registry=new eh.TValue(el,null),this.panic=null,this.atnativeerror=null,this.version=null,this.tmname=Array(eg.TMS.TM_N),this.mt=Array(eo)}},n=new R(e);return e.mainthread=n,ep.luaD_rawrunprotected(n,W,null)!==ef&&(n=null),n},e.exports.lua_newthread=function(e){let n=e.l_G,N=new R(n);return e.stack[e.top]=new eh.TValue(ec,N),ed.api_incr_top(e),N.hookmask=e.hookmask,N.basehookcount=e.basehookcount,N.hook=e.hook,N.hookcount=N.basehookcount,K(N),N},e.exports.luaE_extendCI=function(e){let n=new b;return e.ci.next=n,n.previous=e.ci,n.next=null,e.ci=n,n},e.exports.luaE_freeCI=M,e.exports.luaE_freethread=function(e,n){G(n)}},function(e,n,N){let{constant_types:{LUA_TNIL:B}}=N(1),et=N(6);e.exports.MAXUPVAL=255,e.exports.Proto=class{constructor(e){this.id=e.l_G.id_counter++,this.k=[],this.p=[],this.code=[],this.cache=null,this.lineinfo=[],this.upvalues=[],this.numparams=0,this.is_vararg=!1,this.maxstacksize=0,this.locvars=[],this.linedefined=0,this.lastlinedefined=0,this.source=null}},e.exports.luaF_findupval=function(e,n){return e.stack[n]},e.exports.luaF_close=function(e,n){for(let N=n;N<e.top;N++){let n=e.stack[N];e.stack[N]=new et.TValue(n.type,n.value)}},e.exports.luaF_getlocalname=function(e,n,N){for(let B=0;B<e.locvars.length&&e.locvars[B].startpc<=N;B++)if(N<e.locvars[B].endpc&&0==--n)return e.locvars[B].varname.getstr();return null},e.exports.luaF_initupvals=function(e,n){for(let e=0;e<n.nupvalues;e++)n.upvals[e]=new et.TValue(B,null)},e.exports.luaF_newLclosure=function(e,n){return new et.LClosure(e,n)}},function(e,n,N){let{constant_types:{LUA_TTABLE:B,LUA_TUSERDATA:et},to_luastring:ei}=N(1),{lua_assert:eo}=N(4),el=N(6),eu=N(8),ec=N(12),{luaS_bless:ef,luaS_new:eh}=N(10),ep=N(9),ed=N(11),e_=N(15),eg=["no value","nil","boolean","userdata","number","string","table","function","userdata","thread","proto"].map(e=>ei(e)),m=function(e){return eg[e+1]},em={TM_INDEX:0,TM_NEWINDEX:1,TM_GC:2,TM_MODE:3,TM_LEN:4,TM_EQ:5,TM_ADD:6,TM_SUB:7,TM_MUL:8,TM_MOD:9,TM_POW:10,TM_DIV:11,TM_IDIV:12,TM_BAND:13,TM_BOR:14,TM_BXOR:15,TM_SHL:16,TM_SHR:17,TM_UNM:18,TM_BNOT:19,TM_LT:20,TM_LE:21,TM_CONCAT:22,TM_CALL:23,TM_N:24},eb=ei("__name",!0),M=function(e,n,N,B,et,ei){let eo=e.top;if(el.pushobj2s(e,n),el.pushobj2s(e,N),el.pushobj2s(e,B),ei||el.pushobj2s(e,et),e.ci.callstatus&ec.CIST_LUA?eu.luaD_call(e,eo,ei):eu.luaD_callnoyield(e,eo,ei),ei){let n=e.stack[e.top-1];delete e.stack[--e.top],et.setfrom(n)}},K=function(e,n,N,B,et){let ei=W(e,n,et);return ei.ttisnil()&&(ei=W(e,N,et)),!ei.ttisnil()&&(M(e,ei,n,N,B,1),!0)},G=function(e,n,N){let B=ep.luaH_getstr(e,N);return eo(n<=em.TM_EQ),B.ttisnil()?(e.flags|=1<<n,null):B},W=function(e,n,N){let ei;switch(n.ttnov()){case B:case et:ei=n.value.metatable;break;default:ei=e.l_G.mt[n.ttnov()]}return ei?ep.luaH_getstr(ei,e.l_G.tmname[N]):el.luaO_nilobject};e.exports.fasttm=function(e,n,N){return null===n||n.flags&1<<N?null:G(n,N,e.l_G.tmname[N])},e.exports.TMS=em,e.exports.luaT_callTM=M,e.exports.luaT_callbinTM=K,e.exports.luaT_trybinTM=function(e,n,N,B,et){if(!K(e,n,N,B,et))switch(et){case em.TM_CONCAT:return ed.luaG_concaterror(e,n,N);case em.TM_BAND:case em.TM_BOR:case em.TM_BXOR:case em.TM_SHL:case em.TM_SHR:case em.TM_BNOT:{let B=e_.tonumber(n),et=e_.tonumber(N);return!1!==B&&!1!==et?ed.luaG_tointerror(e,n,N):ed.luaG_opinterror(e,n,N,ei("perform bitwise operation on",!0))}default:return ed.luaG_opinterror(e,n,N,ei("perform arithmetic on",!0))}},e.exports.luaT_callorderTM=function(e,n,N,B){let et=new el.TValue;return K(e,n,N,et,B)?!et.l_isfalse():null},e.exports.luaT_gettm=G,e.exports.luaT_gettmbyobj=W,e.exports.luaT_init=function(e){e.l_G.tmname[em.TM_INDEX]=new eh(e,ei("__index",!0)),e.l_G.tmname[em.TM_NEWINDEX]=new eh(e,ei("__newindex",!0)),e.l_G.tmname[em.TM_GC]=new eh(e,ei("__gc",!0)),e.l_G.tmname[em.TM_MODE]=new eh(e,ei("__mode",!0)),e.l_G.tmname[em.TM_LEN]=new eh(e,ei("__len",!0)),e.l_G.tmname[em.TM_EQ]=new eh(e,ei("__eq",!0)),e.l_G.tmname[em.TM_ADD]=new eh(e,ei("__add",!0)),e.l_G.tmname[em.TM_SUB]=new eh(e,ei("__sub",!0)),e.l_G.tmname[em.TM_MUL]=new eh(e,ei("__mul",!0)),e.l_G.tmname[em.TM_MOD]=new eh(e,ei("__mod",!0)),e.l_G.tmname[em.TM_POW]=new eh(e,ei("__pow",!0)),e.l_G.tmname[em.TM_DIV]=new eh(e,ei("__div",!0)),e.l_G.tmname[em.TM_IDIV]=new eh(e,ei("__idiv",!0)),e.l_G.tmname[em.TM_BAND]=new eh(e,ei("__band",!0)),e.l_G.tmname[em.TM_BOR]=new eh(e,ei("__bor",!0)),e.l_G.tmname[em.TM_BXOR]=new eh(e,ei("__bxor",!0)),e.l_G.tmname[em.TM_SHL]=new eh(e,ei("__shl",!0)),e.l_G.tmname[em.TM_SHR]=new eh(e,ei("__shr",!0)),e.l_G.tmname[em.TM_UNM]=new eh(e,ei("__unm",!0)),e.l_G.tmname[em.TM_BNOT]=new eh(e,ei("__bnot",!0)),e.l_G.tmname[em.TM_LT]=new eh(e,ei("__lt",!0)),e.l_G.tmname[em.TM_LE]=new eh(e,ei("__le",!0)),e.l_G.tmname[em.TM_CONCAT]=new eh(e,ei("__concat",!0)),e.l_G.tmname[em.TM_CALL]=new eh(e,ei("__call",!0))},e.exports.luaT_objtypename=function(e,n){let N;if(n.ttistable()&&null!==(N=n.value.metatable)||n.ttisfulluserdata()&&null!==(N=n.value.metatable)){let n=ep.luaH_getstr(N,ef(e,eb));if(n.ttisstring())return n.svalue()}return m(n.ttnov())},e.exports.ttypename=m},function(e,n,N){let{LUA_MASKLINE:B,LUA_MASKCOUNT:et,LUA_MULTRET:ei,constant_types:{LUA_TBOOLEAN:eo,LUA_TLCF:el,LUA_TLIGHTUSERDATA:eu,LUA_TLNGSTR:ec,LUA_TNIL:ef,LUA_TNUMBER:eh,LUA_TNUMFLT:ep,LUA_TNUMINT:ed,LUA_TSHRSTR:e_,LUA_TTABLE:eg,LUA_TUSERDATA:em},to_luastring:eb}=N(1),{INDEXK:ey,ISK:ev,LFIELDS_PER_FLUSH:ek,OpCodesI:{OP_ADD:eA,OP_BAND:eL,OP_BNOT:ex,OP_BOR:ew,OP_BXOR:eT,OP_CALL:eO,OP_CLOSURE:eE,OP_CONCAT:eS,OP_DIV:eN,OP_EQ:eI,OP_EXTRAARG:eR,OP_FORLOOP:eU,OP_FORPREP:eC,OP_GETTABLE:eM,OP_GETTABUP:eP,OP_GETUPVAL:eD,OP_IDIV:eB,OP_JMP:eK,OP_LE:eG,OP_LEN:eV,OP_LOADBOOL:eF,OP_LOADK:ez,OP_LOADKX:ej,OP_LOADNIL:eH,OP_LT:e$,OP_MOD:eX,OP_MOVE:eq,OP_MUL:eW,OP_NEWTABLE:eZ,OP_NOT:eY,OP_POW:eJ,OP_RETURN:eQ,OP_SELF:e0,OP_SETLIST:e1,OP_SETTABLE:e2,OP_SETTABUP:e3,OP_SETUPVAL:e5,OP_SHL:e4,OP_SHR:e8,OP_SUB:e6,OP_TAILCALL:e9,OP_TEST:e7,OP_TESTSET:ti,OP_TFORCALL:to,OP_TFORLOOP:tl,OP_UNM:tu,OP_VARARG:tc}}=N(16),{LUA_MAXINTEGER:tf,LUA_MININTEGER:th,lua_numbertointeger:tp}=N(3),{lua_assert:td,luai_nummod:t_}=N(4),tg=N(6),tm=N(13),tb=N(12),{luaS_bless:ty,luaS_eqlngstr:tv,luaS_hashlongstr:tk}=N(10),tA=N(8),tL=N(14),tx=N(9),tw=N(11),c=function(e,n,N){return n+N.A},x=function(e,n,N){return n+N.B},p=function(e,n,N,B){return ev(B.B)?N[ey(B.B)]:e.stack[n+B.B]},T=function(e,n,N,B){return ev(B.C)?N[ey(B.C)]:e.stack[n+B.C]},X=function(e,n,N,B){let et=N.A;0!==et&&tm.luaF_close(e,n.l_base+et-1),n.l_savedpc+=N.sBx+B},U=function(e,n){X(e,n,n.l_code[n.l_savedpc],1)},pe=function(e,n,N){if(n.ttisnumber()&&N.ttisnumber())return V(n,N)?1:0;if(n.ttisstring()&&N.ttisstring())return 0>fe(n.tsvalue(),N.tsvalue())?1:0;{let B=tL.luaT_callorderTM(e,n,N,tL.TMS.TM_LT);return null===B&&tw.luaG_ordererror(e,n,N),B?1:0}},Ke=function(e,n,N){let B;return n.ttisnumber()&&N.ttisnumber()?Te(n,N)?1:0:n.ttisstring()&&N.ttisstring()?0>=fe(n.tsvalue(),N.tsvalue())?1:0:null!==(B=tL.luaT_callorderTM(e,n,N,tL.TMS.TM_LE))?B?1:0:(e.ci.callstatus|=tb.CIST_LEQ,B=tL.luaT_callorderTM(e,N,n,tL.TMS.TM_LT),e.ci.callstatus^=tb.CIST_LEQ,null===B&&tw.luaG_ordererror(e,n,N),B?0:1)},Qe=function(e,n,N){let B;if(n.ttype()!==N.ttype())return n.ttnov()!==N.ttnov()||n.ttnov()!==eh?0:n.value===N.value?1:0;switch(n.ttype()){case ef:return 1;case eo:return n.value==N.value?1:0;case eu:case ed:case ep:case el:return n.value===N.value?1:0;case e_:case ec:return tv(n.tsvalue(),N.tsvalue())?1:0;case em:case eg:if(n.value===N.value)return 1;if(null===e)return 0;null===(B=tL.fasttm(e,n.value.metatable,tL.TMS.TM_EQ))&&(B=tL.fasttm(e,N.value.metatable,tL.TMS.TM_EQ));break;default:return n.value===N.value?1:0}if(null===B)return 0;let et=new tg.TValue;return tL.luaT_callTM(e,B,n,N,et,1),et.l_isfalse()?0:1},kt=function(e,n){let N=!1,B=J(e,n<0?2:1);if(!1===B){let et=ke(e);if(!1===et)return!1;0<et?(B=tf,n<0&&(N=!0)):(B=th,n>=0&&(N=!0))}return{stopnow:N,ilimit:B}},J=function(e,n){if(e.ttisfloat()){let N=e.value,B=Math.floor(N);if(N!==B){if(0===n)return!1;n>1&&(B+=1)}return tp(B)}if(e.ttisinteger())return e.value;if(wt(e)){let N=new tg.TValue;if(tg.luaO_str2num(e.svalue(),N)===e.vslen()+1)return J(N,n)}return!1},Z=function(e){return e.ttisinteger()?e.value:J(e,0)},ke=function(e){if(e.ttnov()===eh)return e.value;if(wt(e)){let n=new tg.TValue;if(tg.luaO_str2num(e.svalue(),n)===e.vslen()+1)return n.value}return!1},V=function(e,n){return e.value<n.value},Te=function(e,n){return e.value<=n.value},fe=function(e,n){let N=tk(e),B=tk(n);return N===B?0:N<B?-1:1},Me=function(e,n,N){let B;switch(N.ttype()){case eg:{let et=N.value;if(null!==(B=tL.fasttm(e,et.metatable,tL.TMS.TM_LEN)))break;return void n.setivalue(tx.luaH_getn(et))}case e_:case ec:return void n.setivalue(N.vslen());default:(B=tL.luaT_gettmbyobj(e,N,tL.TMS.TM_LEN)).ttisnil()&&tw.luaG_typeerror(e,N,eb("get length of",!0))}tL.luaT_callTM(e,B,N,N,n,1)},tT=Math.imul||function(e,n){let N=65535&e,B=65535&n;return N*B+((e>>>16&65535)*B+N*(n>>>16&65535)<<16>>>0)|0},ct=function(e,n,N){return 0===N&&tw.luaG_runerror(e,eb("attempt to divide by zero")),0|Math.floor(n/N)},at=function(e,n,N){return 0===N&&tw.luaG_runerror(e,eb("attempt to perform 'n%%0'")),n-Math.floor(n/N)*N|0},_t=function(e,n){return n<0?n<=-32?0:e>>>-n:n>=32?0:e<<n},Ct=function(e,n,N,B){let et=e.cache;if(null!==et){let ei=e.upvalues,eo=ei.length;for(let e=0;e<eo;e++){let eo=ei[e].instack?N[B+ei[e].idx]:n[ei[e].idx];if(et.upvals[e]!==eo)return null}}return et},gt=function(e,n,N,B,et){let ei=n.upvalues.length,eo=n.upvalues,el=new tg.LClosure(e,ei);el.p=n,e.stack[et].setclLvalue(el);for(let n=0;n<ei;n++)eo[n].instack?el.upvals[n]=tm.luaF_findupval(e,B+eo[n].idx):el.upvals[n]=N[eo[n].idx];n.cache=el},Et=function(e){return e.ttisnumber()},wt=function(e){return e.ttisstring()},Bt=function(e,n){let N=e.stack[n];return!!N.ttisstring()||!!Et(N)&&(tg.luaO_tostring(e,N),!0)},Mt=function(e){return e.ttisstring()&&0===e.vslen()},Zt=function(e,n,N,B){let et=0;do{let ei=e.stack[n-N],eo=ei.vslen(),el=ei.svalue();B.set(el,et),et+=eo}while(--N>0)},Dt=function(e,n){td(n>=2);do{let N=e.top,B=2;if((e.stack[N-2].ttisstring()||Et(e.stack[N-2]))&&Bt(e,N-1)){if(Mt(e.stack[N-1]))Bt(e,N-2);else if(Mt(e.stack[N-2]))tg.setobjs2s(e,N-2,N-1);else{let et=e.stack[N-1].vslen();for(B=1;B<n&&Bt(e,N-B-1);B++)et+=e.stack[N-B-1].vslen();let ei=new Uint8Array(et);Zt(e,N,B,ei);let eo=ty(e,ei);tg.setsvalue2s(e,N-B,eo)}}else tL.luaT_trybinTM(e,e.stack[N-2],e.stack[N-1],e.stack[N-2],tL.TMS.TM_CONCAT);for(n-=B-1;e.top>N-(B-1);)delete e.stack[--e.top]}while(n>1)},qt=function(e,n,N,B){for(let et=0;et<2e3;et++){let et;if(n.ttistable()){let ei=tx.luaH_get(e,n.value,N);if(!ei.ttisnil())return void tg.setobj2s(e,B,ei);if(null===(et=tL.fasttm(e,n.value.metatable,tL.TMS.TM_INDEX)))return void e.stack[B].setnilvalue()}else(et=tL.luaT_gettmbyobj(e,n,tL.TMS.TM_INDEX)).ttisnil()&&tw.luaG_typeerror(e,n,eb("index",!0));if(et.ttisfunction())return void tL.luaT_callTM(e,et,n,N,e.stack[B],1);n=et}tw.luaG_runerror(e,eb("'__index' chain too long; possible loop",!0))},Xt=function(e,n,N,B){for(let et=0;et<2e3;et++){let et;if(n.ttistable()){let ei=n.value;if(!tx.luaH_get(e,ei,N).ttisnil()||null===(et=tL.fasttm(e,ei.metatable,tL.TMS.TM_NEWINDEX)))return tx.luaH_setfrom(e,ei,N,B),void tx.invalidateTMcache(ei)}else(et=tL.luaT_gettmbyobj(e,n,tL.TMS.TM_NEWINDEX)).ttisnil()&&tw.luaG_typeerror(e,n,eb("index",!0));if(et.ttisfunction())return void tL.luaT_callTM(e,et,n,N,B,0);n=et}tw.luaG_runerror(e,eb("'__newindex' chain too long; possible loop",!0))};e.exports.cvt2str=Et,e.exports.cvt2num=wt,e.exports.luaV_gettable=qt,e.exports.luaV_concat=Dt,e.exports.luaV_div=ct,e.exports.luaV_equalobj=Qe,e.exports.luaV_execute=function(e){let n=e.ci;for(n.callstatus|=tb.CIST_FRESH;;){td(n===e.ci);let N=n.func.value,eo=N.p.k,el=n.l_base,eu=n.l_code[n.l_savedpc++];e.hookmask&(B|et)&&tw.luaG_traceexec(e);let ec=c(0,el,eu);switch(eu.opcode){case eq:tg.setobjs2s(e,ec,x(0,el,eu));break;case ez:{let n=eo[eu.Bx];tg.setobj2s(e,ec,n);break}case ej:{td(n.l_code[n.l_savedpc].opcode===eR);let N=eo[n.l_code[n.l_savedpc++].Ax];tg.setobj2s(e,ec,N);break}case eF:e.stack[ec].setbvalue(0!==eu.B),0!==eu.C&&n.l_savedpc++;break;case eH:for(let n=0;n<=eu.B;n++)e.stack[ec+n].setnilvalue();break;case eD:{let n=eu.B;tg.setobj2s(e,ec,N.upvals[n]);break}case eP:{let n=N.upvals[eu.B],B=T(e,el,eo,eu);qt(e,n,B,ec);break}case eM:{let n=e.stack[x(0,el,eu)],N=T(e,el,eo,eu);qt(e,n,N,ec);break}case e3:{let n=N.upvals[eu.A],B=p(e,el,eo,eu),et=T(e,el,eo,eu);Xt(e,n,B,et);break}case e5:N.upvals[eu.B].setfrom(e.stack[ec]);break;case e2:{let n=e.stack[ec],N=p(e,el,eo,eu),B=T(e,el,eo,eu);Xt(e,n,N,B);break}case eZ:e.stack[ec].sethvalue(tx.luaH_new(e));break;case e0:{let n=x(0,el,eu),N=T(e,el,eo,eu);tg.setobjs2s(e,ec+1,n),qt(e,e.stack[n],N,ec);break}case eA:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);B.ttisinteger()&&et.ttisinteger()?e.stack[ec].setivalue(B.value+et.value|0):!1!==(n=ke(B))&&!1!==(N=ke(et))?e.stack[ec].setfltvalue(n+N):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_ADD);break}case e6:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);B.ttisinteger()&&et.ttisinteger()?e.stack[ec].setivalue(B.value-et.value|0):!1!==(n=ke(B))&&!1!==(N=ke(et))?e.stack[ec].setfltvalue(n-N):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_SUB);break}case eW:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);B.ttisinteger()&&et.ttisinteger()?e.stack[ec].setivalue(tT(B.value,et.value)):!1!==(n=ke(B))&&!1!==(N=ke(et))?e.stack[ec].setfltvalue(n*N):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_MUL);break}case eX:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);B.ttisinteger()&&et.ttisinteger()?e.stack[ec].setivalue(at(e,B.value,et.value)):!1!==(n=ke(B))&&!1!==(N=ke(et))?e.stack[ec].setfltvalue(t_(e,n,N)):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_MOD);break}case eJ:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);!1!==(n=ke(B))&&!1!==(N=ke(et))?e.stack[ec].setfltvalue(Math.pow(n,N)):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_POW);break}case eN:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);!1!==(n=ke(B))&&!1!==(N=ke(et))?e.stack[ec].setfltvalue(n/N):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_DIV);break}case eB:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);B.ttisinteger()&&et.ttisinteger()?e.stack[ec].setivalue(ct(e,B.value,et.value)):!1!==(n=ke(B))&&!1!==(N=ke(et))?e.stack[ec].setfltvalue(Math.floor(n/N)):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_IDIV);break}case eL:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);!1!==(n=Z(B))&&!1!==(N=Z(et))?e.stack[ec].setivalue(n&N):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_BAND);break}case ew:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);!1!==(n=Z(B))&&!1!==(N=Z(et))?e.stack[ec].setivalue(n|N):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_BOR);break}case eT:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);!1!==(n=Z(B))&&!1!==(N=Z(et))?e.stack[ec].setivalue(n^N):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_BXOR);break}case e4:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);!1!==(n=Z(B))&&!1!==(N=Z(et))?e.stack[ec].setivalue(_t(n,N)):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_SHL);break}case e8:{let n,N,B=p(e,el,eo,eu),et=T(e,el,eo,eu);!1!==(n=Z(B))&&!1!==(N=Z(et))?e.stack[ec].setivalue(_t(n,-N)):tL.luaT_trybinTM(e,B,et,e.stack[ec],tL.TMS.TM_SHR);break}case tu:{let n,N=e.stack[x(0,el,eu)];N.ttisinteger()?e.stack[ec].setivalue(0|-N.value):!1!==(n=ke(N))?e.stack[ec].setfltvalue(-n):tL.luaT_trybinTM(e,N,N,e.stack[ec],tL.TMS.TM_UNM);break}case ex:{let n=e.stack[x(0,el,eu)];n.ttisinteger()?e.stack[ec].setivalue(~n.value):tL.luaT_trybinTM(e,n,n,e.stack[ec],tL.TMS.TM_BNOT);break}case eY:{let n=e.stack[x(0,el,eu)];e.stack[ec].setbvalue(n.l_isfalse());break}case eV:Me(e,e.stack[ec],e.stack[x(0,el,eu)]);break;case eS:{let N=eu.B,B=eu.C;e.top=el+B+1,Dt(e,B-N+1);let et=el+N;tg.setobjs2s(e,ec,et),tA.adjust_top(e,n.top);break}case eK:X(e,n,eu,0);break;case eI:Qe(e,p(e,el,eo,eu),T(e,el,eo,eu))!==eu.A?n.l_savedpc++:U(e,n);break;case e$:pe(e,p(e,el,eo,eu),T(e,el,eo,eu))!==eu.A?n.l_savedpc++:U(e,n);break;case eG:Ke(e,p(e,el,eo,eu),T(e,el,eo,eu))!==eu.A?n.l_savedpc++:U(e,n);break;case e7:(eu.C?e.stack[ec].l_isfalse():!e.stack[ec].l_isfalse())?n.l_savedpc++:U(e,n);break;case ti:{let N=x(0,el,eu),B=e.stack[N];(eu.C?B.l_isfalse():!B.l_isfalse())?n.l_savedpc++:(tg.setobjs2s(e,ec,N),U(e,n));break}case eO:{let N=eu.B,B=eu.C-1;if(0!==N&&tA.adjust_top(e,ec+N),!tA.luaD_precall(e,ec,B)){n=e.ci;continue}B>=0&&tA.adjust_top(e,n.top);break}case e9:{let B=eu.B;if(0!==B&&tA.adjust_top(e,ec+B),!tA.luaD_precall(e,ec,ei)){let B=e.ci,et=B.previous,ei=B.func,eo=B.funcOff,el=et.funcOff,eu=B.l_base+ei.value.p.numparams;N.p.p.length>0&&tm.luaF_close(e,et.l_base);for(let n=0;eo+n<eu;n++)tg.setobjs2s(e,el+n,eo+n);et.l_base=el+(B.l_base-eo),et.top=el+(e.top-eo),tA.adjust_top(e,et.top),et.l_code=B.l_code,et.l_savedpc=B.l_savedpc,et.callstatus|=tb.CIST_TAIL,et.next=null,n=e.ci=et,td(e.top===et.l_base+e.stack[el].value.p.maxstacksize);continue}break}case eQ:{N.p.p.length>0&&tm.luaF_close(e,el);let B=tA.luaD_poscall(e,n,ec,0!==eu.B?eu.B-1:e.top-ec);if(n.callstatus&tb.CIST_FRESH)return;n=e.ci,B&&tA.adjust_top(e,n.top),td(n.callstatus&tb.CIST_LUA),td(n.l_code[n.l_savedpc-1].opcode===eO);continue}case eU:if(e.stack[ec].ttisinteger()){let N=e.stack[ec+2].value,B=e.stack[ec].value+N|0,et=e.stack[ec+1].value;(0<N?B<=et:et<=B)&&(n.l_savedpc+=eu.sBx,e.stack[ec].chgivalue(B),e.stack[ec+3].setivalue(B))}else{let N=e.stack[ec+2].value,B=e.stack[ec].value+N,et=e.stack[ec+1].value;(0<N?B<=et:et<=B)&&(n.l_savedpc+=eu.sBx,e.stack[ec].chgfltvalue(B),e.stack[ec+3].setfltvalue(B))}break;case eC:{let N,B=e.stack[ec],et=e.stack[ec+1],ei=e.stack[ec+2];if(B.ttisinteger()&&ei.ttisinteger()&&(N=kt(et,ei.value))){let e=N.stopnow?0:B.value;et.value=N.ilimit,B.value=e-ei.value|0}else{let n,N,eo;!1===(n=ke(et))&&tw.luaG_runerror(e,eb("'for' limit must be a number",!0)),e.stack[ec+1].setfltvalue(n),!1===(N=ke(ei))&&tw.luaG_runerror(e,eb("'for' step must be a number",!0)),e.stack[ec+2].setfltvalue(N),!1===(eo=ke(B))&&tw.luaG_runerror(e,eb("'for' initial value must be a number",!0)),e.stack[ec].setfltvalue(eo-N)}n.l_savedpc+=eu.sBx;break}case to:{let N=ec+3;tg.setobjs2s(e,N+2,ec+2),tg.setobjs2s(e,N+1,ec+1),tg.setobjs2s(e,N,ec),tA.adjust_top(e,N+3),tA.luaD_call(e,N,eu.C),tA.adjust_top(e,n.top),ec=c(0,el,eu=n.l_code[n.l_savedpc++]),td(eu.opcode===tl)}case tl:e.stack[ec+1].ttisnil()||(tg.setobjs2s(e,ec,ec+1),n.l_savedpc+=eu.sBx);break;case e1:{let N=eu.B,B=eu.C;0===N&&(N=e.top-ec-1),0===B&&(td(n.l_code[n.l_savedpc].opcode===eR),B=n.l_code[n.l_savedpc++].Ax);let et=e.stack[ec].value,ei=(B-1)*ek+N;for(;N>0;N--)tx.luaH_setint(et,ei--,e.stack[ec+N]);tA.adjust_top(e,n.top);break}case eE:{let n=N.p.p[eu.Bx],B=Ct(n,N.upvals,e.stack,el);null===B?gt(e,n,N.upvals,el,ec):e.stack[ec].setclLvalue(B);break}case tc:{let B,et=eu.B-1,ei=el-n.funcOff-N.p.numparams-1;for(ei<0&&(ei=0),et<0&&(et=ei,tA.luaD_checkstack(e,ei),tA.adjust_top(e,ec+ei)),B=0;B<et&&B<ei;B++)tg.setobjs2s(e,ec+B,el-ei+B);for(;B<et;B++)e.stack[ec+B].setnilvalue();break}case eR:throw Error("invalid opcode")}}},e.exports.luaV_finishOp=function(e){let n=e.ci,N=n.l_base,B=n.l_code[n.l_savedpc-1],et=B.opcode;switch(et){case eA:case e6:case eW:case eN:case eB:case eL:case ew:case eT:case e4:case e8:case eX:case eJ:case tu:case ex:case eV:case eP:case eM:case e0:tg.setobjs2s(e,N+B.A,e.top-1),delete e.stack[--e.top];break;case eG:case e$:case eI:{let N=!e.stack[e.top-1].l_isfalse();delete e.stack[--e.top],n.callstatus&tb.CIST_LEQ&&(td(et===eG),n.callstatus^=tb.CIST_LEQ,N=!N),td(n.l_code[n.l_savedpc].opcode===eK),!!B.A!==N&&n.l_savedpc++;break}case eS:{let et=e.top-1,ei=et-1-(N+B.B);tg.setobjs2s(e,et-2,et),ei>1&&(e.top=et-1,Dt(e,ei)),tg.setobjs2s(e,n.l_base+B.A,e.top-1),tA.adjust_top(e,n.top);break}case to:td(n.l_code[n.l_savedpc].opcode===tl),tA.adjust_top(e,n.top);break;case eO:B.C-1>=0&&tA.adjust_top(e,n.top)}},e.exports.luaV_imul=tT,e.exports.luaV_lessequal=Ke,e.exports.luaV_lessthan=pe,e.exports.luaV_mod=at,e.exports.luaV_objlen=Me,e.exports.luaV_rawequalobj=function(e,n){return Qe(null,e,n)},e.exports.luaV_shiftl=_t,e.exports.luaV_tointeger=J,e.exports.settable=Xt,e.exports.tointeger=Z,e.exports.tonumber=ke},function(e,n,N){let B=[96,113,65,84,80,80,92,108,60,16,60,84,108,124,124,124,124,124,124,124,124,124,124,124,124,96,96,96,96,104,34,188,188,188,132,228,84,84,16,98,98,4,98,20,81,80,23],s=function(e,n){return~(-1<<e)<<n},a=function(e,n){return~s(e,n)},i=function(e,n,N,B){return e.code=e.code&a(B,N)|n<<N&s(B,N),u(e)},l=function(e,n){return i(e,n,14,18)},u=function(e){if("number"==typeof e)return{code:e,opcode:e>>0&s(6,0),A:e>>6&s(8,0),B:e>>23&s(9,0),C:e>>14&s(9,0),Bx:e>>14&s(18,0),Ax:e>>6&s(26,0),sBx:(e>>14&s(18,0))-131071};{let n=e.code;return e.opcode=n>>0&s(6,0),e.A=n>>6&s(8,0),e.B=n>>23&s(9,0),e.C=n>>14&s(9,0),e.Bx=n>>14&s(18,0),e.Ax=n>>6&s(26,0),e.sBx=(n>>14&s(18,0))-131071,e}};e.exports.BITRK=256,e.exports.CREATE_ABC=function(e,n,N,B){return u(e<<0|n<<6|N<<23|B<<14)},e.exports.CREATE_ABx=function(e,n,N){return u(e<<0|n<<6|N<<14)},e.exports.CREATE_Ax=function(e,n){return u(e<<0|n<<6)},e.exports.GET_OPCODE=function(e){return e.opcode},e.exports.GETARG_A=function(e){return e.A},e.exports.GETARG_B=function(e){return e.B},e.exports.GETARG_C=function(e){return e.C},e.exports.GETARG_Bx=function(e){return e.Bx},e.exports.GETARG_Ax=function(e){return e.Ax},e.exports.GETARG_sBx=function(e){return e.sBx},e.exports.INDEXK=function(e){return -257&e},e.exports.ISK=function(e){return 256&e},e.exports.LFIELDS_PER_FLUSH=50,e.exports.MAXARG_A=255,e.exports.MAXARG_Ax=67108863,e.exports.MAXARG_B=511,e.exports.MAXARG_Bx=262143,e.exports.MAXARG_C=511,e.exports.MAXARG_sBx=131071,e.exports.MAXINDEXRK=255,e.exports.NO_REG=255,e.exports.OpArgK=3,e.exports.OpArgN=0,e.exports.OpArgR=2,e.exports.OpArgU=1,e.exports.OpCodes=["MOVE","LOADK","LOADKX","LOADBOOL","LOADNIL","GETUPVAL","GETTABUP","GETTABLE","SETTABUP","SETUPVAL","SETTABLE","NEWTABLE","SELF","ADD","SUB","MUL","MOD","POW","DIV","IDIV","BAND","BOR","BXOR","SHL","SHR","UNM","BNOT","NOT","LEN","CONCAT","JMP","EQ","LT","LE","TEST","TESTSET","CALL","TAILCALL","RETURN","FORLOOP","FORPREP","TFORCALL","TFORLOOP","SETLIST","CLOSURE","VARARG","EXTRAARG"],e.exports.OpCodesI={OP_MOVE:0,OP_LOADK:1,OP_LOADKX:2,OP_LOADBOOL:3,OP_LOADNIL:4,OP_GETUPVAL:5,OP_GETTABUP:6,OP_GETTABLE:7,OP_SETTABUP:8,OP_SETUPVAL:9,OP_SETTABLE:10,OP_NEWTABLE:11,OP_SELF:12,OP_ADD:13,OP_SUB:14,OP_MUL:15,OP_MOD:16,OP_POW:17,OP_DIV:18,OP_IDIV:19,OP_BAND:20,OP_BOR:21,OP_BXOR:22,OP_SHL:23,OP_SHR:24,OP_UNM:25,OP_BNOT:26,OP_NOT:27,OP_LEN:28,OP_CONCAT:29,OP_JMP:30,OP_EQ:31,OP_LT:32,OP_LE:33,OP_TEST:34,OP_TESTSET:35,OP_CALL:36,OP_TAILCALL:37,OP_RETURN:38,OP_FORLOOP:39,OP_FORPREP:40,OP_TFORCALL:41,OP_TFORLOOP:42,OP_SETLIST:43,OP_CLOSURE:44,OP_VARARG:45,OP_EXTRAARG:46},e.exports.POS_A=6,e.exports.POS_Ax=6,e.exports.POS_B=23,e.exports.POS_Bx=14,e.exports.POS_C=14,e.exports.POS_OP=0,e.exports.RKASK=function(e){return 256|e},e.exports.SETARG_A=function(e,n){return i(e,n,6,8)},e.exports.SETARG_Ax=function(e,n){return i(e,n,6,26)},e.exports.SETARG_B=function(e,n){return i(e,n,23,9)},e.exports.SETARG_Bx=l,e.exports.SETARG_C=function(e,n){return i(e,n,14,9)},e.exports.SETARG_sBx=function(e,n){return l(e,n+131071)},e.exports.SET_OPCODE=function(e,n){return e.code=e.code&a(6,0)|n<<0&s(6,0),u(e)},e.exports.SIZE_A=8,e.exports.SIZE_Ax=26,e.exports.SIZE_B=9,e.exports.SIZE_Bx=18,e.exports.SIZE_C=9,e.exports.SIZE_OP=6,e.exports.fullins=u,e.exports.getBMode=function(e){return B[e]>>4&3},e.exports.getCMode=function(e){return B[e]>>2&3},e.exports.getOpMode=function(e){return 3&B[e]},e.exports.iABC=0,e.exports.iABx=1,e.exports.iAsBx=2,e.exports.iAx=3,e.exports.testAMode=function(e){return 64&B[e]},e.exports.testTMode=function(e){return 128&B[e]}},function(e,n,N){let{LUA_VERSION_MAJOR:B,LUA_VERSION_MINOR:et}=N(2);e.exports.LUA_VERSUFFIX="_"+B+"_"+et,e.exports.lua_assert=function(e){},e.exports.luaopen_base=N(24).luaopen_base,e.exports.LUA_COLIBNAME="coroutine",e.exports.luaopen_coroutine=N(25).luaopen_coroutine,e.exports.LUA_TABLIBNAME="table",e.exports.luaopen_table=N(26).luaopen_table,e.exports.LUA_OSLIBNAME="os",e.exports.luaopen_os=N(27).luaopen_os,e.exports.LUA_STRLIBNAME="string",e.exports.luaopen_string=N(28).luaopen_string,e.exports.LUA_UTF8LIBNAME="utf8",e.exports.luaopen_utf8=N(29).luaopen_utf8,e.exports.LUA_BITLIBNAME="bit32",e.exports.LUA_MATHLIBNAME="math",e.exports.luaopen_math=N(30).luaopen_math,e.exports.LUA_DBLIBNAME="debug",e.exports.luaopen_debug=N(31).luaopen_debug,e.exports.LUA_LOADLIBNAME="package",e.exports.luaopen_package=N(32).luaopen_package,e.exports.LUA_FENGARILIBNAME="fengari",e.exports.luaopen_fengari=N(33).luaopen_fengari;let ei=N(39);e.exports.luaL_openlibs=ei.luaL_openlibs},function(e,n,N){let{LUA_MULTRET:B,LUA_OPBNOT:et,LUA_OPEQ:ei,LUA_OPLE:eo,LUA_OPLT:el,LUA_OPUNM:eu,LUA_REGISTRYINDEX:ec,LUA_RIDX_GLOBALS:ef,LUA_VERSION_NUM:eh,constant_types:{LUA_NUMTAGS:ep,LUA_TBOOLEAN:ed,LUA_TCCL:e_,LUA_TFUNCTION:eg,LUA_TLCF:em,LUA_TLCL:eb,LUA_TLIGHTUSERDATA:ey,LUA_TLNGSTR:ev,LUA_TNIL:ek,LUA_TNONE:eA,LUA_TNUMFLT:eL,LUA_TNUMINT:ex,LUA_TSHRSTR:ew,LUA_TTABLE:eT,LUA_TTHREAD:eO,LUA_TUSERDATA:eE},thread_status:{LUA_OK:eS},from_userstring:eN,to_luastring:eI}=N(1),{api_check:eR}=N(4),eU=N(11),eC=N(8),{luaU_dump:eM}=N(37),eP=N(13),eD=N(6),eB=N(12),{luaS_bless:eK,luaS_new:eG,luaS_newliteral:eV}=N(10),eF=N(14),{LUAI_MAXSTACK:ez}=N(3),ej=N(15),eH=N(9),{ZIO:e$}=N(19),eX=eD.TValue,eq=eD.CClosure,xe=function(e){e.top++,eR(e,e.top<=e.ci.top,"stack overflow")},Ge=function(e,n){eR(e,n<e.top-e.ci.funcOff,"not enough elements in the stack")},g=function(e){if(!e)throw TypeError("invalid argument")},ge=function(e){g("number"==typeof e&&(0|e)===e)},te=function(e){return e!==eD.luaO_nilobject},A=function(e,n){let N=e.ci;if(n>0){let B=N.funcOff+n;return eR(e,n<=N.top-(N.funcOff+1),"unacceptable index"),B>=e.top?eD.luaO_nilobject:e.stack[B]}return n>ec?(eR(e,0!==n&&-n<=e.top,"invalid index"),e.stack[e.top+n]):n===ec?e.l_G.l_registry:(eR(e,(n=ec-n)<=eP.MAXUPVAL+1,"upvalue index too large"),N.func.ttislcf()?eD.luaO_nilobject:n<=N.func.value.nupvalues?N.func.value.upvalue[n-1]:eD.luaO_nilobject)},S=function(e,n){let N=e.ci;if(n>0){let B=N.funcOff+n;return eR(e,n<=N.top-(N.funcOff+1),"unacceptable index"),B>=e.top?null:B}if(n>ec)return eR(e,0!==n&&-n<=e.top,"invalid index"),e.top+n;throw Error("attempt to use pseudo-index")},v=function(e,n){let N,B=e.ci.funcOff;n>=0?(eR(e,n<=e.stack_last-(B+1),"new top too large"),N=B+1+n):(eR(e,-(n+1)<=e.top-(B+1),"invalid new top"),N=e.top+n+1),eC.adjust_top(e,N)},q=function(e,n){v(e,-n-1)},oe=function(e,n,N){for(;n<N;n++,N--){let B=e.stack[n],et=new eX(B.type,B.value);eD.setobjs2s(e,n,N),eD.setobj2s(e,N,et)}},O=function(e,n,N){let B=e.top-1,et=S(e,n),ei=e.stack[et];eR(e,te(ei)&&n>ec,"index not in the stack"),eR(e,(N>=0?N:-N)<=B-et+1,"invalid 'n'");let eo=N>=0?B-N:et-N-1;oe(e,et,eo),oe(e,eo+1,e.top-1),oe(e,et,e.top-1)},ee=function(e,n,N){let B=A(e,n);A(e,N).setfrom(B)},ce=function(e,n,N){if(g("function"==typeof n),ge(N),0===N)e.stack[e.top]=new eX(em,n);else{Ge(e,N),eR(e,N<=eP.MAXUPVAL,"upvalue index too large");let B=new eq(e,n,N);for(let n=0;n<N;n++)B.upvalue[n].setfrom(e.stack[e.top-N+n]);for(let n=1;n<N;n++)delete e.stack[--e.top];N>0&&--e.top,e.stack[e.top].setclCvalue(B)}xe(e)},$e=function(e,n){ce(e,n,0)},dt=function(e,n,N){let B=eG(e,eN(N));Ge(e,1),eD.pushsvalue2s(e,B),eR(e,e.top<=e.ci.top,"stack overflow"),ej.settable(e,n,e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top],delete e.stack[--e.top]},xt=function(e,n){dt(e,eH.luaH_getint(e.l_G.l_registry.value,ef),n)},Ot=function(e,n,N){let B=eG(e,eN(N));return eD.pushsvalue2s(e,B),eR(e,e.top<=e.ci.top,"stack overflow"),ej.luaV_gettable(e,n,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},St=function(e,n,N){let B=A(e,n);return ge(N),eR(e,B.ttistable(),"table expected"),eD.pushobj2s(e,eH.luaH_getint(B.value,N)),eR(e,e.top<=e.ci.top,"stack overflow"),e.stack[e.top-1].ttnov()},D=function(e,n,N){let B=new eD.TValue(eT,eH.luaH_new(e));e.stack[e.top]=B,xe(e)},Be=function(e,n,N){switch(ge(N),n.ttype()){case e_:{let e=n.value;return 1<=N&&N<=e.nupvalues?{name:eI("",!0),val:e.upvalue[N-1]}:null}case eb:{let e=n.value,B=e.p;if(!(1<=N&&N<=B.upvalues.length))return null;let et=B.upvalues[N-1].name;return{name:et?et.getstr():eI("(*no name)",!0),val:e.upvals[N-1]}}default:return null}},De=function(e,n){let N=A(e,n);if(!N.ttisstring()){if(!ej.cvt2str(N))return null;eD.luaO_tostring(e,N)}return N.svalue()},Se=function(e,n){return ej.tointeger(A(e,n))},je=function(e,n){return ej.tonumber(A(e,n))},eW=new WeakMap,bt=function(e,n){eC.luaD_callnoyield(e,n.funcOff,n.nresults)},vt=function(e,n){let N=A(e,n);return te(N)?N.ttnov():eA},eZ=eI("?"),Rt=function(e,n,N){eR(e,N===B||e.ci.top-e.top>=N-n,"results from function overflow current stack size")},lt=function(e,n,N,et,ei){eR(e,null===ei||!(e.ci.callstatus&eB.CIST_LUA),"cannot use continuations inside hooks"),Ge(e,n+1),eR(e,e.status===eS,"cannot do calls on non-normal thread"),Rt(e,n,N);let eo=e.top-(n+1);null!==ei&&0===e.nny?(e.ci.c_k=ei,e.ci.c_ctx=et,eC.luaD_call(e,eo,N)):eC.luaD_callnoyield(e,eo,N),N===B&&e.ci.top<e.top&&(e.ci.top=e.top)},pt=function(e,n,N,et,ei,eo){let el,eu;eR(e,null===eo||!(e.ci.callstatus&eB.CIST_LUA),"cannot use continuations inside hooks"),Ge(e,n+1),eR(e,e.status===eS,"cannot do calls on non-normal thread"),Rt(e,n,N),eu=0===et?0:S(e,et);let ec=e.top-(n+1);if(null===eo||e.nny>0)el=eC.luaD_pcall(e,bt,{funcOff:ec,nresults:N},ec,eu);else{let n=e.ci;n.c_k=eo,n.c_ctx=ei,n.extra=ec,n.c_old_errfunc=e.errfunc,e.errfunc=eu,n.callstatus&=~eB.CIST_OAH|e.allowhook,n.callstatus|=eB.CIST_YPCALL,eC.luaD_call(e,ec,N),n.callstatus&=~eB.CIST_YPCALL,e.errfunc=n.c_old_errfunc,el=eS}return N===B&&e.ci.top<e.top&&(e.ci.top=e.top),el},At=function(e,n,N){let B=A(e,n);eR(e,B.ttisLclosure(),"Lua function expected");let et=B.value;return ge(N),eR(e,1<=N&&N<=et.p.upvalues.length,"invalid upvalue index"),{f:et,i:N-1}};e.exports.api_incr_top=xe,e.exports.api_checknelems=Ge,e.exports.lua_absindex=function(e,n){return n>0||n<=ec?n:e.top-e.ci.funcOff+n},e.exports.lua_arith=function(e,n){n!==eu&&n!==et?Ge(e,2):(Ge(e,1),eD.pushobj2s(e,e.stack[e.top-1]),eR(e,e.top<=e.ci.top,"stack overflow")),eD.luaO_arith(e,n,e.stack[e.top-2],e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top]},e.exports.lua_atpanic=function(e,n){let N=e.l_G.panic;return e.l_G.panic=n,N},e.exports.lua_atnativeerror=function(e,n){let N=e.l_G.atnativeerror;return e.l_G.atnativeerror=n,N},e.exports.lua_call=function(e,n,N){lt(e,n,N,0,null)},e.exports.lua_callk=lt,e.exports.lua_checkstack=function(e,n){let N,B=e.ci;return eR(e,n>=0,"negative 'n'"),e.stack_last-e.top>n?N=!0:e.top+eB.EXTRA_STACK>ez-n?N=!1:(eC.luaD_growstack(e,n),N=!0),N&&B.top<e.top+n&&(B.top=e.top+n),N},e.exports.lua_compare=function(e,n,N,B){let et=A(e,n),eu=A(e,N),ec=0;if(te(et)&&te(eu))switch(B){case ei:ec=ej.luaV_equalobj(e,et,eu);break;case el:ec=ej.luaV_lessthan(e,et,eu);break;case eo:ec=ej.luaV_lessequal(e,et,eu);break;default:eR(e,!1,"invalid option")}return ec},e.exports.lua_concat=function(e,n){Ge(e,n),n>=2?ej.luaV_concat(e,n):0===n&&(eD.pushsvalue2s(e,eK(e,eI("",!0))),eR(e,e.top<=e.ci.top,"stack overflow"))},e.exports.lua_copy=ee,e.exports.lua_createtable=D,e.exports.lua_dump=function(e,n,N,B){Ge(e,1);let et=e.stack[e.top-1];return et.ttisLclosure()?eM(e,et.value.p,n,N,B):1},e.exports.lua_error=function(e){Ge(e,1),eU.luaG_errormsg(e)},e.exports.lua_gc=function(){},e.exports.lua_getallocf=function(){return console.warn("lua_getallocf is not available"),0},e.exports.lua_getextraspace=function(){return console.warn("lua_getextraspace is not available"),0},e.exports.lua_getfield=function(e,n,N){return Ot(e,A(e,n),N)},e.exports.lua_getglobal=function(e,n){return Ot(e,eH.luaH_getint(e.l_G.l_registry.value,ef),n)},e.exports.lua_geti=function(e,n,N){let B=A(e,n);return ge(N),e.stack[e.top]=new eX(ex,N),xe(e),ej.luaV_gettable(e,B,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},e.exports.lua_getmetatable=function(e,n){let N,B=A(e,n),et=!1;switch(B.ttnov()){case eT:case eE:N=B.value.metatable;break;default:N=e.l_G.mt[B.ttnov()]}return null!=N&&(e.stack[e.top]=new eX(eT,N),xe(e),et=!0),et},e.exports.lua_gettable=function(e,n){let N=A(e,n);return ej.luaV_gettable(e,N,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},e.exports.lua_gettop=function(e){return e.top-(e.ci.funcOff+1)},e.exports.lua_getupvalue=function(e,n,N){let B=Be(0,A(e,n),N);if(B){let n=B.name,N=B.val;return eD.pushobj2s(e,N),eR(e,e.top<=e.ci.top,"stack overflow"),n}return null},e.exports.lua_getuservalue=function(e,n){let N=A(e,n);eR(e,N.ttisfulluserdata(),"full userdata expected");let B=N.value.uservalue;return e.stack[e.top]=new eX(B.type,B.value),xe(e),e.stack[e.top-1].ttnov()},e.exports.lua_insert=function(e,n){O(e,n,1)},e.exports.lua_isboolean=function(e,n){return vt(e,n)===ed},e.exports.lua_iscfunction=function(e,n){let N=A(e,n);return N.ttislcf(N)||N.ttisCclosure()},e.exports.lua_isfunction=function(e,n){return vt(e,n)===eg},e.exports.lua_isinteger=function(e,n){return A(e,n).ttisinteger()},e.exports.lua_islightuserdata=function(e,n){return vt(e,n)===ey},e.exports.lua_isnil=function(e,n){return vt(e,n)===ek},e.exports.lua_isnone=function(e,n){return vt(e,n)===eA},e.exports.lua_isnoneornil=function(e,n){return 0>=vt(e,n)},e.exports.lua_isnumber=function(e,n){return!1!==ej.tonumber(A(e,n))},e.exports.lua_isproxy=function(e,n){let N=eW.get(e);return!!N&&(null===n||n.l_G===N)},e.exports.lua_isstring=function(e,n){let N=A(e,n);return N.ttisstring()||ej.cvt2str(N)},e.exports.lua_istable=function(e,n){return A(e,n).ttistable()},e.exports.lua_isthread=function(e,n){return vt(e,n)===eO},e.exports.lua_isuserdata=function(e,n){let N=A(e,n);return N.ttisfulluserdata(N)||N.ttislightuserdata()},e.exports.lua_len=function(e,n){let N=A(e,n),B=new eX;ej.luaV_objlen(e,B,N),e.stack[e.top]=B,xe(e)},e.exports.lua_load=function(e,n,N,B,et){B=B?eN(B):eZ,null!==et&&(et=eN(et));let ei=new e$(e,n,N),eo=eC.luaD_protectedparser(e,ei,B,et);if(eo===eS){let n=e.stack[e.top-1].value;if(n.nupvalues>=1){let N=eH.luaH_getint(e.l_G.l_registry.value,ef);n.upvals[0].setfrom(N)}}return eo},e.exports.lua_newtable=function(e){D(e)},e.exports.lua_newuserdata=function(e,n){let N=new eD.Udata(e,n);return e.stack[e.top]=new eD.TValue(eE,N),xe(e),N.data},e.exports.lua_next=function(e,n){let N=A(e,n);return eR(e,N.ttistable(),"table expected"),e.stack[e.top]=new eX,eH.luaH_next(e,N.value,e.top-1)?(xe(e),1):(delete e.stack[e.top],delete e.stack[--e.top],0)},e.exports.lua_pcall=function(e,n,N,B){return pt(e,n,N,B,0,null)},e.exports.lua_pcallk=pt,e.exports.lua_pop=q,e.exports.lua_pushboolean=function(e,n){e.stack[e.top]=new eX(ed,!!n),xe(e)},e.exports.lua_pushcclosure=ce,e.exports.lua_pushcfunction=$e,e.exports.lua_pushfstring=function(e,n,...N){return n=eN(n),eD.luaO_pushvfstring(e,n,N)},e.exports.lua_pushglobaltable=function(e){St(e,ec,ef)},e.exports.lua_pushinteger=function(e,n){ge(n),e.stack[e.top]=new eX(ex,n),xe(e)},e.exports.lua_pushjsclosure=ce,e.exports.lua_pushjsfunction=$e,e.exports.lua_pushlightuserdata=function(e,n){e.stack[e.top]=new eX(ey,n),xe(e)},e.exports.lua_pushliteral=function(e,n){if(null==n)e.stack[e.top]=new eX(ek,null),e.top++;else{g("string"==typeof n);let N=eV(e,n);eD.pushsvalue2s(e,N),n=N.getstr()}return eR(e,e.top<=e.ci.top,"stack overflow"),n},e.exports.lua_pushlstring=function(e,n,N){let B;return ge(N),0===N?B=eK(e,n=eI("",!0)):(eR(e,(n=eN(n)).length>=N,"invalid length to lua_pushlstring"),B=eG(e,n.subarray(0,N))),eD.pushsvalue2s(e,B),eR(e,e.top<=e.ci.top,"stack overflow"),B.value},e.exports.lua_pushnil=function(e){e.stack[e.top]=new eX(ek,null),xe(e)},e.exports.lua_pushnumber=function(e,n){g("number"==typeof n),e.stack[e.top]=new eX(eL,n),xe(e)},e.exports.lua_pushstring=function(e,n){if(null==n)e.stack[e.top]=new eX(ek,null),e.top++;else{let N=eG(e,eN(n));eD.pushsvalue2s(e,N),n=N.getstr()}return eR(e,e.top<=e.ci.top,"stack overflow"),n},e.exports.lua_pushthread=function(e){return e.stack[e.top]=new eX(eO,e),xe(e),e.l_G.mainthread===e},e.exports.lua_pushvalue=function(e,n){eD.pushobj2s(e,A(e,n)),eR(e,e.top<=e.ci.top,"stack overflow")},e.exports.lua_pushvfstring=function(e,n,N){return n=eN(n),eD.luaO_pushvfstring(e,n,N)},e.exports.lua_rawequal=function(e,n,N){let B=A(e,n),et=A(e,N);return te(B)&&te(et)?ej.luaV_equalobj(null,B,et):0},e.exports.lua_rawget=function(e,n){let N=A(e,n);return eR(e,N.ttistable(N),"table expected"),eD.setobj2s(e,e.top-1,eH.luaH_get(e,N.value,e.stack[e.top-1])),e.stack[e.top-1].ttnov()},e.exports.lua_rawgeti=St,e.exports.lua_rawgetp=function(e,n,N){let B=A(e,n);eR(e,B.ttistable(),"table expected");let et=new eX(ey,N);return eD.pushobj2s(e,eH.luaH_get(e,B.value,et)),eR(e,e.top<=e.ci.top,"stack overflow"),e.stack[e.top-1].ttnov()},e.exports.lua_rawlen=function(e,n){let N=A(e,n);switch(N.ttype()){case ew:case ev:return N.vslen();case eE:return N.value.len;case eT:return eH.luaH_getn(N.value);default:return 0}},e.exports.lua_rawset=function(e,n){Ge(e,2);let N=A(e,n);eR(e,N.ttistable(),"table expected");let B=e.stack[e.top-2],et=e.stack[e.top-1];eH.luaH_setfrom(e,N.value,B,et),eH.invalidateTMcache(N.value),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_rawseti=function(e,n,N){ge(N),Ge(e,1);let B=A(e,n);eR(e,B.ttistable(),"table expected"),eH.luaH_setint(B.value,N,e.stack[e.top-1]),delete e.stack[--e.top]},e.exports.lua_rawsetp=function(e,n,N){Ge(e,1);let B=A(e,n);eR(e,B.ttistable(),"table expected");let et=new eX(ey,N),ei=e.stack[e.top-1];eH.luaH_setfrom(e,B.value,et,ei),delete e.stack[--e.top]},e.exports.lua_register=function(e,n,N){$e(e,N),xt(e,n)},e.exports.lua_remove=function(e,n){O(e,n,-1),q(e,1)},e.exports.lua_replace=function(e,n){ee(e,-1,n),q(e,1)},e.exports.lua_rotate=O,e.exports.lua_setallocf=function(){return console.warn("lua_setallocf is not available"),0},e.exports.lua_setfield=function(e,n,N){dt(e,A(e,n),N)},e.exports.lua_setglobal=xt,e.exports.lua_seti=function(e,n,N){ge(N),Ge(e,1);let B=A(e,n);e.stack[e.top]=new eX(ex,N),xe(e),ej.settable(e,B,e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_setmetatable=function(e,n){let N;Ge(e,1);let B=A(e,n);switch(e.stack[e.top-1].ttisnil()?N=null:(eR(e,e.stack[e.top-1].ttistable(),"table expected"),N=e.stack[e.top-1].value),B.ttnov()){case eE:case eT:B.value.metatable=N;break;default:e.l_G.mt[B.ttnov()]=N}return delete e.stack[--e.top],!0},e.exports.lua_settable=function(e,n){Ge(e,2);let N=A(e,n);ej.settable(e,N,e.stack[e.top-2],e.stack[e.top-1]),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_settop=v,e.exports.lua_setupvalue=function(e,n,N){let B=A(e,n);Ge(e,1);let et=Be(0,B,N);if(et){let n=et.name;return et.val.setfrom(e.stack[e.top-1]),delete e.stack[--e.top],n}return null},e.exports.lua_setuservalue=function(e,n){Ge(e,1);let N=A(e,n);eR(e,N.ttisfulluserdata(),"full userdata expected"),N.value.uservalue.setfrom(e.stack[e.top-1]),delete e.stack[--e.top]},e.exports.lua_status=function(e){return e.status},e.exports.lua_stringtonumber=function(e,n){let N=new eX,B=eD.luaO_str2num(n,N);return 0!==B&&(e.stack[e.top]=N,xe(e)),B},e.exports.lua_toboolean=function(e,n){return!A(e,n).l_isfalse()},e.exports.lua_tocfunction=function(e,n){let N=A(e,n);return N.ttislcf()||N.ttisCclosure()?N.value:null},e.exports.lua_todataview=function(e,n){let N=De(e,n);return new DataView(N.buffer,N.byteOffset,N.byteLength)},e.exports.lua_tointeger=function(e,n){let N=Se(e,n);return!1===N?0:N},e.exports.lua_tointegerx=Se,e.exports.lua_tojsstring=function(e,n){let N=A(e,n);if(!N.ttisstring()){if(!ej.cvt2str(N))return null;eD.luaO_tostring(e,N)}return N.jsstring()},e.exports.lua_tolstring=De,e.exports.lua_tonumber=function(e,n){let N=je(e,n);return!1===N?0:N},e.exports.lua_tonumberx=je,e.exports.lua_topointer=function(e,n){let N=A(e,n);switch(N.ttype()){case eT:case eb:case e_:case em:case eO:case eE:case ey:return N.value;default:return null}},e.exports.lua_toproxy=function(e,n){var N,B,et;let ei,eo=A(e,n);return N=e.l_G,B=eo.type,et=eo.value,ei=function(e){eR(e,e instanceof eB.lua_State&&N===e.l_G,"must be from same global state"),e.stack[e.top]=new eX(B,et),xe(e)},eW.set(ei,N),ei},e.exports.lua_tostring=De,e.exports.lua_tothread=function(e,n){let N=A(e,n);return N.ttisthread()?N.value:null},e.exports.lua_touserdata=function(e,n){let N=A(e,n);switch(N.ttnov()){case eE:return N.value.data;case ey:return N.value;default:return null}},e.exports.lua_type=vt,e.exports.lua_typename=function(e,n){return eR(e,eA<=n&&n<ep,"invalid tag"),eF.ttypename(n)},e.exports.lua_upvalueid=function(e,n,N){let B=A(e,n);switch(B.ttype()){case eb:{let B=At(e,n,N);return B.f.upvals[B.i]}case e_:{let n=B.value;return eR(e,(0|N)===N&&N>0&&N<=n.nupvalues,"invalid upvalue index"),n.upvalue[N-1]}default:return eR(e,!1,"closure expected"),null}},e.exports.lua_upvaluejoin=function(e,n,N,B,et){let ei=At(e,n,N),eo=At(e,B,et),el=eo.f.upvals[eo.i];ei.f.upvals[ei.i]=el},e.exports.lua_version=function(e){return null===e?eh:e.l_G.version},e.exports.lua_xmove=function(e,n,N){if(e!==n){Ge(e,N),eR(e,e.l_G===n.l_G,"moving among independent states"),eR(e,n.ci.top-n.top>=N,"stack overflow"),e.top-=N;for(let B=0;B<N;B++)n.stack[n.top]=new eD.TValue,eD.setobj2s(n,n.top,e.stack[e.top+B]),delete e.stack[e.top+B],n.top++}}},function(e,n,N){let{lua_assert:B}=N(4),s=function(e){let n=e.reader(e.L,e.data);if(null===n)return -1;B(n instanceof Uint8Array,"Should only load binary of array of bytes");let N=n.length;return 0===N?-1:(e.buffer=n,e.off=0,e.n=N-1,e.buffer[e.off++])};e.exports.EOZ=-1,e.exports.luaZ_buffer=function(e){return e.buffer.subarray(0,e.n)},e.exports.luaZ_buffremove=function(e,n){e.n-=n},e.exports.luaZ_fill=s,e.exports.luaZ_read=function(e,n,N,B){for(;B;){if(0===e.n){if(-1===s(e))return B;e.n++,e.off--}let et=B<=e.n?B:e.n;for(let B=0;B<et;B++)n[N++]=e.buffer[e.off++];e.n-=et,0===e.n&&(e.buffer=null),B-=et}return 0},e.exports.luaZ_resetbuffer=function(e){e.n=0},e.exports.luaZ_resizebuffer=function(e,n,N){let B=new Uint8Array(N);n.buffer&&B.set(n.buffer),n.buffer=B},e.exports.MBuffer=class{constructor(){this.buffer=null,this.n=0}},e.exports.ZIO=class{constructor(e,n,N){this.L=e,B("function"==typeof n,"ZIO requires a reader"),this.reader=n,this.data=N,this.n=0,this.buffer=null,this.off=0}zgetc(){return this.n-- >0?this.buffer[this.off++]:s(this)}}},function(e,n,N){let{constant_types:{LUA_TBOOLEAN:B,LUA_TLNGSTR:et},thread_status:{LUA_ERRSYNTAX:ei},to_luastring:eo}=N(1),{LUA_MINBUFFER:el,MAX_INT:eu,lua_assert:ec}=N(4),ef=N(11),eh=N(8),{lisdigit:ep,lislalnum:ed,lislalpha:e_,lisspace:eg,lisxdigit:em}=N(22),eb=N(6),{luaS_bless:ey,luaS_hash:ev,luaS_hashlongstr:ek,luaS_new:eA}=N(10),eL=N(9),{EOZ:ex,luaZ_buffer:ew,luaZ_buffremove:eT,luaZ_resetbuffer:eO,luaZ_resizebuffer:eE}=N(19),eS=eo("_ENV",!0),eN=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","//","..","...","==",">=","<=","~=","<<",">>","::","<eof>","<number>","<integer>","<name>","<string>"].map((e,n)=>eo(e));let Y=class Y{constructor(){this.r=NaN,this.i=NaN,this.ts=null}};let de=class de{constructor(){this.token=NaN,this.seminfo=new Y}};let _e=function(e,n){let N=e.buff;if(N.n+1>N.buffer.length){N.buffer.length>=eu/2&&Ze(e,eo("lexical element too long",!0),0);let n=2*N.buffer.length;eE(e.L,N,n)}N.buffer[N.n++]=n<0?255+n+1:n},me=function(e,n){if(n<257)return eb.luaO_pushfstring(e.L,eo("'%c'",!0),n);{let N=eN[n-257];return n<289?eb.luaO_pushfstring(e.L,eo("'%s'",!0),N):N}},ve=function(e){return 10===e.current||13===e.current},z=function(e){e.current=e.z.zgetc()},I=function(e){_e(e,e.current),z(e)},eI=new eb.TValue(B,!0),ye=function(e,n){let N=e.L,B=eA(N,n),ei=e.h.strong.get(ek(B));if(ei)B=ei.key.tsvalue();else{let n=new eb.TValue(et,B);eL.luaH_setfrom(N,e.h,n,eI)}return B},be=function(e){let n=e.current;ec(ve(e)),z(e),ve(e)&&e.current!==n&&z(e),++e.linenumber>=eu&&Ze(e,eo("chunk has too many lines",!0),0)},Ue=function(e,n){return e.current===n&&(z(e),!0)},He=function(e,n){return(e.current===n[0].charCodeAt(0)||e.current===n[1].charCodeAt(0))&&(I(e),!0)},st=function(e,n){let N="Ee",B=e.current;for(ec(ep(e.current)),I(e),48===B&&He(e,"xX")&&(N="Pp");;)if(He(e,N)&&He(e,"-+"),em(e.current))I(e);else{if(46!==e.current)break;I(e)}let et=new eb.TValue;return 0===eb.luaO_str2num(ew(e.buff),et)&&Ze(e,eo("malformed number",!0),290),et.ttisinteger()?(n.i=et.value,291):(ec(et.ttisfloat()),n.r=et.value,290)},Ze=function(e,n,N){n=ef.luaG_addinfo(e.L,n,e.source,e.linenumber),N&&eb.luaO_pushfstring(e.L,eo("%s near %s"),n,function(e,n){switch(n){case 292:case 293:case 290:case 291:return eb.luaO_pushfstring(e.L,eo("'%s'",!0),ew(e.buff));default:return me(e,n)}}(e,N)),eh.luaD_throw(e.L,ei)},ae=function(e){let n=0,N=e.current;for(ec(91===N||93===N),I(e);61===e.current;)I(e),n++;return e.current===N?n:-n-1},le=function(e,n,N){let B=e.linenumber;I(e),ve(e)&&be(e);let et=!1;for(;!et;)switch(e.current){case ex:Ze(e,eo(`unfinished long ${n?"string":"comment"} (starting at line ${B})`),289);break;case 93:ae(e)===N&&(I(e),et=!0);break;case 10:case 13:_e(e,10),be(e),n||eO(e.buff);break;default:n?I(e):z(e)}n&&(n.ts=ye(e,e.buff.buffer.subarray(2+N,e.buff.n-(2+N))))},Pe=function(e,n,N){n||(e.current!==ex&&I(e),Ze(e,N,293))},xe=function(e){return I(e),Pe(e,em(e.current),eo("hexadecimal digit expected",!0)),eb.luaO_hexavalue(e.current)},Ge=function(e){let n=xe(e);return n=(n<<4)+xe(e),eT(e.buff,2),n},g=function(e){let n=new Uint8Array(eb.UTF8BUFFSZ),N=eb.luaO_utf8esc(n,function(e){let n=4;I(e),Pe(e,123===e.current,eo("missing '{'",!0));let N=xe(e);for(I(e);em(e.current);)n++,N=(N<<4)+eb.luaO_hexavalue(e.current),Pe(e,N<=1114111,eo("UTF-8 value too large",!0)),I(e);return Pe(e,125===e.current,eo("missing '}'",!0)),z(e),eT(e.buff,n),N}(e));for(;N>0;N--)_e(e,n[eb.UTF8BUFFSZ-N])},ge=function(e){let n,N=0;for(n=0;n<3&&ep(e.current);n++)N=10*N+e.current-48,I(e);return Pe(e,N<=255,eo("decimal escape too large",!0)),eT(e.buff,n),N},te=function(e,n,N){for(I(e);e.current!==n;)switch(e.current){case ex:Ze(e,eo("unfinished string",!0),289);break;case 10:case 13:Ze(e,eo("unfinished string",!0),293);break;case 92:{let n,N;switch(I(e),e.current){case 97:N=7,n="read_save";break;case 98:N=8,n="read_save";break;case 102:N=12,n="read_save";break;case 110:N=10,n="read_save";break;case 114:N=13,n="read_save";break;case 116:N=9,n="read_save";break;case 118:N=11,n="read_save";break;case 120:N=Ge(e),n="read_save";break;case 117:g(e),n="no_save";break;case 10:case 13:be(e),N=10,n="only_save";break;case 92:case 34:case 39:N=e.current,n="read_save";break;case ex:n="no_save";break;case 122:for(eT(e.buff,1),z(e);eg(e.current);)ve(e)?be(e):z(e);n="no_save";break;default:Pe(e,ep(e.current),eo("invalid escape sequence",!0)),N=ge(e),n="only_save"}"read_save"===n&&z(e),"read_save"!==n&&"only_save"!==n||(eT(e.buff,1),_e(e,N));break}default:I(e)}I(e),N.ts=ye(e,e.buff.buffer.subarray(1,e.buff.n-1))},eR=Object.create(null);eN.forEach((e,n)=>eR[ev(e)]=n);let S=function(e,n){for(eO(e.buff);;)switch(ec("number"==typeof e.current),e.current){case 10:case 13:be(e);break;case 32:case 12:case 9:case 11:z(e);break;case 45:if(z(e),45!==e.current)return 45;if(z(e),91===e.current){let n=ae(e);if(eO(e.buff),n>=0){le(e,null,n),eO(e.buff);break}}for(;!ve(e)&&e.current!==ex;)z(e);break;case 91:{let N=ae(e);return N>=0?(le(e,n,N),293):(-1!==N&&Ze(e,eo("invalid long string delimiter",!0),293),91)}case 61:return z(e),Ue(e,61)?282:61;case 60:return z(e),Ue(e,61)?284:Ue(e,60)?286:60;case 62:return z(e),Ue(e,61)?283:Ue(e,62)?287:62;case 47:return z(e),Ue(e,47)?279:47;case 126:return z(e),Ue(e,61)?285:126;case 58:return z(e),Ue(e,58)?288:58;case 34:case 39:return te(e,e.current,n),293;case 46:return I(e),Ue(e,46)?Ue(e,46)?281:280:ep(e.current)?st(e,n):46;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return st(e,n);case ex:return 289;default:if(e_(e.current)){do I(e);while(ed(e.current));let N=ye(e,ew(e.buff));n.ts=N;let B=eR[ek(N)];return void 0!==B&&B<=22?B+257:292}{let n=e.current;return z(e),n}}};e.exports.FIRST_RESERVED=257,e.exports.LUA_ENV=eS,e.exports.LexState=class{constructor(){this.current=NaN,this.linenumber=NaN,this.lastline=NaN,this.t=new de,this.lookahead=new de,this.fs=null,this.L=null,this.z=null,this.buff=null,this.h=null,this.dyd=null,this.source=null,this.envn=null}},e.exports.RESERVED={TK_AND:257,TK_BREAK:258,TK_DO:259,TK_ELSE:260,TK_ELSEIF:261,TK_END:262,TK_FALSE:263,TK_FOR:264,TK_FUNCTION:265,TK_GOTO:266,TK_IF:267,TK_IN:268,TK_LOCAL:269,TK_NIL:270,TK_NOT:271,TK_OR:272,TK_REPEAT:273,TK_RETURN:274,TK_THEN:275,TK_TRUE:276,TK_UNTIL:277,TK_WHILE:278,TK_IDIV:279,TK_CONCAT:280,TK_DOTS:281,TK_EQ:282,TK_GE:283,TK_LE:284,TK_NE:285,TK_SHL:286,TK_SHR:287,TK_DBCOLON:288,TK_EOS:289,TK_FLT:290,TK_INT:291,TK_NAME:292,TK_STRING:293},e.exports.isreserved=function(e){let n=eR[ek(e)];return void 0!==n&&n<=22},e.exports.luaX_lookahead=function(e){return ec(289===e.lookahead.token),e.lookahead.token=S(e,e.lookahead.seminfo),e.lookahead.token},e.exports.luaX_newstring=ye,e.exports.luaX_next=function(e){e.lastline=e.linenumber,289!==e.lookahead.token?(e.t.token=e.lookahead.token,e.t.seminfo.i=e.lookahead.seminfo.i,e.t.seminfo.r=e.lookahead.seminfo.r,e.t.seminfo.ts=e.lookahead.seminfo.ts,e.lookahead.token=289):e.t.token=S(e,e.t.seminfo)},e.exports.luaX_setinput=function(e,n,N,B,et){n.t={token:0,seminfo:new Y},n.L=e,n.current=et,n.lookahead={token:289,seminfo:new Y},n.z=N,n.fs=null,n.linenumber=1,n.lastline=1,n.source=B,n.envn=ey(e,eS),eE(e,n.buff,el)},e.exports.luaX_syntaxerror=function(e,n){Ze(e,n,e.t.token)},e.exports.luaX_token2str=me,e.exports.luaX_tokens=eN},function(e,n,N){let B,et,ei;let{lua:eo,lauxlib:el,lualib:eu,to_luastring:ec}=N(0),{LUA_MULTRET:ef,LUA_OK:eh,LUA_REGISTRYINDEX:ep,LUA_RIDX_MAINTHREAD:ed,LUA_TBOOLEAN:e_,LUA_TFUNCTION:eg,LUA_TLIGHTUSERDATA:em,LUA_TNIL:eb,LUA_TNONE:ey,LUA_TNUMBER:ev,LUA_TSTRING:ek,LUA_TTABLE:eA,LUA_TTHREAD:eL,LUA_TUSERDATA:ex,lua_atnativeerror:ew,lua_call:eT,lua_getfield:eO,lua_gettable:eE,lua_gettop:eS,lua_isnil:eN,lua_isproxy:eI,lua_newuserdata:eR,lua_pcall:eU,lua_pop:eC,lua_pushboolean:eM,lua_pushcfunction:eP,lua_pushinteger:eD,lua_pushlightuserdata:eB,lua_pushliteral:eK,lua_pushnil:eG,lua_pushnumber:eV,lua_pushstring:eF,lua_pushvalue:ez,lua_rawgeti:ej,lua_rawgetp:eH,lua_rawsetp:e$,lua_rotate:eX,lua_setfield:eq,lua_settable:eW,lua_settop:eZ,lua_toboolean:eY,lua_tojsstring:eJ,lua_tonumber:eQ,lua_toproxy:e0,lua_tothread:e1,lua_touserdata:e2,lua_type:e3}=eo,{luaL_argerror:e5,luaL_checkany:e4,luaL_checkoption:e8,luaL_checkstack:e6,luaL_checkudata:e9,luaL_error:e7,luaL_getmetafield:ti,luaL_newlib:to,luaL_newmetatable:tl,luaL_requiref:tu,luaL_setfuncs:tc,luaL_setmetatable:tf,luaL_testudata:th,luaL_tolstring:tp}=el,{luaopen_base:td}=eu,t_="u">typeof window?window:"u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this");if("u">typeof Reflect)B=Reflect.apply,et=Reflect.construct,ei=Reflect.deleteProperty;else{let e=Function.apply,n=Function.bind;B=function(n,N,B){return e.call(n,N,B)},et=function(e,N){switch(N.length){case 0:return new e;case 1:return new e(N[0]);case 2:return new e(N[0],N[1]);case 3:return new e(N[0],N[1],N[2]);case 4:return new e(N[0],N[1],N[2],N[3])}let B=[null];return B.push.apply(B,N),new(n.apply(e,B))},ei=Function("t","k","delete t[k]")}let tg=String.prototype.concat.bind(""),We=function(e){return"object"==typeof e?null!==e:"function"==typeof e},tm=ec("js object"),vt=function(e,n){let N=th(e,n,tm);return N?N.data:void 0},yt=function(e,n){return e9(e,n,tm).data},Rt=function(e,n){eR(e).data=n,tf(e,tm)},lt=function(e){ej(e,ep,ed);let n=e1(e,-1);return eC(e,1),n},tb=new WeakMap,At=function(e,n){switch(typeof n){case"undefined":eG(e);break;case"number":eV(e,n);break;case"string":eF(e,ec(n));break;case"boolean":eM(e,n);break;case"symbol":eB(e,n);break;case"function":if(eI(n,e)){n(e);break}case"object":if(null===n){if(eH(e,ep,null)!==ex)throw Error("js library not loaded into lua_State");break}default:{let N=tb.get(lt(e));if(!N)throw Error("js library not loaded into lua_State");let B=N.get(n);B?B(e):(Rt(e,n),B=e0(e,-1),N.set(n,B))}}},o=function(e){let n=e2(e,1);return At(e,n),1},c=function(e,n){switch(e3(e,n)){case ey:case eb:return;case e_:return eY(e,n);case em:return e2(e,n);case ev:return eQ(e,n);case ek:return eJ(e,n);case ex:{let N=vt(e,n);if(void 0!==N)return N}default:return J(e,e0(e,n))}},x=function(e,n){let N=eU(e,n,1,0),B=c(e,-1);if(eC(e,1),N===eh)return B;throw B},p=function(e,n,N,B,et){if(!We(B))throw TypeError("`args` argument must be an object");let ei=+B.length;ei>=0||(ei=0),e6(e,2+ei,null);let eo=eS(e);n(e),At(e,N);for(let n=0;n<ei;n++)At(e,B[n]);if(eU(e,1+ei,et,0)===eh){let n=eS(e)-eo,N=Array(n);for(let B=0;B<n;B++)N[B]=c(e,eo+B+1);return eZ(e,eo),N}{let n=c(e,-1);throw eZ(e,eo),n}},T=function(e){return eE(e,1),1},X=function(e,n,N){return e6(e,3,null),eP(e,T),n(e),At(e,N),x(e,2)},U=function(e,n,N){if(e6(e,3,null),eP(e,T),n(e),At(e,N),eU(e,2,1,0)===eh){let n=eN(e,-1);return eC(e,1),!n}{let n=c(e,-1);throw eC(e,1),n}},pe=function(e,n,N,B){if(e6(e,4,null),eP(e,function(e){return eW(e,1),0}),n(e),At(e,N),At(e,B),eU(e,3,0,0)!==eh){let n=c(e,-1);throw eC(e,1),n}},Ke=function(e,n,N){if(e6(e,4,null),eP(e,function(e){return eW(e,1),0}),n(e),At(e,N),eG(e),eU(e,3,0,0)!==eh){let n=c(e,-1);throw eC(e,1),n}},Qe=function(e,n){return e6(e,2,null),eP(e,function(e){return tp(e,1),1}),n(e),x(e,1)},kt=function(){let e=this.L;e6(e,3,null);let n=eS(e);if(this.iter(e),this.state(e),this.last(e),eU(e,2,ef,0)===eh){let N;if(this.last=e0(e,n+1),eN(e,-1))N={done:!0,value:void 0};else{let B=eS(e)-n,et=Array(B);for(let N=0;N<B;N++)et[N]=c(e,n+N+1);N={done:!1,value:et}}return eZ(e,n),N}{let n=c(e,-1);throw eC(e,1),n}},J=function(e,n){let N=lt(e),Me=function(){return p(N,n,this,arguments,1)[0]};Me.apply=function(e,B){return p(N,n,e,B,1)[0]},Me.invoke=function(e,B){return p(N,n,e,B,ef)},Me.get=function(e){return X(N,n,e)},Me.has=function(e){return U(N,n,e)},Me.set=function(e,B){return pe(N,n,e,B)},Me.delete=function(e){return Ke(N,n,e)},Me.toString=function(){return Qe(N,n)},"function"==typeof Symbol&&(Me[Symbol.toStringTag]="Fengari object",Me[Symbol.iterator]=function(){return function(e,n){if(e6(e,1,null),eP(e,function(e){return tu(e,ec("_G"),td,0),eO(e,-1,ec("pairs")),n(e),eT(e,1,3),3}),eU(e,0,3,0)===eh){let n=e0(e,-3),N=e0(e,-2),B=e0(e,-1);return eC(e,3),{L:e,iter:n,state:N,last:B,next:kt}}{let n=c(e,-1);throw eC(e,1),n}}(N,n)},Symbol.toPrimitive&&(Me[Symbol.toPrimitive]=function(e){if("string"===e)return Qe(N,n)}));let B=tb.get(N);if(!B)throw Error("js library not loaded into lua_State");return B.set(Me,n),Me},ty={new:function(e){let n=c(e,1),N=eS(e)-1,B=Array(N);for(let n=0;n<N;n++)B[n]=c(e,n+2);return At(e,et(n,B)),1},tonumber:function(e){let n=c(e,1);return eV(e,+n),1},tostring:function(e){let n=c(e,1);return eK(e,tg(n)),1},instanceof:function(e){let n=c(e,1),N=c(e,2);return eM(e,n instanceof N),1},typeof:function(e){let n=c(e,1);return eK(e,typeof n),1}};if("function"==typeof Symbol&&Symbol.iterator){let V=function(e,n){let N=yt(e,n),et=N[Symbol.iterator];et||e5(e,n,ec("object not iterable"));let ei=B(et,N,[]);return We(ei)||e5(e,n,ec("Result of the Symbol.iterator method is not an object")),ei},Te=function(e){let n=c(e,1).next();return n.done?0:(At(e,n.value),1)};ty.of=function(e){let n=V(e,1);return eP(e,Te),At(e,n),2}}if("function"==typeof Proxy&&"function"==typeof Symbol){let e=Symbol("lua_State"),n=Symbol("fengari-proxy"),N={apply:function(N,B,et){return p(N[e],N[n],B,et,1)[0]},construct:function(N,B){let et=N[e],ei=N[n],eo=B.length;e6(et,2+eo,null),ei(et);let el=eS(et);if(ti(et,el,ec("construct"))===eb)throw eC(et,1),TypeError("not a constructor");eX(et,el,1);for(let e=0;e<eo;e++)At(et,B[e]);return x(et,1+eo)},defineProperty:function(N,B,et){let ei=N[e],eo=N[n];return e6(ei,4,null),eo(ei),ti(ei,-1,ec("defineProperty"))===eb?(eC(ei,1),!1):(eX(ei,-2,1),At(ei,B),At(ei,et),x(ei,3))},deleteProperty:function(N,B){return Ke(N[e],N[n],B)},get:function(N,B){return X(N[e],N[n],B)},getOwnPropertyDescriptor:function(N,B){let et=N[e],ei=N[n];if(e6(et,3,null),ei(et),ti(et,-1,ec("getOwnPropertyDescriptor"))!==eb)return eX(et,-2,1),At(et,B),x(et,2);eC(et,1)},getPrototypeOf:function(N){let B=N[e],et=N[n];return e6(B,2,null),et(B),ti(B,-1,ec("getPrototypeOf"))===eb?(eC(B,1),null):(eX(B,-2,1),x(B,1))},has:function(N,B){return U(N[e],N[n],B)},ownKeys:function(N){let B=N[e],et=N[n];if(e6(B,2,null),et(B),ti(B,-1,ec("ownKeys"))===eb)throw eC(B,1),Error("ownKeys unknown for fengari object");return eX(B,-2,1),x(B,1)},set:function(N,B,et){return pe(N[e],N[n],B,et),!0},setPrototypeOf:function(N,B){let et=N[e],ei=N[n];return e6(et,3,null),ei(et),ti(et,-1,ec("setPrototypeOf"))===eb?(eC(et,1),!1):(eX(et,-2,1),At(et,B),x(et,2))}},Me=function(){let e=(function(){}).bind();return delete e.length,delete e.name,e},B=Function("return ()=>void 0;"),ct=function(){let e=B();return delete e.length,delete e.name,e},at=function(B,et,ei){let eo;let el=lt(B);switch(ei){case"function":eo=Me();break;case"arrow_function":eo=ct();break;case"object":eo={};break;default:throw TypeError("invalid type to createproxy")}return eo[n]=et,eo[e]=el,new Proxy(eo,N)},et=["function","arrow_function","object"],ei=et.map(e=>ec(e));ty.createproxy=function(e){e4(e,1);let n=et[e8(e,2,ei[0],ei)],N=at(e,e0(e,1),n);return At(e,N),1}}let tv={__index:function(e){let n=yt(e,1),N=c(e,2);return At(e,n[N]),1},__newindex:function(e){let n=yt(e,1),N=c(e,2),B=c(e,3);return void 0===B?ei(n,N):n[N]=B,0},__tostring:function(e){let n=tg(yt(e,1));return eF(e,ec(n)),1},__call:function(e){let n,N=yt(e,1),et=eS(e)-1,ei=Array(Math.max(0,et-1));if(et>0&&(n=c(e,2),et-- >0))for(let n=0;n<et;n++)ei[n]=c(e,n+3);return At(e,B(N,n,ei)),1},__pairs:function(e){let n,N,et,ei,eo=yt(e,1);if("function"!=typeof Symbol||void 0===(n=eo[Symbol.for("__pairs")]))N=function(e){if(this.index>=this.keys.length)return;let n=this.keys[this.index++];return[n,this.object[n]]},et={object:eo,keys:Object.keys(eo),index:0};else{let el=B(n,eo,[]);void 0===el&&e7(e,ec("bad '__pairs' result (object with keys 'iter', 'state', 'first' expected)")),void 0===(N=el.iter)&&e7(e,ec("bad '__pairs' result (object.iter is missing)")),et=el.state,ei=el.first}return eP(e,function(){let n=c(e,1),et=c(e,2),ei=B(N,n,[et]);if(void 0===ei)return 0;Array.isArray(ei)||e7(e,ec("bad iterator result (Array or undefined expected)")),e6(e,ei.length,null);for(let n=0;n<ei.length;n++)At(e,ei[n]);return ei.length}),At(e,et),At(e,ei),3},__len:function(e){let n,N=yt(e,1);return At(e,"function"!=typeof Symbol||void 0===(n=N[Symbol.for("__len")])?N.length:B(n,N,[])),1}};e.exports.FENGARI_INTEROP_VERSION="0.1",e.exports.FENGARI_INTEROP_VERSION_NUM=1,e.exports.FENGARI_INTEROP_RELEASE="0.1.2",e.exports.checkjs=yt,e.exports.testjs=vt,e.exports.pushjs=Rt,e.exports.push=At,e.exports.tojs=c,e.exports.luaopen_js=function(e){return tb.set(lt(e),new WeakMap),ew(e,o),to(e,ty),eK(e,"0.1"),eq(e,-2,ec("_VERSION")),eD(e,1),eq(e,-2,ec("_VERSION_NUM")),eK(e,"0.1.2"),eq(e,-2,ec("_RELEASE")),tl(e,tm),tc(e,tv,0),eC(e,1),Rt(e,null),ez(e,-1),e$(e,ep,null),eq(e,-2,ec("null")),At(e,t_),eq(e,-2,ec("global")),1}},function(e,n,N){let{luastring_of:B}=N(1),et=B(0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,22,22,22,22,22,22,22,22,22,22,4,4,4,4,4,4,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,5,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);e.exports.lisdigit=function(e){return(2&et[e+1])!=0},e.exports.lislalnum=function(e){return(3&et[e+1])!=0},e.exports.lislalpha=function(e){return(1&et[e+1])!=0},e.exports.lisprint=function(e){return(4&et[e+1])!=0},e.exports.lisspace=function(e){return(8&et[e+1])!=0},e.exports.lisxdigit=function(e){return(16&et[e+1])!=0}},function(e,n,N){let{LUA_MULTRET:B,to_luastring:et}=N(1),{BinOpr:{OPR_ADD:ei,OPR_AND:eo,OPR_BAND:el,OPR_BOR:eu,OPR_BXOR:ec,OPR_CONCAT:ef,OPR_DIV:eh,OPR_EQ:ep,OPR_GE:ed,OPR_GT:e_,OPR_IDIV:eg,OPR_LE:em,OPR_LT:eb,OPR_MOD:ey,OPR_MUL:ev,OPR_NE:ek,OPR_NOBINOPR:eA,OPR_OR:eL,OPR_POW:ex,OPR_SHL:ew,OPR_SHR:eT,OPR_SUB:eO},UnOpr:{OPR_BNOT:eE,OPR_LEN:eS,OPR_MINUS:eN,OPR_NOT:eI,OPR_NOUNOPR:eR},NO_JUMP:eU,getinstruction:eC,luaK_checkstack:eM,luaK_codeABC:eP,luaK_codeABx:eD,luaK_codeAsBx:eB,luaK_codek:eK,luaK_concat:eG,luaK_dischargevars:eV,luaK_exp2RK:eF,luaK_exp2anyreg:ez,luaK_exp2anyregup:ej,luaK_exp2nextreg:eH,luaK_exp2val:e$,luaK_fixline:eX,luaK_getlabel:eq,luaK_goiffalse:eW,luaK_goiftrue:eZ,luaK_indexed:eY,luaK_infix:eJ,luaK_intK:eQ,luaK_jump:e0,luaK_jumpto:e1,luaK_nil:e2,luaK_patchclose:e3,luaK_patchlist:e5,luaK_patchtohere:e4,luaK_posfix:e8,luaK_prefix:e6,luaK_reserveregs:e9,luaK_ret:e7,luaK_self:ti,luaK_setlist:to,luaK_setmultret:tl,luaK_setoneret:tu,luaK_setreturns:tc,luaK_storevar:tf,luaK_stringK:th}=N(35),tp=N(8),td=N(13),t_=N(20),{LUAI_MAXCCALLS:tg,MAX_INT:tm,lua_assert:tb}=N(4),ty=N(6),{OpCodesI:{OP_CALL:tv,OP_CLOSURE:tk,OP_FORLOOP:tA,OP_FORPREP:tL,OP_GETUPVAL:tx,OP_MOVE:tw,OP_NEWTABLE:tT,OP_SETTABLE:tO,OP_TAILCALL:tE,OP_TFORCALL:tS,OP_TFORLOOP:tN,OP_VARARG:tI},LFIELDS_PER_FLUSH:tR,SETARG_B:tU,SETARG_C:tC,SET_OPCODE:tM}=N(16),{luaS_eqlngstr:tP,luaS_new:tD,luaS_newliteral:tB}=N(10),tK=N(9),tG=td.Proto,tV=t_.RESERVED,Me=function(e){return e===tF.VCALL||e===tF.VVARARG},tt=function(e,n){return tP(e,n)};let ct=class ct{constructor(){this.previous=null,this.firstlabel=NaN,this.firstgoto=NaN,this.nactvar=NaN,this.upval=NaN,this.isloop=NaN}};let tF={VVOID:0,VNIL:1,VTRUE:2,VFALSE:3,VK:4,VKFLT:5,VKINT:6,VNONRELOC:7,VLOCAL:8,VUPVAL:9,VINDEXED:10,VJMP:11,VRELOCABLE:12,VCALL:13,VVARARG:14};let _t=class _t{constructor(){this.k=NaN,this.u={ival:NaN,nval:NaN,info:NaN,ind:{idx:NaN,t:NaN,vt:NaN}},this.t=NaN,this.f=NaN}to(e){this.k=e.k,this.u=e.u,this.t=e.t,this.f=e.f}};let Ct=class Ct{constructor(){this.f=null,this.prev=null,this.ls=null,this.bl=null,this.pc=NaN,this.lasttarget=NaN,this.jpc=NaN,this.nk=NaN,this.np=NaN,this.firstlocal=NaN,this.nlocvars=NaN,this.nactvar=NaN,this.nups=NaN,this.freereg=NaN}};let gt=class gt{constructor(){this.arr=[],this.n=NaN,this.size=NaN}};let Et=function(e,n){e.t.token=0,t_.luaX_syntaxerror(e,n)},wt=function(e,n){t_.luaX_syntaxerror(e,ty.luaO_pushfstring(e.L,et("%s expected",!0),t_.luaX_token2str(e,n)))},Bt=function(e,n,N,B){let ei,eo,el,eu;n>N&&(ei=e.ls.L,el=0===(eo=e.f.linedefined)?et("main function",!0):ty.luaO_pushfstring(ei,et("function at line %d",!0),eo),eu=ty.luaO_pushfstring(ei,et("too many %s (limit is %d) in %s",!0),B,N,el),t_.luaX_syntaxerror(e.ls,eu))},Mt=function(e,n){return e.t.token===n&&(t_.luaX_next(e),!0)},Zt=function(e,n){e.t.token!==n&&wt(e,n)},Dt=function(e,n){Zt(e,n),t_.luaX_next(e)},qt=function(e,n,N){n||t_.luaX_syntaxerror(e,N)},Xt=function(e,n,N,B){Mt(e,n)||(B===e.linenumber?wt(e,n):t_.luaX_syntaxerror(e,ty.luaO_pushfstring(e.L,et("%s expected (to close %s at line %d)"),t_.luaX_token2str(e,n),t_.luaX_token2str(e,N),B)))},j=function(e){Zt(e,tV.TK_NAME);let n=e.t.seminfo.ts;return t_.luaX_next(e),n},Le=function(e,n,N){e.f=e.t=eU,e.k=n,e.u.info=N},Ye=function(e,n,N){Le(n,tF.VK,th(e.fs,N))},Je=function(e,n){Ye(e,n,j(e))},ot=function(e,n){let N,B;let ei=e.fs,eo=e.dyd,el=((B=(N=e.fs).f).locvars[N.nlocvars]=new ty.LocVar,B.locvars[N.nlocvars].varname=n,N.nlocvars++);Bt(ei,eo.actvar.n+1-ei.firstlocal,200,et("local variables",!0)),eo.actvar.arr[eo.actvar.n]=new class{constructor(){this.idx=NaN}},eo.actvar.arr[eo.actvar.n].idx=el,eo.actvar.n++},Xe=function(e,n){ot(e,t_.luaX_newstring(e,et(n,!0)))},qe=function(e,n){let N=e.ls.dyd.actvar.arr[e.firstlocal+n].idx;return tb(N<e.nlocvars),e.f.locvars[N]},Ve=function(e,n){let N=e.fs;for(N.nactvar=N.nactvar+n;n;n--)qe(N,N.nactvar-n).startpc=N.pc},rt=function(e,n,N){let B=e.f;return Bt(e,e.nups+1,td.MAXUPVAL,et("upvalues",!0)),B.upvalues[e.nups]={instack:N.k===tF.VLOCAL,idx:N.u.info,name:n},e.nups++},ht=function(e,n,N,B){if(null===e)Le(N,tF.VVOID,0);else{let et=function(e,n){for(let N=e.nactvar-1;N>=0;N--)if(tt(n,qe(e,N).varname))return N;return -1}(e,n);if(et>=0)Le(N,tF.VLOCAL,et),B||function(e,n){let N=e.bl;for(;N.nactvar>n;)N=N.previous;N.upval=1}(e,et);else{let B=function(e,n){let N=e.f.upvalues;for(let B=0;B<e.nups;B++)if(tt(N[B].name,n))return B;return -1}(e,n);if(B<0){if(ht(e.prev,n,N,0),N.k===tF.VVOID)return;B=rt(e,n,N)}Le(N,tF.VUPVAL,B)}}},k=function(e,n){let N=j(e),B=e.fs;if(ht(B,N,n,1),n.k===tF.VVOID){let et=new _t;ht(B,e.envn,n,1),tb(n.k!==tF.VVOID),Ye(e,et,N),eY(B,n,et)}},se=function(e,n,N,B){let et=e.fs,ei=n-N;if(Me(B.k))++ei<0&&(ei=0),tc(et,B,ei),ei>1&&e9(et,ei-1);else if(B.k!==tF.VVOID&&eH(et,B),ei>0){let e=et.freereg;e9(et,ei),e2(et,e,ei)}N>n&&(e.fs.freereg-=N-n)},re=function(e){let n=e.L;++n.nCcalls,Bt(e.fs,n.nCcalls,tg,et("JS levels",!0))},Ee=function(e){return e.L.nCcalls--},Ae=function(e,n,N){let B=e.fs,ei=e.dyd.gt,eo=ei.arr[n];if(tb(tt(eo.name,N.name)),eo.nactvar<N.nactvar){let n=qe(B,eo.nactvar).varname,N=ty.luaO_pushfstring(e.L,et("<goto %s> at line %d jumps into the scope of local '%s'"),eo.name.getstr(),eo.line,n.getstr());Et(e,N)}e5(B,eo.pc,N.pc);for(let e=n;e<ei.n-1;e++)ei.arr[e]=ei.arr[e+1];ei.n--},we=function(e,n){let N=e.fs.bl,B=e.dyd,et=B.gt.arr[n];for(let ei=N.firstlabel;ei<B.label.n;ei++){let eo=B.label.arr[ei];if(tt(eo.name,et.name))return et.nactvar>eo.nactvar&&(N.upval||B.label.n>N.firstlabel)&&e3(e.fs,et.pc,eo.nactvar),Ae(e,n,eo),!0}return!1},ft=function(e,n,N,B,et){let ei=n.n;return n.arr[ei]=new class{constructor(){this.name=null,this.pc=NaN,this.line=NaN,this.nactvar=NaN}},n.arr[ei].name=N,n.arr[ei].line=B,n.arr[ei].nactvar=e.fs.nactvar,n.arr[ei].pc=et,n.n=ei+1,ei},mt=function(e,n){let N=e.dyd.gt,B=e.fs.bl.firstgoto;for(;B<N.n;)tt(N.arr[B].name,n.name)?Ae(e,B,n):B++},Lt=function(e,n,N){n.isloop=N,n.nactvar=e.nactvar,n.firstlabel=e.ls.dyd.label.n,n.firstgoto=e.ls.dyd.gt.n,n.upval=0,n.previous=e.bl,e.bl=n,tb(e.freereg===e.nactvar)},Ut=function(e,n,N){n.prev=e.fs,n.ls=e,e.fs=n,n.pc=0,n.lasttarget=0,n.jpc=eU,n.freereg=0,n.nk=0,n.np=0,n.nups=0,n.nlocvars=0,n.nactvar=0,n.firstlocal=e.dyd.actvar.n,n.bl=null;let B=n.f;B.source=e.source,B.maxstacksize=2,Lt(n,N,!1)},P=function(e){var n;let N,B,ei,eo=e.bl,el=e.ls;if(eo.previous&&eo.upval){let n=e0(e);e3(e,n,eo.nactvar),e4(e,n)}eo.isloop&&(N=tB(el.L,"break"),B=ft(el,el.dyd.label,N,0,el.fs.pc),mt(el,el.dyd.label.arr[B])),e.bl=eo.previous,function(e,n){for(e.ls.dyd.actvar.n-=e.nactvar-n;e.nactvar>n;)qe(e,--e.nactvar).endpc=e.pc}(e,eo.nactvar),tb(eo.nactvar===e.nactvar),e.freereg=e.nactvar,el.dyd.label.n=eo.firstlabel,eo.previous?function(e,n){let N=n.firstgoto,B=e.ls.dyd.gt;for(;N<B.n;){let et=B.arr[N];et.nactvar>n.nactvar&&(n.upval&&e3(e,et.pc,n.nactvar),et.nactvar=n.nactvar),we(e.ls,N)||N++}}(e,eo):eo.firstgoto<el.dyd.gt.n&&(n=el.dyd.gt.arr[eo.firstgoto],ei=t_.isreserved(n.name)?"<%s> at line %d not inside a loop":"no visible label '%s' for <goto> at line %d",ei=ty.luaO_pushfstring(el.L,et(ei),n.name.getstr(),n.line),Et(el,ei))},ne=function(e){let n=e.fs;e7(n,0,0),P(n),tb(null===n.bl),e.fs=n.prev},Re=function(e,n){switch(e.t.token){case tV.TK_ELSE:case tV.TK_ELSEIF:case tV.TK_END:case tV.TK_EOS:return!0;case tV.TK_UNTIL:return n;default:return!1}},it=function(e){for(;!Re(e,1);){if(e.t.token===tV.TK_RETURN)return void Cr(e);Cr(e)}},Tt=function(e,n){let N=e.fs,B=new _t;ej(N,n),t_.luaX_next(e),Je(e,B),eY(N,n,B)},jt=function(e,n){t_.luaX_next(e),cn(e,n),e$(e.fs,n),Dt(e,93)},Ht=function(e,n){let N=e.fs,B=e.fs.freereg,ei=new _t,eo=new _t;e.t.token===tV.TK_NAME?(Bt(N,n.nh,tm,et("items in a constructor",!0)),Je(e,ei)):jt(e,ei),n.nh++,Dt(e,61);let el=eF(N,ei);cn(e,eo),eP(N,tO,n.t.u.info,el,eF(N,eo)),N.freereg=B},pn=function(e,n){n.v.k!==tF.VVOID&&(eH(e,n.v),n.v.k=tF.VVOID,n.tostore===tR&&(to(e,n.t.u.info,n.na,n.tostore),n.tostore=0))},bn=function(e,n){cn(e,n.v),Bt(e.fs,n.na,tm,et("items in a constructor",!0)),n.na++,n.tostore++},vn=function(e,n){switch(e.t.token){case tV.TK_NAME:61!==t_.luaX_lookahead(e)?bn(e,n):Ht(e,n);break;case 91:Ht(e,n);break;default:bn(e,n)}},ln=function(e,n){let N=e.fs,et=e.linenumber,ei=eP(N,tT,0,0,0),eo=new class{constructor(){this.v=new _t,this.t=new _t,this.nh=NaN,this.na=NaN,this.tostore=NaN}};eo.na=eo.nh=eo.tostore=0,eo.t=n,Le(n,tF.VRELOCABLE,ei),Le(eo.v,tF.VVOID,0),eH(e.fs,n),Dt(e,123);do{if(tb(eo.v.k===tF.VVOID||eo.tostore>0),125===e.t.token)break;pn(N,eo),vn(e,eo)}while(Mt(e,44)||Mt(e,59));Xt(e,125,123,et),0!==eo.tostore&&(Me(eo.v.k)?(tl(N,eo.v),to(N,eo.t.u.info,eo.na,B),eo.na--):(eo.v.k!==tF.VVOID&&eH(N,eo.v),to(N,eo.t.u.info,eo.na,eo.tostore))),tU(N.f.code[ei],ty.luaO_int2fb(eo.na)),tC(N.f.code[ei],ty.luaO_int2fb(eo.nh))},Gt=function(e,n,N,B){let ei,eo,el,eu,ec=new Ct,ef=new ct;ec.f=(ei=e.L,eo=new tG(ei),(el=e.fs).f.p[el.np++]=eo,eo),ec.f.linedefined=B,Ut(e,ec,ef),Dt(e,40),N&&(Xe(e,"self"),Ve(e,1)),function(e){let n=e.fs,N=n.f,B=0;if(N.is_vararg=!1,41!==e.t.token)do switch(e.t.token){case tV.TK_NAME:ot(e,j(e)),B++;break;case tV.TK_DOTS:t_.luaX_next(e),N.is_vararg=!0;break;default:t_.luaX_syntaxerror(e,et("<name> or '...' expected",!0))}while(!N.is_vararg&&Mt(e,44));Ve(e,B),N.numparams=n.nactvar,e9(n,n.nactvar)}(e),Dt(e,41),it(e),ec.f.lastlinedefined=e.linenumber,Xt(e,tV.TK_END,tV.TK_FUNCTION,B),eu=e.fs.prev,Le(n,tF.VRELOCABLE,eD(eu,tk,0,eu.np-1)),eH(eu,n),ne(e)},un=function(e,n){let N=1;for(cn(e,n);Mt(e,44);)eH(e.fs,n),cn(e,n),N++;return N},ms=function(e,n,N){let ei,eo=e.fs,el=new _t;switch(e.t.token){case 40:t_.luaX_next(e),41===e.t.token?el.k=tF.VVOID:(un(e,el),tl(eo,el)),Xt(e,41,40,N);break;case 123:ln(e,el);break;case tV.TK_STRING:Ye(e,el,e.t.seminfo.ts),t_.luaX_next(e);break;default:t_.luaX_syntaxerror(e,et("function arguments expected",!0))}tb(n.k===tF.VNONRELOC);let eu=n.u.info;Me(el.k)?ei=B:(el.k!==tF.VVOID&&eH(eo,el),ei=eo.freereg-(eu+1)),Le(n,tF.VCALL,eP(eo,tv,eu,ei+1,2)),eX(eo,N),eo.freereg=eu+1},Ur=function(e,n){let N=e.fs,B=e.linenumber;for(!function(e,n){switch(e.t.token){case 40:{let N=e.linenumber;return t_.luaX_next(e),cn(e,n),Xt(e,41,40,N),void eV(e.fs,n)}case tV.TK_NAME:return void k(e,n);default:t_.luaX_syntaxerror(e,et("unexpected symbol",!0))}}(e,n);;)switch(e.t.token){case 46:Tt(e,n);break;case 91:{let B=new _t;ej(N,n),jt(e,B),eY(N,n,B);break}case 58:{let et=new _t;t_.luaX_next(e),Je(e,et),ti(N,n,et),ms(e,n,B);break}case 40:case tV.TK_STRING:case 123:eH(N,n),ms(e,n,B);break;default:return}},tz=[{left:10,right:10},{left:10,right:10},{left:11,right:11},{left:11,right:11},{left:14,right:13},{left:11,right:11},{left:11,right:11},{left:6,right:6},{left:4,right:4},{left:5,right:5},{left:7,right:7},{left:7,right:7},{left:9,right:8},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:2,right:2},{left:1,right:1}],Ir=function(e,n,N){re(e);let B=function(e){switch(e){case tV.TK_NOT:return eI;case 45:return eN;case 126:return eE;case 35:return eS;default:return eR}}(e.t.token);if(B!==eR){let N=e.linenumber;t_.luaX_next(e),Ir(e,n,12),e6(e.fs,B,n,N)}else!function(e,n){switch(e.t.token){case tV.TK_FLT:Le(n,tF.VKFLT,0),n.u.nval=e.t.seminfo.r;break;case tV.TK_INT:Le(n,tF.VKINT,0),n.u.ival=e.t.seminfo.i;break;case tV.TK_STRING:Ye(e,n,e.t.seminfo.ts);break;case tV.TK_NIL:Le(n,tF.VNIL,0);break;case tV.TK_TRUE:Le(n,tF.VTRUE,0);break;case tV.TK_FALSE:Le(n,tF.VFALSE,0);break;case tV.TK_DOTS:{let N=e.fs;qt(e,N.f.is_vararg,et("cannot use '...' outside a vararg function",!0)),Le(n,tF.VVARARG,eP(N,tI,0,1,0));break}case 123:return void ln(e,n);case tV.TK_FUNCTION:return t_.luaX_next(e),void Gt(e,n,0,e.linenumber);default:return void Ur(e,n)}t_.luaX_next(e)}(e,n);let eU=function(e){switch(e){case 43:return ei;case 45:return eO;case 42:return ev;case 37:return ey;case 94:return ex;case 47:return eh;case tV.TK_IDIV:return eg;case 38:return el;case 124:return eu;case 126:return ec;case tV.TK_SHL:return ew;case tV.TK_SHR:return eT;case tV.TK_CONCAT:return ef;case tV.TK_NE:return ek;case tV.TK_EQ:return ep;case 60:return eb;case tV.TK_LE:return em;case 62:return e_;case tV.TK_GE:return ed;case tV.TK_AND:return eo;case tV.TK_OR:return eL;default:return eA}}(e.t.token);for(;eU!==eA&&tz[eU].left>N;){let N=new _t,B=e.linenumber;t_.luaX_next(e),eJ(e.fs,eU,n);let et=Ir(e,N,tz[eU].right);e8(e.fs,eU,n,N,B),eU=et}return Ee(e),eU},cn=function(e,n){Ir(e,n,0)},er=function(e){let n=e.fs;Lt(n,new ct,0),it(e),P(n)};let vs=class vs{constructor(){this.prev=null,this.v=new _t}};let ys=function(e,n,N){var B;let ei=new _t;if(qt(e,(B=n.v.k,tF.VLOCAL<=B&&B<=tF.VINDEXED),et("syntax error",!0)),Mt(e,44)){let B=new vs;B.prev=n,Ur(e,B.v),B.v.k!==tF.VINDEXED&&function(e,n,N){let B=e.fs,et=B.freereg,ei=!1;for(;n;n=n.prev)n.v.k===tF.VINDEXED&&(n.v.u.ind.vt===N.k&&n.v.u.ind.t===N.u.info&&(ei=!0,n.v.u.ind.vt=tF.VLOCAL,n.v.u.ind.t=et),N.k===tF.VLOCAL&&n.v.u.ind.idx===N.u.info&&(ei=!0,n.v.u.ind.idx=et));ei&&(eP(B,N.k===tF.VLOCAL?tw:tx,et,N.u.info,0),e9(B,1))}(e,n,B.v),Bt(e.fs,N+e.L.nCcalls,tg,et("JS levels",!0)),ys(e,B,N+1)}else{Dt(e,61);let B=un(e,ei);if(B===N)return tu(e.fs,ei),void tf(e.fs,n.v,ei);se(e,N,B,ei)}Le(ei,tF.VNONRELOC,e.fs.freereg-1),tf(e.fs,n.v,ei)},ks=function(e){let n=new _t;return cn(e,n),n.k===tF.VNIL&&(n.k=tF.VFALSE),eZ(e.fs,n),n.f},Ls=function(e,n){let N,B=e.linenumber;Mt(e,tV.TK_GOTO)?N=j(e):(t_.luaX_next(e),N=tB(e.L,"break"));let et=ft(e,e.dyd.gt,N,B,n);we(e,et)},Va=function(e,n,N){let B,ei=e.fs,eo=e.dyd.label;(function(e,n,N){for(let B=e.bl.firstlabel;B<n.n;B++)if(tt(N,n.arr[B].name)){let ei=ty.luaO_pushfstring(e.ls.L,et("label '%s' already defined on line %d",!0),N.getstr(),n.arr[B].line);Et(e.ls,ei)}})(ei,eo,n),Dt(e,tV.TK_DBCOLON),B=ft(e,eo,n,N,eq(ei)),function(e){for(;59===e.t.token||e.t.token===tV.TK_DBCOLON;)Cr(e)}(e),Re(e,0)&&(eo.arr[B].nactvar=ei.bl.nactvar),mt(e,eo.arr[B])},Pr=function(e){let n=new _t;return cn(e,n),eH(e.fs,n),tb(n.k===tF.VNONRELOC),n.u.info},As=function(e,n,N,B,et){let ei,eo=new ct,el=e.fs;Ve(e,3),Dt(e,tV.TK_DO);let eu=et?eB(el,tL,n,eU):e0(el);Lt(el,eo,0),Ve(e,B),e9(el,B),er(e),P(el),e4(el,eu),et?ei=eB(el,tA,n,eU):(eP(el,tS,n,0,B),eX(el,N),ei=eB(el,tN,n+2,eU)),e5(el,ei,eu+1),eX(el,N)},za=function(e,n){let N=e.fs;Lt(N,new ct,1),t_.luaX_next(e);let B=j(e);switch(e.t.token){case 61:let ei,eo;eo=(ei=e.fs).freereg,Xe(e,"(for index)"),Xe(e,"(for limit)"),Xe(e,"(for step)"),ot(e,B),Dt(e,61),Pr(e),Dt(e,44),Pr(e),Mt(e,44)?Pr(e):(eK(ei,ei.freereg,eQ(ei,1)),e9(ei,1)),As(e,eo,n,1,1);break;case 44:case tV.TK_IN:!function(e,n){let N=e.fs,B=new _t,et=4,ei=N.freereg;for(Xe(e,"(for generator)"),Xe(e,"(for state)"),Xe(e,"(for control)"),ot(e,n);Mt(e,44);)ot(e,j(e)),et++;Dt(e,tV.TK_IN);let eo=e.linenumber;se(e,3,un(e,B),B),eM(N,3),As(e,ei,eo,et-3,0)}(e,B);break;default:t_.luaX_syntaxerror(e,et("'=' or 'in' expected",!0))}Xt(e,tV.TK_END,tV.TK_FOR,n),P(N)},ws=function(e,n){let N,B=new ct,et=e.fs,ei=new _t;if(t_.luaX_next(e),cn(e,ei),Dt(e,tV.TK_THEN),e.t.token===tV.TK_GOTO||e.t.token===tV.TK_BREAK){for(eW(e.fs,ei),Lt(et,B,!1),Ls(e,ei.t);Mt(e,59););if(Re(e,0))return P(et),n;N=e0(et)}else eZ(e.fs,ei),Lt(et,B,!1),N=ei.f;return it(e),P(et),e.t.token!==tV.TK_ELSE&&e.t.token!==tV.TK_ELSEIF||(n=eG(et,n,e0(et))),e4(et,N),n},Ga=function(e,n){let N=new _t,B=new _t;t_.luaX_next(e);let et=function(e,n){let N=0;for(k(e,n);46===e.t.token;)Tt(e,n);return 58===e.t.token&&(N=1,Tt(e,n)),N}(e,N);Gt(e,B,et,n),tf(e.fs,N,B),eX(e.fs,n)},Cr=function(e){let n=e.linenumber;switch(re(e),e.t.token){case 59:t_.luaX_next(e);break;case tV.TK_IF:!function(e,n){let N=e.fs,B=eU;for(B=ws(e,B);e.t.token===tV.TK_ELSEIF;)B=ws(e,B);Mt(e,tV.TK_ELSE)&&er(e),Xt(e,tV.TK_END,tV.TK_IF,n),e4(N,B)}(e,n);break;case tV.TK_WHILE:let N,ei,eo,el;N=e.fs,ei=new ct,t_.luaX_next(e),eo=eq(N),el=ks(e),Lt(N,ei,1),Dt(e,tV.TK_DO),er(e),e1(N,eo),Xt(e,tV.TK_END,tV.TK_WHILE,n),P(N),e4(N,el);break;case tV.TK_DO:t_.luaX_next(e),er(e),Xt(e,tV.TK_END,tV.TK_DO,n);break;case tV.TK_FOR:za(e,n);break;case tV.TK_REPEAT:let eu,ec,ef,eh,ep;ec=eq(eu=e.fs),ef=new ct,eh=new ct,Lt(eu,ef,1),Lt(eu,eh,0),t_.luaX_next(e),it(e),Xt(e,tV.TK_UNTIL,tV.TK_REPEAT,n),ep=ks(e),eh.upval&&e3(eu,ep,eh.nactvar),P(eu),e5(eu,ep,ec),P(eu);break;case tV.TK_FUNCTION:Ga(e,n);break;case tV.TK_LOCAL:let ed,e_;t_.luaX_next(e),Mt(e,tV.TK_FUNCTION)?(ed=new _t,e_=e.fs,ot(e,j(e)),Ve(e,1),Gt(e,ed,0,e.linenumber),qe(e_,ed.u.info).startpc=e_.pc):function(e){let n,N=0,B=new _t;do ot(e,j(e)),N++;while(Mt(e,44));Mt(e,61)?n=un(e,B):(B.k=tF.VVOID,n=0),se(e,N,n,B),Ve(e,N)}(e);break;case tV.TK_DBCOLON:t_.luaX_next(e),Va(e,j(e),n);break;case tV.TK_RETURN:let eg,em,eb,ey;t_.luaX_next(e),eb=e.fs,ey=new _t,Re(e,1)||59===e.t.token?eg=em=0:(em=un(e,ey),Me(ey.k)?(tl(eb,ey),ey.k===tF.VCALL&&1===em&&(tM(eC(eb,ey),tE),tb(eC(eb,ey).A===eb.nactvar)),eg=eb.nactvar,em=B):1===em?eg=ez(eb,ey):(eH(eb,ey),eg=eb.nactvar,tb(em===eb.freereg-eg))),e7(eb,eg,em),Mt(e,59);break;case tV.TK_BREAK:case tV.TK_GOTO:Ls(e,e0(e.fs));break;default:let ev,ek;ev=e.fs,Ur(e,(ek=new vs).v),61===e.t.token||44===e.t.token?(ek.prev=null,ys(e,ek,1)):(qt(e,ek.v.k===tF.VCALL,et("syntax error",!0)),tC(eC(ev,ek.v),1))}tb(e.fs.f.maxstacksize>=e.fs.freereg&&e.fs.freereg>=e.fs.nactvar),e.fs.freereg=e.fs.nactvar,Ee(e)};e.exports.Dyndata=class{constructor(){this.actvar={arr:[],n:NaN,size:NaN},this.gt=new gt,this.label=new gt}},e.exports.expkind=tF,e.exports.expdesc=_t,e.exports.luaY_parser=function(e,n,N,B,et,ei){let eo,el,eu=new t_.LexState,ec=new Ct,ef=td.luaF_newLclosure(e,1);return tp.luaD_inctop(e),e.stack[e.top-1].setclLvalue(ef),eu.h=tK.luaH_new(e),tp.luaD_inctop(e),e.stack[e.top-1].sethvalue(eu.h),ec.f=ef.p=new tG(e),ec.f.source=tD(e,et),eu.buff=N,eu.dyd=B,B.actvar.n=B.gt.n=B.label.n=0,t_.luaX_setinput(e,eu,n,ec.f.source,ei),eo=new ct,el=new _t,Ut(eu,ec,eo),ec.f.is_vararg=!0,Le(el,tF.VLOCAL,0),rt(ec,eu.envn,el),t_.luaX_next(eu),it(eu),Zt(eu,tV.TK_EOS),ne(eu),tb(!ec.prev&&1===ec.nups&&!eu.fs),tb(0===B.actvar.n&&0===B.gt.n&&0===B.label.n),delete e.stack[--e.top],ef},e.exports.vkisinreg=function(e){return e===tF.VNONRELOC||e===tF.VLOCAL}},function(e,n,N){let B,et;let{LUA_MULTRET:ei,LUA_OK:eo,LUA_TFUNCTION:el,LUA_TNIL:eu,LUA_TNONE:ec,LUA_TNUMBER:ef,LUA_TSTRING:eh,LUA_TTABLE:ep,LUA_VERSION:ed,LUA_YIELD:e_,lua_call:eg,lua_callk:em,lua_concat:eb,lua_error:ey,lua_getglobal:ev,lua_geti:ek,lua_getmetatable:eA,lua_gettop:eL,lua_insert:ex,lua_isnil:ew,lua_isnone:eT,lua_isstring:eO,lua_load:eE,lua_next:eS,lua_pcallk:eN,lua_pop:eI,lua_pushboolean:eR,lua_pushcfunction:eU,lua_pushglobaltable:eC,lua_pushinteger:eM,lua_pushliteral:eP,lua_pushnil:eD,lua_pushstring:eB,lua_pushvalue:eK,lua_rawequal:eG,lua_rawget:eV,lua_rawlen:eF,lua_rawset:ez,lua_remove:ej,lua_replace:eH,lua_rotate:e$,lua_setfield:eX,lua_setmetatable:eq,lua_settop:eW,lua_setupvalue:eZ,lua_stringtonumber:eY,lua_toboolean:eJ,lua_tolstring:eQ,lua_tostring:e0,lua_type:e1,lua_typename:e2}=N(2),{luaL_argcheck:e3,luaL_checkany:e5,luaL_checkinteger:e4,luaL_checkoption:e8,luaL_checkstack:e6,luaL_checktype:e9,luaL_error:e7,luaL_getmetafield:ti,luaL_loadbufferx:to,luaL_loadfile:tl,luaL_loadfilex:tu,luaL_optinteger:tc,luaL_optstring:tf,luaL_setfuncs:th,luaL_tolstring:tp,luaL_where:td}=N(7),{to_jsstring:t_,to_luastring:tg}=N(5);if("function"==typeof TextDecoder){let e="",n=new TextDecoder("utf-8");B=function(N){e+=n.decode(N,{stream:!0})};let N=new Uint8Array(0);et=function(){console.log(e+=n.decode(N)),e=""}}else{let e=[];B=function(n){try{n=t_(n)}catch{let e=new Uint8Array(n.length);e.set(n),n=e}e.push(n)},et=function(){console.log.apply(console.log,e),e=[]}}let tm=["stop","restart","collect","count","step","setpause","setstepmul","isrunning"].map(e=>tg(e)),bt=function(e){return e9(e,1,ep),eW(e,2),eS(e,1)?2:(eD(e),1)},vt=function(e){let n=e4(e,2)+1;return eM(e,n),ek(e,1,n)===eu?1:2},yt=function(e){let n=tc(e,2,1);return eW(e,1),e1(e,1)===eh&&n>0&&(td(e,n),eK(e,1),eb(e,2)),ey(e)},Rt=function(e,n,N){return n!==eo&&n!==e_?(eR(e,0),eK(e,-2),2):eL(e)-N},lt=function(e,n,N){return n===eo?(0!==N&&(eK(e,N),eZ(e,-2,1)||eI(e,1)),1):(eD(e),ex(e,-2),2)},pt=function(e,n){return e6(e,2,"too many nested functions"),eK(e,1),eg(e,0,1),ew(e,-1)?(eI(e,1),null):(eO(e,-1)||e7(e,tg("reader function must return a string")),eH(e,5),e0(e,5))},At=function(e,n,N){return eL(e)-1},tb={assert:function(e){return eJ(e,1)?eL(e):(e5(e,1),ej(e,1),eP(e,"assertion failed!"),eW(e,1),yt(e))},collectgarbage:function(e){e8(e,1,"collect",tm),tc(e,2,0),e7(e,tg("lua_gc not implemented"))},dofile:function(e){let n=tf(e,1,null);return eW(e,1),tl(e,n)!==eo?ey(e):(em(e,0,ei,0,At),At(e))},error:yt,getmetatable:function(e){return e5(e,1),eA(e,1)?ti(e,1,tg("__metatable",!0)):eD(e),1},ipairs:function(e){return e5(e,1),eU(e,vt),eK(e,1),eM(e,0),3},load:function(e){let n,N=e0(e,1),B=tf(e,3,"bt"),et=eT(e,4)?0:4;if(null!==N){let et=tf(e,2,N);n=to(e,N,N.length,et,B)}else{let N=tf(e,2,"=(load)");e9(e,1,el),eW(e,5),n=eE(e,pt,null,N,B)}return lt(e,n,et)},loadfile:function(e){let n=tf(e,1,null),N=tf(e,2,null),B=eT(e,3)?0:3,et=tu(e,n,N);return lt(e,et,B)},next:bt,pairs:function(e){var n;return n=tg("__pairs",!0),e5(e,1),ti(e,1,n)===eu?(eU(e,bt),eK(e,1),eD(e)):(eK(e,1),eg(e,1,3)),3},pcall:function(e){e5(e,1),eR(e,1),ex(e,1);let n=eN(e,eL(e)-2,ei,0,0,Rt);return Rt(e,n,0)},print:function(e){let n=eL(e);ev(e,tg("tostring",!0));for(let N=1;N<=n;N++){eK(e,-1),eK(e,N),eg(e,1,1);let n=eQ(e,-1);if(null===n)return e7(e,tg("'tostring' must return a string to 'print'"));N>1&&B(tg("	")),B(n),eI(e,1)}return et(),0},rawequal:function(e){return e5(e,1),e5(e,2),eR(e,eG(e,1,2)),1},rawget:function(e){return e9(e,1,ep),e5(e,2),eW(e,2),eV(e,1),1},rawlen:function(e){let n=e1(e,1);return e3(e,n===ep||n===eh,1,"table or string expected"),eM(e,eF(e,1)),1},rawset:function(e){return e9(e,1,ep),e5(e,2),e5(e,3),eW(e,3),ez(e,1),1},select:function(e){let n=eL(e);if(e1(e,1)===eh&&35===e0(e,1)[0])return eM(e,n-1),1;{let N=e4(e,1);return N<0?N=n+N:N>n&&(N=n),e3(e,1<=N,1,"index out of range"),n-N}},setmetatable:function(e){let n=e1(e,2);return e9(e,1,ep),e3(e,n===eu||n===ep,2,"nil or table expected"),ti(e,1,tg("__metatable",!0))!==eu?e7(e,tg("cannot change a protected metatable")):(eW(e,2),eq(e,1),1)},tonumber:function(e){if(0>=e1(e,2)){if(e5(e,1),e1(e,1)===ef)return eW(e,1),1;{let n=e0(e,1);if(null!==n&&eY(e,n)===n.length+1)return 1}}else{let n=e4(e,2);e9(e,1,eh);let N=e0(e,1);e3(e,2<=n&&n<=36,2,"base out of range");let B=function(e,n){try{e=t_(e)}catch{return null}let N=/^[\t\v\f \n\r]*([+-]?)0*([0-9A-Za-z]+)[\t\v\f \n\r]*$/.exec(e);if(!N)return null;let B=parseInt(N[1]+N[2],n);return isNaN(B)?null:0|B}(N,n);if(null!==B)return eM(e,B),1}return eD(e),1},tostring:function(e){return e5(e,1),tp(e,1),1},type:function(e){let n=e1(e,1);return e3(e,n!==ec,1,"value expected"),eB(e,e2(e,n)),1},xpcall:function(e){let n=eL(e);e9(e,2,el),eR(e,1),eK(e,1),e$(e,3,2);let N=eN(e,n-2,ei,2,2,Rt);return Rt(e,N,2)}};e.exports.luaopen_base=function(e){return eC(e),th(e,tb,0),eK(e,-1),eX(e,-2,tg("_G")),eP(e,ed),eX(e,-2,tg("_VERSION")),1}},function(e,n,N){let{LUA_OK:B,LUA_TFUNCTION:et,LUA_TSTRING:ei,LUA_YIELD:eo,lua_Debug:el,lua_checkstack:eu,lua_concat:ec,lua_error:ef,lua_getstack:eh,lua_gettop:ep,lua_insert:ed,lua_isyieldable:e_,lua_newthread:eg,lua_pop:em,lua_pushboolean:eb,lua_pushcclosure:ey,lua_pushliteral:ev,lua_pushthread:ek,lua_pushvalue:eA,lua_resume:eL,lua_status:ex,lua_tothread:ew,lua_type:eT,lua_upvalueindex:eO,lua_xmove:eE,lua_yield:eS}=N(2),{luaL_argcheck:eN,luaL_checktype:eI,luaL_newlib:eR,luaL_where:eU}=N(7),_e=function(e){let n=ew(e,1);return eN(e,n,1,"thread expected"),n},me=function(e,n,N){if(!eu(n,N))return ev(e,"too many arguments to resume"),-1;if(ex(n)===B&&0===ep(n))return ev(e,"cannot resume dead coroutine"),-1;eE(e,n,N);let et=eL(n,e,N);if(et===B||et===eo){let N=ep(n);return eu(e,N+1)?(eE(n,e,N),N):(em(n,N),ev(e,"too many results to resume"),-1)}return eE(n,e,1),-1},ve=function(e){let n=ew(e,eO(1)),N=me(e,n,ep(e));return N<0?(eT(e,-1)===ei&&(eU(e,1),ed(e,-2),ec(e,2)),ef(e)):N},z=function(e){eI(e,1,et);let n=eg(e);return eA(e,1),eE(e,n,1),1},eC={create:z,isyieldable:function(e){return eb(e,e_(e)),1},resume:function(e){let n=_e(e),N=me(e,n,ep(e)-1);return N<0?(eb(e,0),ed(e,-2),2):(eb(e,1),ed(e,-(N+1)),N+1)},running:function(e){return eb(e,ek(e)),2},status:function(e){let n=_e(e);if(e===n)ev(e,"running");else switch(ex(n)){case eo:ev(e,"suspended");break;case B:eh(n,0,new el)>0?ev(e,"normal"):0===ep(n)?ev(e,"dead"):ev(e,"suspended");break;default:ev(e,"dead")}return 1},wrap:function(e){return z(e),ey(e,ve,1),1},yield:function(e){return eS(e,ep(e))}};e.exports.luaopen_coroutine=function(e){return eR(e,eC),1}},function(e,n,N){let{LUA_MAXINTEGER:B}=N(3),{LUA_OPEQ:et,LUA_OPLT:ei,LUA_TFUNCTION:eo,LUA_TNIL:el,LUA_TTABLE:eu,lua_call:ec,lua_checkstack:ef,lua_compare:eh,lua_createtable:ep,lua_geti:ed,lua_getmetatable:e_,lua_gettop:eg,lua_insert:em,lua_isnil:eb,lua_isnoneornil:ey,lua_isstring:ev,lua_pop:ek,lua_pushinteger:eA,lua_pushnil:eL,lua_pushstring:ex,lua_pushvalue:ew,lua_rawget:eT,lua_setfield:eO,lua_seti:eE,lua_settop:eS,lua_toboolean:eN,lua_type:eI}=N(2),{luaL_Buffer:eR,luaL_addlstring:eU,luaL_addvalue:eC,luaL_argcheck:eM,luaL_buffinit:eP,luaL_checkinteger:eD,luaL_checktype:eB,luaL_error:eK,luaL_len:eG,luaL_newlib:eV,luaL_opt:eF,luaL_optinteger:ez,luaL_optlstring:ej,luaL_pushresult:eH,luaL_typename:e$}=N(7),eX=N(17),{to_luastring:eq}=N(5),xe=function(e,n,N){return ex(e,n),eT(e,-N)!==el},Ge=function(e,n,N){if(eI(e,n)!==eu){let B=1;e_(e,n)&&(!(1&N)||xe(e,eq("__index",!0),++B))&&(!(2&N)||xe(e,eq("__newindex",!0),++B))&&(!(4&N)||xe(e,eq("__len",!0),++B))?ek(e,B):eB(e,n,eu)}},g=function(e,n,N){return Ge(e,n,4|N),eG(e,n)},ge=function(e,n,N){ed(e,1,N),ev(e,-1)||eK(e,eq("invalid value (%s) at index %d in table for 'concat'"),e$(e,-1),N),eC(n)},te=function(e,n,N){eE(e,1,n),eE(e,1,N)},A=function(e,n,N){if(eb(e,2))return eh(e,n,N,ei);{ew(e,2),ew(e,n-1),ew(e,N-2),ec(e,2,1);let B=eN(e,-1);return ek(e,1),B}},S=function(e,n,N){let B=n,et=N-1;for(;;){for(;ed(e,1,++B),A(e,-1,-2);)B==N-1&&eK(e,eq("invalid order function for sorting")),ek(e,1);for(;ed(e,1,--et),A(e,-3,-1);)et<B&&eK(e,eq("invalid order function for sorting")),ek(e,1);if(et<B)return ek(e,1),te(e,N-1,B),B;te(e,B,et)}},v=function(e,n,N){let B=Math.floor((n-e)/4),et=N%(2*B)+(e+B);return eX.lua_assert(e+B<=et&&et<=n-B),et},q=function(e,n,N,B){for(;n<N;){let et,ei;if(ed(e,1,n),ed(e,1,N),A(e,-1,-2)?te(e,n,N):ek(e,2),N-n==1||(ed(e,1,et=N-n<100||0===B?Math.floor((n+N)/2):v(n,N,B)),ed(e,1,n),A(e,-2,-1)?te(e,et,n):(ek(e,1),ed(e,1,N),A(e,-1,-2)?te(e,et,N):ek(e,2)),N-n==2))return;ed(e,1,et),ew(e,-1),ed(e,1,N-1),te(e,et,N-1),(et=S(e,n,N))-n<N-et?(q(e,n,et-1,B),ei=et-n,n=et+1):(q(e,et+1,N,B),ei=N-et,N=et-1),(N-n)/128>ei&&(B=Math.floor(4294967296*Math.random()))}},eW={concat:function(e){let n=g(e,1,1),N=ej(e,2,""),B=N.length,et=ez(e,3,1);n=ez(e,4,n);let ei=new eR;for(eP(e,ei);et<n;et++)ge(e,ei,et),eU(ei,N,B);return et===n&&ge(e,ei,et),eH(ei),1},insert:function(e){let n,N=g(e,1,3)+1;switch(eg(e)){case 2:n=N;break;case 3:n=eD(e,2),eM(e,1<=n&&n<=N,2,"position out of bounds");for(let B=N;B>n;B--)ed(e,1,B-1),eE(e,1,B);break;default:return eK(e,"wrong number of arguments to 'insert'")}return eE(e,1,n),0},move:function(e){let n=eD(e,2),N=eD(e,3),ei=eD(e,4),eo=ey(e,5)?1:5;if(Ge(e,1,1),Ge(e,eo,2),N>=n){eM(e,n>0||N<B+n,3,"too many elements to move");let el=N-n+1;if(eM(e,ei<=B-el+1,4,"destination wrap around"),ei>N||ei<=n||1!==eo&&1!==eh(e,1,eo,et))for(let N=0;N<el;N++)ed(e,1,n+N),eE(e,eo,ei+N);else for(let N=el-1;N>=0;N--)ed(e,1,n+N),eE(e,eo,ei+N)}return ew(e,eo),1},pack:function(e){let n=eg(e);ep(e,n,1),em(e,1);for(let N=n;N>=1;N--)eE(e,1,N);return eA(e,n),eO(e,1,eq("n")),1},remove:function(e){let n=g(e,1,3),N=ez(e,2,n);for(N!==n&&eM(e,1<=N&&N<=n+1,1,"position out of bounds"),ed(e,1,N);N<n;N++)ed(e,1,N+1),eE(e,1,N);return eL(e),eE(e,1,N),1},sort:function(e){let n=g(e,1,3);return n>1&&(eM(e,n<B,1,"array too big"),ey(e,2)||eB(e,2,eo),eS(e,2),q(e,1,n,0)),0},unpack:function(e){let n=ez(e,2,1),N=eF(e,eD,3,eG(e,1));if(n>N)return 0;let B=N-n;if(B>=Number.MAX_SAFE_INTEGER||!ef(e,++B))return eK(e,eq("too many results to unpack"));for(;n<N;n++)ed(e,1,n);return ed(e,1,N),B}};e.exports.luaopen_table=function(e){return eV(e,eW),1}},function(e,n,N){let{LUA_TNIL:B,LUA_TTABLE:et,lua_close:ei,lua_createtable:eo,lua_getfield:el,lua_isboolean:eu,lua_isnoneornil:ec,lua_pop:ef,lua_pushboolean:eh,lua_pushfstring:ep,lua_pushinteger:ed,lua_pushliteral:e_,lua_pushnil:eg,lua_pushnumber:em,lua_pushstring:eb,lua_setfield:ey,lua_settop:ev,lua_toboolean:ek,lua_tointegerx:eA}=N(2),{luaL_Buffer:eL,luaL_addchar:ex,luaL_addstring:ew,luaL_argerror:eT,luaL_buffinit:eO,luaL_checkinteger:eE,luaL_checkstring:eS,luaL_checktype:eN,luaL_error:eI,luaL_execresult:eR,luaL_fileresult:eU,luaL_newlib:eC,luaL_optinteger:eM,luaL_optlstring:eP,luaL_optstring:eD,luaL_pushresult:eB}=N(7),{luastring_eq:eK,to_jsstring:eG,to_luastring:eV}=N(5),eF=eV("aAbBcCdDeFhHIjklmMnpPrRStTuUwWxXyYzZ%"),He=function(e,n,N){ed(e,N),ey(e,-2,eV(n,!0))},st=function(e,n,N){He(e,"sec",N?n.getUTCSeconds():n.getSeconds()),He(e,"min",N?n.getUTCMinutes():n.getMinutes()),He(e,"hour",N?n.getUTCHours():n.getHours()),He(e,"day",N?n.getUTCDate():n.getDate()),He(e,"month",(N?n.getUTCMonth():n.getMonth())+1),He(e,"year",N?n.getUTCFullYear():n.getFullYear()),He(e,"wday",(N?n.getUTCDay():n.getDay())+1),He(e,"yday",Math.floor((n-new Date(n.getFullYear(),0,0))/864e5))},ez=Number.MAX_SAFE_INTEGER/2,ae=function(e,n,N,et){let ei=el(e,-1,eV(n,!0)),eo=eA(e,-1);if(!1===eo){if(ei!==B)return eI(e,eV("field '%s' is not an integer"),n);if(N<0)return eI(e,eV("field '%s' missing in date table"),n);eo=N}else{if(!(-ez<=eo&&eo<=ez))return eI(e,eV("field '%s' is out-of-bound"),n);eo-=et}return ef(e,1),eo},ej={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(e=>eV(e)),shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>eV(e)),months:["January","February","March","April","May","June","July","August","September","October","November","December"].map(e=>eV(e)),shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>eV(e)),AM:eV("AM"),PM:eV("PM"),am:eV("am"),pm:eV("pm"),formats:{c:eV("%a %b %e %H:%M:%S %Y"),D:eV("%m/%d/%y"),F:eV("%Y-%m-%d"),R:eV("%H:%M"),r:eV("%I:%M:%S %p"),T:eV("%H:%M:%S"),X:eV("%T"),x:eV("%D")}},Pe=function(e,n){let N=e.getDay();return"monday"===n&&(0===N?N=6:N--),Math.floor(((e-new Date(e.getFullYear(),0,1))/864e5+7-N)/7)},xe=function(e,n,N){n<10&&ex(e,N),ew(e,eV(String(n)))},Ge=function(e,n,N,B){let et=0;for(;et<N.length;)if(37!==N[et])ex(n,N[et++]);else{let ei=g(e,N,++et);switch(N[et]){case 37:ex(n,37);break;case 65:ew(n,ej.days[B.getDay()]);break;case 66:ew(n,ej.months[B.getMonth()]);break;case 67:xe(n,Math.floor(B.getFullYear()/100),48);break;case 68:Ge(e,n,ej.formats.D,B);break;case 70:Ge(e,n,ej.formats.F,B);break;case 72:xe(n,B.getHours(),48);break;case 73:xe(n,(B.getHours()+11)%12+1,48);break;case 77:xe(n,B.getMinutes(),48);break;case 80:ew(n,12>B.getHours()?ej.am:ej.pm);break;case 82:Ge(e,n,ej.formats.R,B);break;case 83:xe(n,B.getSeconds(),48);break;case 84:Ge(e,n,ej.formats.T,B);break;case 85:xe(n,Pe(B,"sunday"),48);break;case 87:xe(n,Pe(B,"monday"),48);break;case 88:Ge(e,n,ej.formats.X,B);break;case 89:ew(n,eV(String(B.getFullYear())));break;case 90:{let e=B.toString().match(/\(([\w\s]+)\)/);e&&ew(n,eV(e[1]));break}case 97:ew(n,ej.shortDays[B.getDay()]);break;case 98:case 104:ew(n,ej.shortMonths[B.getMonth()]);break;case 99:Ge(e,n,ej.formats.c,B);break;case 100:xe(n,B.getDate(),48);break;case 101:xe(n,B.getDate(),32);break;case 106:{let e=Math.floor((B-new Date(B.getFullYear(),0,1))/864e5);e<100&&(e<10&&ex(n,48),ex(n,48)),ew(n,eV(String(e)));break}case 107:xe(n,B.getHours(),32);break;case 108:xe(n,(B.getHours()+11)%12+1,32);break;case 109:xe(n,B.getMonth()+1,48);break;case 110:ex(n,10);break;case 112:ew(n,12>B.getHours()?ej.AM:ej.PM);break;case 114:Ge(e,n,ej.formats.r,B);break;case 115:ew(n,eV(String(Math.floor(B/1e3))));break;case 116:ex(n,8);break;case 117:{let e=B.getDay();ew(n,eV(String(0===e?7:e)));break}case 119:ew(n,eV(String(B.getDay())));break;case 120:Ge(e,n,ej.formats.x,B);break;case 121:xe(n,B.getFullYear()%100,48);break;case 122:{let e=B.getTimezoneOffset();e>0?ex(n,45):(e=-e,ex(n,43)),xe(n,Math.floor(e/60),48),xe(n,e%60,48)}}et+=ei}},g=function(e,n,N){let B=0,et=1;for(;B<eF.length&&et<=n.length-N;B+=et)if(124===eF[B])et++;else if(eK(n.subarray(N,N+et),eF.subarray(B,B+et)))return et;eT(e,1,ep(e,eV("invalid conversion specifier '%%%s'"),n))},ge=function(e,n){return eE(e,n)},eH={date:function(e){let n=eP(e,1,"%c"),N=ec(e,2)?new Date:new Date(1e3*ge(e,2)),B=!1,et=0;if(33===n[0]&&(B=!0,et++),42===n[et]&&116===n[et+1])eo(e,0,9),st(e,N,B);else{new Uint8Array(4)[0]=37;let B=new eL;eO(e,B),Ge(e,B,n,N),eB(B)}return 1},difftime:function(e){let n=ge(e,1),N=ge(e,2);return em(e,n-N),1},time:function(e){let n;return ec(e,1)?n=new Date:(eN(e,1,et),ev(e,1),n=new Date(ae(e,"year",-1,0),ae(e,"month",-1,1),ae(e,"day",-1,0),ae(e,"hour",12,0),ae(e,"min",0,0),ae(e,"sec",0,0)),st(e,n)),ed(e,Math.floor(n/1e3)),1},clock:function(e){return em(e,performance.now()/1e3),1}};e.exports.luaopen_os=function(e){return eC(e,eH),1}},function(e,n,N){let{sprintf:B}=N(38),{LUA_INTEGER_FMT:et,LUA_INTEGER_FRMLEN:ei,LUA_MININTEGER:eo,LUA_NUMBER_FMT:el,LUA_NUMBER_FRMLEN:eu,frexp:ec,lua_getlocaledecpoint:ef}=N(3),{LUA_TBOOLEAN:eh,LUA_TFUNCTION:ep,LUA_TNIL:ed,LUA_TNUMBER:e_,LUA_TSTRING:eg,LUA_TTABLE:em,lua_call:eb,lua_createtable:ey,lua_dump:ev,lua_gettable:ek,lua_gettop:eA,lua_isinteger:eL,lua_isstring:ex,lua_pop:ew,lua_pushcclosure:eT,lua_pushinteger:eO,lua_pushlightuserdata:eE,lua_pushliteral:eS,lua_pushlstring:eN,lua_pushnil:eI,lua_pushnumber:eR,lua_pushstring:eU,lua_pushvalue:eC,lua_remove:eM,lua_setfield:eP,lua_setmetatable:eD,lua_settop:eB,lua_toboolean:eK,lua_tointeger:eG,lua_tonumber:eV,lua_tostring:eF,lua_touserdata:ez,lua_type:ej,lua_upvalueindex:eH}=N(2),{luaL_Buffer:e$,luaL_addchar:eX,luaL_addlstring:eq,luaL_addsize:eW,luaL_addstring:eZ,luaL_addvalue:eY,luaL_argcheck:eJ,luaL_argerror:eQ,luaL_buffinit:e0,luaL_buffinitsize:e1,luaL_checkinteger:e2,luaL_checknumber:e3,luaL_checkstack:e5,luaL_checkstring:e4,luaL_checktype:e8,luaL_error:e6,luaL_newlib:e9,luaL_optinteger:e7,luaL_optstring:ti,luaL_prepbuffsize:to,luaL_pushresult:tl,luaL_pushresultsize:tu,luaL_tolstring:tc,luaL_typename:tf}=N(7),th=N(17),{luastring_eq:tp,luastring_indexOf:td,to_jsstring:t_,to_luastring:tg}=N(5),bt=function(e){let n=td(e,0);return n>-1?n:e.length},vt=function(e,n){return e>=0?e:0-e>n?0:n+e+1},yt=function(e,n,N,B){return eq(B,n,N),0},tm=eu.length+1,lt=function(e,n,N){let et=function(e){if(Object.is(e,1/0))return tg("inf");if(Object.is(e,-1/0))return tg("-inf");if(Number.isNaN(e))return tg("nan");if(0===e){let n=B(el+"x0p+0",e);return Object.is(e,-0)&&(n="-"+n),tg(n)}{let n="",N=ec(e),et=N[0],ei=N[1];return et<0&&(n+="-",et=-et),tg(n+="0x"+(2*et).toString(16)+B("p%+d",ei-=1))}}(N);if(65===n[tm])for(let e=0;e<et.length;e++){let n=et[e];n>=97&&(et[e]=223&n)}else 97!==n[tm]&&e6(e,tg("modifiers for format '%%a'/'%%A' not implemented"));return et},tb=tg("-+ #0"),At=e=>97<=e&&e<=122||65<=e&&e<=90,o=e=>48<=e&&e<=57,c=e=>0<=e&&e<=31||127===e,x=e=>33<=e&&e<=126,p=e=>97<=e&&e<=122,T=e=>65<=e&&e<=90,X=e=>97<=e&&e<=122||65<=e&&e<=90||48<=e&&e<=57,U=e=>x(e)&&!X(e),pe=e=>32===e||e>=9&&e<=13,Ke=e=>48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102,Qe=function(e,n,N){switch(ej(e,N)){case eg:{let B=eF(e,N);!function(e,n,N){eX(e,34);let B=0;for(;N--;){if(34===n[B]||92===n[B]||10===n[B])eX(e,92),eX(e,n[B]);else if(c(n[B])){let N=""+n[B];o(n[B+1])&&(N="0".repeat(3-N.length)+N),eZ(e,tg("\\"+N))}else eX(e,n[B]);B++}eX(e,34)}(n,B,B.length);break}case e_:{let el;if(eL(e,N)){let n=eG(e,N);el=tg(B(n===eo?"0x%"+ei+"x":et,n))}else{let n=eV(e,N);!function(e){if(0>td(e,46)){let n=td(e,ef());n&&(e[n]=46)}}(el=lt(e,tg(`%${ei}a`),n))}eZ(n,el);break}case ed:case eh:tc(e,N),eY(n);break;default:eQ(e,N,tg("value has no literal form"))}},kt=function(e,n,N,B){let et=N;for(;0!==n[et]&&td(tb,n[et])>=0;)et++;et-N>=tb.length&&e6(e,tg("invalid format (repeated flags)")),o(n[et])&&et++,o(n[et])&&et++,46===n[et]&&(o(n[++et])&&et++,o(n[et])&&et++),o(n[et])&&e6(e,tg("invalid format (width or precision too long)")),B[0]=37;for(let e=0;e<et-N+1;e++)B[e+1]=n[N+e];return et},J=function(e,n){let N=e.length,B=n.length,et=e[N-1];for(let et=0;et<B;et++)e[et+N-1]=n[et];e[N+B-1]=et};let Z=class Z{constructor(e){this.L=e,this.islittle=!0,this.maxalign=1}};let V=function(e,n){if(e.off>=e.s.length||!o(e.s[e.off]))return n;{let n=0;do n=10*n+(e.s[e.off++]-48);while(e.off<e.s.length&&o(e.s[e.off])&&n<=214748363.8);return n}},Te=function(e,n,N){let B=V(n,N);return(B>16||B<=0)&&e6(e.L,tg("integral size (%d) out of limits [1,%d]"),B,16),B},fe=function(e,n){let N={opt:n.s[n.off++],size:0};switch(N.opt){case 98:return N.size=1,N.opt=0,N;case 66:return N.size=1,N.opt=1,N;case 104:return N.size=2,N.opt=0,N;case 72:return N.size=2,N.opt=1,N;case 108:case 106:return N.size=4,N.opt=0,N;case 76:case 74:case 84:return N.size=4,N.opt=1,N;case 102:return N.size=4,N.opt=2,N;case 100:case 110:return N.size=8,N.opt=2,N;case 105:return N.size=Te(e,n,4),N.opt=0,N;case 73:return N.size=Te(e,n,4),N.opt=1,N;case 115:return N.size=Te(e,n,4),N.opt=4,N;case 99:return N.size=V(n,-1),-1===N.size&&e6(e.L,tg("missing size for format option 'c'")),N.opt=3,N;case 122:return N.opt=5,N;case 120:return N.size=1,N.opt=6,N;case 88:return N.opt=7,N;case 32:break;case 60:case 61:e.islittle=!0;break;case 62:e.islittle=!1;break;case 33:e.maxalign=Te(e,n,8);break;default:e6(e.L,tg("invalid format option '%c'"),N.opt)}return N.opt=8,N},Me=function(e,n,N){let B={opt:NaN,size:NaN,ntoalign:NaN},et=fe(e,N);B.size=et.size,B.opt=et.opt;let ei=B.size;if(7===B.opt){if(N.off>=N.s.length||0===N.s[N.off])eQ(e.L,1,tg("invalid next option for option 'X'"));else{let n=fe(e,N);ei=n.size,3!==(n=n.opt)&&0!==ei||eQ(e.L,1,tg("invalid next option for option 'X'"))}}return ei<=1||3===B.opt?B.ntoalign=0:(ei>e.maxalign&&(ei=e.maxalign),ei&ei-1&&eQ(e.L,1,tg("format asks for alignment not power of 2")),B.ntoalign=ei-(n&ei-1)&ei-1),B},tt=function(e,n,N,B,et){let ei=to(e,B);ei[N?0:B-1]=255&n;for(let e=1;e<B;e++)n>>=8,ei[N?e:B-1-e]=255&n;if(et&&B>4)for(let e=4;e<B;e++)ei[N?e:B-1-e]=255;eW(e,B)},ct=function(e,n,N,B,et){let ei=0,eo=B<=4?B:4;for(let e=eo-1;e>=0;e--)ei<<=8,ei|=n[N?e:B-1-e];if(B<4){if(et){let e=1<<8*B-1;ei=(ei^e)-e}}else if(B>4){let el=!et||ei>=0?0:255;for(let et=eo;et<B;et++)n[N?et:B-1-et]!==el&&e6(e,tg("%d-byte integer does not fit into Lua Integer"),B)}return ei},at=function(e,n,N,B){th.lua_assert(n.length>=B);let et=new DataView(new ArrayBuffer(B));for(let e=0;e<B;e++)et.setUint8(e,n[e],N);return 4==B?et.getFloat32(0,N):et.getFloat64(0,N)},ty=tg("^$*+?.([%-");let Ct=class Ct{constructor(e){this.src=null,this.src_init=null,this.src_end=null,this.p=null,this.p_end=null,this.L=e,this.matchdepth=NaN,this.level=NaN,this.capture=[]}};let gt=function(e,n){switch(e.p[n++]){case 37:return n===e.p_end&&e6(e.L,tg("malformed pattern (ends with '%%')")),n+1;case 91:94===e.p[n]&&n++;do n===e.p_end&&e6(e.L,tg("malformed pattern (missing ']')")),37===e.p[n++]&&n<e.p_end&&n++;while(93!==e.p[n]);return n+1;default:return n}},Et=function(e,n){switch(n){case 97:return At(e);case 65:return!At(e);case 99:return c(e);case 67:return!c(e);case 100:return o(e);case 68:return!o(e);case 103:return x(e);case 71:return!x(e);case 108:return p(e);case 76:return!p(e);case 112:return U(e);case 80:return!U(e);case 115:return pe(e);case 83:return!pe(e);case 117:return T(e);case 85:return!T(e);case 119:return X(e);case 87:return!X(e);case 120:return Ke(e);case 88:return!Ke(e);case 122:return 0===e;case 90:return 0!==e;default:return n===e}},wt=function(e,n,N,B){let et=!0;for(94===e.p[N+1]&&(et=!1,N++);++N<B;)if(37===e.p[N]){if(N++,Et(n,e.p[N]))return et}else if(45===e.p[N+1]&&N+2<B){if(N+=2,e.p[N-2]<=n&&n<=e.p[N])return et}else if(e.p[N]===n)return et;return!et},Bt=function(e,n,N,B){if(n>=e.src_end)return!1;{let et=e.src[n];switch(e.p[N]){case 46:return!0;case 37:return Et(et,e.p[N+1]);case 91:return wt(e,et,N,B-1);default:return e.p[N]===et}}},Mt=function(e,n,N){if(N>=e.p_end-1&&e6(e.L,tg("malformed pattern (missing arguments to '%%b'")),e.src[n]!==e.p[N])return null;{let B=e.p[N],et=e.p[N+1],ei=1;for(;++n<e.src_end;)if(e.src[n]===et){if(0==--ei)return n+1}else e.src[n]===B&&ei++}return null},Zt=function(e,n,N,B){let et=0;for(;Bt(e,n+et,N,B);)et++;for(;et>=0;){let N=Le(e,n+et,B+1);if(N)return N;et--}return null},Dt=function(e,n,N,B){for(;;){let et=Le(e,n,B+1);if(null!==et)return et;if(!Bt(e,n,N,B))return null;n++}},qt=function(e,n,N,B){let et,ei=e.level;return ei>=32&&e6(e.L,tg("too many captures")),e.capture[ei]=e.capture[ei]?e.capture[ei]:{},e.capture[ei].init=n,e.capture[ei].len=B,e.level=ei+1,null===(et=Le(e,n,N))&&e.level--,et},Xt=function(e,n,N){let B,et=function(e){let n=e.level;for(n--;n>=0;n--)if(-1===e.capture[n].len)return n;return e6(e.L,tg("invalid pattern capture"))}(e);return e.capture[et].len=n-e.capture[et].init,null===(B=Le(e,n,N))&&(e.capture[et].len=-1),B},j=function(e,n,N){var B,et,ei,eo;N=(B=N-49)<0||B>=e.level||-1===e.capture[B].len?e6(e.L,tg("invalid capture index %%%d"),B+1):B;let el=e.capture[N].len;return e.src_end-n>=el&&(et=e.src,ei=e.capture[N].init,eo=e.src,tp(et.subarray(ei,ei+el),eo.subarray(n,n+el)))?n+el:null},Le=function(e,n,N){let B=!1,et=!0;for(0==e.matchdepth--&&e6(e.L,tg("pattern too complex"));et||B;)if(et=!1,N!==e.p_end)switch(B?void 0:e.p[N]){case 40:n=41===e.p[N+1]?qt(e,n,N+2,-2):qt(e,n,N+1,-1);break;case 41:n=Xt(e,n,N+1);break;case 36:if(N+1!==e.p_end){B=!0;break}n=e.src.length-n==0?n:null;break;case 37:switch(e.p[N+1]){case 98:null!==(n=Mt(e,n,N+2))&&(N+=4,et=!0);break;case 102:{N+=2,91!==e.p[N]&&e6(e.L,tg("missing '[' after '%%f' in pattern"));let B=gt(e,N),ei=n===e.src_init?0:e.src[n-1];if(!wt(e,ei,N,B-1)&&wt(e,n===e.src_end?0:e.src[n],N,B-1)){N=B,et=!0;break}n=null;break}case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:null!==(n=j(e,n,e.p[N+1]))&&(N+=2,et=!0);break;default:B=!0}break;default:{B=!1;let ei=gt(e,N);if(Bt(e,n,N,ei))switch(e.p[ei]){case 63:{let B;null!==(B=Le(e,n+1,ei+1))?n=B:(N=ei+1,et=!0);break}case 43:n++;case 42:n=Zt(e,n,N,ei);break;case 45:n=Dt(e,n,N,ei);break;default:n++,N=ei,et=!0}else{if(42===e.p[ei]||63===e.p[ei]||45===e.p[ei]){N=ei+1,et=!0;break}n=null}}}return e.matchdepth++,n},Ye=function(e,n,N,B){if(n>=e.level)0===n?eN(e.L,e.src.subarray(N,B),B-N):e6(e.L,tg("invalid capture index %%%d"),n+1);else{let N=e.capture[n].len;-1===N&&e6(e.L,tg("unfinished capture")),-2===N?eO(e.L,e.capture[n].init-e.src_init+1):eN(e.L,e.src.subarray(e.capture[n].init),N)}},Je=function(e,n,N){let B=0===e.level&&e.src.subarray(n)?1:e.level;e5(e.L,B,"too many captures");for(let et=0;et<B;et++)Ye(e,et,n,N);return B},ot=function(e,n,N,B,et,ei){e.L=n,e.matchdepth=200,e.src=N,e.src_init=0,e.src_end=B,e.p=et,e.p_end=ei},Xe=function(e){e.level=0,th.lua_assert(200===e.matchdepth)},qe=function(e,n){let N=e4(e,1),B=e4(e,2),et=N.length,ei=B.length,eo=vt(e7(e,3,1),et);if(eo<1)eo=1;else if(eo>et+1)return eI(e),1;if(n&&(eK(e,4)||function(e,n){for(let N=0;N<n;N++)if(-1!==td(ty,e[N]))return!1;return!0}(B,ei))){let n=function(e,n,N){var B=0,et=n.length;if(0===et)return B;for(;-1!==(B=e.indexOf(n[0],B));B++)if(tp(e.subarray(B,B+et),n))return B;return -1}(N.subarray(eo-1),B,0);if(n>-1)return eO(e,eo+n),eO(e,eo+n+ei-1),2}else{let el=new Ct(e),eu=eo-1,ec=94===B[0];ec&&(B=B.subarray(1),ei--),ot(el,e,N,et,B,ei);do{let N;if(Xe(el),null!==(N=Le(el,eu,0)))return n?(eO(e,eu+1),eO(e,N),Je(el,null,0)+2):Je(el,eu,N)}while(eu++<el.src_end&&!ec)}return eI(e),1},Ve=function(e){let n=ez(e,eH(3));n.ms.L=e;for(let e=n.src;e<=n.ms.src_end;e++){let N;if(Xe(n.ms),null!==(N=Le(n.ms,e,n.p))&&N!==n.lastmatch)return n.src=n.lastmatch=N,Je(n.ms,e,N)}return 0},rt=function(e,n,N,B,et){let ei=e.L;switch(et){case ep:eC(ei,3),eb(ei,Je(e,N,B),1);break;case em:Ye(e,0,N,B),ek(ei,3);break;default:return void function(e,n,N,B){let et=e.L,ei=eF(et,3),eo=ei.length;for(let el=0;el<eo;el++)37!==ei[el]?eX(n,ei[el]):o(ei[++el])?48===ei[el]?eq(n,e.src.subarray(N,B),B-N):(Ye(e,ei[el]-49,N,B),tc(et,-1),eM(et,-2),eY(n)):(37!==ei[el]&&e6(et,tg("invalid use of '%c' in replacement string"),37),eX(n,ei[el]))}(e,n,N,B)}eK(ei,-1)?ex(ei,-1)||e6(ei,tg("invalid replacement value (a %s)"),tf(ei,-1)):(ew(ei,1),eN(ei,e.src.subarray(N,B),B-N)),eY(n)},tv={byte:function(e){let n=e4(e,1),N=n.length,B=vt(e7(e,2,1),N),et=vt(e7(e,3,B),N);if(B<1&&(B=1),et>N&&(et=N),B>et)return 0;if(et-B>=Number.MAX_SAFE_INTEGER)return e6(e,"string slice too long");let ei=et-B+1;e5(e,ei,"string slice too long");for(let N=0;N<ei;N++)eO(e,n[B+N-1]);return ei},char:function(e){let n=eA(e),N=new e$,B=e1(e,N,n);for(let N=1;N<=n;N++){let n=e2(e,N);eJ(e,n>=0&&n<=255,"value out of range"),B[N-1]=n}return tu(N,n),1},dump:function(e){let n=new e$,N=eK(e,2);return e8(e,1,ep),eB(e,1),e0(e,n),0!==ev(e,yt,n,N)?e6(e,tg("unable to dump given function")):(tl(n),1)},find:function(e){return qe(e,1)},format:function(e){let n=eA(e),N=1,et=e4(e,1),eo=0,el=new e$;for(e0(e,el);eo<et.length;)if(37!==et[eo])eX(el,et[eo++]);else if(37===et[++eo])eX(el,et[eo++]);else{let eu=[];switch(++N>n&&eQ(e,N,tg("no value")),eo=kt(e,et,eo,eu),String.fromCharCode(et[eo++])){case"c":eX(el,e2(e,N));break;case"d":case"i":case"o":case"u":case"x":case"X":{let n=e2(e,N);J(eu,tg(ei,!0)),eZ(el,tg(B(String.fromCharCode(...eu),n)));break}case"a":case"A":J(eu,tg(ei,!0)),eZ(el,lt(e,eu,e3(e,N)));break;case"e":case"E":case"f":case"g":case"G":{let n=e3(e,N);J(eu,tg(ei,!0)),eZ(el,tg(B(String.fromCharCode(...eu),n)));break}case"q":Qe(e,el,N);break;case"s":{let n=tc(e,N);eu.length<=2||0===eu[2]?eY(el):(eJ(e,n.length===bt(n),N,"string contains zeros"),0>td(eu,46)&&n.length>=100?eY(el):(eZ(el,tg(B(String.fromCharCode(...eu),t_(n)))),ew(e,1)));break}default:return e6(e,tg("invalid option '%%%c' to 'format'"),et[eo-1])}}return tl(el),1},gmatch:function(e){let n=e4(e,1),N=e4(e,2),B=n.length,et=N.length;eB(e,2);let ei=new class{constructor(){this.src=NaN,this.p=NaN,this.lastmatch=NaN,this.ms=new Ct}};return eE(e,ei),ot(ei.ms,e,n,B,N,et),ei.src=0,ei.p=0,ei.lastmatch=null,eT(e,Ve,3),1},gsub:function(e){let n=e4(e,1),N=n.length,B=e4(e,2),et=B.length,ei=null,eo=ej(e,3),el=e7(e,4,N+1),eu=94===B[0],ec=0,ef=new Ct(e),eh=new e$;for(eJ(e,eo===e_||eo===eg||eo===ep||eo===em,3,"string/function/table expected"),e0(e,eh),eu&&(B=B.subarray(1),et--),ot(ef,e,n,N,B,et),n=0,B=0;ec<el;){let e;if(Xe(ef),null!==(e=Le(ef,n,B))&&e!==ei)ec++,rt(ef,eh,n,e,eo),n=ei=e;else{if(!(n<ef.src_end))break;eX(eh,ef.src[n++])}if(eu)break}return eq(eh,ef.src.subarray(n,ef.src_end),ef.src_end-n),tl(eh),eO(e,ec),2},len:function(e){return eO(e,e4(e,1).length),1},lower:function(e){let n=e4(e,1),N=n.length,B=new Uint8Array(N);for(let e=0;e<N;e++){let N=n[e];T(N)&&(N|=32),B[e]=N}return eU(e,B),1},match:function(e){return qe(e,0)},pack:function(e){let n=new e$,N=new Z(e),B={s:e4(e,1),off:0},et=1,ei=0;for(eI(e),e0(e,n);B.off<B.s.length;){let eo=Me(N,ei,B),el=eo.opt,eu=eo.size,ec=eo.ntoalign;for(ei+=ec+eu;ec-- >0;)eX(n,0);switch(et++,el){case 0:{let B=e2(e,et);if(eu<4){let n=1<<8*eu-1;eJ(e,-n<=B&&B<n,et,"integer overflow")}tt(n,B,N.islittle,eu,B<0);break}case 1:{let B=e2(e,et);eu<4&&eJ(e,B>>>0<1<<8*eu,et,"unsigned overflow"),tt(n,B>>>0,N.islittle,eu,!1);break}case 2:{let B=to(n,eu),ei=e3(e,et),eo=new DataView(B.buffer,B.byteOffset,B.byteLength);4===eu?eo.setFloat32(0,ei,N.islittle):eo.setFloat64(0,ei,N.islittle),eW(n,eu);break}case 3:{let N=e4(e,et),B=N.length;for(eJ(e,B<=eu,et,"string longer than given size"),eq(n,N,B);B++<eu;)eX(n,0);break}case 4:{let B=e4(e,et),eo=B.length;eJ(e,eu>=4||eo<1<<8*eu,et,"string length does not fit in given size"),tt(n,eo,N.islittle,eu,0),eq(n,B,eo),ei+=eo;break}case 5:{let N=e4(e,et),B=N.length;eJ(e,0>td(N,0),et,"strings contains zeros"),eq(n,N,B),eX(n,0),ei+=B+1;break}case 6:eX(n,0);case 7:case 8:et--}}return tl(n),1},packsize:function(e){let n=new Z(e),N={s:e4(e,1),off:0},B=0;for(;N.off<N.s.length;){let et=Me(n,B,N),ei=et.opt,eo=et.size;switch(eJ(e,B<=2147483647-(eo+=et.ntoalign),1,"format result too large"),B+=eo,ei){case 4:case 5:eQ(e,1,"variable-length format")}}return eO(e,B),1},rep:function(e){let n=e4(e,1),N=n.length,B=e2(e,2),et=ti(e,3,""),ei=et.length;if(B<=0)eS(e,"");else{if(N+ei<N||N+ei>2147483647/B)return e6(e,tg("resulting string too large"));{let eo=B*N+(B-1)*ei,el=new e$,eu=e1(e,el,eo),ec=0;for(;B-- >1;)eu.set(n,ec),ec+=N,ei>0&&(eu.set(et,ec),ec+=ei);eu.set(n,ec),tu(el,eo)}}return 1},reverse:function(e){let n=e4(e,1),N=n.length,B=new Uint8Array(N);for(let e=0;e<N;e++)B[e]=n[N-1-e];return eU(e,B),1},sub:function(e){let n=e4(e,1),N=n.length,B=vt(e2(e,2),N),et=vt(e7(e,3,-1),N);return B<1&&(B=1),et>N&&(et=N),B<=et?eU(e,n.subarray(B-1,B-1+(et-B+1))):eS(e,""),1},unpack:function(e){let n=new Z(e),N={s:e4(e,1),off:0},B=e4(e,2),et=B.length,ei=vt(e7(e,3,1),et)-1,eo=0;for(eJ(e,ei<=et&&ei>=0,3,"initial position out of string");N.off<N.s.length;){let el=Me(n,ei,N),eu=el.opt,ec=el.size,ef=el.ntoalign;switch(ei+ef+ec>et&&eQ(e,2,tg("data string too short")),ei+=ef,e5(e,2,"too many results"),eo++,eu){case 0:case 1:{let N=ct(e,B.subarray(ei),n.islittle,ec,0===eu);eO(e,N);break}case 2:eR(e,at(0,B.subarray(ei),n.islittle,ec));break;case 3:eU(e,B.subarray(ei,ei+ec));break;case 4:{let N=ct(e,B.subarray(ei),n.islittle,ec,0);eJ(e,ei+N+ec<=et,2,"data string too short"),eU(e,B.subarray(ei+ec,ei+ec+N)),ei+=N;break}case 5:{let n=td(B,0,ei);-1===n&&(n=B.length-ei),eU(e,B.subarray(ei,n)),ei=n+1;break}case 7:case 6:case 8:eo--}ei+=ec}return eO(e,ei+1),eo+1},upper:function(e){let n=e4(e,1),N=n.length,B=new Uint8Array(N);for(let e=0;e<N;e++){let N=n[e];p(N)&&(N&=223),B[e]=N}return eU(e,B),1}};e.exports.luaopen_string=function(e){return e9(e,tv),ey(e,0,1),eS(e,""),eC(e,-2),eD(e,-2),ew(e,1),eC(e,-2),eP(e,-2,tg("__index",!0)),ew(e,1),1}},function(e,n,N){let{lua_gettop:B,lua_pushcfunction:et,lua_pushfstring:ei,lua_pushinteger:eo,lua_pushnil:el,lua_pushstring:eu,lua_pushvalue:ec,lua_setfield:ef,lua_tointeger:eh}=N(2),{luaL_Buffer:ep,luaL_addvalue:ed,luaL_argcheck:e_,luaL_buffinit:eg,luaL_checkinteger:em,luaL_checkstack:eb,luaL_checkstring:ey,luaL_error:ev,luaL_newlib:ek,luaL_optinteger:eA,luaL_pushresult:eL}=N(7),{luastring_of:ex,to_luastring:ew}=N(5),$=function(e){return(192&e)==128},Q=function(e,n){return e>=0?e:0-e>n?0:n+e+1},eT=[255,127,2047,65535],F=function(e,n){let N=e[n],B=0;if(N<128)B=N;else{let et=0;for(;64&N;){let ei=e[n+ ++et];if((192&ei)!=128)return null;B=B<<6|63&ei,N<<=1}if(B|=(127&N)<<5*et,et>3||B>1114111||B<=eT[et])return null;n+=et}return{code:B,pos:n+1}},eO=ew("%U"),y=function(e,n){let N=em(e,n);e_(e,0<=N&&N<=1114111,n,"value out of range"),ei(e,eO,N)},Y=function(e){let n=ey(e,1),N=n.length,B=eh(e,2)-1;if(B<0)B=0;else if(B<N)for(B++;$(n[B]);)B++;if(B>=N)return 0;{let N=F(n,B);return null===N||$(n[N.pos])?ev(e,ew("invalid UTF-8 code")):(eo(e,B+1),eo(e,N.code),2)}},eE={char:function(e){let n=B(e);if(1===n)y(e,1);else{let N=new ep;eg(e,N);for(let B=1;B<=n;B++)y(e,B),ed(N);eL(N)}return 1},codepoint:function(e){let n=ey(e,1),N=Q(eA(e,2,1),n.length),B=Q(eA(e,3,N),n.length);if(e_(e,N>=1,2,"out of range"),e_(e,B<=n.length,3,"out of range"),N>B)return 0;if(B-N>=Number.MAX_SAFE_INTEGER)return ev(e,"string slice too long");let et=B-N+1;for(eb(e,et,"string slice too long"),et=0,N-=1;N<B;){let B=F(n,N);if(null===B)return ev(e,"invalid UTF-8 code");eo(e,B.code),N=B.pos,et++}return et},codes:function(e){return ey(e,1),et(e,Y),ec(e,1),eo(e,0),3},len:function(e){let n=0,N=ey(e,1),B=N.length,et=Q(eA(e,2,1),B),ei=Q(eA(e,3,-1),B);for(e_(e,1<=et&&--et<=B,2,"initial position out of string"),e_(e,--ei<B,3,"final position out of string");et<=ei;){let B=F(N,et);if(null===B)return el(e),eo(e,et+1),2;et=B.pos,n++}return eo(e,n),1},offset:function(e){let n=ey(e,1),N=em(e,2),B=N>=0?1:n.length+1;if(B=Q(eA(e,3,B),n.length),e_(e,1<=B&&--B<=n.length,3,"position out of range"),0===N)for(;B>0&&$(n[B]);)B--;else if($(n[B])&&ev(e,"initial position is a continuation byte"),N<0)for(;N<0&&B>0;){do B--;while(B>0&&$(n[B]));N++}else for(N--;N>0&&B<n.length;){do B++;while($(n[B]));N--}return 0===N?eo(e,B+1):el(e),1}},eS=ex(91,0,45,127,194,45,244,93,91,128,45,191,93,42);e.exports.luaopen_utf8=function(e){return ek(e,eE),eu(e,eS),ef(e,-2,ew("charpattern",!0)),1}},function(e,n,N){let B;let{LUA_OPLT:et,LUA_TNUMBER:ei,lua_compare:eo,lua_gettop:el,lua_isinteger:eu,lua_isnoneornil:ec,lua_pushboolean:ef,lua_pushinteger:eh,lua_pushliteral:ep,lua_pushnil:ed,lua_pushnumber:e_,lua_pushvalue:eg,lua_setfield:em,lua_settop:eb,lua_tointeger:ey,lua_tointegerx:ev,lua_type:ek}=N(2),{luaL_argcheck:eA,luaL_argerror:eL,luaL_checkany:ex,luaL_checkinteger:ew,luaL_checknumber:eT,luaL_error:eO,luaL_newlib:eE,luaL_optnumber:eS}=N(7),{LUA_MAXINTEGER:eN,LUA_MININTEGER:eI,lua_numbertointeger:eR}=N(3),{to_luastring:eU}=N(5),_e=function(){return B=1103515245*B+12345&2147483647},me=function(e,n){let N=eR(n);!1!==N?eh(e,N):e_(e,n)},eC={abs:function(e){if(eu(e,1)){let n=ey(e,1);n<0&&(n=0|-n),eh(e,n)}else e_(e,Math.abs(eT(e,1)));return 1},acos:function(e){return e_(e,Math.acos(eT(e,1))),1},asin:function(e){return e_(e,Math.asin(eT(e,1))),1},atan:function(e){let n=eT(e,1),N=eS(e,2,1);return e_(e,Math.atan2(n,N)),1},ceil:function(e){return eu(e,1)?eb(e,1):me(e,Math.ceil(eT(e,1))),1},cos:function(e){return e_(e,Math.cos(eT(e,1))),1},deg:function(e){return e_(e,eT(e,1)*(180/Math.PI)),1},exp:function(e){return e_(e,Math.exp(eT(e,1))),1},floor:function(e){return eu(e,1)?eb(e,1):me(e,Math.floor(eT(e,1))),1},fmod:function(e){if(eu(e,1)&&eu(e,2)){let n=ey(e,2);0===n?eL(e,2,"zero"):eh(e,ey(e,1)%n|0)}else{let n=eT(e,1),N=eT(e,2);e_(e,n%N)}return 1},log:function(e){let n,N=eT(e,1);if(ec(e,2))n=Math.log(N);else{let B=eT(e,2);n=2===B?Math.log2(N):10===B?Math.log10(N):Math.log(N)/Math.log(B)}return e_(e,n),1},max:function(e){let n=el(e),N=1;eA(e,n>=1,1,"value expected");for(let B=2;B<=n;B++)eo(e,N,B,et)&&(N=B);return eg(e,N),1},min:function(e){let n=el(e),N=1;eA(e,n>=1,1,"value expected");for(let B=2;B<=n;B++)eo(e,B,N,et)&&(N=B);return eg(e,N),1},modf:function(e){if(eu(e,1))eb(e,1),e_(e,0);else{let n=eT(e,1),N=n<0?Math.ceil(n):Math.floor(n);me(e,N),e_(e,n===N?0:n-N)}return 2},rad:function(e){return e_(e,eT(e,1)*(Math.PI/180)),1},random:function(e){let n,N,et=void 0===B?Math.random():_e()/2147483648;switch(el(e)){case 0:return e_(e,et),1;case 1:n=1,N=ew(e,1);break;case 2:n=ew(e,1),N=ew(e,2);break;default:return eO(e,"wrong number of arguments")}return eA(e,n<=N,1,"interval is empty"),eA(e,n>=0||N<=eN+n,1,"interval too large"),eh(e,Math.floor(et*=N-n+1)+n),1},randomseed:function(e){return 0==(B=0|eT(e,1))&&(B=1),_e(),0},sin:function(e){return e_(e,Math.sin(eT(e,1))),1},sqrt:function(e){return e_(e,Math.sqrt(eT(e,1))),1},tan:function(e){return e_(e,Math.tan(eT(e,1))),1},tointeger:function(e){let n=ev(e,1);return!1!==n?eh(e,n):(ex(e,1),ed(e)),1},type:function(e){return ek(e,1)===ei?eu(e,1)?ep(e,"integer"):ep(e,"float"):(ex(e,1),ed(e)),1},ult:function(e){let n=ew(e,1),N=ew(e,2);return ef(e,n>=0?N<0||n<N:N<0&&n<N),1}};e.exports.luaopen_math=function(e){return eE(e,eC),e_(e,Math.PI),em(e,-2,eU("pi",!0)),e_(e,1/0),em(e,-2,eU("huge",!0)),eh(e,eN),em(e,-2,eU("maxinteger",!0)),eh(e,eI),em(e,-2,eU("mininteger",!0)),1}},function(e,n,N){let B;let{LUA_MASKCALL:et,LUA_MASKCOUNT:ei,LUA_MASKLINE:eo,LUA_MASKRET:el,LUA_REGISTRYINDEX:eu,LUA_TFUNCTION:ec,LUA_TNIL:ef,LUA_TTABLE:eh,LUA_TUSERDATA:ep,lua_Debug:ed,lua_call:e_,lua_checkstack:eg,lua_gethook:em,lua_gethookcount:eb,lua_gethookmask:ey,lua_getinfo:ev,lua_getlocal:ek,lua_getmetatable:eA,lua_getstack:eL,lua_getupvalue:ex,lua_getuservalue:ew,lua_insert:eT,lua_iscfunction:eO,lua_isfunction:eE,lua_isnoneornil:eS,lua_isthread:eN,lua_newtable:eI,lua_pcall:eR,lua_pop:eU,lua_pushboolean:eC,lua_pushfstring:eM,lua_pushinteger:eP,lua_pushlightuserdata:eD,lua_pushliteral:eB,lua_pushnil:eK,lua_pushstring:eG,lua_pushvalue:eV,lua_rawgetp:eF,lua_rawsetp:ez,lua_rotate:ej,lua_setfield:eH,lua_sethook:e$,lua_setlocal:eX,lua_setmetatable:eq,lua_settop:eW,lua_setupvalue:eZ,lua_setuservalue:eY,lua_tojsstring:eJ,lua_toproxy:eQ,lua_tostring:e0,lua_tothread:e1,lua_touserdata:e2,lua_type:e3,lua_upvalueid:e5,lua_upvaluejoin:e4,lua_xmove:e8}=N(2),{luaL_argcheck:e6,luaL_argerror:e9,luaL_checkany:e7,luaL_checkinteger:ti,luaL_checkstring:to,luaL_checktype:tl,luaL_error:tu,luaL_loadbuffer:tc,luaL_newlib:tf,luaL_optinteger:th,luaL_optstring:tp,luaL_traceback:td,lua_writestringerror:t_}=N(7),tg=N(17),{luastring_indexOf:tm,to_luastring:tb}=N(5),bt=function(e,n,N){e===n||eg(n,N)||tu(e,tb("stack overflow",!0))},vt=function(e){return eN(e,1)?{arg:1,thread:e1(e,1)}:{arg:0,thread:e}},yt=function(e,n,N){eG(e,N),eH(e,-2,n)},Rt=function(e,n,N){eP(e,N),eH(e,-2,n)},lt=function(e,n,N){eC(e,N),eH(e,-2,n)},pt=function(e,n,N){e==n?ej(e,-2,1):e8(n,e,1),eH(e,-2,N)},At=function(e,n){let N=ti(e,2);tl(e,1,ec);let B=n?ex(e,1,N):eZ(e,1,N);return null===B?0:(eG(e,B),eT(e,-(n+1)),n+1)},o=function(e,n,N){let B=ti(e,N);return tl(e,n,ec),e6(e,null!==ex(e,n,B),N,"invalid upvalue index"),B},ty=tb("__hooks__",!0),tv=["call","return","line","count","tail call"].map(e=>tb(e)),p=function(e,n){eF(e,eu,ty);let N=e2(e,-1).get(e);N&&(N(e),eG(e,tv[n.event]),n.currentline>=0?eP(e,n.currentline):eK(e),tg.lua_assert(ev(e,tb("lS"),n)),e_(e,2,0))},tk={gethook:function(e){let n,N=vt(e).thread,B=new Uint8Array(5),ei=ey(N),ec=em(N);return null===ec?eK(e):ec!==p?eB(e,"external hook"):(eF(e,eu,ty),e2(e,-1).get(N)(e)),eG(e,(n=0,ei&et&&(B[n++]=99),ei&el&&(B[n++]=114),ei&eo&&(B[n++]=108),B.subarray(0,n))),eP(e,eb(N)),3},getinfo:function(e){let n=new ed,N=vt(e),B=N.arg,et=N.thread,ei=tp(e,B+2,"flnStu");if(bt(e,et,3),eE(e,B+1))ei=eM(e,tb(">%s"),ei),eV(e,B+1),e8(e,et,1);else if(!eL(et,ti(e,B+1),n))return eK(e),1;return ev(et,ei,n)||e9(e,B+2,"invalid option"),eI(e),tm(ei,83)>-1&&(yt(e,tb("source",!0),n.source),yt(e,tb("short_src",!0),n.short_src),Rt(e,tb("linedefined",!0),n.linedefined),Rt(e,tb("lastlinedefined",!0),n.lastlinedefined),yt(e,tb("what",!0),n.what)),tm(ei,108)>-1&&Rt(e,tb("currentline",!0),n.currentline),tm(ei,117)>-1&&(Rt(e,tb("nups",!0),n.nups),Rt(e,tb("nparams",!0),n.nparams),lt(e,tb("isvararg",!0),n.isvararg)),tm(ei,110)>-1&&(yt(e,tb("name",!0),n.name),yt(e,tb("namewhat",!0),n.namewhat)),tm(ei,116)>-1&&lt(e,tb("istailcall",!0),n.istailcall),tm(ei,76)>-1&&pt(e,et,tb("activelines",!0)),tm(ei,102)>-1&&pt(e,et,tb("func",!0)),1},getlocal:function(e){let n=vt(e),N=n.thread,B=n.arg,et=new ed,ei=ti(e,B+2);if(eE(e,B+1))return eV(e,B+1),eG(e,ek(e,null,ei)),1;{if(!eL(N,ti(e,B+1),et))return e9(e,B+1,"level out of range");bt(e,N,1);let n=ek(N,et,ei);return n?(e8(N,e,1),eG(e,n),ej(e,-2,1),2):(eK(e),1)}},getmetatable:function(e){return e7(e,1),eA(e,1)||eK(e),1},getregistry:function(e){return eV(e,eu),1},getupvalue:function(e){return At(e,1)},getuservalue:function(e){return e3(e,1)!==ep?eK(e):ew(e,1),1},sethook:function(e){let n,N,B,eh,ep=vt(e),ed=ep.thread,e_=ep.arg;if(eS(e,e_+1))eW(e,e_+1),B=null,n=0,N=0;else{var eg;let eu;let ef=to(e,e_+2);tl(e,e_+1,ec),N=th(e,e_+3,0),B=p,eg=N,eu=0,tm(ef,99)>-1&&(eu|=et),tm(ef,114)>-1&&(eu|=el),tm(ef,108)>-1&&(eu|=eo),eg>0&&(eu|=ei),n=eu}eF(e,eu,ty)===ef?(eD(e,eh=new WeakMap),ez(e,eu,ty)):eh=e2(e,-1);let em=eQ(e,e_+1);return eh.set(ed,em),e$(ed,B,n,N),0},setlocal:function(e){let n=vt(e),N=n.thread,B=n.arg,et=new ed,ei=ti(e,B+1),eo=ti(e,B+2);if(!eL(N,ei,et))return e9(e,B+1,"level out of range");e7(e,B+3),eW(e,B+3),bt(e,N,1),e8(e,N,1);let el=eX(N,et,eo);return null===el&&eU(N,1),eG(e,el),1},setmetatable:function(e){let n=e3(e,2);return e6(e,n==ef||n==eh,2,"nil or table expected"),eW(e,2),eq(e,1),1},setupvalue:function(e){return e7(e,3),At(e,0)},setuservalue:function(e){return tl(e,1,ep),e7(e,2),eW(e,2),eY(e,1),1},traceback:function(e){let n=vt(e),N=n.thread,B=n.arg,et=e0(e,B+1);if(null!==et||eS(e,B+1)){let n=th(e,B+2,e===N?1:0);td(e,N,et,n)}else eV(e,B+1);return 1},upvalueid:function(e){let n=o(e,1,2);return eD(e,e5(e,1,n)),1},upvaluejoin:function(e){let n=o(e,1,2),N=o(e,3,4);return e6(e,!eO(e,1),1,"Lua function expected"),e6(e,!eO(e,3),3,"Lua function expected"),e4(e,1,n,3,N),0}};"u">typeof window&&(B=function(){let e=prompt("lua_debug>","");return null!==e?e:""}),B&&(tk.debug=function(e){for(;;){let n=B();if("cont"===n)return 0;if(0===n.length)continue;let N=tb(n);(tc(e,N,N.length,tb("=(debug command)",!0))||eR(e,0,0,0))&&t_(eJ(e,-1),`
`),eW(e,0)}}),e.exports.luaopen_debug=function(e){return tf(e,tk),1}},function(e,n,N){let B,et;let{LUA_DIRSEP:ei,LUA_EXEC_DIR:eo,LUA_JSPATH_DEFAULT:el,LUA_PATH_DEFAULT:eu,LUA_PATH_MARK:ec,LUA_PATH_SEP:ef}=N(3),{LUA_OK:eh,LUA_REGISTRYINDEX:ep,LUA_TNIL:ed,LUA_TTABLE:e_,lua_callk:eg,lua_createtable:em,lua_getfield:eb,lua_insert:ey,lua_isfunction:ev,lua_isnil:ek,lua_isstring:eA,lua_newtable:eL,lua_pop:ex,lua_pushboolean:ew,lua_pushcclosure:eT,lua_pushcfunction:eO,lua_pushfstring:eE,lua_pushglobaltable:eS,lua_pushlightuserdata:eN,lua_pushliteral:eI,lua_pushlstring:eR,lua_pushnil:eU,lua_pushstring:eC,lua_pushvalue:eM,lua_rawgeti:eP,lua_rawgetp:eD,lua_rawseti:eB,lua_rawsetp:eK,lua_remove:eG,lua_setfield:eV,lua_setmetatable:eF,lua_settop:ez,lua_toboolean:ej,lua_tostring:eH,lua_touserdata:e$,lua_upvalueindex:eX}=N(2),{LUA_LOADED_TABLE:eq,LUA_PRELOAD_TABLE:eW,luaL_Buffer:eZ,luaL_addvalue:eY,luaL_buffinit:eJ,luaL_checkstring:eQ,luaL_error:e0,luaL_getsubtable:e1,luaL_gsub:e2,luaL_len:e3,luaL_loadfile:e5,luaL_newlib:e4,luaL_optstring:e8,luaL_pushresult:e6,luaL_setfuncs:e9}=N(7),e7=N(17),{luastring_indexOf:ti,to_jsstring:to,to_luastring:tl,to_uristring:tu}=N(5),tc=N(0),tf="u">typeof window?window:"u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this"),th=tl("__JSLIBS__"),tp=tl("luaopen_"),td=tl("_"),t_=tl("\x01");B=function(e,n,N){n=tu(n);let B=new XMLHttpRequest;if(B.open("GET",n,!1),B.send(),B.status<200||B.status>=300)return eC(e,tl(`${B.status}: ${B.statusText}`)),null;let et,ei=B.response;/\/\/[#@] sourceURL=/.test(ei)||(ei+=" //# sourceURL="+n);try{et=Function("fengari",ei)}catch(n){return eC(e,tl(`${n.name}: ${n.message}`)),null}let eo=et(tc);return"function"==typeof eo||"object"==typeof eo&&null!==eo?eo:void 0===eo?tf:(eC(e,tl(`library returned unexpected type (${typeof eo})`)),null)},et=function(e){e=tu(e);let n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(),n.status>=200&&n.status<=299};let bt=function(e,n,N){let et=Rt(e,n);if(null===et){if(null===(et=B(e,n,42===N[0])))return 1;lt(e,n,et)}if(42===N[0])return ew(e,1),0;{let n;let B=(n=et[to(N)])&&"function"==typeof n?n:(eE(e,tl("undefined symbol: %s"),N),null);return null===B?2:(eO(e,B),0)}},yt=function(e,n,N,B){let et,ei=`${N}${e7.LUA_VERSUFFIX}`;eC(e,tl(ei));let eo=tf[ei];void 0===eo&&(eo=tf[N]),void 0===eo||(eb(e,ep,tl("LUA_NOENV")),et=ej(e,-1),ex(e,1),et)?eC(e,B):(eo=e2(e,tl(eo),tl(ef+ef,!0),tl(ef+to(t_)+ef,!0)),e2(e,eo,t_,B),eG(e,-2)),eV(e,-3,n),ex(e,1)},Rt=function(e,n){eD(e,ep,th),eb(e,-1,n);let N=e$(e,-1);return ex(e,2),N},lt=function(e,n,N){eD(e,ep,th),eN(e,N),eM(e,-1),eV(e,-3,n),eB(e,-2,e3(e,-2)+1),ex(e,1)},pt=function(e,n){for(;n[0]===ef.charCodeAt(0);)n=n.subarray(1);if(0===n.length)return null;let N=ti(n,ef.charCodeAt(0));return N<0&&(N=n.length),eR(e,n,N),n.subarray(N)},At=function(e,n,N,B,ei){let eo=new eZ;for(eJ(e,eo),0!==B[0]&&(n=e2(e,n,B,ei));null!==(N=pt(e,N));){let N=e2(e,eH(e,-1),tl(ec,!0),n);if(eG(e,-2),et(N))return N;eE(e,tl(`
	no file '%s'`),N),eG(e,-2),eY(eo)}return e6(eo),null},o=function(e,n,N,B){eb(e,eX(1),N);let et=eH(e,-1);return null===et&&e0(e,tl("'package.%s' must be a string"),N),At(e,n,et,tl("."),B)},c=function(e,n,N){return n?(eC(e,N),2):e0(e,tl(`error loading module '%s' from file '%s':
	%s`),eH(e,1),N,eH(e,-1))},x=function(e){let n=eQ(e,1),N=o(e,n,tl("path",!0),tl(ei,!0));return null===N?1:c(e,e5(e,N)===eh,N)},p=function(e,n,N){let B;let et=ti(N=e2(e,N,tl("."),td),45);if(et>=0){B=eR(e,N,et),B=eE(e,tl("%s%s"),tp,B);let ei=bt(e,n,B);if(2!==ei)return ei;N=et+1}return B=eE(e,tl("%s%s"),tp,N),bt(e,n,B)},T=function(e){let n=eQ(e,1),N=o(e,n,tl("jspath",!0),tl(ei,!0));return null===N?1:c(e,0===p(e,N,n),N)},X=function(e){let n,N=eQ(e,1),B=ti(N,46);if(B<0)return 0;eR(e,N,B);let et=o(e,eH(e,-1),tl("jspath",!0),tl(ei,!0));return null===et?1:0!==(n=p(e,et,N))?2!=n?c(e,0,et):(eC(e,tl(`
	no module '%s' in file '%s'`),N,et),1):(eC(e,et),2)},U=function(e){let n=eQ(e,1);return eb(e,ep,eW),eb(e,-1,n)===ed&&eE(e,tl(`
	no field package.preload['%s']`),n),1},pe=function(e,n,N){for(;n===eh?(eP(e,3,N.i)===ed&&(ex(e,1),e6(N.msg),e0(e,tl("module '%s' not found:%s"),N.name,eH(e,-1))),eC(e,N.name),eg(e,1,2,N,pe)):n=eh,!ev(e,-2);N.i++)eA(e,-2)?(ex(e,1),eY(N.msg)):ex(e,2);return N.k(e,eh,N.ctx)},Ke=function(e,n,N){return eC(e,N),ey(e,-2),eg(e,2,1,N,Qe),Qe(e,eh,N)},Qe=function(e,n,N){return ek(e,-1)||eV(e,2,N),eb(e,2,N)==ed&&(ew(e,1),eM(e,-1),eV(e,2,N)),1},tg={loadlib:function(e){let n=eQ(e,1),N=eQ(e,2),B=bt(e,n,N);return 0===B?1:(eU(e),ey(e,-2),eI(e,1===B?"open":"init"),3)},searchpath:function(e){return null!==At(e,eQ(e,1),eQ(e,2),e8(e,3,"."),e8(e,4,ei))?1:(eU(e),ey(e,-2),2)}},tm={require:function(e){let n,N=eQ(e,1);return ez(e,1),eb(e,ep,eq),eb(e,2,N),ej(e,-1)?1:(ex(e,1),eJ(e,n=new eZ),eb(e,eX(1),tl("searchers",!0))!==e_&&e0(e,tl("'package.searchers' must be a table")),pe(e,eh,{name:N,i:1,msg:n,ctx:N,k:Ke}))}};e.exports.luaopen_package=function(e){return eL(e),em(e,0,1),eF(e,-2),eK(e,ep,th),e4(e,tg),function(e){let n=[U,x,T,X,null];em(e);for(let N=0;n[N];N++)eM(e,-2),eT(e,n[N],1),eB(e,-2,N+1);eV(e,-2,tl("searchers",!0))}(e),yt(e,tl("path",!0),"LUA_PATH",eu),yt(e,tl("jspath",!0),"LUA_JSPATH",el),eI(e,ei+`
`+ef+`
`+ec+`
`+eo+`
-
`),eV(e,-2,tl("config",!0)),e1(e,ep,eq),eV(e,-2,tl("loaded",!0)),e1(e,ep,eW),eV(e,-2,tl("preload",!0)),eS(e),eM(e,-2),e9(e,tm,1),ex(e,1),1}},function(e,n,N){let{lua_pushinteger:B,lua_pushliteral:et,lua_setfield:ei}=N(2),{luaL_newlib:eo}=N(7),{FENGARI_AUTHORS:el,FENGARI_COPYRIGHT:eu,FENGARI_RELEASE:ec,FENGARI_VERSION:ef,FENGARI_VERSION_MAJOR:eh,FENGARI_VERSION_MINOR:ep,FENGARI_VERSION_NUM:ed,FENGARI_VERSION_RELEASE:e_,to_luastring:eg}=N(5);e.exports.luaopen_fengari=function(e){return eo(e,{}),et(e,el),ei(e,-2,eg("AUTHORS")),et(e,eu),ei(e,-2,eg("COPYRIGHT")),et(e,ec),ei(e,-2,eg("RELEASE")),et(e,ef),ei(e,-2,eg("VERSION")),et(e,eh),ei(e,-2,eg("VERSION_MAJOR")),et(e,ep),ei(e,-2,eg("VERSION_MINOR")),B(e,ed),ei(e,-2,eg("VERSION_NUM")),et(e,e_),ei(e,-2,eg("VERSION_RELEASE")),1}},function(e,n,N){N.r(n),N.d(n,"L",function(){return eN}),N.d(n,"load",function(){return y});var B=N(0);N.d(n,"FENGARI_AUTHORS",function(){return B.FENGARI_AUTHORS}),N.d(n,"FENGARI_COPYRIGHT",function(){return B.FENGARI_COPYRIGHT}),N.d(n,"FENGARI_RELEASE",function(){return B.FENGARI_RELEASE}),N.d(n,"FENGARI_VERSION",function(){return B.FENGARI_VERSION}),N.d(n,"FENGARI_VERSION_MAJOR",function(){return B.FENGARI_VERSION_MAJOR}),N.d(n,"FENGARI_VERSION_MINOR",function(){return B.FENGARI_VERSION_MINOR}),N.d(n,"FENGARI_VERSION_NUM",function(){return B.FENGARI_VERSION_NUM}),N.d(n,"FENGARI_VERSION_RELEASE",function(){return B.FENGARI_VERSION_RELEASE}),N.d(n,"luastring_eq",function(){return B.luastring_eq}),N.d(n,"luastring_indexOf",function(){return B.luastring_indexOf}),N.d(n,"luastring_of",function(){return B.luastring_of}),N.d(n,"to_jsstring",function(){return B.to_jsstring}),N.d(n,"to_luastring",function(){return B.to_luastring}),N.d(n,"to_uristring",function(){return B.to_uristring}),N.d(n,"lua",function(){return B.lua}),N.d(n,"lauxlib",function(){return B.lauxlib}),N.d(n,"lualib",function(){return B.lualib});var et=N(21);N.d(n,"interop",function(){return et});let{LUA_ERRRUN:ei,LUA_ERRSYNTAX:eo,LUA_OK:el,LUA_VERSION_MAJOR:eu,LUA_VERSION_MINOR:ec,lua_Debug:ef,lua_getinfo:eh,lua_getstack:ep,lua_gettop:ed,lua_insert:e_,lua_pcall:eg,lua_pop:em,lua_pushcfunction:eb,lua_pushstring:ey,lua_remove:ev,lua_setglobal:ek,lua_tojsstring:eA}=B.lua,{luaL_loadbuffer:eL,luaL_newstate:ex,luaL_requiref:ew}=B.lauxlib,{checkjs:eT,luaopen_js:eO,push:eE,tojs:eS}=et,eN=ex();function y(e,n){if("string"==typeof e)e=Object(B.to_luastring)(e);else if(!(e instanceof Uint8Array))throw TypeError("expects an array of bytes or javascript string");let N,et=eL(eN,e,null,n=n?Object(B.to_luastring)(n):null);if(N=et===eo?SyntaxError(eA(eN,-1)):eS(eN,-1),em(eN,1),et!==el)throw N;return N}if(B.lualib.luaL_openlibs(eN),ew(eN,Object(B.to_luastring)("js"),eO,1),em(eN,1),ey(eN,Object(B.to_luastring)(B.FENGARI_COPYRIGHT)),ek(eN,Object(B.to_luastring)("_COPYRIGHT")),"u">typeof document&&document instanceof HTMLDocument){let Y=function(e){switch(e){case"anonymous":return"omit";case"use-credentials":return"include";default:return"same-origin"}},de=function(e){let n=new ef;return ep(e,2,n)&&eh(e,Object(B.to_luastring)("Sl"),n),eE(e,new ErrorEvent("error",{bubbles:!0,cancelable:!0,message:eA(e,1),error:eS(e,1),filename:n.short_src?Object(B.to_jsstring)(n.short_src):void 0,lineno:n.currentline>0?n.currentline:void 0})),1},_e=function(e,n,N){let B,et=eL(eN,n,null,N);if(et===eo){let n=eA(eN,-1),N=e.src?e.src:document.location,et,ei=SyntaxError(n,N,et);B=new ErrorEvent("error",{message:n,error:ei,filename:N,lineno:et})}else if(et===el){let n=ed(eN);eb(eN,de),e_(eN,n),Object.defineProperty(document,"currentScript",{value:e,configurable:!0}),et=eg(eN,0,0,n),delete document.currentScript,ev(eN,n),et===ei&&(B=eT(eN,-1))}et!==el&&(void 0===B&&(B=new ErrorEvent("error",{message:eA(eN,-1),error:eS(eN,-1)})),em(eN,1),window.dispatchEvent(B)&&console.error("uncaught exception",B.error))},me=function(e,n,N){if(e.status>=200&&e.status<300){let et=e.response;_e(n,et="string"==typeof et?Object(B.to_luastring)(e.response):new Uint8Array(et),N)}else n.dispatchEvent(new Event("error"))},ve=function(e){if(e.src){let n=Object(B.to_luastring)("@"+e.src);if("complete"===document.readyState||e.async){if("function"==typeof fetch)fetch(e.src,{method:"GET",credentials:Y(e.crossorigin),redirect:"follow",integrity:e.integrity}).then(function(e){if(e.ok)return e.arrayBuffer();throw Error("unable to fetch")}).then(function(N){_e(e,new Uint8Array(N),n)}).catch(function(n){e.dispatchEvent(new Event("error"))});else{let N=new XMLHttpRequest;N.open("GET",e.src,!0),N.responseType="arraybuffer",N.onreadystatechange=function(){4===N.readyState&&me(N,e,n)},N.send()}}else{let N=new XMLHttpRequest;N.open("GET",e.src,!1),N.send(),me(N,e,n)}}else{let n=Object(B.to_luastring)(e.innerHTML),N=e.id?Object(B.to_luastring)("="+e.id):n;_e(e,n,N)}},e=/^(.*?\/.*?)([\t ]*;.*)?$/,n=/^(\d+)\.(\d+)$/,C=function(N){if("SCRIPT"!==N.tagName)return;let B=e.exec(N.type);if(!B)return;let et=B[1];if("application/lua"===et||"text/lua"===et){if(N.hasAttribute("lua-version")){let e=n.exec(N.getAttribute("lua-version"));if(!e||e[1]!==eu||e[2]!==ec)return}ve(N)}};"u">typeof MutationObserver?new MutationObserver(function(e,n){for(let n=0;n<e.length;n++){let N=e[n];for(let e=0;e<N.addedNodes.length;e++)C(N.addedNodes[e])}}).observe(document,{childList:!0,subtree:!0}):console.warn&&console.warn("fengari-web: MutationObserver not found; lua script tags will not be run when inserted"),Array.prototype.forEach.call(document.querySelectorAll('script[type^="application/lua"], script[type^="text/lua"]'),C)}},function(e,n,N){let{LUA_MULTRET:B,LUA_OPADD:et,LUA_OPBAND:ei,LUA_OPBNOT:eo,LUA_OPBOR:el,LUA_OPBXOR:eu,LUA_OPDIV:ec,LUA_OPIDIV:ef,LUA_OPMOD:eh,LUA_OPSHL:ep,LUA_OPSHR:ed,LUA_OPUNM:e_,constant_types:{LUA_TBOOLEAN:eg,LUA_TLIGHTUSERDATA:em,LUA_TLNGSTR:eb,LUA_TNIL:ey,LUA_TNUMFLT:ev,LUA_TNUMINT:ek,LUA_TTABLE:eA},to_luastring:eL}=N(1),{lua_assert:ex}=N(4),ew=N(20),eT=N(6),eO=N(16),eE=N(23),eS=N(9),eN=N(15),eI=eO.OpCodesI,eR=eT.TValue,eU={OPR_ADD:0,OPR_SUB:1,OPR_MUL:2,OPR_MOD:3,OPR_POW:4,OPR_DIV:5,OPR_IDIV:6,OPR_BAND:7,OPR_BOR:8,OPR_BXOR:9,OPR_SHL:10,OPR_SHR:11,OPR_CONCAT:12,OPR_EQ:13,OPR_LT:14,OPR_LE:15,OPR_NE:16,OPR_GT:17,OPR_GE:18,OPR_AND:19,OPR_OR:20,OPR_NOBINOPR:21},eC={OPR_MINUS:0,OPR_BNOT:1,OPR_NOT:2,OPR_LEN:3,OPR_NOUNOPR:4},me=function(e){return e.t!==e.f},ve=function(e,n){let N=eE.expkind;if(me(e))return!1;switch(e.k){case N.VKINT:return!n||new eR(ek,e.u.ival);case N.VKFLT:return!n||new eR(ev,e.u.nval);default:return!1}},z=function(e,n,N){let B,et=n+N-1;if(e.pc>e.lasttarget&&(B=e.f.code[e.pc-1]).opcode===eI.OP_LOADNIL){let e=B.A,N=e+B.B;if(e<=n&&n<=N+1||n<=e&&e<=et+1)return e<n&&(n=e),N>et&&(et=N),eO.SETARG_A(B,n),void eO.SETARG_B(B,et-n)}te(e,eI.OP_LOADNIL,n,N-1,0)},I=function(e,n){return e.f.code[n.u.info]},C=function(e,n){let N=e.f.code[n].sBx;return -1===N?-1:n+1+N},ye=function(e,n,N){let B=e.f.code[n],et=N-(n+1);ex(-1!==N),Math.abs(et)>eO.MAXARG_sBx&&ew.luaX_syntaxerror(e.ls,eL("control structure too long",!0)),eO.SETARG_sBx(B,et)},be=function(e,n,N){if(-1===N)return n;if(-1===n)n=N;else{let B=n,et=C(e,B);for(;-1!==et;)et=C(e,B=et);ye(e,B,N)}return n},Ue=function(e){let n=e.jpc;e.jpc=-1;let N=S(e,eI.OP_JMP,0,-1);return be(e,N,n)},He=function(e,n,N,B,et){return te(e,n,N,B,et),Ue(e)},st=function(e){return e.lasttarget=e.pc,e.pc},Ze=function(e,n){return n>=1&&eO.testTMode(e.f.code[n-1].opcode)?n-1:n},ae=function(e,n){return e.f.code[Ze(e,n)]},le=function(e,n,N){let B=Ze(e,n),et=e.f.code[B];return et.opcode===eI.OP_TESTSET&&(N!==eO.NO_REG&&N!==et.B?eO.SETARG_A(et,N):e.f.code[B]=eO.CREATE_ABC(eI.OP_TEST,et.B,0,et.C),!0)},Pe=function(e,n){for(;-1!==n;n=C(e,n))le(e,n,eO.NO_REG)},xe=function(e,n,N,B,et){for(;-1!==n;){let ei=C(e,n);le(e,n,B)?ye(e,n,N):ye(e,n,et),n=ei}},Ge=function(e,n){st(e),e.jpc=be(e,e.jpc,n)},g=function(e,n,N){N===e.pc?Ge(e,n):(ex(N<e.pc),xe(e,n,N,eO.NO_REG,N))},ge=function(e,n){let N=e.f;return xe(e,e.jpc,e.pc,eO.NO_REG,e.pc),e.jpc=-1,N.code[e.pc]=n,N.lineinfo[e.pc]=e.ls.lastline,e.pc++},te=function(e,n,N,B,et){return ex(eO.getOpMode(n)===eO.iABC),ex(eO.getBMode(n)!==eO.OpArgN||0===B),ex(eO.getCMode(n)!==eO.OpArgN||0===et),ex(N<=eO.MAXARG_A&&B<=eO.MAXARG_B&&et<=eO.MAXARG_C),ge(e,eO.CREATE_ABC(n,N,B,et))},A=function(e,n,N,B){return ex(eO.getOpMode(n)===eO.iABx||eO.getOpMode(n)===eO.iAsBx),ex(eO.getCMode(n)===eO.OpArgN),ex(N<=eO.MAXARG_A&&B<=eO.MAXARG_Bx),ge(e,eO.CREATE_ABx(n,N,B))},S=function(e,n,N,B){return A(e,n,N,B+eO.MAXARG_sBx)},v=function(e,n){return ex(n<=eO.MAXARG_Ax),ge(e,eO.CREATE_Ax(eI.OP_EXTRAARG,n))},q=function(e,n,N){if(N<=eO.MAXARG_Bx)return A(e,eI.OP_LOADK,n,N);{let B=A(e,eI.OP_LOADKX,n,0);return v(e,N),B}},oe=function(e,n){let N=e.freereg+n;N>e.f.maxstacksize&&(N>=255&&ew.luaX_syntaxerror(e.ls,eL("function or expression needs too many registers",!0)),e.f.maxstacksize=N)},O=function(e,n){oe(e,n),e.freereg+=n},ee=function(e,n){!eO.ISK(n)&&n>=e.nactvar&&(e.freereg--,ex(n===e.freereg))},ce=function(e,n){n.k===eE.expkind.VNONRELOC&&ee(e,n.u.info)},Ne=function(e,n,N){let B=n.k===eE.expkind.VNONRELOC?n.u.info:-1,et=N.k===eE.expkind.VNONRELOC?N.u.info:-1;B>et?(ee(e,B),ee(e,et)):(ee(e,et),ee(e,B))},$e=function(e,n,N){let B=e.f,et=eS.luaH_get(e.L,e.ls.h,n);if(et.ttisinteger()){let n=et.value;if(n<e.nk&&B.k[n].ttype()===N.ttype()&&B.k[n].value===N.value)return n}let ei=e.nk;return eS.luaH_setfrom(e.L,e.ls.h,n,new eT.TValue(ek,ei)),B.k[ei]=N,e.nk++,ei},nt=function(e,n){return $e(e,new eR(em,n),new eR(ek,n))},dt=function(e,n){let N=new eR(ev,n);return $e(e,N,N)},xt=function(e,n){let N=new eR(eg,n);return $e(e,N,N)},Ot=function(e,n,N){let et=eE.expkind;if(n.k===et.VCALL)eO.SETARG_C(I(e,n),N+1);else if(n.k===et.VVARARG){let B=I(e,n);eO.SETARG_B(B,N+1),eO.SETARG_A(B,e.freereg),O(e,1)}else ex(N===B)},St=function(e,n){let N=eE.expkind;n.k===N.VCALL?(ex(2===I(e,n).C),n.k=N.VNONRELOC,n.u.info=I(e,n).A):n.k===N.VVARARG&&(eO.SETARG_B(I(e,n),2),n.k=N.VRELOCABLE)},D=function(e,n){let N=eE.expkind;switch(n.k){case N.VLOCAL:n.k=N.VNONRELOC;break;case N.VUPVAL:n.u.info=te(e,eI.OP_GETUPVAL,0,n.u.info,0),n.k=N.VRELOCABLE;break;case N.VINDEXED:{let B;ee(e,n.u.ind.idx),n.u.ind.vt===N.VLOCAL?(ee(e,n.u.ind.t),B=eI.OP_GETTABLE):(ex(n.u.ind.vt===N.VUPVAL),B=eI.OP_GETTABUP),n.u.info=te(e,B,0,n.u.ind.t,n.u.ind.idx),n.k=N.VRELOCABLE;break}case N.VVARARG:case N.VCALL:St(e,n)}},Be=function(e,n,N,B){return st(e),te(e,eI.OP_LOADBOOL,n,N,B)},De=function(e,n,N){let B=eE.expkind;switch(D(e,n),n.k){case B.VNIL:z(e,N,1);break;case B.VFALSE:case B.VTRUE:te(e,eI.OP_LOADBOOL,N,n.k===B.VTRUE,0);break;case B.VK:q(e,N,n.u.info);break;case B.VKFLT:q(e,N,dt(e,n.u.nval));break;case B.VKINT:q(e,N,nt(e,n.u.ival));break;case B.VRELOCABLE:{let B=I(e,n);eO.SETARG_A(B,N);break}case B.VNONRELOC:N!==n.u.info&&te(e,eI.OP_MOVE,N,n.u.info,0);break;default:return void ex(n.k===B.VJMP)}n.u.info=N,n.k=B.VNONRELOC},Fe=function(e,n){n.k!==eE.expkind.VNONRELOC&&(O(e,1),De(e,n,e.freereg-1))},Se=function(e,n){for(;-1!==n;n=C(e,n))if(ae(e,n).opcode!==eI.OP_TESTSET)return!0;return!1},je=function(e,n,N){let B=eE.expkind;if(De(e,n,N),n.k===B.VJMP&&(n.t=be(e,n.t,n.u.info)),me(n)){let et,ei=-1,eo=-1;if(Se(e,n.t)||Se(e,n.f)){let et=n.k===B.VJMP?-1:Ue(e);ei=Be(e,N,0,1),eo=Be(e,N,1,0),Ge(e,et)}et=st(e),xe(e,n.f,et,N,ei),xe(e,n.t,et,N,eo)}n.f=n.t=-1,n.u.info=N,n.k=B.VNONRELOC},We=function(e,n){D(e,n),ce(e,n),O(e,1),je(e,n,e.freereg-1)},bt=function(e,n){if(D(e,n),n.k===eE.expkind.VNONRELOC){if(!me(n))return n.u.info;if(n.u.info>=e.nactvar)return je(e,n,n.u.info),n.u.info}return We(e,n),n.u.info},vt=function(e,n){me(n)?bt(e,n):D(e,n)},yt=function(e,n){let N=eE.expkind,B=!1;switch(vt(e,n),n.k){case N.VTRUE:n.u.info=xt(e,!0),B=!0;break;case N.VFALSE:n.u.info=xt(e,!1),B=!0;break;case N.VNIL:let et,ei;n.u.info=(et=new eR(ey,null),ei=new eR(eA,e.ls.h),$e(e,ei,et)),B=!0;break;case N.VKINT:n.u.info=nt(e,n.u.ival),B=!0;break;case N.VKFLT:n.u.info=dt(e,n.u.nval),B=!0;break;case N.VK:B=!0}return B&&(n.k=N.VK,n.u.info<=eO.MAXINDEXRK)?eO.RKASK(n.u.info):bt(e,n)},Rt=function(e,n){let N=ae(e,n.u.info);ex(eO.testTMode(N.opcode)&&N.opcode!==eI.OP_TESTSET&&N.opcode!==eI.OP_TEST),eO.SETARG_A(N,!N.A)},lt=function(e,n,N){if(n.k===eE.expkind.VRELOCABLE){let B=I(e,n);if(B.opcode===eI.OP_NOT)return e.pc--,He(e,eI.OP_TEST,B.B,0,!N)}return Fe(e,n),ce(e,n),He(e,eI.OP_TESTSET,eO.NO_REG,n.u.info,N)},pt=function(e,n){let N,B=eE.expkind;switch(D(e,n),n.k){case B.VJMP:Rt(e,n),N=n.u.info;break;case B.VK:case B.VKFLT:case B.VKINT:case B.VTRUE:N=-1;break;default:N=lt(e,n,0)}n.f=be(e,n.f,N),Ge(e,n.t),n.t=-1},At=function(e,n){let N,B=eE.expkind;switch(D(e,n),n.k){case B.VJMP:N=n.u.info;break;case B.VNIL:case B.VFALSE:N=-1;break;default:N=lt(e,n,1)}n.t=be(e,n.t,N),Ge(e,n.f),n.f=-1},o=function(e,n,N){let B,et,e_=eE.expkind;if(!(B=ve(n,!0))||!(et=ve(N,!0))||!function(e,n,N){switch(e){case ei:case el:case eu:case ep:case ed:case eo:return!1!==eN.tointeger(n)&&!1!==eN.tointeger(N);case ec:case ef:case eh:return 0!==N.value;default:return 1}}(e,B,et))return 0;let eg=new eR;if(eT.luaO_arith(null,e,B,et,eg),eg.ttisinteger())n.k=e_.VKINT,n.u.ival=eg.value;else{let e=eg.value;if(isNaN(e)||0===e)return!1;n.k=e_.VKFLT,n.u.nval=e}return!0},c=function(e,n,N,B,et){let ei=yt(e,B),eo=yt(e,N);Ne(e,N,B),N.u.info=te(e,n,0,eo,ei),N.k=eE.expkind.VRELOCABLE,x(e,et)},x=function(e,n){e.f.lineinfo[e.pc-1]=n};e.exports.BinOpr=eU,e.exports.NO_JUMP=-1,e.exports.UnOpr=eC,e.exports.getinstruction=I,e.exports.luaK_checkstack=oe,e.exports.luaK_code=ge,e.exports.luaK_codeABC=te,e.exports.luaK_codeABx=A,e.exports.luaK_codeAsBx=S,e.exports.luaK_codek=q,e.exports.luaK_concat=be,e.exports.luaK_dischargevars=D,e.exports.luaK_exp2RK=yt,e.exports.luaK_exp2anyreg=bt,e.exports.luaK_exp2anyregup=function(e,n){(n.k!==eE.expkind.VUPVAL||me(n))&&bt(e,n)},e.exports.luaK_exp2nextreg=We,e.exports.luaK_exp2val=vt,e.exports.luaK_fixline=x,e.exports.luaK_getlabel=st,e.exports.luaK_goiffalse=At,e.exports.luaK_goiftrue=pt,e.exports.luaK_indexed=function(e,n,N){let B=eE.expkind;ex(!me(n)&&(eE.vkisinreg(n.k)||n.k===B.VUPVAL)),n.u.ind.t=n.u.info,n.u.ind.idx=yt(e,N),n.u.ind.vt=n.k===B.VUPVAL?B.VUPVAL:B.VLOCAL,n.k=B.VINDEXED},e.exports.luaK_infix=function(e,n,N){switch(n){case eU.OPR_AND:pt(e,N);break;case eU.OPR_OR:At(e,N);break;case eU.OPR_CONCAT:We(e,N);break;case eU.OPR_ADD:case eU.OPR_SUB:case eU.OPR_MUL:case eU.OPR_DIV:case eU.OPR_IDIV:case eU.OPR_MOD:case eU.OPR_POW:case eU.OPR_BAND:case eU.OPR_BOR:case eU.OPR_BXOR:case eU.OPR_SHL:case eU.OPR_SHR:ve(N,!1)||yt(e,N);break;default:yt(e,N)}},e.exports.luaK_intK=nt,e.exports.luaK_jump=Ue,e.exports.luaK_jumpto=function(e,n){return g(e,Ue(e),n)},e.exports.luaK_nil=z,e.exports.luaK_numberK=dt,e.exports.luaK_patchclose=function(e,n,N){for(N++;-1!==n;n=C(e,n)){let B=e.f.code[n];ex(B.opcode===eI.OP_JMP&&(0===B.A||B.A>=N)),eO.SETARG_A(B,N)}},e.exports.luaK_patchlist=g,e.exports.luaK_patchtohere=Ge,e.exports.luaK_posfix=function(e,n,N,B,ei){let eo=eE.expkind;switch(n){case eU.OPR_AND:ex(-1===N.t),D(e,B),B.f=be(e,B.f,N.f),N.to(B);break;case eU.OPR_OR:ex(-1===N.f),D(e,B),B.t=be(e,B.t,N.t),N.to(B);break;case eU.OPR_CONCAT:{vt(e,B);let n=I(e,B);B.k===eo.VRELOCABLE&&n.opcode===eI.OP_CONCAT?(ex(N.u.info===n.B-1),ce(e,N),eO.SETARG_B(n,N.u.info),N.k=eo.VRELOCABLE,N.u.info=B.u.info):(We(e,B),c(e,eI.OP_CONCAT,N,B,ei));break}case eU.OPR_ADD:case eU.OPR_SUB:case eU.OPR_MUL:case eU.OPR_DIV:case eU.OPR_IDIV:case eU.OPR_MOD:case eU.OPR_POW:case eU.OPR_BAND:case eU.OPR_BOR:case eU.OPR_BXOR:case eU.OPR_SHL:case eU.OPR_SHR:o(n+et,N,B)||c(e,n+eI.OP_ADD,N,B,ei);break;case eU.OPR_EQ:case eU.OPR_LT:case eU.OPR_LE:case eU.OPR_NE:case eU.OPR_GT:case eU.OPR_GE:(function(e,n,N,B){let et,ei=eE.expkind;N.k===ei.VK?et=eO.RKASK(N.u.info):(ex(N.k===ei.VNONRELOC),et=N.u.info);let eo=yt(e,B);switch(Ne(e,N,B),n){case eU.OPR_NE:N.u.info=He(e,eI.OP_EQ,0,et,eo);break;case eU.OPR_GT:case eU.OPR_GE:{let B=n-eU.OPR_NE+eI.OP_EQ;N.u.info=He(e,B,1,eo,et);break}default:{let B=n-eU.OPR_EQ+eI.OP_EQ;N.u.info=He(e,B,1,et,eo)}}N.k=ei.VJMP})(e,n,N,B)}return N},e.exports.luaK_prefix=function(e,n,N,B){let et=new eE.expdesc;switch(et.k=eE.expkind.VKINT,et.u.ival=et.u.nval=et.u.info=0,et.t=-1,et.f=-1,n){case eC.OPR_MINUS:case eC.OPR_BNOT:if(o(n+e_,N,et))break;case eC.OPR_LEN:var ei;let eo;ei=n+eI.OP_UNM,eo=bt(e,N),ce(e,N),N.u.info=te(e,ei,0,eo,0),N.k=eE.expkind.VRELOCABLE,x(e,B);break;case eC.OPR_NOT:(function(e,n){let N=eE.expkind;switch(D(e,n),n.k){case N.VNIL:case N.VFALSE:n.k=N.VTRUE;break;case N.VK:case N.VKFLT:case N.VKINT:case N.VTRUE:n.k=N.VFALSE;break;case N.VJMP:Rt(e,n);break;case N.VRELOCABLE:case N.VNONRELOC:Fe(e,n),ce(e,n),n.u.info=te(e,eI.OP_NOT,0,n.u.info,0),n.k=N.VRELOCABLE}{let e=n.f;n.f=n.t,n.t=e}Pe(e,n.f),Pe(e,n.t)})(e,N)}},e.exports.luaK_reserveregs=O,e.exports.luaK_ret=function(e,n,N){te(e,eI.OP_RETURN,n,N+1,0)},e.exports.luaK_self=function(e,n,N){bt(e,n);let B=n.u.info;ce(e,n),n.u.info=e.freereg,n.k=eE.expkind.VNONRELOC,O(e,2),te(e,eI.OP_SELF,n.u.info,B,yt(e,N)),ce(e,N)},e.exports.luaK_setlist=function(e,n,N,et){let ei=(N-1)/eO.LFIELDS_PER_FLUSH+1,eo=et===B?0:et;ex(0!==et&&et<=eO.LFIELDS_PER_FLUSH),ei<=eO.MAXARG_C?te(e,eI.OP_SETLIST,n,eo,ei):ei<=eO.MAXARG_Ax?(te(e,eI.OP_SETLIST,n,eo,0),v(e,ei)):ew.luaX_syntaxerror(e.ls,eL("constructor too long",!0)),e.freereg=n+1},e.exports.luaK_setmultret=function(e,n){Ot(e,n,B)},e.exports.luaK_setoneret=St,e.exports.luaK_setreturns=Ot,e.exports.luaK_storevar=function(e,n,N){let B=eE.expkind;switch(n.k){case B.VLOCAL:return ce(e,N),void je(e,N,n.u.info);case B.VUPVAL:{let B=bt(e,N);te(e,eI.OP_SETUPVAL,B,n.u.info,0);break}case B.VINDEXED:{let et=n.u.ind.vt===B.VLOCAL?eI.OP_SETTABLE:eI.OP_SETTABUP,ei=yt(e,N);te(e,et,n.u.ind.t,n.u.ind.idx,ei)}}ce(e,N)},e.exports.luaK_stringK=function(e,n){let N=new eR(eb,n);return $e(e,N,N)}},function(e,n,N){let{LUA_SIGNATURE:B,constant_types:{LUA_TBOOLEAN:et,LUA_TLNGSTR:ei,LUA_TNIL:eo,LUA_TNUMFLT:el,LUA_TNUMINT:eu,LUA_TSHRSTR:ec},thread_status:{LUA_ERRSYNTAX:ef},is_luastring:eh,luastring_eq:ep,to_luastring:ed}=N(1),e_=N(8),eg=N(13),em=N(6),{MAXARG_sBx:eb,POS_A:ey,POS_Ax:ev,POS_B:ek,POS_Bx:eA,POS_C:eL,POS_OP:ex,SIZE_A:ew,SIZE_Ax:eT,SIZE_B:eO,SIZE_Bx:eE,SIZE_C:eS,SIZE_OP:eN}=N(16),{lua_assert:eI}=N(4),{luaS_bless:eR}=N(10),{luaZ_read:eU,ZIO:eC}=N(19),eM=[25,147,13,10,26,10];let ve=class ve{constructor(e,n,N){this.intSize=4,this.size_tSize=4,this.instructionSize=4,this.integerSize=4,this.numberSize=8,eI(n instanceof eC,"BytecodeParser only operates on a ZIO"),eI(eh(N)),64===N[0]||61===N[0]?this.name=N.subarray(1):N[0]==B[0]?this.name=ed("binary string",!0):this.name=N,this.L=e,this.Z=n,this.arraybuffer=new ArrayBuffer(Math.max(this.intSize,this.size_tSize,this.instructionSize,this.integerSize,this.numberSize)),this.dv=new DataView(this.arraybuffer),this.u8=new Uint8Array(this.arraybuffer)}read(e){let n=new Uint8Array(e);return 0!==eU(this.Z,n,0,e)&&this.error("truncated"),n}LoadByte(){return 0!==eU(this.Z,this.u8,0,1)&&this.error("truncated"),this.u8[0]}LoadInt(){return 0!==eU(this.Z,this.u8,0,this.intSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadNumber(){return 0!==eU(this.Z,this.u8,0,this.numberSize)&&this.error("truncated"),this.dv.getFloat64(0,!0)}LoadInteger(){return 0!==eU(this.Z,this.u8,0,this.integerSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadSize_t(){return this.LoadInteger()}LoadString(){let e=this.LoadByte();return 255===e&&(e=this.LoadSize_t()),0===e?null:eR(this.L,this.read(e-1))}static MASK1(e,n){return~(-1<<e)<<n}LoadCode(e){let n=this.LoadInt();for(let N=0;N<n;N++){0!==eU(this.Z,this.u8,0,this.instructionSize)&&this.error("truncated");let n=this.dv.getUint32(0,!0);e.code[N]={code:n,opcode:n>>ex&ve.MASK1(eN,0),A:n>>ey&ve.MASK1(ew,0),B:n>>ek&ve.MASK1(eO,0),C:n>>eL&ve.MASK1(eS,0),Bx:n>>eA&ve.MASK1(eE,0),Ax:n>>ev&ve.MASK1(eT,0),sBx:(n>>eA&ve.MASK1(eE,0))-eb}}}LoadConstants(e){let n=this.LoadInt();for(let N=0;N<n;N++){let n=this.LoadByte();switch(n){case eo:e.k.push(new em.TValue(eo,null));break;case et:e.k.push(new em.TValue(et,0!==this.LoadByte()));break;case el:e.k.push(new em.TValue(el,this.LoadNumber()));break;case eu:e.k.push(new em.TValue(eu,this.LoadInteger()));break;case ec:case ei:e.k.push(new em.TValue(ei,this.LoadString()));break;default:this.error(`unrecognized constant '${n}'`)}}}LoadProtos(e){let n=this.LoadInt();for(let N=0;N<n;N++)e.p[N]=new eg.Proto(this.L),this.LoadFunction(e.p[N],e.source)}LoadUpvalues(e){let n=this.LoadInt();for(let N=0;N<n;N++)e.upvalues[N]={name:null,instack:this.LoadByte(),idx:this.LoadByte()}}LoadDebug(e){let n=this.LoadInt();for(let N=0;N<n;N++)e.lineinfo[N]=this.LoadInt();n=this.LoadInt();for(let N=0;N<n;N++)e.locvars[N]={varname:this.LoadString(),startpc:this.LoadInt(),endpc:this.LoadInt()};n=this.LoadInt();for(let N=0;N<n;N++)e.upvalues[N].name=this.LoadString()}LoadFunction(e,n){e.source=this.LoadString(),null===e.source&&(e.source=n),e.linedefined=this.LoadInt(),e.lastlinedefined=this.LoadInt(),e.numparams=this.LoadByte(),e.is_vararg=0!==this.LoadByte(),e.maxstacksize=this.LoadByte(),this.LoadCode(e),this.LoadConstants(e),this.LoadUpvalues(e),this.LoadProtos(e),this.LoadDebug(e)}checkliteral(e,n){ep(this.read(e.length),e)||this.error(n)}checkHeader(){this.checkliteral(B.subarray(1),"not a"),83!==this.LoadByte()&&this.error("version mismatch in"),0!==this.LoadByte()&&this.error("format mismatch in"),this.checkliteral(eM,"corrupted"),this.intSize=this.LoadByte(),this.size_tSize=this.LoadByte(),this.instructionSize=this.LoadByte(),this.integerSize=this.LoadByte(),this.numberSize=this.LoadByte(),this.checksize(this.intSize,4,"int"),this.checksize(this.size_tSize,4,"size_t"),this.checksize(this.instructionSize,4,"instruction"),this.checksize(this.integerSize,4,"integer"),this.checksize(this.numberSize,8,"number"),22136!==this.LoadInteger()&&this.error("endianness mismatch in"),370.5!==this.LoadNumber()&&this.error("float format mismatch in")}error(e){em.luaO_pushfstring(this.L,ed("%s: %s precompiled chunk"),this.name,ed(e)),e_.luaD_throw(this.L,ef)}checksize(e,n,N){e!==n&&this.error(`${N} size mismatch in`)}};e.exports.luaU_undump=function(e,n,N){let B=new ve(e,n,N);B.checkHeader();let et=eg.luaF_newLclosure(e,B.LoadByte());return e_.luaD_inctop(e),e.stack[e.top-1].setclLvalue(et),et.p=new eg.Proto(e),B.LoadFunction(et.p,null),eI(et.nupvalues===et.p.upvalues.length),et}},function(e,n,N){let{LUA_SIGNATURE:B,LUA_VERSION_MAJOR:et,LUA_VERSION_MINOR:ei,constant_types:{LUA_TBOOLEAN:eo,LUA_TLNGSTR:el,LUA_TNIL:eu,LUA_TNUMFLT:ec,LUA_TNUMINT:ef,LUA_TSHRSTR:eh},luastring_of:ep}=N(1),ed=ep(25,147,13,10,26,10),e_=16*Number(et)+Number(ei),f=function(e,n,N){0===N.status&&n>0&&(N.status=N.writer(N.L,e,n,N.data))},m=function(e,n){f(ep(e),1,n)},b=function(e,n){let N=new ArrayBuffer(4);new DataView(N).setInt32(0,e,!0),f(new Uint8Array(N),4,n)},R=function(e,n){let N=new ArrayBuffer(4);new DataView(N).setInt32(0,e,!0),f(new Uint8Array(N),4,n)},M=function(e,n){let N=new ArrayBuffer(8);new DataView(N).setFloat64(0,e,!0),f(new Uint8Array(N),8,n)},K=function(e,n){if(null===e)m(0,n);else{let N=e.tsslen()+1,B=e.getstr();N<255?m(N,n):(m(255,n),R(N,n)),f(B,N-1,n)}},G=function(e,n,N){N.strip||e.source===n?K(null,N):K(e.source,N),b(e.linedefined,N),b(e.lastlinedefined,N),m(e.numparams,N),m(e.is_vararg?1:0,N),m(e.maxstacksize,N),function(e,n){let N=e.code.map(e=>e.code);b(N.length,n);for(let e=0;e<N.length;e++)b(N[e],n)}(e,N),function(e,n){let N=e.k.length;b(N,n);for(let B=0;B<N;B++){let N=e.k[B];switch(m(N.ttype(),n),N.ttype()){case eu:break;case eo:m(N.value?1:0,n);break;case ec:M(N.value,n);break;case ef:R(N.value,n);break;case eh:case el:K(N.tsvalue(),n)}}}(e,N),function(e,n){let N=e.upvalues.length;b(N,n);for(let B=0;B<N;B++)m(e.upvalues[B].instack?1:0,n),m(e.upvalues[B].idx,n)}(e,N),function(e,n){let N=e.p.length;b(N,n);for(let B=0;B<N;B++)G(e.p[B],e.source,n)}(e,N),function(e,n){let N=n.strip?0:e.lineinfo.length;b(N,n);for(let B=0;B<N;B++)b(e.lineinfo[B],n);b(N=n.strip?0:e.locvars.length,n);for(let B=0;B<N;B++)K(e.locvars[B].varname,n),b(e.locvars[B].startpc,n),b(e.locvars[B].endpc,n);b(N=n.strip?0:e.upvalues.length,n);for(let B=0;B<N;B++)K(e.upvalues[B].name,n)}(e,N)};e.exports.luaU_dump=function(e,n,N,et,ei){let eo=new class{constructor(){this.L=null,this.write=null,this.data=null,this.strip=NaN,this.status=NaN}};return eo.L=e,eo.writer=N,eo.data=et,eo.strip=ei,eo.status=0,f(B,B.length,eo),m(e_,eo),m(0,eo),f(ed,ed.length,eo),m(4,eo),m(4,eo),m(4,eo),m(4,eo),m(8,eo),R(22136,eo),M(370.5,eo),m(n.upvalues.length,eo),G(n,null,eo),eo.status}},function(e,n,N){var B;!function(){var et={not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function a(e){return function(e,n){var N,B,ei,eo,el,eu,ec,ef,eh,ep=1,ed=e.length,e_="";for(B=0;B<ed;B++)if("string"==typeof e[B])e_+=e[B];else if(Array.isArray(e[B])){if((eo=e[B])[2])for(N=n[ep],ei=0;ei<eo[2].length;ei++){if(!N.hasOwnProperty(eo[2][ei]))throw Error(a('[sprintf] property "%s" does not exist',eo[2][ei]));N=N[eo[2][ei]]}else N=eo[1]?n[eo[1]]:n[ep++];if(et.not_type.test(eo[8])&&et.not_primitive.test(eo[8])&&N instanceof Function&&(N=N()),et.numeric_arg.test(eo[8])&&"number"!=typeof N&&isNaN(N))throw TypeError(a("[sprintf] expecting number but found %T",N));switch(et.number.test(eo[8])&&(ef=N>=0),eo[8]){case"b":N=parseInt(N,10).toString(2);break;case"c":N=String.fromCharCode(parseInt(N,10));break;case"d":case"i":N=parseInt(N,10);break;case"j":N=JSON.stringify(N,null,eo[6]?parseInt(eo[6]):0);break;case"e":N=eo[7]?parseFloat(N).toExponential(eo[7]):parseFloat(N).toExponential();break;case"f":N=eo[7]?parseFloat(N).toFixed(eo[7]):parseFloat(N);break;case"g":N=eo[7]?String(Number(N.toPrecision(eo[7]))):parseFloat(N);break;case"o":N=(parseInt(N,10)>>>0).toString(8);break;case"s":N=String(N),N=eo[7]?N.substring(0,eo[7]):N;break;case"t":N=String(!!N),N=eo[7]?N.substring(0,eo[7]):N;break;case"T":N=Object.prototype.toString.call(N).slice(8,-1).toLowerCase(),N=eo[7]?N.substring(0,eo[7]):N;break;case"u":N=parseInt(N,10)>>>0;break;case"v":N=N.valueOf(),N=eo[7]?N.substring(0,eo[7]):N;break;case"x":N=(parseInt(N,10)>>>0).toString(16);break;case"X":N=(parseInt(N,10)>>>0).toString(16).toUpperCase()}et.json.test(eo[8])?e_+=N:(et.number.test(eo[8])&&(!ef||eo[3])?(eh=ef?"+":"-",N=N.toString().replace(et.sign,"")):eh="",eu=eo[4]?"0"===eo[4]?"0":eo[4].charAt(1):" ",ec=eo[6]-(eh+N).length,el=eo[6]&&ec>0?eu.repeat(ec):"",e_+=eo[5]?eh+N+el:"0"===eu?eh+el+N:el+eh+N)}return e_}(function(e){if(ei[e])return ei[e];for(var n,N=e,B=[],eo=0;N;){if(null!==(n=et.text.exec(N)))B.push(n[0]);else if(null!==(n=et.modulo.exec(N)))B.push("%");else{if(null===(n=et.placeholder.exec(N)))throw SyntaxError("[sprintf] unexpected placeholder");if(n[2]){eo|=1;var el=[],eu=n[2],ec=[];if(null===(ec=et.key.exec(eu)))throw SyntaxError("[sprintf] failed to parse named argument key");for(el.push(ec[1]);""!==(eu=eu.substring(ec[0].length));)if(null!==(ec=et.key_access.exec(eu)))el.push(ec[1]);else{if(null===(ec=et.index_access.exec(eu)))throw SyntaxError("[sprintf] failed to parse named argument key");el.push(ec[1])}n[2]=el}else eo|=2;if(3===eo)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");B.push(n)}N=N.substring(n[0].length)}return ei[e]=B}(e),arguments)}function i(e,n){return a.apply(null,[e].concat(n||[]))}var ei=Object.create(null);n.sprintf=a,n.vsprintf=i,"u">typeof window&&(window.sprintf=a,window.vsprintf=i,void 0===(B=(function(){return{sprintf:a,vsprintf:i}}).call(n,N,n,e))||(e.exports=B))}()},function(e,n,N){let{lua_pop:B}=N(2),{luaL_requiref:et}=N(7),{to_luastring:ei}=N(5),eo={};e.exports.luaL_openlibs=function(e){for(let n in eo)et(e,ei(n),eo[n],1),B(e,1)};let el=N(17),{luaopen_base:eu}=N(24),{luaopen_coroutine:ec}=N(25),{luaopen_debug:ef}=N(31),{luaopen_math:eh}=N(30),{luaopen_package:ep}=N(32),{luaopen_os:ed}=N(27),{luaopen_string:e_}=N(28),{luaopen_table:eg}=N(26),{luaopen_utf8:em}=N(29);eo._G=eu,eo[el.LUA_LOADLIBNAME]=ep,eo[el.LUA_COLIBNAME]=ec,eo[el.LUA_TABLIBNAME]=eg,eo[el.LUA_OSLIBNAME]=ed,eo[el.LUA_STRLIBNAME]=e_,eo[el.LUA_MATHLIBNAME]=eh,eo[el.LUA_UTF8LIBNAME]=em,eo[el.LUA_DBLIBNAME]=ef;let{luaopen_fengari:eb}=N(33);eo[el.LUA_FENGARILIBNAME]=eb}]);function gr(e,n){if("boolean"==typeof n)e_.lua.lua_pushboolean(e,n);else if("number"==typeof n)e_.lua.lua_pushnumber(e,n);else if("string"==typeof n)e_.lua.lua_pushstring(e,e_.to_luastring(n));else if(Array.isArray(n))e_.lua.lua_newtable(e),n.forEach((n,N)=>{gr(e,n),e_.lua.lua_rawseti(e,-2,N+1)});else if("object"==typeof n)e_.lua.lua_newtable(e),Object.entries(n).forEach(([n,N])=>{gr(e,N),e_.lua.lua_setfield(e,-2,n)});else throw`unknown type ${typeof n}`}function Qr(e,n){return e_.lua.lua_tojsstring(e,n)}function Os(e,n){e_.lua.lua_pushnil(e);let N={};for(;0!=e_.lua.lua_next(e,-2);)N[Qr(e,-2)]=es(e,-1),e_.lua.lua_pop(e,1);return N}function Ss(e){let n=es(e,-1);return e_.lua.lua_pop(e,1),n}function es(e,n){if(!e_.lua.lua_isnil(e,n)){if(e_.lua.lua_isboolean(e,n))return e_.lua.lua_toboolean(e,n);if(e_.lua.lua_isnumber(e,n))return e_.lua.lua_tonumber(e,n);if(e_.lua.lua_isstring(e,n))return Qr(e,n);if(e_.lua.lua_istable(e,n))return function(e,n){let N=e_.lua.lua_rawlen(e,n);if(0===N)return Os(e);let B=[];for(let n=0;n<N;++n){if(e_.lua.lua_rawgeti(e,-1,n+1),e_.lua.lua_isnil(e,-1))return e_.lua.lua_pop(e,1),Os(e);B.push(es(e,-1)),e_.lua.lua_pop(e,1)}return B}(e,n);throw`unknown type ${e_.lua.lua_typename(e,e_.lua.lua_type(e,n))}`}}function Br(e,n,...N){if(e_.lua.lua_getglobal(e,e_.to_luastring(n,!0)),N.forEach(n=>{gr(e,n)}),e_.lua.lua_call(e,N.length,1)!==e_.lua.LUA_OK){let n=Qr(e,-1);if(n)throw Error(n)}}let ri=class ri{get luaState(){return this._luaState}constructor(e){this._luaState=e}};let ai=class ai{get luaState(){return this._instance.luaState}constructor(e){this._instance=e}saveState(){return Br(this.luaState,"saveState"),Ss(this.luaState)}loadState(e){Br(this.luaState,"loadState",e)}inputs(e){return Br(this.luaState,"inputs",e),Ss(this.luaState)}};let li=class li{constructor(){this._exceptionLogged=!1}get id(){return 0}get label(){return"Agent"}get isBound(){return void 0!==this._vm}get isAgent(){return!0}get isPlayer(){return!1}loadAgent(e){return new Promise(n=>{let s=(e,N,B)=>{let et=function(e,n){switch(e){case"lua":return function(e){let n=function(e){let n=e_.lauxlib.luaL_newstate(),t=function(e,N){gr(n,N),e_.lua.lua_setglobal(n,e_.to_luastring(e))};if(void 0!==e.globals&&Object.entries(e.globals).forEach(([e,n])=>{console.log("register Lua global",e),t(e,n)}),void 0!==e.api&&Object.entries(e.api).forEach(([e,N])=>{console.log("register Lua api",e),e_.lua.lua_register(n,e,n=>{try{return N(n)}catch(n){throw Error(`error in ${e} implementation: ${n}`)}})}),void 0!==e.script&&e_.lauxlib.luaL_dostring(n,e_.to_luastring(e.script))!=e_.lua.LUA_OK){console.error(e_.to_jsstring(e_.lua.lua_tostring(n,-1)));return}return new ri(n)}({script:e});return void 0!==n?new ai(n):void 0}(n);case"javascript":return function(e){let n={},N={exports:n},B=Object.keys(N),et=Function(...B,`${e}
; ${ed.map(e=>`if (typeof ${e} !== "undefined") exports.${e} = ${e}`).join(";")}`);return et(...B.map(e=>N[e])),new Ha(et,n)}(n);default:return}}(e,B);this._agent={language:e,url:N,code:B},this.unloadAgent(),this._vm=et,this._exceptionLogged=!1,n()};void 0!==e.url?fetch(e.url).then(e=>e.text()).then(n=>s(void 0!==e.language?e.language:e.url.endsWith(".lua")?"lua":"javascript",e.url,n)):void 0!==e.script&&s(e.language??"javascript",void 0,e.script)})}unloadAgent(){this._vm=void 0}inputs(e){if(void 0!==this._vm)try{return this._vm.inputs(e)}catch(e){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling inputs",e))}return{}}saveState(){if(void 0!==this._vm)try{return this._vm.saveState()}catch(e){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling saveState",e))}return{}}loadState(e){if(void 0!==this._vm)try{this._vm.loadState(e)}catch(e){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling loadState",e))}}};let Rs=class Rs{get id(){return this._id}get label(){return this._agentController.isBound?this._agentController.label:void 0!==this._inputController?"human":"<>"}get isBound(){return void 0!==this._inputController}get isAgent(){return this._agentController.isBound}get isPlayer(){return this.isBound&&!this.isAgent}constructor(e,n){this._id=e,this._inputController=n,this._agentController=new li}inputs(e){return this._agentController.isBound?this._agentController.inputs(e):void 0!==this._inputController?this._inputController.inputs:{}}loadAgent(e){return this._agentController.loadAgent(e)}unloadAgent(){this._agentController.unloadAgent()}saveState(){return this._agentController.saveState()}loadState(e){this._agentController.loadState(e)}};let ui=class ui{constructor(e){this._controllers=new Map,this._controllersArray=[new Rs(0,e.inputController()),new Rs(1)],this._controllers.set(0,this._controllersArray[0]),this._controllers.set(1,this._controllersArray[1])}get ids(){return[...this._controllers.keys()]}get controllers(){return this._controllers}get(e){return this._controllers.get(e)}inputs(e){return this._controllersArray.map(n=>({label:n.label,isBound:n.isBound,isPlayer:n.isPlayer,isAgent:n.isAgent,inputs:n.inputs(e)}))}saveState(){return[this._controllers.get(0).saveState(),this._controllers.get(1).saveState()]}loadState(e){this._controllers.get(0).loadState(e),this._controllers.get(1).loadState(e)}};let tr=class tr{constructor(e,n){this._el=document.createElement("div"),this._el.style.boxSizing="border-box",this._el.style.display="block",this._el.style.position="absolute",this._el.style.width="32px",this._el.style.height="32px",this._el.style.margin="4px",this._el.style.border="4px solid #fff",this._el.style.borderRadius="50%",this._el.style.animation="moroboxai-spinner-rotate 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite",this._el.style.borderColor="#fff transparent transparent transparent",void 0!==n&&(this._el.style.animationDelay=`-${n}s`),e.appendChild(this._el)}};let ci=class ci{constructor(e){this._el=document.createElement("div"),this._el.style.display="inline-block",this._el.style.position="relative",this._el.style.width="40px",this._el.style.height="40px",new tr(this._el,.45),new tr(this._el,.3),new tr(this._el,.15),new tr(this._el),e.appendChild(this._el);let n=document.getElementById("moroboxai-dynamic-style");n||((n=document.createElement("style")).id="moroboxai-dynamic-style",document.body.appendChild(n)),n.innerHTML=`@keyframes moroboxai-spinner-rotate {
   0% {
      transform: rotate(0deg);
   }
   100% {
      transform: rotate(360deg);
   }
}`}remove(){this._el.remove()}};let ts=class ts{get style(){return this.el.style}constructor(e){this.el=document.createElement("div"),this.el.style.width="100%",this.el.style.height="100%",this.el.style.position="absolute",this.el.style.left="0",this.el.style.top="0",this.el.style.display="flex",this.el.style.flexDirection="column",this.el.style.justifyContent="center",this.el.style.alignItems="center",e.appendChild(this.el)}show(){this.el.style.display="flex"}hide(){this.el.style.display="none"}remove(){this.el.remove()}};let fi=class fi{constructor(e){this._overlay=new ts(e),this._input=document.createElement("input"),this._input.type="button",this._input.value="Play",this._input.onclick=()=>{this.onPlay&&this.onPlay()},this._overlay.el.appendChild(this._input),e.appendChild(this._overlay.el)}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){}mouseMove(){}mouseLeave(){}remove(){this._overlay.remove()}};let hi=class hi{constructor(e){this._overlay=new ts(e),this._overlay.style.backgroundColor="black",new ci(this._overlay.el),e.appendChild(this._overlay.el)}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){}mouseMove(){}mouseLeave(){}remove(){this._overlay.remove()}};let pi=class pi{constructor(e){this._overlay=new ts(e),this._speed1=document.createElement("input"),this._speed1.type="button",this._speed1.value="x1",this._speed1.onclick=()=>{this.onSpeed&&this.onSpeed(1)},this._speed2=document.createElement("input"),this._speed2.type="button",this._speed2.value="x2",this._speed2.onclick=()=>{this.onSpeed&&this.onSpeed(2)},this._speed4=document.createElement("input"),this._speed4.type="button",this._speed4.value="x4",this._speed4.onclick=()=>{this.onSpeed&&this.onSpeed(4)},this._overlay.el.appendChild(this._speed1),this._overlay.el.appendChild(this._speed2),this._overlay.el.appendChild(this._speed4),this._overlay.hide(),e.appendChild(this._overlay.el)}playing(){}paused(){}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){this.show()}mouseMove(){}mouseLeave(){this.hide()}remove(){this._overlay.remove()}};let di=class di{constructor(e){this._root=e,this._playOverlay=new fi(e),this._selectedOverlay=this._playOverlay,this._playOverlay.onPlay=()=>{this.onPlay&&this.onPlay()},this._loadingOverlay=new hi(this._root),this._loadingOverlay.hide(),this._settingsOverlay=new pi(this._root),this._settingsOverlay.hide(),this._settingsOverlay.onSpeed=e=>{this.onSpeed&&this.onSpeed(e)}}stopped(){this._selectedOverlay.hide(),this._selectedOverlay=this._playOverlay,this._playOverlay.show()}loading(){this._playOverlay.hide(),this._selectedOverlay=this._loadingOverlay,this._loadingOverlay.show()}playing(){this._loadingOverlay.hide(),this._selectedOverlay=this._settingsOverlay,this._settingsOverlay.hide(),this._settingsOverlay.playing()}paused(){this._settingsOverlay.paused()}show(){}hide(){}mouseEnter(){this._selectedOverlay.mouseEnter()}mouseMove(){this._selectedOverlay.mouseMove()}mouseLeave(){this._selectedOverlay.mouseLeave()}remove(){this._playOverlay.remove(),this._loadingOverlay.remove(),this._settingsOverlay.remove()}};let vi=class vi{constructor(e,n,N){this.sortedPlugins=new Map,this.unfulfilledActions=new Set,this.plugins=[...N?N.plugins:[],...n],this.pluginContexts=new Map(this.plugins.map(n=>[n,e]))}hookFirst(e,n,N,B){return this.hookFirstAndGetPlugin(e,n,N,B).then(e=>e&&e[0])}async hookFirstAndGetPlugin(e,n,N,B){for(let et of this.getSortedPlugins(e)){if(null!=B&&B.has(et))continue;let ei=await this.runHook(e,n,et,N);if(null!=ei)return[ei,et]}return null}async hookParallel(e,n,N){let B=[];for(let et of this.getSortedPlugins(e))et[e].sequential?(await Promise.all(B),B.length=0,await this.runHook(e,n,et,N)):B.push(this.runHook(e,n,et,N));await Promise.all(B)}hookReduceArg0(e,[n,...N],B,et){let ei=Promise.resolve(n);for(let n of this.getSortedPlugins(e))ei=ei.then(ei=>this.runHook(e,[ei,...N],n,et).then(e=>B.call(this.pluginContexts.get(n),ei,e,n)));return ei}getSortedPlugins(e,n){return function(e,n,N){let B=e.get(n);if(void 0!==B)return B;let et=N();return e.set(n,et),et}(this.sortedPlugins,e,()=>(function(e,n,N=function(e,n,N){if("function"!=typeof e)throw`invalid plugin hook ${n} ${N}`}){let B=[],et=[],ei=[];for(let eo of n){let n=eo[e];if(n){if("object"==typeof n){if(N(n.handler,e,eo),"pre"===n.order){B.push(eo);continue}if("post"===n.order){ei.push(eo);continue}}else N(n,e,eo);et.push(eo)}}return[...B,...et,...ei]})(e,this.plugins,n))}runHook(e,n,N,B){let et=N[e],ei="object"==typeof et?et.handler:et,eo=this.pluginContexts.get(N);B&&(eo=B(eo,N));let el=null;return Promise.resolve().then(()=>{if("function"!=typeof ei)return ei;let B=ei.apply(eo,n);return null!=B&&B.then?(el=[N.name,e,n],this.unfulfilledActions.add(el),Promise.resolve(B).then(e=>(this.unfulfilledActions.delete(el),e))):B}).catch(e=>{throw null!==el&&this.unfulfilledActions.delete(el),e})}};let eg=Symbol.for("yaml.alias"),em=Symbol.for("yaml.document"),eb=Symbol.for("yaml.map"),ey=Symbol.for("yaml.pair"),ev=Symbol.for("yaml.scalar"),ek=Symbol.for("yaml.seq"),eA=Symbol.for("yaml.node.type"),An=e=>!!e&&"object"==typeof e&&e[eA]===eg,Cn=e=>!!e&&"object"==typeof e&&e[eA]===em,Bn=e=>!!e&&"object"==typeof e&&e[eA]===eb,zt=e=>!!e&&"object"==typeof e&&e[eA]===ey,Vt=e=>!!e&&"object"==typeof e&&e[eA]===ev,Mn=e=>!!e&&"object"==typeof e&&e[eA]===ek;function Kt(e){if(e&&"object"==typeof e)switch(e[eA]){case eb:case ek:return!0}return!1}function $t(e){if(e&&"object"==typeof e)switch(e[eA]){case eg:case eb:case ev:case ek:return!0}return!1}let Li=e=>(Vt(e)||Kt(e))&&!!e.anchor,eL=Symbol("break visit"),ex=Symbol("skip children"),ew=Symbol("remove node");function gn(e,n){let N=Zs(n);Cn(e)?xn(null,e.contents,N,Object.freeze([e]))===ew&&(e.contents=null):xn(null,e,N,Object.freeze([]))}function xn(e,n,N,B){let et=qs(e,n,N,B);if($t(et)||zt(et))return Ws(e,B,et),xn(e,et,N,B);if("symbol"!=typeof et){if(Kt(n)){B=Object.freeze(B.concat(n));for(let e=0;e<n.items.length;++e){let et=xn(e,n.items[e],N,B);if("number"==typeof et)e=et-1;else{if(et===eL)return eL;et===ew&&(n.items.splice(e,1),e-=1)}}}else if(zt(n)){B=Object.freeze(B.concat(n));let e=xn("key",n.key,N,B);if(e===eL)return eL;e===ew&&(n.key=null);let et=xn("value",n.value,N,B);if(et===eL)return eL;et===ew&&(n.value=null)}}return et}async function mr(e,n){let N=Zs(n);Cn(e)?await En(null,e.contents,N,Object.freeze([e]))===ew&&(e.contents=null):await En(null,e,N,Object.freeze([]))}async function En(e,n,N,B){let et=await qs(e,n,N,B);if($t(et)||zt(et))return Ws(e,B,et),En(e,et,N,B);if("symbol"!=typeof et){if(Kt(n)){B=Object.freeze(B.concat(n));for(let e=0;e<n.items.length;++e){let et=await En(e,n.items[e],N,B);if("number"==typeof et)e=et-1;else{if(et===eL)return eL;et===ew&&(n.items.splice(e,1),e-=1)}}}else if(zt(n)){B=Object.freeze(B.concat(n));let e=await En("key",n.key,N,B);if(e===eL)return eL;e===ew&&(n.key=null);let et=await En("value",n.value,N,B);if(et===eL)return eL;et===ew&&(n.value=null)}}return et}function Zs(e){return"object"==typeof e&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function qs(e,n,N,B){var et,ei,eo,el,eu;return"function"==typeof N?N(e,n,B):Bn(n)?null==(et=N.Map)?void 0:et.call(N,e,n,B):Mn(n)?null==(ei=N.Seq)?void 0:ei.call(N,e,n,B):zt(n)?null==(eo=N.Pair)?void 0:eo.call(N,e,n,B):Vt(n)?null==(el=N.Scalar)?void 0:el.call(N,e,n,B):An(n)?null==(eu=N.Alias)?void 0:eu.call(N,e,n,B):void 0}function Ws(e,n,N){let B=n[n.length-1];if(Kt(B))B.items[e]=N;else if(zt(B))"key"===e?B.key=N:B.value=N;else if(Cn(B))B.contents=N;else{let e=An(B)?"alias":"scalar";throw Error(`Cannot replace node with ${e} parent`)}}gn.BREAK=eL,gn.SKIP=ex,gn.REMOVE=ew,mr.BREAK=eL,mr.SKIP=ex,mr.REMOVE=ew;let eT={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},wi=e=>e.replace(/[!,[\]{}]/g,e=>eT[e]);let Wt=class Wt{constructor(e,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Wt.defaultYaml,e),this.tags=Object.assign({},Wt.defaultTags,n)}clone(){let e=new Wt(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){let e=new Wt(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Wt.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Wt.defaultTags)}return e}add(e,n){this.atNextDocument&&(this.yaml={explicit:Wt.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Wt.defaultTags),this.atNextDocument=!1);let N=e.trim().split(/[ \t]+/),B=N.shift();switch(B){case"%TAG":{if(2!==N.length&&(n(0,"%TAG directive should contain exactly two parts"),N.length<2))return!1;let[e,B]=N;return this.tags[e]=B,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==N.length)return n(0,"%YAML directive should contain exactly one part"),!1;let[e]=N;if("1.1"===e||"1.2"===e)return this.yaml.version=e,!0;{let N=/^\d+\.\d+$/.test(e);return n(6,`Unsupported YAML version ${e}`,N),!1}}default:return n(0,`Unknown directive ${B}`,!0),!1}}tagName(e,n){if("!"===e)return"!";if("!"!==e[0])return n(`Not a valid tag: ${e}`),null;if("<"===e[1]){let N=e.slice(2,-1);return"!"===N||"!!"===N?(n(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(">"!==e[e.length-1]&&n("Verbatim tags must end with a >"),N)}let[,N,B]=e.match(/^(.*!)([^!]*)$/);B||n(`The ${e} tag has no suffix`);let et=this.tags[N];if(et)try{return et+decodeURIComponent(B)}catch(e){return n(String(e)),null}return"!"===N?e:(n(`Could not resolve tag: ${e}`),null)}tagString(e){for(let[n,N]of Object.entries(this.tags))if(e.startsWith(N))return n+wi(e.substring(N.length));return"!"===e[0]?e:`!<${e}>`}toString(e){let n;let N=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],B=Object.entries(this.tags);if(e&&B.length>0&&$t(e.contents)){let N={};gn(e.contents,(e,n)=>{$t(n)&&n.tag&&(N[n.tag]=!0)}),n=Object.keys(N)}else n=[];for(let[et,ei]of B)"!!"===et&&"tag:yaml.org,2002:"===ei||(!e||n.some(e=>e.startsWith(ei)))&&N.push(`%TAG ${et} ${ei}`);return N.join(`
`)}};function Js(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){let n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(e)}`;throw Error(n)}return!0}function Qs(e){let n=new Set;return gn(e,{Value(e,N){N.anchor&&n.add(N.anchor)}}),n}function ea(e,n){for(let N=1;;++N){let B=`${e}${N}`;if(!n.has(B))return B}}function On(e,n,N,B){if(B&&"object"==typeof B){if(Array.isArray(B))for(let n=0,N=B.length;n<N;++n){let N=B[n],et=On(e,B,String(n),N);void 0===et?delete B[n]:et!==N&&(B[n]=et)}else if(B instanceof Map)for(let n of Array.from(B.keys())){let N=B.get(n),et=On(e,B,n,N);void 0===et?B.delete(n):et!==N&&B.set(n,et)}else if(B instanceof Set)for(let n of Array.from(B)){let N=On(e,B,n,n);void 0===N?B.delete(n):N!==n&&(B.delete(n),B.add(N))}else for(let[n,N]of Object.entries(B)){let et=On(e,B,n,N);void 0===et?delete B[n]:et!==N&&(B[n]=et)}}return e.call(n,N,B)}function nn(e,n,N){if(Array.isArray(e))return e.map((e,n)=>nn(e,String(n),N));if(e&&"function"==typeof e.toJSON){if(!N||!Li(e))return e.toJSON(n,N);let B={aliasCount:0,count:1,res:void 0};N.anchors.set(e,B),N.onCreate=e=>{B.res=e,delete N.onCreate};let et=e.toJSON(n,N);return N.onCreate&&N.onCreate(et),et}return"bigint"!=typeof e||null!=N&&N.keep?e:Number(e)}Wt.defaultYaml={explicit:!1,version:"1.2"},Wt.defaultTags={"!!":"tag:yaml.org,2002:"};let rs=class rs{constructor(e){Object.defineProperty(this,eA,{value:e})}clone(){let e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:n,maxAliasCount:N,onAnchor:B,reviver:et}={}){if(!Cn(e))throw TypeError("A document argument is required");let ei={anchors:new Map,doc:e,keep:!0,mapAsMap:!0===n,mapKeyWarned:!1,maxAliasCount:"number"==typeof N?N:100},eo=nn(this,"",ei);if("function"==typeof B)for(let{count:e,res:n}of ei.anchors.values())B(n,e);return"function"==typeof et?On(et,{"":eo},"",eo):eo}};let br=class br extends rs{constructor(e){super(eg),this.source=e,Object.defineProperty(this,"tag",{set(){throw Error("Alias nodes cannot have tags")}})}resolve(e){let n;return gn(e,{Node:(e,N)=>{if(N===this)return gn.BREAK;N.anchor===this.source&&(n=N)}}),n}toJSON(e,n){if(!n)return{source:this.source};let{anchors:N,doc:B,maxAliasCount:et}=n,ei=this.resolve(B);if(!ei){let e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw ReferenceError(e)}let eo=N.get(ei);if(eo||(nn(ei,null,n),eo=N.get(ei)),!eo||void 0===eo.res)throw ReferenceError("This should not happen: Alias anchor was not resolved?");if(et>=0&&(eo.count+=1,0===eo.aliasCount&&(eo.aliasCount=function lr(e,n,N){if(An(n)){let B=n.resolve(e),et=N&&B&&N.get(B);return et?et.count*et.aliasCount:0}if(Kt(n)){let B=0;for(let et of n.items){let n=lr(e,et,N);n>B&&(B=n)}return B}if(zt(n)){let B=lr(e,n.key,N),et=lr(e,n.value,N);return Math.max(B,et)}return 1}(B,ei,N)),eo.count*eo.aliasCount>et))throw ReferenceError("Excessive alias count indicates a resource exhaustion attack");return eo.res}toString(e,n,N){let B=`*${this.source}`;if(e){if(Js(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){let e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw Error(e)}if(e.implicitKey)return`${B} `}return B}};let ta=e=>!e||"function"!=typeof e&&"object"!=typeof e;let It=class It extends rs{constructor(e){super(ev),this.value=e}toJSON(e,n){return null!=n&&n.keep?this.value:nn(this.value,e,n)}toString(){return String(this.value)}};function Yn(e,n,N){var B,et,ei;let eo;if(Cn(e)&&(e=e.contents),$t(e))return e;if(zt(e)){let n=null==(et=(B=N.schema[eb]).createNode)?void 0:et.call(B,N.schema,null,N);return n.items.push(e),n}(e instanceof String||e instanceof Number||e instanceof Boolean||"u">typeof BigInt&&e instanceof BigInt)&&(e=e.valueOf());let{aliasDuplicateObjects:el,onAnchor:eu,onTagObj:ec,schema:ef,sourceObjects:eh}=N;if(el&&e&&"object"==typeof e){if(eo=eh.get(e))return eo.anchor||(eo.anchor=eu(e)),new br(eo.anchor);eo={anchor:null,node:null},eh.set(e,eo)}null!=n&&n.startsWith("!!")&&(n="tag:yaml.org,2002:"+n.slice(2));let ep=function(e,n,N){if(n){let e=N.filter(e=>e.tag===n),B=e.find(e=>!e.format)??e[0];if(!B)throw Error(`Tag ${n} not found`);return B}return N.find(n=>{var N;return(null==(N=n.identify)?void 0:N.call(n,e))&&!n.format})}(e,n,ef.tags);if(!ep){if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),!e||"object"!=typeof e){let n=new It(e);return eo&&(eo.node=n),n}ep=e instanceof Map?ef[eb]:Symbol.iterator in Object(e)?ef[ek]:ef[eb]}ec&&(ec(ep),delete N.onTagObj);let ed=null!=ep&&ep.createNode?ep.createNode(N.schema,e,N):"function"==typeof(null==(ei=null==ep?void 0:ep.nodeClass)?void 0:ei.from)?ep.nodeClass.from(N.schema,e,N):new It(e);return n?ed.tag=n:ep.default||(ed.tag=ep.tag),eo&&(eo.node=ed),ed}function hr(e,n,N){let B=N;for(let e=n.length-1;e>=0;--e){let N=n[e];if("number"==typeof N&&Number.isInteger(N)&&N>=0){let e=[];e[N]=B,B=e}else B=new Map([[N,B]])}return Yn(B,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}It.BLOCK_FOLDED="BLOCK_FOLDED",It.BLOCK_LITERAL="BLOCK_LITERAL",It.PLAIN="PLAIN",It.QUOTE_DOUBLE="QUOTE_DOUBLE",It.QUOTE_SINGLE="QUOTE_SINGLE";let $n=e=>null==e||"object"==typeof e&&!!e[Symbol.iterator]().next().done;let vr=class vr extends rs{constructor(e,n){super(e),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(e){let n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(n.schema=e),n.items=n.items.map(n=>$t(n)||zt(n)?n.clone(e):n),this.range&&(n.range=this.range.slice()),n}addIn(e,n){if($n(e))this.add(n);else{let[N,...B]=e,et=this.get(N,!0);if(Kt(et))et.addIn(B,n);else if(void 0===et&&this.schema)this.set(N,hr(this.schema,B,n));else throw Error(`Expected YAML collection at ${N}. Remaining path: ${B}`)}}deleteIn(e){let[n,...N]=e;if(0===N.length)return this.delete(n);let B=this.get(n,!0);if(Kt(B))return B.deleteIn(N);throw Error(`Expected YAML collection at ${n}. Remaining path: ${N}`)}getIn(e,n){let[N,...B]=e,et=this.get(N,!0);return 0===B.length?!n&&Vt(et)?et.value:et:Kt(et)?et.getIn(B,n):void 0}hasAllNullValues(e){return this.items.every(n=>{if(!zt(n))return!1;let N=n.value;return null==N||e&&Vt(N)&&null==N.value&&!N.commentBefore&&!N.comment&&!N.tag})}hasIn(e){let[n,...N]=e;if(0===N.length)return this.has(n);let B=this.get(n,!0);return!!Kt(B)&&B.hasIn(N)}setIn(e,n){let[N,...B]=e;if(0===B.length)this.set(N,n);else{let e=this.get(N,!0);if(Kt(e))e.setIn(B,n);else if(void 0===e&&this.schema)this.set(N,hr(this.schema,B,n));else throw Error(`Expected YAML collection at ${N}. Remaining path: ${B}`)}}};vr.maxFlowStringSingleLineLength=60;let Oi=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function fn(e,n){return/^\n+$/.test(e)?e.substring(1):n?e.replace(/^(?! *$)/gm,n):e}let dn=(e,n,N)=>e.endsWith(`
`)?fn(N,n):N.includes(`
`)?`
`+fn(N,n):(e.endsWith(" ")?"":" ")+N,eO="flow",eE="block",eS="quoted";function yr(e,n,N="flow",{indentAtStart:B,lineWidth:et=80,minContentWidth:ei=20,onFold:eo,onOverflow:el}={}){if(!et||et<0)return e;let eu=Math.max(1+ei,1+et-n.length);if(e.length<=eu)return e;let ec=[],ef={},eh=et-n.length;"number"==typeof B&&(B>et-Math.max(2,ei)?ec.push(0):eh=et-B);let ep,ed,e_=!1,eg=-1,em=-1,eb=-1;N===eE&&-1!==(eg=Us(e,eg))&&(eh=eg+eu);for(let n;n=e[eg+=1];){if(N===eS&&"\\"===n){switch(em=eg,e[eg+1]){case"x":eg+=3;break;case"u":eg+=5;break;case"U":eg+=9;break;default:eg+=1}eb=eg}if(n===`
`)N===eE&&(eg=Us(e,eg)),eh=eg+eu,ep=void 0;else{if(" "===n&&ed&&" "!==ed&&ed!==`
`&&"	"!==ed){let n=e[eg+1];n&&" "!==n&&n!==`
`&&"	"!==n&&(ep=eg)}if(eg>=eh){if(ep)ec.push(ep),eh=ep+eu,ep=void 0;else if(N===eS){for(;" "===ed||"	"===ed;)ed=n,n=e[eg+=1],e_=!0;let N=eg>eb+1?eg-2:em-1;if(ef[N])return e;ec.push(N),ef[N]=!0,eh=N+eu,ep=void 0}else e_=!0}}ed=n}if(e_&&el&&el(),0===ec.length)return e;eo&&eo();let ey=e.slice(0,ec[0]);for(let B=0;B<ec.length;++B){let et=ec[B],ei=ec[B+1]||e.length;0===et?ey=`
${n}${e.slice(0,ei)}`:(N===eS&&ef[et]&&(ey+=`${e[et]}\\`),ey+=`
${n}${e.slice(et+1,ei)}`)}return ey}function Us(e,n){let N=e[n+1];for(;" "===N||"	"===N;){do N=e[n+=1];while(N&&N!==`
`);N=e[n+1]}return n}let kr=(e,n)=>({indentAtStart:n?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),Lr=e=>/^(%|---|\.\.\.)/m.test(e);function Xn(e,n){let N=JSON.stringify(e);if(n.options.doubleQuotedAsJSON)return N;let{implicitKey:B}=n,et=n.options.doubleQuotedMinMultiLineLength,ei=n.indent||(Lr(e)?"  ":""),eo="",el=0;for(let e=0,n=N[e];n;n=N[++e])if(" "===n&&"\\"===N[e+1]&&"n"===N[e+2]&&(eo+=N.slice(el,e)+"\\ ",e+=1,el=e,n="\\"),"\\"===n)switch(N[e+1]){case"u":{eo+=N.slice(el,e);let n=N.substr(e+2,4);switch(n){case"0000":eo+="\\0";break;case"0007":eo+="\\a";break;case"000b":eo+="\\v";break;case"001b":eo+="\\e";break;case"0085":eo+="\\N";break;case"00a0":eo+="\\_";break;case"2028":eo+="\\L";break;case"2029":eo+="\\P";break;default:"00"===n.substr(0,2)?eo+="\\x"+n.substr(2):eo+=N.substr(e,6)}e+=5,el=e+1}break;case"n":if(B||'"'===N[e+2]||N.length<et)e+=1;else{for(eo+=N.slice(el,e)+`

`;"\\"===N[e+2]&&"n"===N[e+3]&&'"'!==N[e+4];)eo+=`
`,e+=2;eo+=ei," "===N[e+2]&&(eo+="\\"),e+=1,el=e+1}break;default:e+=1}return eo=el?eo+N.slice(el):N,B?eo:yr(eo,ei,eS,kr(n,!1))}function Yr(e,n){if(!1===n.options.singleQuote||n.implicitKey&&e.includes(`
`)||/[ \t]\n|\n[ \t]/.test(e))return Xn(e,n);let N=n.indent||(Lr(e)?"  ":""),B="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&
${N}`)+"'";return n.implicitKey?B:yr(B,N,eO,kr(n,!1))}function Sn(e,n){let N;let{singleQuote:B}=n.options;if(!1===B)N=Xn;else{let n=e.includes('"'),et=e.includes("'");N=n&&!et?Yr:et&&!n?Xn:B?Yr:Xn}return N(e,n)}try{B=RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{B=/\n+(?!\n|$)/g}function cr({comment:e,type:n,value:N},et,ei,eo){let el,eu;let{blockQuote:ec,commentString:ef,lineWidth:eh}=et.options;if(!ec||/\n[\t ]+$/.test(N)||/^\s*$/.test(N))return Sn(N,et);let ep=et.indent||(et.forceBlockIndent||Lr(N)?"  ":""),ed="literal"===ec||"folded"!==ec&&n!==It.BLOCK_FOLDED&&(n===It.BLOCK_LITERAL||!function(e,n,N){if(!n||n<0)return!1;let B=n-N,et=e.length;if(et<=B)return!1;for(let n=0,N=0;n<et;++n)if(e[n]===`
`){if(n-N>B)return!0;if(et-(N=n+1)<=B)return!1}return!0}(N,eh,ep.length));if(!N)return ed?`|
`:`>
`;for(eu=N.length;eu>0;--eu){let e=N[eu-1];if(e!==`
`&&"	"!==e&&" "!==e)break}let e_=N.substring(eu),eg=e_.indexOf(`
`);-1===eg?el="-":N===e_||eg!==e_.length-1?(el="+",eo&&eo()):el="",e_&&(N=N.slice(0,-e_.length),e_[e_.length-1]===`
`&&(e_=e_.slice(0,-1)),e_=e_.replace(B,`$&${ep}`));let em=!1,eb,ey=-1;for(eb=0;eb<N.length;++eb){let e=N[eb];if(" "===e)em=!0;else if(e===`
`)ey=eb;else break}let ev=N.substring(0,ey<eb?ey+1:eb);ev&&(N=N.substring(ev.length),ev=ev.replace(/\n+/g,`$&${ep}`));let ek=(ed?"|":">")+(em?ep?"2":"1":"")+el;if(e&&(ek+=" "+ef(e.replace(/ ?[\r\n]+/g," ")),ei&&ei()),ed)return N=N.replace(/\n+/g,`$&${ep}`),`${ek}
${ep}${ev}${N}${e_}`;N=N.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${ep}`);let eA=yr(`${ev}${N}${e_}`,ep,eE,kr(et,!0));return`${ek}
${ep}${eA}`}function Wn(e,n,N,B){let{implicitKey:et,inFlow:ei}=n,eo="string"==typeof e.value?e:Object.assign({},e,{value:String(e.value)}),{type:el}=e;el!==It.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(eo.value)&&(el=It.QUOTE_DOUBLE);let u=e=>{switch(e){case It.BLOCK_FOLDED:case It.BLOCK_LITERAL:return et||ei?Sn(eo.value,n):cr(eo,n,N,B);case It.QUOTE_DOUBLE:return Xn(eo.value,n);case It.QUOTE_SINGLE:return Yr(eo.value,n);case It.PLAIN:return function(e,n,N,B){let{type:et,value:ei}=e,{actualString:eo,implicitKey:el,indent:eu,indentStep:ec,inFlow:ef}=n;if(el&&ei.includes(`
`)||ef&&/[[\]{},]/.test(ei))return Sn(ei,n);if(!ei||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(ei))return el||ef||!ei.includes(`
`)?Sn(ei,n):cr(e,n,N,B);if(!el&&!ef&&et!==It.PLAIN&&ei.includes(`
`))return cr(e,n,N,B);if(Lr(ei)){if(""===eu)return n.forceBlockIndent=!0,cr(e,n,N,B);if(el&&eu===ec)return Sn(ei,n)}let eh=ei.replace(/\n+/g,`$&
${eu}`);if(eo){let L=e=>{var n;return e.default&&"tag:yaml.org,2002:str"!==e.tag&&(null==(n=e.test)?void 0:n.test(eh))},{compat:e,tags:N}=n.doc.schema;if(N.some(L)||null!=e&&e.some(L))return Sn(ei,n)}return el?eh:yr(eh,eu,eO,kr(n,!1))}(eo,n,N,B);default:return null}},eu=u(el);if(null===eu){let{defaultKeyType:e,defaultStringType:N}=n.options,B=et&&e||N;if(null===(eu=u(B)))throw Error(`Unsupported default string type ${B}`)}return eu}function ra(e,n){let N;let B=Object.assign({blockQuote:!0,commentString:Oi,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,n);switch(B.collectionStyle){case"block":N=!1;break;case"flow":N=!0;break;default:N=null}return{anchors:new Set,doc:e,flowCollectionPadding:B.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof B.indent?" ".repeat(B.indent):"  ",inFlow:N,options:B}}function Un(e,n,N,B){var et;let ei;if(zt(e))return e.toString(n,N,B);if(An(e)){if(n.doc.directives)return e.toString(n);if(null!=(et=n.resolvedAliases)&&et.has(e))throw TypeError("Cannot stringify circular structure without alias nodes");n.resolvedAliases?n.resolvedAliases.add(e):n.resolvedAliases=new Set([e]),e=e.resolve(n.doc)}let eo=$t(e)?e:n.doc.createNode(e,{onTagObj:e=>ei=e});ei||(ei=function(e,n){var N;let B,et;if(n.tag){let N=e.filter(e=>e.tag===n.tag);if(N.length>0)return N.find(e=>e.format===n.format)??N[0]}if(Vt(n)){et=n.value;let N=e.filter(e=>{var n;return null==(n=e.identify)?void 0:n.call(e,et)});B=N.find(e=>e.format===n.format)??N.find(e=>!e.format)}else et=n,B=e.find(e=>e.nodeClass&&et instanceof e.nodeClass);if(!B){let e=(null==(N=null==et?void 0:et.constructor)?void 0:N.name)??typeof et;throw Error(`Tag not resolved for ${e} value`)}return B}(n.doc.schema.tags,eo));let el=function(e,n,{anchors:N,doc:B}){if(!B.directives)return"";let et=[],ei=(Vt(e)||Kt(e))&&e.anchor;ei&&Js(ei)&&(N.add(ei),et.push(`&${ei}`));let eo=e.tag?e.tag:n.default?null:n.tag;return eo&&et.push(B.directives.tagString(eo)),et.join(" ")}(eo,ei,n);el.length>0&&(n.indentAtStart=(n.indentAtStart??0)+el.length+1);let eu="function"==typeof ei.stringify?ei.stringify(eo,n,N,B):Vt(eo)?Wn(eo,n,N,B):eo.toString(n,N,B);return el?Vt(eo)||"{"===eu[0]||"["===eu[0]?`${el} ${eu}`:`${el}
${n.indent}${eu}`:eu}function sa(e,n){("debug"===e||"warn"===e)&&("u">typeof eu&&eu.emitWarning?eu.emitWarning(n):console.warn(n))}function aa(e,n,{key:N,value:B}){if(null!=e&&e.doc.schema.merge&&Pi(N)){if(Mn(B=An(B)?B.resolve(e.doc):B))for(let N of B.items)Mr(e,n,N);else if(Array.isArray(B))for(let N of B)Mr(e,n,N);else Mr(e,n,B)}else{let et=nn(N,"",e);if(n instanceof Map)n.set(et,nn(B,et,e));else if(n instanceof Set)n.add(et);else{let ei=function(e,n,N){if(null===n)return"";if("object"!=typeof n)return String(n);if($t(e)&&null!=N&&N.doc){let n=ra(N.doc,{});for(let e of(n.anchors=new Set,N.anchors.keys()))n.anchors.add(e.anchor);n.inFlow=!0,n.inStringifyKey=!0;let B=e.toString(n);if(!N.mapKeyWarned){let e=JSON.stringify(B);e.length>40&&(e=e.substring(0,36)+'..."'),sa(N.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${e}. Set mapAsMap: true to use object keys.`),N.mapKeyWarned=!0}return B}return JSON.stringify(n)}(N,et,e),eo=nn(B,ei,e);ei in n?Object.defineProperty(n,ei,{value:eo,writable:!0,enumerable:!0,configurable:!0}):n[ei]=eo}}return n}let Pi=e=>"<<"===e||Vt(e)&&"<<"===e.value&&(!e.type||e.type===It.PLAIN);function Mr(e,n,N){let B=e&&An(N)?N.resolve(e.doc):N;if(!Bn(B))throw Error("Merge sources must be maps or map aliases");let et=B.toJSON(null,e,Map);for(let[e,N]of et)n instanceof Map?n.has(e)||n.set(e,N):n instanceof Set?n.add(e):Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(n,e,{value:N,writable:!0,enumerable:!0,configurable:!0});return n}function ss(e,n,N){let B=Yn(e,void 0,N),et=Yn(n,void 0,N);return new Yt(B,et)}let Yt=class Yt{constructor(e,n=null){Object.defineProperty(this,eA,{value:ey}),this.key=e,this.value=n}clone(e){let{key:n,value:N}=this;return $t(n)&&(n=n.clone(e)),$t(N)&&(N=N.clone(e)),new Yt(n,N)}toJSON(e,n){let N=null!=n&&n.mapAsMap?new Map:{};return aa(n,N,this)}toString(e,n,N){return null!=e&&e.doc?function({key:e,value:n},N,B,et){let ei,eo,el;let{allNullValues:eu,doc:ec,indent:ef,indentStep:eh,options:{commentString:ep,indentSeq:ed,simpleKeys:e_}}=N,eg=$t(e)&&e.comment||null;if(e_){if(eg)throw Error("With simple keys, key nodes cannot have comments");if(Kt(e))throw Error("With simple keys, collection cannot be used as a key value")}let em=!e_&&(!e||eg&&null==n&&!N.inFlow||Kt(e)||(Vt(e)?e.type===It.BLOCK_FOLDED||e.type===It.BLOCK_LITERAL:"object"==typeof e));N=Object.assign({},N,{allNullValues:!1,implicitKey:!em&&(e_||!eu),indent:ef+eh});let eb=!1,ey=!1,ev=Un(e,N,()=>eb=!0,()=>ey=!0);if(!em&&!N.inFlow&&ev.length>1024){if(e_)throw Error("With simple keys, single line scalar must not span more than 1024 characters");em=!0}if(N.inFlow){if(eu||null==n)return eb&&B&&B(),""===ev?"?":em?`? ${ev}`:ev}else if(eu&&!e_||null==n&&em)return ev=`? ${ev}`,eg&&!eb?ev+=dn(ev,N.indent,ep(eg)):ey&&et&&et(),ev;eb&&(eg=null),em?(eg&&(ev+=dn(ev,N.indent,ep(eg))),ev=`? ${ev}
${ef}:`):(ev=`${ev}:`,eg&&(ev+=dn(ev,N.indent,ep(eg)))),$t(n)?(ei=!!n.spaceBefore,eo=n.commentBefore,el=n.comment):(ei=!1,eo=null,el=null,n&&"object"==typeof n&&(n=ec.createNode(n))),N.implicitKey=!1,!em&&!eg&&Vt(n)&&(N.indentAtStart=ev.length+1),ey=!1,!(!ed&&eh.length>=2&&!N.inFlow&&!em&&Mn(n))||n.flow||n.tag||n.anchor||(N.indent=N.indent.substring(2));let ek=!1,eA=Un(n,N,()=>ek=!0,()=>ey=!0),eL=" ";if(eg||ei||eo){if(eL=ei?`
`:"",eo){let e=ep(eo);eL+=`
${fn(e,N.indent)}`}""!==eA||N.inFlow?eL+=`
${N.indent}`:eL===`
`&&(eL=`

`)}else if(!em&&Kt(n)){let e=eA[0],B=eA.indexOf(`
`),et=-1!==B,ei=N.inFlow??n.flow??0===n.items.length;if(et||!ei){let n=!1;if(et&&("&"===e||"!"===e)){let N=eA.indexOf(" ");"&"===e&&-1!==N&&N<B&&"!"===eA[N+1]&&(N=eA.indexOf(" ",N+1)),(-1===N||B<N)&&(n=!0)}n||(eL=`
${N.indent}`)}}else(""===eA||eA[0]===`
`)&&(eL="");return ev+=eL+eA,N.inFlow?ek&&B&&B():el&&!ek?ev+=dn(ev,N.indent,ep(el)):ey&&et&&et(),ev}(this,e,n,N):JSON.stringify(this)}};function ia(e,n,N){return(n.inFlow??e.flow?function({comment:e,items:n},N,{flowChars:B,itemIndent:et,onComment:ei}){let eo;let{indent:el,indentStep:eu,flowCollectionPadding:ec,options:{commentString:ef}}=N;et+=eu;let eh=Object.assign({},N,{indent:et,inFlow:!0,type:null}),ep=!1,ed=0,e_=[];for(let e=0;e<n.length;++e){let B=n[e],ei=null;if($t(B))B.spaceBefore&&e_.push(""),pr(N,e_,B.commentBefore,!1),B.comment&&(ei=B.comment);else if(zt(B)){let e=$t(B.key)?B.key:null;e&&(e.spaceBefore&&e_.push(""),pr(N,e_,e.commentBefore,!1),e.comment&&(ep=!0));let n=$t(B.value)?B.value:null;n?(n.comment&&(ei=n.comment),n.commentBefore&&(ep=!0)):null==B.value&&null!=e&&e.comment&&(ei=e.comment)}ei&&(ep=!0);let eo=Un(B,eh,()=>ei=null);e<n.length-1&&(eo+=","),ei&&(eo+=dn(eo,et,ef(ei))),!ep&&(e_.length>ed||eo.includes(`
`))&&(ep=!0),e_.push(eo),ed=e_.length}let{start:eg,end:em}=B;if(0===e_.length)eo=eg+em;else if(ep||(ep=e_.reduce((e,n)=>e+n.length+2,2)>vr.maxFlowStringSingleLineLength),ep){for(let e of(eo=eg,e_))eo+=e?`
${eu}${el}${e}`:`
`;eo+=`
${el}${em}`}else eo=`${eg}${ec}${e_.join(" ")}${ec}${em}`;return e&&(eo+=dn(eo,el,ef(e)),ei&&ei()),eo}:function({comment:e,items:n},N,{blockItemPrefix:B,flowChars:et,itemIndent:ei,onChompKeep:eo,onComment:el}){let eu;let{indent:ec,options:{commentString:ef}}=N,eh=Object.assign({},N,{indent:ei,type:null}),ep=!1,ed=[];for(let e=0;e<n.length;++e){let et=n[e],eo=null;if($t(et))!ep&&et.spaceBefore&&ed.push(""),pr(N,ed,et.commentBefore,ep),et.comment&&(eo=et.comment);else if(zt(et)){let e=$t(et.key)?et.key:null;e&&(!ep&&e.spaceBefore&&ed.push(""),pr(N,ed,e.commentBefore,ep))}ep=!1;let el=Un(et,eh,()=>eo=null,()=>ep=!0);eo&&(el+=dn(el,ei,ef(eo))),ep&&eo&&(ep=!1),ed.push(B+el)}if(0===ed.length)eu=et.start+et.end;else{eu=ed[0];for(let e=1;e<ed.length;++e){let n=ed[e];eu+=n?`
${ec}${n}`:`
`}}return e?(eu+=`
`+fn(ef(e),ec),el&&el()):ep&&eo&&eo(),eu})(e,n,N)}function pr({indent:e,options:{commentString:n}},N,B,et){if(B&&et&&(B=B.replace(/^\n+/,"")),B){let et=fn(n(B),e);N.push(et.trimStart())}}function yn(e,n){let N=Vt(n)?n.value:n;for(let B of e)if(zt(B)&&(B.key===n||B.key===N||Vt(B.key)&&B.key.value===N))return B}let en=class en extends vr{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(eb,e),this.items=[]}static from(e,n,N){let{keepUndefined:B,replacer:et}=N,ei=new this(e),l=(e,eo)=>{if("function"==typeof et)eo=et.call(n,e,eo);else if(Array.isArray(et)&&!et.includes(e))return;(void 0!==eo||B)&&ei.items.push(ss(e,eo,N))};if(n instanceof Map)for(let[e,N]of n)l(e,N);else if(n&&"object"==typeof n)for(let e of Object.keys(n))l(e,n[e]);return"function"==typeof e.sortMapEntries&&ei.items.sort(e.sortMapEntries),ei}add(e,n){var N;let B;B=zt(e)?e:e&&"object"==typeof e&&"key"in e?new Yt(e.key,e.value):new Yt(e,null==e?void 0:e.value);let et=yn(this.items,B.key),ei=null==(N=this.schema)?void 0:N.sortMapEntries;if(et){if(!n)throw Error(`Key ${B.key} already set`);Vt(et.value)&&ta(B.value)?et.value.value=B.value:et.value=B.value}else if(ei){let e=this.items.findIndex(e=>0>ei(B,e));-1===e?this.items.push(B):this.items.splice(e,0,B)}else this.items.push(B)}delete(e){let n=yn(this.items,e);return!!n&&this.items.splice(this.items.indexOf(n),1).length>0}get(e,n){let N=yn(this.items,e),B=null==N?void 0:N.value;return(!n&&Vt(B)?B.value:B)??void 0}has(e){return!!yn(this.items,e)}set(e,n){this.add(new Yt(e,n),!0)}toJSON(e,n,N){let B=N?new N:null!=n&&n.mapAsMap?new Map:{};for(let e of(null!=n&&n.onCreate&&n.onCreate(B),this.items))aa(n,B,e);return B}toString(e,n,N){if(!e)return JSON.stringify(this);for(let e of this.items)if(!zt(e))throw Error(`Map items must all be pairs; found ${JSON.stringify(e)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),ia(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:N,onComment:n})}};let eN={collection:"map",default:!0,nodeClass:en,tag:"tag:yaml.org,2002:map",resolve:(e,n)=>(Bn(e)||n("Expected a mapping for this tag"),e),createNode:(e,n,N)=>en.from(e,n,N)};let mn=class mn extends vr{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(ek,e),this.items=[]}add(e){this.items.push(e)}delete(e){let n=nr(e);return"number"==typeof n&&this.items.splice(n,1).length>0}get(e,n){let N=nr(e);if("number"!=typeof N)return;let B=this.items[N];return!n&&Vt(B)?B.value:B}has(e){let n=nr(e);return"number"==typeof n&&n<this.items.length}set(e,n){let N=nr(e);if("number"!=typeof N)throw Error(`Expected a valid index, not ${e}.`);let B=this.items[N];Vt(B)&&ta(n)?B.value=n:this.items[N]=n}toJSON(e,n){let N=[];null!=n&&n.onCreate&&n.onCreate(N);let B=0;for(let e of this.items)N.push(nn(e,String(B++),n));return N}toString(e,n,N){return e?ia(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:N,onComment:n}):JSON.stringify(this)}static from(e,n,N){let{replacer:B}=N,et=new this(e);if(n&&Symbol.iterator in Object(n)){let e=0;for(let ei of n){if("function"==typeof B){let N=n instanceof Set?ei:String(e++);ei=B.call(n,N,ei)}et.items.push(Yn(ei,void 0,N))}}return et}};function nr(e){let n=Vt(e)?e.value:e;return n&&"string"==typeof n&&(n=Number(n)),"number"==typeof n&&Number.isInteger(n)&&n>=0?n:null}let eI={collection:"seq",default:!0,nodeClass:mn,tag:"tag:yaml.org,2002:seq",resolve:(e,n)=>(Mn(e)||n("Expected a sequence for this tag"),e),createNode:(e,n,N)=>mn.from(e,n,N)},eR={identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:(e,n,N,B)=>Wn(e,n=Object.assign({actualString:!0},n),N,B)},eU={identify:e=>null==e,createNode:()=>new It(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new It(null),stringify:({source:e},n)=>"string"==typeof e&&eU.test.test(e)?e:n.options.nullStr},eC={identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new It("t"===e[0]||"T"===e[0]),stringify({source:e,value:n},N){if(e&&eC.test.test(e)){let N="t"===e[0]||"T"===e[0];if(n===N)return e}return n?N.options.trueStr:N.options.falseStr}};function an({format:e,minFractionDigits:n,tag:N,value:B}){if("bigint"==typeof B)return String(B);let et="number"==typeof B?B:Number(B);if(!isFinite(et))return isNaN(et)?".nan":et<0?"-.inf":".inf";let ei=JSON.stringify(B);if(!e&&n&&(!N||"tag:yaml.org,2002:float"===N)&&/^\d/.test(ei)){let e=ei.indexOf(".");e<0&&(e=ei.length,ei+=".");let N=n-(ei.length-e-1);for(;N-- >0;)ei+="0"}return ei}let eM={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:an},eP={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){let n=Number(e.value);return isFinite(n)?n.toExponential():an(e)}},eD={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){let n=new It(parseFloat(e)),N=e.indexOf(".");return -1!==N&&"0"===e[e.length-1]&&(n.minFractionDigits=e.length-N-1),n},stringify:an},Tr=e=>"bigint"==typeof e||Number.isInteger(e),is=(e,n,N,{intAsBigInt:B})=>B?BigInt(e):parseInt(e.substring(n),N);function ca(e,n,N){let{value:B}=e;return Tr(B)&&B>=0?N+B.toString(n):an(e)}let eB={identify:e=>Tr(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,n,N)=>is(e,2,8,N),stringify:e=>ca(e,8,"0o")},eK={identify:Tr,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,n,N)=>is(e,0,10,N),stringify:an},eG={identify:e=>Tr(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,n,N)=>is(e,2,16,N),stringify:e=>ca(e,16,"0x")},eV=[eN,eI,eR,eU,eC,eB,eK,eG,eM,eP,eD];function Ps(e){return"bigint"==typeof e||Number.isInteger(e)}let rr=({value:e})=>JSON.stringify(e),eF=[{identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:rr},{identify:e=>null==e,createNode:()=>new It(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:rr},{identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:e=>"true"===e,stringify:rr},{identify:Ps,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,n,{intAsBigInt:N})=>N?BigInt(e):parseInt(e,10),stringify:({value:e})=>Ps(e)?e.toString():JSON.stringify(e)},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:rr}],ez=[eN,eI].concat(eF,{default:!0,tag:"",test:/^/,resolve:(e,n)=>(n(`Unresolved plain scalar ${JSON.stringify(e)}`),e)}),ej={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,n){if("function"==typeof ec)return ec.from(e,"base64");if("function"!=typeof atob)return n("This environment does not support reading binary tags; either Buffer or atob is required"),e;{let n=atob(e.replace(/[\n\r]/g,"")),N=new Uint8Array(n.length);for(let e=0;e<n.length;++e)N[e]=n.charCodeAt(e);return N}},stringify({comment:e,type:n,value:N},B,et,ei){let eo;if("function"==typeof ec)eo=N instanceof ec?N.toString("base64"):ec.from(N.buffer).toString("base64");else if("function"==typeof btoa){let e="";for(let n=0;n<N.length;++n)e+=String.fromCharCode(N[n]);eo=btoa(e)}else throw Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(n||(n=It.BLOCK_LITERAL),n!==It.QUOTE_DOUBLE){let e=Math.max(B.options.lineWidth-B.indent.length,B.options.minContentWidth),N=Math.ceil(eo.length/e),et=Array(N);for(let n=0,B=0;n<N;++n,B+=e)et[n]=eo.substr(B,e);eo=et.join(n===It.BLOCK_LITERAL?`
`:" ")}return Wn({comment:e,type:n,value:eo},B,et,ei)}};function da(e,n){if(Mn(e))for(let N=0;N<e.items.length;++N){let B=e.items[N];if(!zt(B)){if(Bn(B)){B.items.length>1&&n("Each pair must have its own sequence indicator");let e=B.items[0]||new Yt(new It(null));if(B.commentBefore&&(e.key.commentBefore=e.key.commentBefore?`${B.commentBefore}
${e.key.commentBefore}`:B.commentBefore),B.comment){let n=e.value??e.key;n.comment=n.comment?`${B.comment}
${n.comment}`:B.comment}B=e}e.items[N]=zt(B)?B:new Yt(B)}}else n("Expected a sequence for this tag");return e}function _a(e,n,N){let{replacer:B}=N,et=new mn(e);et.tag="tag:yaml.org,2002:pairs";let ei=0;if(n&&Symbol.iterator in Object(n))for(let e of n){let eo,el;if("function"==typeof B&&(e=B.call(n,String(ei++),e)),Array.isArray(e)){if(2===e.length)eo=e[0],el=e[1];else throw TypeError(`Expected [key, value] tuple: ${e}`)}else if(e&&e instanceof Object){let n=Object.keys(e);if(1===n.length)el=e[eo=n[0]];else throw TypeError(`Expected tuple with one key, not ${n.length} keys`)}else eo=e;et.items.push(ss(eo,el,N))}return et}let eH={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:da,createNode:_a};let Rn=class Rn extends mn{constructor(){super(),this.add=en.prototype.add.bind(this),this.delete=en.prototype.delete.bind(this),this.get=en.prototype.get.bind(this),this.has=en.prototype.has.bind(this),this.set=en.prototype.set.bind(this),this.tag=Rn.tag}toJSON(e,n){if(!n)return super.toJSON(e);let N=new Map;for(let e of(null!=n&&n.onCreate&&n.onCreate(N),this.items)){let B,et;if(zt(e)?(B=nn(e.key,"",n),et=nn(e.value,B,n)):B=nn(e,"",n),N.has(B))throw Error("Ordered maps must not include duplicate keys");N.set(B,et)}return N}static from(e,n,N){let B=_a(e,n,N),et=new this;return et.items=B.items,et}};Rn.tag="tag:yaml.org,2002:omap";let e$={collection:"seq",identify:e=>e instanceof Map,nodeClass:Rn,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,n){let N=da(e,n),B=[];for(let{key:e}of N.items)Vt(e)&&(B.includes(e.value)?n(`Ordered maps must not include duplicate keys: ${e.value}`):B.push(e.value));return Object.assign(new Rn,N)},createNode:(e,n,N)=>Rn.from(e,n,N)};function ga({value:e,source:n},N){return n&&(e?eX:eq).test.test(n)?n:e?N.options.trueStr:N.options.falseStr}let eX={identify:e=>!0===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new It(!0),stringify:ga},eq={identify:e=>!1===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>new It(!1),stringify:ga},Jn=e=>"bigint"==typeof e||Number.isInteger(e);function xr(e,n,N,{intAsBigInt:B}){let et=e[0];if(("-"===et||"+"===et)&&(n+=1),e=e.substring(n).replace(/_/g,""),B){switch(N){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`}let n=BigInt(e);return"-"===et?BigInt(-1)*n:n}let ei=parseInt(e,N);return"-"===et?-1*ei:ei}function cs(e,n,N){let{value:B}=e;if(Jn(B)){let e=B.toString(n);return B<0?"-"+N+e.substr(1):N+e}return an(e)}let Nn=class Nn extends en{constructor(e){super(e),this.tag=Nn.tag}add(e){let n;n=zt(e)?e:e&&"object"==typeof e&&"key"in e&&"value"in e&&null===e.value?new Yt(e.key,null):new Yt(e,null),yn(this.items,n.key)||this.items.push(n)}get(e,n){let N=yn(this.items,e);return!n&&zt(N)?Vt(N.key)?N.key.value:N.key:N}set(e,n){if("boolean"!=typeof n)throw Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);let N=yn(this.items,e);N&&!n?this.items.splice(this.items.indexOf(N),1):!N&&n&&this.items.push(new Yt(e))}toJSON(e,n){return super.toJSON(e,n,Set)}toString(e,n,N){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),n,N);throw Error("Set items must all have null values")}static from(e,n,N){let{replacer:B}=N,et=new this(e);if(n&&Symbol.iterator in Object(n))for(let e of n)"function"==typeof B&&(e=B.call(n,e,e)),et.items.push(ss(e,null,N));return et}};Nn.tag="tag:yaml.org,2002:set";let eW={collection:"map",identify:e=>e instanceof Set,nodeClass:Nn,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,n,N)=>Nn.from(e,n,N),resolve(e,n){if(Bn(e)){if(e.hasAllNullValues(!0))return Object.assign(new Nn,e);n("Set items must all have null values")}else n("Expected a mapping for this tag");return e}};function hs(e,n){let N=e[0],B="-"===N||"+"===N?e.substring(1):e,s=e=>n?BigInt(e):Number(e),et=B.replace(/_/g,"").split(":").reduce((e,n)=>e*s(60)+s(n),s(0));return"-"===N?s(-1)*et:et}function va(e){let{value:n}=e,t=e=>e;if("bigint"==typeof n)t=e=>BigInt(e);else if(isNaN(n)||!isFinite(n))return an(e);let N="";n<0&&(N="-",n*=t(-1));let B=t(60),et=[n%B];return n<60?et.unshift(0):(n=(n-et[0])/B,et.unshift(n%B),n>=60&&(n=(n-et[0])/B,et.unshift(n))),N+et.map(e=>String(e).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}let eZ={identify:e=>"bigint"==typeof e||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,n,{intAsBigInt:N})=>hs(e,N),stringify:va},eY={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>hs(e,!1),stringify:va},eJ={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){let n=e.match(eJ.test);if(!n)throw Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,N,B,et,ei,eo,el]=n.map(Number),eu=n[7]?Number((n[7]+"00").substr(1,3)):0,ec=Date.UTC(N,B-1,et,ei||0,eo||0,el||0,eu),ef=n[8];if(ef&&"Z"!==ef){let e=hs(ef,!1);30>Math.abs(e)&&(e*=60),ec-=6e4*e}return new Date(ec)},stringify:({value:e})=>e.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},eQ=[eN,eI,eR,eU,eX,eq,{identify:Jn,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,n,N)=>xr(e,2,2,N),stringify:e=>cs(e,2,"0b")},{identify:Jn,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,n,N)=>xr(e,1,8,N),stringify:e=>cs(e,8,"0")},{identify:Jn,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,n,N)=>xr(e,0,10,N),stringify:an},{identify:Jn,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,n,N)=>xr(e,2,16,N),stringify:e=>cs(e,16,"0x")},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:an},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){let n=Number(e.value);return isFinite(n)?n.toExponential():an(e)}},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){let n=new It(parseFloat(e.replace(/_/g,""))),N=e.indexOf(".");if(-1!==N){let B=e.substring(N+1).replace(/_/g,"");"0"===B[B.length-1]&&(n.minFractionDigits=B.length)}return n},stringify:an},ej,e$,eH,eW,eZ,eY,eJ],e0=new Map([["core",eV],["failsafe",[eN,eI,eR]],["json",ez],["yaml11",eQ],["yaml-1.1",eQ]]),e1={binary:ej,bool:eC,float:eD,floatExp:eP,floatNaN:eM,floatTime:eY,int:eK,intHex:eG,intOct:eB,intTime:eZ,map:eN,null:eU,omap:e$,pairs:eH,seq:eI,set:eW,timestamp:eJ},e2={"tag:yaml.org,2002:binary":ej,"tag:yaml.org,2002:omap":e$,"tag:yaml.org,2002:pairs":eH,"tag:yaml.org,2002:set":eW,"tag:yaml.org,2002:timestamp":eJ};function jr(e,n){let N=e0.get(n);if(!N){if(Array.isArray(e))N=[];else{let e=Array.from(e0.keys()).filter(e=>"yaml11"!==e).map(e=>JSON.stringify(e)).join(", ");throw Error(`Unknown schema "${n}"; use one of ${e} or define customTags array`)}}if(Array.isArray(e))for(let n of e)N=N.concat(n);else"function"==typeof e&&(N=e(N.slice()));return N.map(e=>{if("string"!=typeof e)return e;let n=e1[e];if(n)return n;let N=Object.keys(e1).map(e=>JSON.stringify(e)).join(", ");throw Error(`Unknown custom tag "${e}"; use one of ${N}`)})}let qi=(e,n)=>e.key<n.key?-1:e.key>n.key?1:0;let Or=class Or{constructor({compat:e,customTags:n,merge:N,resolveKnownTags:B,schema:et,sortMapEntries:ei,toStringDefaults:eo}){this.compat=Array.isArray(e)?jr(e,"compat"):e?jr(null,e):null,this.merge=!!N,this.name="string"==typeof et&&et||"core",this.knownTags=B?e2:{},this.tags=jr(n,this.name),this.toStringOptions=eo??null,Object.defineProperty(this,eb,{value:eN}),Object.defineProperty(this,ev,{value:eR}),Object.defineProperty(this,ek,{value:eI}),this.sortMapEntries="function"==typeof ei?ei:!0===ei?qi:null}clone(){let e=Object.create(Or.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}};let Dn=class Dn{constructor(e,n,N){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,eA,{value:em});let B=null;"function"==typeof n||Array.isArray(n)?B=n:void 0===N&&n&&(N=n,n=void 0);let et=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},N);this.options=et;let{version:ei}=et;null!=N&&N._directives?(this.directives=N._directives.atDocument(),this.directives.yaml.explicit&&(ei=this.directives.yaml.version)):this.directives=new Wt({version:ei}),this.setSchema(ei,N),this.contents=void 0===e?null:this.createNode(e,B,N)}clone(){let e=Object.create(Dn.prototype,{[eA]:{value:em}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=$t(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){wn(this.contents)&&this.contents.add(e)}addIn(e,n){wn(this.contents)&&this.contents.addIn(e,n)}createAlias(e,n){if(!e.anchor){let N=Qs(this);e.anchor=!n||N.has(n)?ea(n||"a",N):n}return new br(e.anchor)}createNode(e,n,N){let B;if("function"==typeof n)e=n.call({"":e},"",e),B=n;else if(Array.isArray(n)){let e=n.filter(e=>"number"==typeof e||e instanceof String||e instanceof Number).map(String);e.length>0&&(n=n.concat(e)),B=n}else void 0===N&&n&&(N=n,n=void 0);let{aliasDuplicateObjects:et,anchorPrefix:ei,flow:eo,keepUndefined:el,onTagObj:eu,tag:ec}=N??{},{onAnchor:ef,setAnchors:eh,sourceObjects:ep}=function(e,n){let N=[],B=new Map,et=null;return{onAnchor:B=>{N.push(B),et||(et=Qs(e));let ei=ea(n,et);return et.add(ei),ei},setAnchors:()=>{for(let e of N){let n=B.get(e);if("object"==typeof n&&n.anchor&&(Vt(n.node)||Kt(n.node)))n.node.anchor=n.anchor;else{let n=Error("Failed to resolve repeated object (this should not happen)");throw n.source=e,n}}},sourceObjects:B}}(this,ei||"a"),ed={aliasDuplicateObjects:et??!0,keepUndefined:el??!1,onAnchor:ef,onTagObj:eu,replacer:B,schema:this.schema,sourceObjects:ep},e_=Yn(e,ec,ed);return eo&&Kt(e_)&&(e_.flow=!0),eh(),e_}createPair(e,n,N={}){let B=this.createNode(e,null,N),et=this.createNode(n,null,N);return new Yt(B,et)}delete(e){return!!wn(this.contents)&&this.contents.delete(e)}deleteIn(e){return $n(e)?null!=this.contents&&(this.contents=null,!0):!!wn(this.contents)&&this.contents.deleteIn(e)}get(e,n){return Kt(this.contents)?this.contents.get(e,n):void 0}getIn(e,n){return $n(e)?!n&&Vt(this.contents)?this.contents.value:this.contents:Kt(this.contents)?this.contents.getIn(e,n):void 0}has(e){return!!Kt(this.contents)&&this.contents.has(e)}hasIn(e){return $n(e)?void 0!==this.contents:!!Kt(this.contents)&&this.contents.hasIn(e)}set(e,n){null==this.contents?this.contents=hr(this.schema,[e],n):wn(this.contents)&&this.contents.set(e,n)}setIn(e,n){$n(e)?this.contents=n:null==this.contents?this.contents=hr(this.schema,Array.from(e),n):wn(this.contents)&&this.contents.setIn(e,n)}setSchema(e,n={}){let N;switch("number"==typeof e&&(e=String(e)),e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Wt({version:"1.1"}),N={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new Wt({version:e}),N={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,N=null;break;default:{let n=JSON.stringify(e);throw Error(`Expected '1.1', '1.2' or null as first argument, but found: ${n}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(N)this.schema=new Or(Object.assign(N,n));else throw Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:n,mapAsMap:N,maxAliasCount:B,onAnchor:et,reviver:ei}={}){let eo={anchors:new Map,doc:this,keep:!e,mapAsMap:!0===N,mapKeyWarned:!1,maxAliasCount:"number"==typeof B?B:100},el=nn(this.contents,n??"",eo);if("function"==typeof et)for(let{count:e,res:n}of eo.anchors.values())et(n,e);return"function"==typeof ei?On(ei,{"":el},"",el):el}toJSON(e,n){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:n})}toString(e={}){if(this.errors.length>0)throw Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||0>=Number(e.indent))){let n=JSON.stringify(e.indent);throw Error(`"indent" option must be a positive integer, not ${n}`)}return function(e,n){var N;let B=[],et=!0===n.directives;if(!1!==n.directives&&e.directives){let n=e.directives.toString(e);n?(B.push(n),et=!0):e.directives.docStart&&(et=!0)}et&&B.push("---");let ei=ra(e,n),{commentString:eo}=ei.options;if(e.commentBefore){1!==B.length&&B.unshift("");let n=eo(e.commentBefore);B.unshift(fn(n,""))}let el=!1,eu=null;if(e.contents){if($t(e.contents)){if(e.contents.spaceBefore&&et&&B.push(""),e.contents.commentBefore){let n=eo(e.contents.commentBefore);B.push(fn(n,""))}ei.forceBlockIndent=!!e.comment,eu=e.contents.comment}let n=eu?void 0:()=>el=!0,N=Un(e.contents,ei,()=>eu=null,n);eu&&(N+=dn(N,"",eo(eu))),("|"===N[0]||">"===N[0])&&"---"===B[B.length-1]?B[B.length-1]=`--- ${N}`:B.push(N)}else B.push(Un(e.contents,ei));if(null!=(N=e.directives)&&N.docEnd){if(e.comment){let n=eo(e.comment);n.includes(`
`)?(B.push("..."),B.push(fn(n,""))):B.push(`... ${n}`)}else B.push("...")}else{let n=e.comment;n&&el&&(n=n.replace(/^\n+/,"")),n&&((!el||eu)&&""!==B[B.length-1]&&B.push(""),B.push(fn(eo(n),"")))}return B.join(`
`)+`
`}(this,e)}};function wn(e){if(Kt(e))return!0;throw Error("Expected a YAML collection as document contents")}let ps=class ps extends Error{constructor(e,n,N,B){super(),this.name=e,this.code=N,this.message=B,this.pos=n}};let kn=class kn extends ps{constructor(e,n,N){super("YAMLParseError",e,n,N)}};let La=class La extends ps{constructor(e,n,N){super("YAMLWarning",e,n,N)}};let dr=(e,n)=>N=>{if(-1===N.pos[0])return;N.linePos=N.pos.map(e=>n.linePos(e));let{line:B,col:et}=N.linePos[0];N.message+=` at line ${B}, column ${et}`;let ei=et-1,eo=e.substring(n.lineStarts[B-1],n.lineStarts[B]).replace(/[\n\r]+$/,"");if(ei>=60&&eo.length>80){let e=Math.min(ei-39,eo.length-79);eo="…"+eo.substring(e),ei-=e-1}if(eo.length>80&&(eo=eo.substring(0,79)+"…"),B>1&&/^ *$/.test(eo.substring(0,ei))){let N=e.substring(n.lineStarts[B-2],n.lineStarts[B-1]);N.length>80&&(N=N.substring(0,79)+`…
`),eo=N+eo}if(/[^ ]/.test(eo)){let e=1,n=N.linePos[1];n&&n.line===B&&n.col>et&&(e=Math.max(1,Math.min(n.col-et,80-ei)));let el=" ".repeat(ei)+"^".repeat(e);N.message+=`:

${eo}
${el}
`}};function In(e,{flow:n,indicator:N,next:B,offset:et,onError:ei,startOnNewline:eo}){let el=!1,eu=eo,ec=eo,ef="",eh="",ep=!1,ed=!1,e_=!1,eg=null,em=null,eb=null,ey=null,ev=null;for(let B of e)switch(e_&&("space"!==B.type&&"newline"!==B.type&&"comma"!==B.type&&ei(B.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),e_=!1),B.type){case"space":!n&&eu&&"doc-start"!==N&&"	"===B.source[0]&&ei(B,"TAB_AS_INDENT","Tabs are not allowed as indentation"),ec=!0;break;case"comment":{ec||ei(B,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let e=B.source.substring(1)||" ";ef?ef+=eh+e:ef=e,eh="",eu=!1;break}case"newline":eu?ef?ef+=B.source:el=!0:eh+=B.source,eu=!0,ep=!0,(eg||em)&&(ed=!0),ec=!0;break;case"anchor":eg&&ei(B,"MULTIPLE_ANCHORS","A node can have at most one anchor"),B.source.endsWith(":")&&ei(B.offset+B.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),eg=B,null===ev&&(ev=B.offset),eu=!1,ec=!1,e_=!0;break;case"tag":em&&ei(B,"MULTIPLE_TAGS","A node can have at most one tag"),em=B,null===ev&&(ev=B.offset),eu=!1,ec=!1,e_=!0;break;case N:(eg||em)&&ei(B,"BAD_PROP_ORDER",`Anchors and tags must be after the ${B.source} indicator`),ey&&ei(B,"UNEXPECTED_TOKEN",`Unexpected ${B.source} in ${n??"collection"}`),ey=B,eu=!1,ec=!1;break;case"comma":if(n){eb&&ei(B,"UNEXPECTED_TOKEN",`Unexpected , in ${n}`),eb=B,eu=!1,ec=!1;break}default:ei(B,"UNEXPECTED_TOKEN",`Unexpected ${B.type} token`),eu=!1,ec=!1}let ek=e[e.length-1],eA=ek?ek.offset+ek.source.length:et;return e_&&B&&"space"!==B.type&&"newline"!==B.type&&"comma"!==B.type&&("scalar"!==B.type||""!==B.source)&&ei(B.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:eb,found:ey,spaceBefore:el,comment:ef,hasNewline:ep,hasNewlineAfterProp:ed,anchor:eg,tag:em,end:eA,start:ev??eA}}function Zn(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes(`
`))return!0;if(e.end){for(let n of e.end)if("newline"===n.type)return!0}return!1;case"flow-collection":for(let n of e.items){for(let e of n.start)if("newline"===e.type)return!0;if(n.sep){for(let e of n.sep)if("newline"===e.type)return!0}if(Zn(n.key)||Zn(n.value))return!0}return!1;default:return!0}}function qr(e,n,N){if((null==n?void 0:n.type)==="flow-collection"){let B=n.end[0];B.indent===e&&("]"===B.source||"}"===B.source)&&Zn(n)&&N(B,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function Aa(e,n,N){let{uniqueKeys:B}=e.options;if(!1===B)return!1;let et="function"==typeof B?B:(n,N)=>n===N||Vt(n)&&Vt(N)&&n.value===N.value&&!("<<"===n.value&&e.schema.merge);return n.some(e=>et(e.key,N))}let e3="All mapping items must start at the same column";function Qn(e,n,N,B){let et="";if(e){let ei=!1,eo="";for(let el of e){let{source:e,type:eu}=el;switch(eu){case"space":ei=!0;break;case"comment":{N&&!ei&&B(el,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let n=e.substring(1)||" ";et?et+=eo+n:et=n,eo="";break}case"newline":et&&(eo+=e),ei=!0;break;default:B(el,"UNEXPECTED_TOKEN",`Unexpected ${eu} at node end`)}n+=e.length}}return{comment:et,offset:n}}let e5="Block collections are not allowed within flow collections",Dr=e=>e&&("block-map"===e.type||"block-seq"===e.type);function Vr(e,n,N,B,et,ei){let eo="block-map"===N.type?function({composeNode:e,composeEmptyNode:n},N,B,et,ei){var eo;let el=(null==ei?void 0:ei.nodeClass)??en,eu=new el(N.schema);N.atRoot&&(N.atRoot=!1);let ec=B.offset,ef=null;for(let ei of B.items){let{start:el,key:eh,sep:ep,value:ed}=ei,e_=In(el,{indicator:"explicit-key-ind",next:eh??(null==ep?void 0:ep[0]),offset:ec,onError:et,startOnNewline:!0}),eg=!e_.found;if(eg){if(eh&&("block-seq"===eh.type?et(ec,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in eh&&eh.indent!==B.indent&&et(ec,"BAD_INDENT",e3)),!e_.anchor&&!e_.tag&&!ep){ef=e_.end,e_.comment&&(eu.comment?eu.comment+=`
`+e_.comment:eu.comment=e_.comment);continue}(e_.hasNewlineAfterProp||Zn(eh))&&et(eh??el[el.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else(null==(eo=e_.found)?void 0:eo.indent)!==B.indent&&et(ec,"BAD_INDENT",e3);let em=e_.end,eb=eh?e(N,eh,e_,et):n(N,em,el,null,e_,et);N.schema.compat&&qr(B.indent,eh,et),Aa(N,eu.items,eb)&&et(em,"DUPLICATE_KEY","Map keys must be unique");let ey=In(ep??[],{indicator:"map-value-ind",next:ed,offset:eb.range[2],onError:et,startOnNewline:!eh||"block-scalar"===eh.type});if(ec=ey.end,ey.found){eg&&((null==ed?void 0:ed.type)!=="block-map"||ey.hasNewline||et(ec,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),N.options.strict&&e_.start<ey.found.offset-1024&&et(eb.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let eo=ed?e(N,ed,ey,et):n(N,ec,ep,null,ey,et);N.schema.compat&&qr(B.indent,ed,et),ec=eo.range[2];let el=new Yt(eb,eo);N.options.keepSourceTokens&&(el.srcToken=ei),eu.items.push(el)}else{eg&&et(eb.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),ey.comment&&(eb.comment?eb.comment+=`
`+ey.comment:eb.comment=ey.comment);let e=new Yt(eb);N.options.keepSourceTokens&&(e.srcToken=ei),eu.items.push(e)}}return ef&&ef<ec&&et(ef,"IMPOSSIBLE","Map comment with trailing content"),eu.range=[B.offset,ec,ef??ec],eu}(e,n,N,B,ei):"block-seq"===N.type?function({composeNode:e,composeEmptyNode:n},N,B,et,ei){let eo=(null==ei?void 0:ei.nodeClass)??mn,el=new eo(N.schema);N.atRoot&&(N.atRoot=!1);let eu=B.offset,ec=null;for(let{start:ei,value:eo}of B.items){let ef=In(ei,{indicator:"seq-item-ind",next:eo,offset:eu,onError:et,startOnNewline:!0});if(!ef.found){if(ef.anchor||ef.tag||eo)eo&&"block-seq"===eo.type?et(ef.end,"BAD_INDENT","All sequence items must start at the same column"):et(eu,"MISSING_CHAR","Sequence item without - indicator");else{ec=ef.end,ef.comment&&(el.comment=ef.comment);continue}}let eh=eo?e(N,eo,ef,et):n(N,ef.end,ei,null,ef,et);N.schema.compat&&qr(B.indent,eo,et),eu=eh.range[2],el.items.push(eh)}return el.range=[B.offset,eu,ec??eu],el}(e,n,N,B,ei):function({composeNode:e,composeEmptyNode:n},N,B,et,ei){let eo="{"===B.start.source,el=eo?"flow map":"flow sequence",eu=(null==ei?void 0:ei.nodeClass)??(eo?en:mn),ec=new eu(N.schema);ec.flow=!0;let ef=N.atRoot;ef&&(N.atRoot=!1);let eh=B.offset+B.start.source.length;for(let ei=0;ei<B.items.length;++ei){let eu=B.items[ei],{start:ef,key:ep,sep:ed,value:e_}=eu,eg=In(ef,{flow:el,indicator:"explicit-key-ind",next:ep??(null==ed?void 0:ed[0]),offset:eh,onError:et,startOnNewline:!1});if(!eg.found){if(!eg.anchor&&!eg.tag&&!ed&&!e_){0===ei&&eg.comma?et(eg.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${el}`):ei<B.items.length-1&&et(eg.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${el}`),eg.comment&&(ec.comment?ec.comment+=`
`+eg.comment:ec.comment=eg.comment),eh=eg.end;continue}!eo&&N.options.strict&&Zn(ep)&&et(ep,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(0===ei)eg.comma&&et(eg.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${el}`);else if(eg.comma||et(eg.start,"MISSING_CHAR",`Missing , between ${el} items`),eg.comment){let e="";e:for(let n of ef)switch(n.type){case"comma":case"space":break;case"comment":e=n.source.substring(1);break e;default:break e}if(e){let n=ec.items[ec.items.length-1];zt(n)&&(n=n.value??n.key),n.comment?n.comment+=`
`+e:n.comment=e,eg.comment=eg.comment.substring(e.length+1)}}if(eo||ed||eg.found){let B=eg.end,ei=ep?e(N,ep,eg,et):n(N,B,ef,null,eg,et);Dr(ep)&&et(ei.range,"BLOCK_IN_FLOW",e5);let em=In(ed??[],{flow:el,indicator:"map-value-ind",next:e_,offset:ei.range[2],onError:et,startOnNewline:!1});if(em.found){if(!eo&&!eg.found&&N.options.strict){if(ed)for(let e of ed){if(e===em.found)break;if("newline"===e.type){et(e,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}eg.start<em.found.offset-1024&&et(em.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else e_&&("source"in e_&&e_.source&&":"===e_.source[0]?et(e_,"MISSING_CHAR",`Missing space after : in ${el}`):et(em.start,"MISSING_CHAR",`Missing , or : between ${el} items`));let eb=e_?e(N,e_,em,et):em.found?n(N,em.end,ed,null,em,et):null;eb?Dr(e_)&&et(eb.range,"BLOCK_IN_FLOW",e5):em.comment&&(ei.comment?ei.comment+=`
`+em.comment:ei.comment=em.comment);let ey=new Yt(ei,eb);if(N.options.keepSourceTokens&&(ey.srcToken=eu),eo)Aa(N,ec.items,ei)&&et(B,"DUPLICATE_KEY","Map keys must be unique"),ec.items.push(ey);else{let e=new en(N.schema);e.flow=!0,e.items.push(ey),ec.items.push(e)}eh=eb?eb.range[2]:em.end}else{let B=e_?e(N,e_,eg,et):n(N,eg.end,ed,null,eg,et);ec.items.push(B),eh=B.range[2],Dr(e_)&&et(B.range,"BLOCK_IN_FLOW",e5)}}let ep=eo?"}":"]",[ed,...e_]=B.end,eg=eh;if(ed&&ed.source===ep)eg=ed.offset+ed.source.length;else{let e=el[0].toUpperCase()+el.substring(1),n=ef?`${e} must end with a ${ep}`:`${e} in block collection must be sufficiently indented and end with a ${ep}`;et(eh,ef?"MISSING_CHAR":"BAD_INDENT",n),ed&&1!==ed.source.length&&e_.unshift(ed)}if(e_.length>0){let e=Qn(e_,eg,N.options.strict,et);e.comment&&(ec.comment?ec.comment+=`
`+e.comment:ec.comment=e.comment),ec.range=[B.offset,eg,e.offset]}else ec.range=[B.offset,eg,eg];return ec}(e,n,N,B,ei),el=eo.constructor;return"!"===et||et===el.tagName?eo.tag=el.tagName:et&&(eo.tag=et),eo}function wa(e,n,N){let B=e.offset,et=function({offset:e,props:n},N,B){if("block-scalar-header"!==n[0].type)return B(n[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:et}=n[0],ei=et[0],eo=0,el="",eu=-1;for(let n=1;n<et.length;++n){let N=et[n];if(el||"-"!==N&&"+"!==N){let B=Number(N);!eo&&B?eo=B:-1===eu&&(eu=e+n)}else el=N}-1!==eu&&B(eu,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${et}`);let ec=!1,ef="",eh=et.length;for(let e=1;e<n.length;++e){let et=n[e];switch(et.type){case"space":ec=!0;case"newline":eh+=et.source.length;break;case"comment":N&&!ec&&B(et,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),eh+=et.source.length,ef=et.source.substring(1);break;case"error":B(et,"UNEXPECTED_TOKEN",et.message),eh+=et.source.length;break;default:{let e=`Unexpected token in block scalar header: ${et.type}`;B(et,"UNEXPECTED_TOKEN",e);let n=et.source;n&&"string"==typeof n&&(eh+=n.length)}}}return{mode:ei,indent:eo,chomp:el,comment:ef,length:eh}}(e,n,N);if(!et)return{value:"",type:null,comment:"",range:[B,B,B]};let ei=">"===et.mode?It.BLOCK_FOLDED:It.BLOCK_LITERAL,eo=e.source?function(e){let n=e.split(/\n( *)/),N=n[0],B=N.match(/^( *)/),et=[null!=B&&B[1]?[B[1],N.slice(B[1].length)]:["",N]];for(let e=1;e<n.length;e+=2)et.push([n[e],n[e+1]]);return et}(e.source):[],el=eo.length;for(let e=eo.length-1;e>=0;--e){let n=eo[e][1];if(""===n||"\r"===n)el=e;else break}if(0===el){let n="+"===et.chomp&&eo.length>0?`
`.repeat(Math.max(1,eo.length-1)):"",N=B+et.length;return e.source&&(N+=e.source.length),{value:n,type:ei,comment:et.comment,range:[B,N,N]}}let eu=e.indent+et.indent,ec=e.offset+et.length,ef=0;for(let e=0;e<el;++e){let[n,B]=eo[e];if(""===B||"\r"===B)0===et.indent&&n.length>eu&&(eu=n.length);else{n.length<eu&&N(ec+n.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),0===et.indent&&(eu=n.length),ef=e;break}ec+=n.length+B.length+1}for(let e=eo.length-1;e>=el;--e)eo[e][0].length>eu&&(el=e+1);let eh="",ep="",ed=!1;for(let e=0;e<ef;++e)eh+=eo[e][0].slice(eu)+`
`;for(let e=ef;e<el;++e){let[n,B]=eo[e];ec+=n.length+B.length+1;let el="\r"===B[B.length-1];if(el&&(B=B.slice(0,-1)),B&&n.length<eu){let e=`Block scalar lines must not be less indented than their ${et.indent?"explicit indentation indicator":"first line"}`;N(ec-B.length-(el?2:1),"BAD_INDENT",e),n=""}ei===It.BLOCK_LITERAL?(eh+=ep+n.slice(eu)+B,ep=`
`):n.length>eu||"	"===B[0]?(" "===ep?ep=`
`:ed||ep!==`
`||(ep=`

`),eh+=ep+n.slice(eu)+B,ep=`
`,ed=!0):""===B?ep===`
`?eh+=`
`:ep=`
`:(eh+=ep+B,ep=" ",ed=!1)}switch(et.chomp){case"-":break;case"+":for(let e=el;e<eo.length;++e)eh+=`
`+eo[e][0].slice(eu);eh[eh.length-1]!==`
`&&(eh+=`
`);break;default:eh+=`
`}let e_=B+et.length+e.source.length;return{value:eh,type:ei,comment:et.comment,range:[B,e_,e_]}}function Ta(e,n,N){let B,et;let{offset:ei,type:eo,source:el,end:eu}=e,h=(e,n,B)=>N(ei+e,n,B);switch(eo){case"scalar":B=It.PLAIN,et=function(e,n){let N="";switch(e[0]){case"	":N="a tab character";break;case",":N="flow indicator character ,";break;case"%":N="directive indicator character %";break;case"|":case">":N=`block scalar indicator ${e[0]}`;break;case"@":case"`":N=`reserved character ${e[0]}`}return N&&n(0,"BAD_SCALAR_START",`Plain value cannot start with ${N}`),xa(e)}(el,h);break;case"single-quoted-scalar":B=It.QUOTE_SINGLE,("'"!==el[el.length-1]||1===el.length)&&h(el.length,"MISSING_CHAR","Missing closing 'quote"),et=xa(el.slice(1,-1)).replace(/''/g,"'");break;case"double-quoted-scalar":B=It.QUOTE_DOUBLE,et=function(e,n){let N="";for(let B=1;B<e.length-1;++B){let et=e[B];if(!("\r"===et&&e[B+1]===`
`)){if(et===`
`){let{fold:n,offset:et}=function(e,n){let N="",B=e[n+1];for(;(" "===B||"	"===B||B===`
`||"\r"===B)&&!("\r"===B&&e[n+2]!==`
`);)B===`
`&&(N+=`
`),n+=1,B=e[n+1];return N||(N=" "),{fold:N,offset:n}}(e,B);N+=n,B=et}else if("\\"===et){let et=e[++B],ei=e4[et];if(ei)N+=ei;else if(et===`
`)for(et=e[B+1];" "===et||"	"===et;)et=e[++B+1];else if("\r"===et&&e[B+1]===`
`)for(et=e[++B+1];" "===et||"	"===et;)et=e[++B+1];else if("x"===et||"u"===et||"U"===et){let ei={x:2,u:4,U:8}[et];N+=function(e,n,N,B){let et=e.substr(n,N),ei=et.length===N&&/^[0-9a-fA-F]+$/.test(et)?parseInt(et,16):NaN;if(isNaN(ei)){let et=e.substr(n-2,N+2);return B(n-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${et}`),et}return String.fromCodePoint(ei)}(e,B+1,ei,n),B+=ei}else{let et=e.substr(B-1,2);n(B-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${et}`),N+=et}}else if(" "===et||"	"===et){let n=B,ei=e[B+1];for(;" "===ei||"	"===ei;)ei=e[++B+1];ei===`
`||"\r"===ei&&e[B+2]===`
`||(N+=B>n?e.slice(n,B+1):et)}else N+=et}}return('"'!==e[e.length-1]||1===e.length)&&n(e.length,"MISSING_CHAR",'Missing closing "quote'),N}(el,h);break;default:return N(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${eo}`),{value:"",type:null,comment:"",range:[ei,ei+el.length,ei+el.length]}}let ec=ei+el.length,ef=Qn(eu,ec,n,N);return{value:et,type:B,comment:ef.comment,range:[ei,ec,ef.offset]}}function xa(e){let n,N;try{n=RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),N=RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{n=/(.*?)[ \t]*\r?\n/sy,N=/[ \t]*(.*?)[ \t]*\r?\n/sy}let B=n.exec(e);if(!B)return e;let et=B[1],ei=" ",eo=n.lastIndex;for(N.lastIndex=eo;B=N.exec(e);)""===B[1]?ei===`
`?et+=ei:ei=`
`:(et+=ei+B[1],ei=" "),eo=N.lastIndex;let el=/[ \t]*(.*)/sy;return el.lastIndex=eo,et+ei+((null==(B=el.exec(e))?void 0:B[1])??"")}let e4={0:"\x00",a:"\x07",b:"\b",e:"\x1b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xa0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Ea(e,n,N,B){let et;let{value:ei,type:eo,comment:el,range:eu}="block-scalar"===n.type?wa(n,e.options.strict,B):Ta(n,e.options.strict,B),ec=N?e.directives.tagName(N.source,e=>B(N,"TAG_RESOLVE_FAILED",e)):null,ef=N&&ec?function(e,n,N,B,et){var ei;if("!"===N)return e[ev];let eo=[];for(let n of e.tags)if(!n.collection&&n.tag===N){if(!n.default||!n.test)return n;eo.push(n)}for(let e of eo)if(null!=(ei=e.test)&&ei.test(n))return e;let el=e.knownTags[N];return el&&!el.collection?(e.tags.push(Object.assign({},el,{default:!1,test:void 0})),el):(et(B,"TAG_RESOLVE_FAILED",`Unresolved tag: ${N}`,"tag:yaml.org,2002:str"!==N),e[ev])}(e.schema,ei,ec,N,B):"scalar"===n.type?function({directives:e,schema:n},N,B,et){let ei=n.tags.find(e=>{var n;return e.default&&(null==(n=e.test)?void 0:n.test(N))})||n[ev];if(n.compat){let eo=n.compat.find(e=>{var n;return e.default&&(null==(n=e.test)?void 0:n.test(N))})??n[ev];if(ei.tag!==eo.tag){let n=e.tagString(ei.tag),N=e.tagString(eo.tag),el=`Value may be parsed as either ${n} or ${N}`;et(B,"TAG_RESOLVE_FAILED",el,!0)}}return ei}(e,ei,n,B):e.schema[ev];try{let eo=ef.resolve(ei,e=>B(N??n,"TAG_RESOLVE_FAILED",e),e.options);et=Vt(eo)?eo:new It(eo)}catch(eo){let e=eo instanceof Error?eo.message:String(eo);B(N??n,"TAG_RESOLVE_FAILED",e),et=new It(ei)}return et.range=eu,et.source=ei,eo&&(et.type=eo),ec&&(et.tag=ec),ef.format&&(et.format=ef.format),el&&(et.comment=el),et}let e8={composeNode:Oa,composeEmptyNode:ds};function Oa(e,n,N,B){let{spaceBefore:et,comment:ei,anchor:eo,tag:el}=N,eu,ec=!0;switch(n.type){case"alias":eu=function({options:e},{offset:n,source:N,end:B},et){let ei=new br(N.substring(1));""===ei.source&&et(n,"BAD_ALIAS","Alias cannot be an empty string"),ei.source.endsWith(":")&&et(n+N.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let eo=n+N.length,el=Qn(B,eo,e.strict,et);return ei.range=[n,eo,el.offset],el.comment&&(ei.comment=el.comment),ei}(e,n,B),(eo||el)&&B(n,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":eu=Ea(e,n,el,B),eo&&(eu.anchor=eo.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":eu=function(e,n,N,B,et){var ei;let eo=B?n.directives.tagName(B.source,e=>et(B,"TAG_RESOLVE_FAILED",e)):null,el="block-map"===N.type?"map":"block-seq"===N.type?"seq":"{"===N.start.source?"map":"seq";if(!B||!eo||"!"===eo||eo===en.tagName&&"map"===el||eo===mn.tagName&&"seq"===el||!el)return Vr(e,n,N,et,eo);let eu=n.schema.tags.find(e=>e.tag===eo&&e.collection===el);if(!eu){let ei=n.schema.knownTags[eo];if(!ei||ei.collection!==el)return null!=ei&&ei.collection?et(B,"BAD_COLLECTION_TYPE",`${ei.tag} used for ${el} collection, but expects ${ei.collection}`,!0):et(B,"TAG_RESOLVE_FAILED",`Unresolved tag: ${eo}`,!0),Vr(e,n,N,et,eo);n.schema.tags.push(Object.assign({},ei,{default:!1})),eu=ei}let ec=Vr(e,n,N,et,eo,eu),ef=(null==(ei=eu.resolve)?void 0:ei.call(eu,ec,e=>et(B,"TAG_RESOLVE_FAILED",e),n.options))??ec,eh=$t(ef)?ef:new It(ef);return eh.range=ec.range,eh.tag=eo,null!=eu&&eu.format&&(eh.format=eu.format),eh}(e8,e,n,el,B),eo&&(eu.anchor=eo.source.substring(1));break;default:{let et="error"===n.type?n.message:`Unsupported token (type: ${n.type})`;B(n,"UNEXPECTED_TOKEN",et),eu=ds(e,n.offset,void 0,null,N,B),ec=!1}}return eo&&""===eu.anchor&&B(eo,"BAD_ALIAS","Anchor cannot be an empty string"),et&&(eu.spaceBefore=!0),ei&&("scalar"===n.type&&""===n.source?eu.comment=ei:eu.commentBefore=ei),e.options.keepSourceTokens&&ec&&(eu.srcToken=n),eu}function ds(e,n,N,B,{spaceBefore:et,comment:ei,anchor:eo,tag:el,end:eu},ec){let ef={type:"scalar",offset:function(e,n,N){if(n){null===N&&(N=n.length);for(let B=N-1;B>=0;--B){let N=n[B];switch(N.type){case"space":case"comment":case"newline":e-=N.source.length;continue}for(N=n[++B];(null==N?void 0:N.type)==="space";)e+=N.source.length,N=n[++B];break}}return e}(n,N,B),indent:-1,source:""},eh=Ea(e,ef,el,ec);return eo&&(eh.anchor=eo.source.substring(1),""===eh.anchor&&ec(eo,"BAD_ALIAS","Anchor cannot be an empty string")),et&&(eh.spaceBefore=!0),ei&&(eh.comment=ei,eh.range[2]=eu),eh}function Kn(e){if("number"==typeof e)return[e,e+1];if(Array.isArray(e))return 2===e.length?e:[e[0],e[1]];let{offset:n,source:N}=e;return[n,n+("string"==typeof N?N.length:1)]}function Fs(e){var n;let N="",B=!1,et=!1;for(let ei=0;ei<e.length;++ei){let eo=e[ei];switch(eo[0]){case"#":N+=(""===N?"":et?`

`:`
`)+(eo.substring(1)||" "),B=!0,et=!1;break;case"%":(null==(n=e[ei+1])?void 0:n[0])!=="#"&&(ei+=1),B=!1;break;default:B||(et=!0),B=!1}}return{comment:N,afterEmptyLine:et}}let _s=class _s{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(e,n,N,B)=>{let et=Kn(e);B?this.warnings.push(new La(et,n,N)):this.errors.push(new kn(et,n,N))},this.directives=new Wt({version:e.version||"1.2"}),this.options=e}decorate(e,n){let{comment:N,afterEmptyLine:B}=Fs(this.prelude);if(N){let et=e.contents;if(n)e.comment=e.comment?`${e.comment}
${N}`:N;else if(B||e.directives.docStart||!et)e.commentBefore=N;else if(Kt(et)&&!et.flow&&et.items.length>0){let e=et.items[0];zt(e)&&(e=e.key);let n=e.commentBefore;e.commentBefore=n?`${N}
${n}`:N}else{let e=et.commentBefore;et.commentBefore=e?`${N}
${e}`:N}}n?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Fs(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,n=!1,N=-1){for(let n of e)yield*this.next(n);yield*this.end(n,N)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(n,N,B)=>{let et=Kn(e);et[0]+=n,this.onError(et,"BAD_DIRECTIVE",N,B)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{let n=function(e,n,{offset:N,start:B,value:et,end:ei},eo){let el=Object.assign({_directives:n},e),eu=new Dn(void 0,el),ec={atRoot:!0,directives:eu.directives,options:eu.options,schema:eu.schema},ef=In(B,{indicator:"doc-start",next:et??(null==ei?void 0:ei[0]),offset:N,onError:eo,startOnNewline:!0});ef.found&&(eu.directives.docStart=!0,et&&("block-map"===et.type||"block-seq"===et.type)&&!ef.hasNewline&&eo(ef.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),eu.contents=et?Oa(ec,et,ef,eo):ds(ec,ef.end,B,null,ef,eo);let eh=eu.contents.range[2],ep=Qn(ei,eh,!1,eo);return ep.comment&&(eu.comment=ep.comment),eu.range=[N,eh,ep.offset],eu}(this.options,this.directives,e,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{let n=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,N=new kn(Kn(e),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(N):this.doc.errors.push(N);break}case"doc-end":{if(!this.doc){this.errors.push(new kn(Kn(e),"UNEXPECTED_TOKEN","Unexpected doc-end without preceding document"));break}this.doc.directives.docEnd=!0;let n=Qn(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){let e=this.doc.comment;this.doc.comment=e?`${e}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new kn(Kn(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){let e=Object.assign({_directives:this.directives},this.options),N=new Dn(void 0,e);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),N.range=[0,n,n],this.decorate(N,!1),yield N}}};function Sa(e,n){if(n)for(let N of n)switch(N.type){case"space":case"comment":e.push(N);break;case"newline":return e.push(N),!0}return!1}function zr(e,n,N){switch(e.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":e.type=N,e.source=n;break;case"block-scalar":{let B=e.props.slice(1),et=n.length;for(let n of("block-scalar-header"===e.props[0].type&&(et-=e.props[0].source.length),B))n.offset+=et;delete e.props,Object.assign(e,{type:N,source:n,end:B});break}case"block-map":case"block-seq":{let B={type:"newline",offset:e.offset+n.length,indent:e.indent,source:`
`};delete e.items,Object.assign(e,{type:N,source:n,end:[B]});break}default:{let B="indent"in e?e.indent:-1,et="end"in e&&Array.isArray(e.end)?e.end.filter(e=>"space"===e.type||"comment"===e.type||"newline"===e.type):[];for(let n of Object.keys(e))"type"!==n&&"offset"!==n&&delete e[n];Object.assign(e,{type:N,indent:B,source:n,end:et})}}}function _r(e){switch(e.type){case"block-scalar":{let n="";for(let N of e.props)n+=_r(N);return n+e.source}case"block-map":case"block-seq":{let n="";for(let N of e.items)n+=fr(N);return n}case"flow-collection":{let n=e.start.source;for(let N of e.items)n+=fr(N);for(let N of e.end)n+=N.source;return n}case"document":{let n=fr(e);if(e.end)for(let N of e.end)n+=N.source;return n}default:{let n=e.source;if("end"in e&&e.end)for(let N of e.end)n+=N.source;return n}}}function fr({start:e,key:n,sep:N,value:B}){let et="";for(let n of e)et+=n.source;if(n&&(et+=_r(n)),N)for(let e of N)et+=e.source;return B&&(et+=_r(B)),et}let e6=Symbol("break visit"),e9=Symbol("skip children"),e7=Symbol("remove item");function Ln(e,n){"type"in e&&"document"===e.type&&(e={start:e.start,value:e.value}),function Na(e,n,N){let B=N(n,e);if("symbol"==typeof B)return B;for(let et of["key","value"]){let ei=n[et];if(ei&&"items"in ei){for(let n=0;n<ei.items.length;++n){let B=Na(Object.freeze(e.concat([[et,n]])),ei.items[n],N);if("number"==typeof B)n=B-1;else{if(B===e6)return e6;B===e7&&(ei.items.splice(n,1),n-=1)}}"function"==typeof B&&"key"===et&&(B=B(n,e))}}return"function"==typeof B?B(n,e):B}(Object.freeze([]),e,n)}function Ua(e){switch(e){case"\uFEFF":return"byte-order-mark";case"\x02":return"doc-mode";case"\x18":return"flow-error-end";case"\x1f":return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}Ln.BREAK=e6,Ln.SKIP=e9,Ln.REMOVE=e7,Ln.itemAtPath=(e,n)=>{let N=e;for(let[e,B]of n){let n=null==N?void 0:N[e];if(!n||!("items"in n))return;N=n.items[B]}return N},Ln.parentCollection=(e,n)=>{let N=Ln.itemAtPath(e,n.slice(0,-1)),B=n[n.length-1][0],et=null==N?void 0:N[B];if(et&&"items"in et)return et;throw Error("Parent collection not found")};let ti=Object.freeze(Object.defineProperty({__proto__:null,BOM:"\uFEFF",DOCUMENT:"\x02",FLOW_END:"\x18",SCALAR:"\x1f",createScalarToken:function(e,n){let{implicitKey:N=!1,indent:B,inFlow:et=!1,offset:ei=-1,type:eo="PLAIN"}=n,el=Wn({type:eo,value:e},{implicitKey:N,indent:B>0?" ".repeat(B):"",inFlow:et,options:{blockQuote:!0,lineWidth:-1}}),eu=n.end??[{type:"newline",offset:-1,indent:B,source:`
`}];switch(el[0]){case"|":case">":{let e=el.indexOf(`
`),n=el.substring(0,e),N=el.substring(e+1)+`
`,et=[{type:"block-scalar-header",offset:ei,indent:B,source:n}];return Sa(et,eu)||et.push({type:"newline",offset:-1,indent:B,source:`
`}),{type:"block-scalar",offset:ei,indent:B,props:et,source:N}}case'"':return{type:"double-quoted-scalar",offset:ei,indent:B,source:el,end:eu};case"'":return{type:"single-quoted-scalar",offset:ei,indent:B,source:el,end:eu};default:return{type:"scalar",offset:ei,indent:B,source:el,end:eu}}},isCollection:e=>!!e&&"items"in e,isScalar:e=>!!e&&("scalar"===e.type||"single-quoted-scalar"===e.type||"double-quoted-scalar"===e.type||"block-scalar"===e.type),prettyToken:function(e){switch(e){case"\uFEFF":return"<BOM>";case"\x02":return"<DOC>";case"\x18":return"<FLOW_END>";case"\x1f":return"<SCALAR>";default:return JSON.stringify(e)}},resolveAsScalar:function(e,n=!0,N){if(e){let r=(e,n,B)=>{let et="number"==typeof e?e:Array.isArray(e)?e[0]:e.offset;if(N)N(et,n,B);else throw new kn([et,et+1],n,B)};switch(e.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return Ta(e,n,r);case"block-scalar":return wa(e,n,r)}}return null},setScalarValue:function(e,n,N={}){let{afterKey:B=!1,implicitKey:et=!1,inFlow:ei=!1,type:eo}=N,el="indent"in e?e.indent:null;if(B&&"number"==typeof el&&(el+=2),!eo)switch(e.type){case"single-quoted-scalar":eo="QUOTE_SINGLE";break;case"double-quoted-scalar":eo="QUOTE_DOUBLE";break;case"block-scalar":{let n=e.props[0];if("block-scalar-header"!==n.type)throw Error("Invalid block scalar header");eo=">"===n.source[0]?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:eo="PLAIN"}let eu=Wn({type:eo,value:n},{implicitKey:et||null===el,indent:null!==el&&el>0?" ".repeat(el):"",inFlow:ei,options:{blockQuote:!0,lineWidth:-1}});switch(eu[0]){case"|":case">":!function(e,n){let N=n.indexOf(`
`),B=n.substring(0,N),et=n.substring(N+1)+`
`;if("block-scalar"===e.type){let n=e.props[0];if("block-scalar-header"!==n.type)throw Error("Invalid block scalar header");n.source=B,e.source=et}else{let{offset:n}=e,N="indent"in e?e.indent:-1,ei=[{type:"block-scalar-header",offset:n,indent:N,source:B}];for(let n of(Sa(ei,"end"in e?e.end:void 0)||ei.push({type:"newline",offset:-1,indent:N,source:`
`}),Object.keys(e)))"type"!==n&&"offset"!==n&&delete e[n];Object.assign(e,{type:"block-scalar",indent:N,props:ei,source:et})}}(e,eu);break;case'"':zr(e,eu,"double-quoted-scalar");break;case"'":zr(e,eu,"single-quoted-scalar");break;default:zr(e,eu,"scalar")}},stringify:e=>"type"in e?_r(e):fr(e),tokenType:Ua,visit:Ln},Symbol.toStringTag,{value:"Module"}));function tn(e){switch(e){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}let to="0123456789ABCDEFabcdef".split(""),tl="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),tu=",[]{}".split(""),tc=` ,[]{}
\r	`.split(""),Kr=e=>!e||tc.includes(e);let Ia=class Ia{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,n=!1){e&&(this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null),this.atEnd=!n;let N=this.next??"stream";for(;N&&(n||this.hasChars(1));)N=yield*this.parseNext(N)}atLineEnd(){let e=this.pos,n=this.buffer[e];for(;" "===n||"	"===n;)n=this.buffer[++e];return!n||"#"===n||n===`
`||"\r"===n&&this.buffer[e+1]===`
`}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let n=this.buffer[e];if(this.indentNext>0){let N=0;for(;" "===n;)n=this.buffer[++N+e];if("\r"===n){let n=this.buffer[N+e+1];if(n===`
`||!n&&!this.atEnd)return e+N+1}return n!==`
`&&!(N>=this.indentNext)&&(n||this.atEnd)?-1:e+N}if("-"===n||"."===n){let n=this.buffer.substr(e,3);if(("---"===n||"..."===n)&&tn(this.buffer[e+3]))return -1}return e}getLine(){let e=this.lineEndPos;return("number"!=typeof e||-1!==e&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),-1===e?this.atEnd?this.buffer.substring(this.pos):null:("\r"===this.buffer[e-1]&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(null===e)return this.setNext("stream");if("\uFEFF"===e[0]&&(yield*this.pushCount(1),e=e.substring(1)),"%"===e[0]){let n=e.length,N=e.indexOf("#");if(-1!==N){let B=e[N-1];(" "===B||"	"===B)&&(n=N-1)}for(;;){let N=e[n-1];if(" "===N||"	"===N)n-=1;else break}let B=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-B),this.pushNewline(),"stream"}if(this.atLineEnd()){let n=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-n),yield*this.pushNewline(),"stream"}return yield"\x02",yield*this.parseLineStart()}*parseLineStart(){let e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if("-"===e||"."===e){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let e=this.peek(3);if("---"===e&&tn(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if("..."===e&&tn(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!tn(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){let[e,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if(("-"===e||"?"===e||":"===e)&&tn(n)){let e=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=e,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let e=this.getLine();if(null===e)return this.setNext("doc");let n=yield*this.pushIndicators();switch(e[n]){case"#":yield*this.pushCount(e.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Kr),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=(yield*this.parseBlockScalarHeader())+(yield*this.pushSpaces(!0)),yield*this.pushCount(e.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,n,N=-1;do(e=yield*this.pushNewline())>0?(n=yield*this.pushSpaces(!1),this.indentValue=N=n):n=0,n+=yield*this.pushSpaces(!0);while(e+n>0);let B=this.getLine();if(null===B)return this.setNext("flow");if((-1!==N&&N<this.indentNext&&"#"!==B[0]||0===N&&(B.startsWith("---")||B.startsWith("..."))&&tn(B[3]))&&!(N===this.indentNext-1&&1===this.flowLevel&&("]"===B[0]||"}"===B[0])))return this.flowLevel=0,yield"\x18",yield*this.parseLineStart();let et=0;for(;","===B[et];)et+=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0)),this.flowKey=!1;switch(B[et+=yield*this.pushIndicators()]){case void 0:return"flow";case"#":return yield*this.pushCount(B.length-et),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Kr),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let e=this.charAt(1);if(this.flowKey||tn(e)||","===e)return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let e=this.charAt(0),n=this.buffer.indexOf(e,this.pos+1);if("'"===e)for(;-1!==n&&"'"===this.buffer[n+1];)n=this.buffer.indexOf("'",n+2);else for(;-1!==n;){let e=0;for(;"\\"===this.buffer[n-1-e];)e+=1;if(e%2==0)break;n=this.buffer.indexOf('"',n+1)}let N=this.buffer.substring(0,n),B=N.indexOf(`
`,this.pos);if(-1!==B){for(;-1!==B;){let e=this.continueScalar(B+1);if(-1===e)break;B=N.indexOf(`
`,e)}-1!==B&&(n=B-("\r"===N[B-1]?2:1))}if(-1===n){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){let n=this.buffer[++e];if("+"===n)this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if("-"!==n)break}return yield*this.pushUntil(e=>tn(e)||"#"===e)}*parseBlockScalar(){let e=this.pos-1,n=0,N;e:for(let B=this.pos;N=this.buffer[B];++B)switch(N){case" ":n+=1;break;case`
`:e=B,n=0;break;case"\r":{let e=this.buffer[B+1];if(!e&&!this.atEnd)return this.setNext("block-scalar");if(e===`
`)break}default:break e}if(!N&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){-1===this.blockScalarIndent?this.indentNext=n:this.indentNext+=this.blockScalarIndent;do{let n=this.continueScalar(e+1);if(-1===n)break;e=this.buffer.indexOf(`
`,n)}while(-1!==e);if(-1===e){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}if(!this.blockScalarKeep)for(;;){let N=e-1,B=this.buffer[N];"\r"===B&&(B=this.buffer[--N]);let et=N;for(;" "===B||"	"===B;)B=this.buffer[--N];if(B===`
`&&N>=this.pos&&N+1+n>et)e=N;else break}return yield"\x1f",yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let e=this.flowLevel>0,n=this.pos-1,N=this.pos-1,B;for(;B=this.buffer[++N];)if(":"===B){let B=this.buffer[N+1];if(tn(B)||e&&","===B)break;n=N}else if(tn(B)){let et=this.buffer[N+1];if("\r"===B&&(et===`
`?(N+=1,B=`
`,et=this.buffer[N+1]):n=N),"#"===et||e&&tu.includes(et))break;if(B===`
`){let e=this.continueScalar(N+1);if(-1===e)break;N=Math.max(N,e-2)}}else{if(e&&tu.includes(B))break;n=N}return B||this.atEnd?(yield"\x1f",yield*this.pushToIndex(n+1,!0),e?"flow":"doc"):this.setNext("plain-scalar")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,n){let N=this.buffer.slice(this.pos,e);return N?(yield N,this.pos+=N.length,N.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Kr))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let e=this.flowLevel>0,n=this.charAt(1);if(tn(n)||e&&tu.includes(n))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if("<"===this.charAt(1)){let e=this.pos+2,n=this.buffer[e];for(;!tn(n)&&">"!==n;)n=this.buffer[++e];return yield*this.pushToIndex(">"===n?e+1:e,!1)}{let e=this.pos+1,n=this.buffer[e];for(;n;)if(tl.includes(n))n=this.buffer[++e];else if("%"===n&&to.includes(this.buffer[e+1])&&to.includes(this.buffer[e+2]))n=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){let e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):"\r"===e&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let n=this.pos-1,N;do N=this.buffer[++n];while(" "===N||e&&"	"===N);let B=n-this.pos;return B>0&&(yield this.buffer.substr(this.pos,B),this.pos=n),B}*pushUntil(e){let n=this.pos,N=this.buffer[n];for(;!e(N);)N=this.buffer[++n];return yield*this.pushToIndex(n,!1)}};let Pa=class Pa{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let n=0,N=this.lineStarts.length;for(;n<N;){let B=n+N>>1;this.lineStarts[B]<e?n=B+1:N=B}if(this.lineStarts[n]===e)return{line:n+1,col:1};if(0===n)return{line:0,col:e};let B=this.lineStarts[n-1];return{line:n,col:e-B+1}}}};function sn(e,n){for(let N=0;N<e.length;++N)if(e[N].type===n)return!0;return!1}function Vs(e){for(let n=0;n<e.length;++n)switch(e[n].type){case"space":case"comment":case"newline":break;default:return n}return -1}function Ca(e){switch(null==e?void 0:e.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function sr(e){switch(e.type){case"document":return e.start;case"block-map":{let n=e.items[e.items.length-1];return n.sep??n.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function Tn(e){var n;if(0===e.length)return[];let N=e.length;e:for(;--N>=0;)switch(e[N].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;(null==(n=e[++N])?void 0:n.type)==="space";);return e.splice(N,e.length)}function zs(e){if("flow-seq-start"===e.start.type)for(let n of e.items)!n.sep||n.value||sn(n.start,"explicit-key-ind")||sn(n.sep,"map-value-ind")||(n.key&&(n.value=n.key),delete n.key,Ca(n.value)?n.value.end?Array.prototype.push.apply(n.value.end,n.sep):n.value.end=n.sep:Array.prototype.push.apply(n.start,n.sep),delete n.sep)}let gs=class gs{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Ia,this.onNewLine=e}*parse(e,n=!1){for(let N of(this.onNewLine&&0===this.offset&&this.onNewLine(0),this.lexer.lex(e,n)))yield*this.next(N);n||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}let n=Ua(e);if(n){if("scalar"===n)this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&" "===e[0]&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}}else{let n=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let e=this.peek(1);if("doc-end"===this.type&&(!e||"doc-end"!==e.type)){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){let n=e??this.stack.pop();if(n){if(0===this.stack.length)yield n;else{let e=this.peek(1);switch("block-scalar"===n.type?n.indent="indent"in e?e.indent:0:"flow-collection"===n.type&&"document"===e.type&&(n.indent=0),"flow-collection"===n.type&&zs(n),e.type){case"document":e.value=n;break;case"block-scalar":e.props.push(n);break;case"block-map":{let N=e.items[e.items.length-1];if(N.value){e.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}if(N.sep)N.value=n;else{Object.assign(N,{key:n,sep:[]}),this.onKeyLine=!sn(N.start,"explicit-key-ind");return}break}case"block-seq":{let N=e.items[e.items.length-1];N.value?e.items.push({start:[],value:n}):N.value=n;break}case"flow-collection":{let N=e.items[e.items.length-1];!N||N.value?e.items.push({start:[],key:n,sep:[]}):N.sep?N.value=n:Object.assign(N,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if(("document"===e.type||"block-map"===e.type||"block-seq"===e.type)&&("block-map"===n.type||"block-seq"===n.type)){let N=n.items[n.items.length-1];N&&!N.sep&&!N.value&&N.start.length>0&&-1===Vs(N.start)&&(0===n.indent||N.start.every(e=>"comment"!==e.type||e.indent<n.indent))&&("document"===e.type?e.end=N.start:e.items.push({start:N.start}),n.items.splice(-1,1))}}}else yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let e={type:"document",offset:this.offset,start:[]};"doc-start"===this.type&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":-1!==Vs(e.start)?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return;case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}let n=this.startBlockValue(e);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if("map-value-ind"===this.type){let n;let N=sr(this.peek(2)),B=Tn(N);e.end?((n=e.end).push(this.sourceToken),delete e.end):n=[this.sourceToken];let et={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:B,key:e,sep:n}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=et}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){var n;let N=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,N.value){let n="end"in N.value?N.value.end:void 0,B=Array.isArray(n)?n[n.length-1]:void 0;(null==B?void 0:B.type)==="comment"?null==n||n.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else N.sep?N.sep.push(this.sourceToken):N.start.push(this.sourceToken);return;case"space":case"comment":if(N.value)e.items.push({start:[this.sourceToken]});else if(N.sep)N.sep.push(this.sourceToken);else{if(this.atIndentedComment(N.start,e.indent)){let B=e.items[e.items.length-2],et=null==(n=null==B?void 0:B.value)?void 0:n.end;if(Array.isArray(et)){Array.prototype.push.apply(et,N.start),et.push(this.sourceToken),e.items.pop();return}}N.start.push(this.sourceToken)}return}if(this.indent>=e.indent){let n=!this.onKeyLine&&this.indent===e.indent&&N.sep,B=[];if(n&&N.sep&&!N.value){let n=[];for(let B=0;B<N.sep.length;++B){let et=N.sep[B];switch(et.type){case"newline":n.push(B);break;case"space":break;case"comment":et.indent>e.indent&&(n.length=0);break;default:n.length=0}}n.length>=2&&(B=N.sep.splice(n[1]))}switch(this.type){case"anchor":case"tag":n||N.value?(B.push(this.sourceToken),e.items.push({start:B}),this.onKeyLine=!0):N.sep?N.sep.push(this.sourceToken):N.start.push(this.sourceToken);return;case"explicit-key-ind":N.sep||sn(N.start,"explicit-key-ind")?n||N.value?(B.push(this.sourceToken),e.items.push({start:B})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}):N.start.push(this.sourceToken),this.onKeyLine=!0;return;case"map-value-ind":if(sn(N.start,"explicit-key-ind")){if(N.sep){if(N.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(sn(N.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:B,key:null,sep:[this.sourceToken]}]});else if(Ca(N.key)&&!sn(N.sep,"newline")){let e=Tn(N.start),n=N.key,B=N.sep;B.push(this.sourceToken),delete N.key,delete N.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:n,sep:B}]})}else B.length>0?N.sep=N.sep.concat(B,this.sourceToken):N.sep.push(this.sourceToken)}else if(sn(N.start,"newline"))Object.assign(N,{key:null,sep:[this.sourceToken]});else{let e=Tn(N.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:null,sep:[this.sourceToken]}]})}}else N.sep?N.value||n?e.items.push({start:B,key:null,sep:[this.sourceToken]}):sn(N.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):N.sep.push(this.sourceToken):Object.assign(N,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let et=this.flowScalar(this.type);n||N.value?(e.items.push({start:B,key:et,sep:[]}),this.onKeyLine=!0):N.sep?this.stack.push(et):(Object.assign(N,{key:et,sep:[]}),this.onKeyLine=!0);return}default:{let et=this.startBlockValue(e);if(et){n&&"block-seq"!==et.type&&sn(N.start,"explicit-key-ind")&&e.items.push({start:B}),this.stack.push(et);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){var n;let N=e.items[e.items.length-1];switch(this.type){case"newline":if(N.value){let n="end"in N.value?N.value.end:void 0,B=Array.isArray(n)?n[n.length-1]:void 0;(null==B?void 0:B.type)==="comment"?null==n||n.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else N.start.push(this.sourceToken);return;case"space":case"comment":if(N.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(N.start,e.indent)){let B=e.items[e.items.length-2],et=null==(n=null==B?void 0:B.value)?void 0:n.end;if(Array.isArray(et)){Array.prototype.push.apply(et,N.start),et.push(this.sourceToken),e.items.pop();return}}N.start.push(this.sourceToken)}return;case"anchor":case"tag":if(N.value||this.indent<=e.indent)break;N.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;N.value||sn(N.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):N.start.push(this.sourceToken);return}if(this.indent>e.indent){let n=this.startBlockValue(e);if(n){this.stack.push(n);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){let n=e.items[e.items.length-1];if("flow-error-end"===this.type){let e;do yield*this.pop(),e=this.peek(1);while(e&&"flow-collection"===e.type)}else if(0===e.end.length){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?e.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?e.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let N=this.flowScalar(this.type);!n||n.value?e.items.push({start:[],key:N,sep:[]}):n.sep?this.stack.push(N):Object.assign(n,{key:N,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}let N=this.startBlockValue(e);N?this.stack.push(N):(yield*this.pop(),yield*this.step())}else{let n=this.peek(2);if("block-map"!==n.type||("map-value-ind"!==this.type||n.indent!==e.indent)&&("newline"!==this.type||n.items[n.items.length-1].sep)){if("map-value-ind"===this.type&&"flow-collection"!==n.type){let N=sr(n),B=Tn(N);zs(e);let et=e.end.splice(1,e.end.length);et.push(this.sourceToken);let ei={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:B,key:e,sep:et}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=ei}else yield*this.lineEnd(e)}else yield*this.pop(),yield*this.step()}}flowScalar(e){if(this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let n=sr(e),N=Tn(n);return N.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:N}]}}case"map-value-ind":{this.onKeyLine=!0;let n=sr(e),N=Tn(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:N,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,n){return"comment"===this.type&&!(this.indent<=n)&&e.every(e=>"newline"===e.type||"space"===e.type)}*documentEnd(e){"doc-mode"!==this.type&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop())}}};function Ba(e){let n=!1!==e.prettyErrors;return{lineCounter:e.lineCounter||n&&new Pa||null,prettyErrors:n}}function Ma(e,n={}){let{lineCounter:N,prettyErrors:B}=Ba(n),et=new gs(null==N?void 0:N.addNewLine),ei=new _s(n),eo=null;for(let n of ei.compose(et.parse(e),!0,e.length))if(eo){if("silent"!==eo.options.logLevel){eo.errors.push(new kn(n.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}}else eo=n;return B&&N&&(eo.errors.forEach(dr(e,N)),eo.warnings.forEach(dr(e,N))),eo}let tf=Object.freeze(Object.defineProperty({__proto__:null,Alias:br,CST:ti,Composer:_s,Document:Dn,Lexer:Ia,LineCounter:Pa,Pair:Yt,Parser:gs,Scalar:It,Schema:Or,YAMLError:ps,YAMLMap:en,YAMLParseError:kn,YAMLSeq:mn,YAMLWarning:La,isAlias:An,isCollection:Kt,isDocument:Cn,isMap:Bn,isNode:$t,isPair:zt,isScalar:Vt,isSeq:Mn,parse:function(e,n,N){let B;"function"==typeof n?B=n:void 0===N&&n&&"object"==typeof n&&(N=n);let et=Ma(e,N);if(!et)return null;if(et.warnings.forEach(e=>sa(et.options.logLevel,e)),et.errors.length>0){if("silent"!==et.options.logLevel)throw et.errors[0];et.errors=[]}return et.toJS(Object.assign({reviver:B},N))},parseAllDocuments:function(e,n={}){let{lineCounter:N,prettyErrors:B}=Ba(n),et=new gs(null==N?void 0:N.addNewLine),ei=new _s(n),eo=Array.from(ei.compose(et.parse(e)));if(B&&N)for(let n of eo)n.errors.forEach(dr(e,N)),n.warnings.forEach(dr(e,N));return eo.length>0?eo:Object.assign([],{empty:!0},ei.streamInfo())},parseDocument:Ma,stringify:function(e,n,N){let B=null;if("function"==typeof n||Array.isArray(n)?B=n:void 0===N&&n&&(N=n),"string"==typeof N&&(N=N.length),"number"==typeof N){let e=Math.round(N);N=e<1?void 0:e>8?{indent:8}:{indent:e}}if(void 0===e){let{keepUndefined:e}=N??n??{};if(!e)return}return new Dn(e,B,N).toString(N)},visit:gn,visitAsync:mr},Symbol.toStringTag,{value:"Module"}));function Gs(e){let n={},N={exports:{boot:void 0}},B={context:Function("exports","module","define",e)(n,N,void 0)};return void 0!==n.boot?B.boot=n.boot:void 0!==N.exports.boot?B.boot=N.exports.boot:"object"===B.context&&void 0!==B.context.boot&&(B.boot=B.context.boot),B}function Io(e){return new Promise(async(n,N)=>{if(void 0!==e.header)return n(e.header);if(void 0===e.url)return N("failed to get header");let B=e.url.split("/").slice(-1)[0];B.endsWith(".yml")||B.endsWith(".yaml")||(B="header.yml"),console.log(`load header ${B}...`);let et=await e.gameServer.get(B);return e.header=tf.parse(et),n(e.header)})}function Po(e){return new Promise(async n=>{if(void 0===e.boot)throw"no boot specified";if("function"==typeof e.boot)return n(e.boot);if("object"==typeof e.boot)return n(e.boot.boot);if(!e.boot.endsWith(".js")&&!e.boot.endsWith(".ts")){let N=window[e.boot];if(void 0===N)throw`boot module ${e.boot} not found`;if(void 0===N.boot)throw`no boot function found in module ${e.boot}`;return n(N.boot)}if(e.boot.startsWith("http")){let N=await fetch(e.boot);if(!N.ok)throw N.statusText;let B=await N.text(),et=Gs(B);if(void 0===et.boot)throw`no boot function found in ${e.boot}`;return e.context=et.context,n(et.boot)}let N=await e.gameServer.get(e.boot),B=Gs(N);if(void 0===B.boot)throw`no boot function found in ${e.boot}`;return e.context=B.context,n(B.boot)})}(et=eo||(eo={})).defaultPlugin=e=>({name:"default",loadHeader:Io,loadBoot:Po}),et.injectHeader=e=>({name:"injectHeader",loadHeader:n=>new Promise((N,B)=>(n.header={...n.header??{},...e??{}},N(n.header)))});let Co=class Co{constructor(e){this._server=e}href(e){return this._server.href(e)}get(e){return this._server.get(e)}ready(e){this._server.ready(e)}close(e){this._server.close(e)}};let jo=class jo{constructor(e){this._isDone=!1,this._cancelRequested=!1,this.options=e}loadHeader(){return new Promise(async e=>{var n,N;console.log("start game server..."),this.gameServer=await (n=this.options.sdkConfig,N=this.options.url,new Promise(e=>{let B=function(e,n){if(n.endsWith(".zip"))return e.zipServer(n);if(n.endsWith(".yaml")||n.endsWith(".yml")){let e=n.lastIndexOf("/");n=e<0?"":n.substring(0,e)}return e.fileServer(n)}(n,N),et=new Co(B);et.ready(()=>e(et))})),console.log("game server started"),console.log("load game header...");let B=await this.options.pluginDriver.hookReduceArg0("loadHeader",[{url:this.options.url,gameServer:this.gameServer}],(e,n,N)=>(null!==n&&(e.header=n),e));if(this.header=B.header,void 0===this.header)throw"could not load game header";return console.log("game header loaded",this.header),e()}).then(()=>{if(this._isDone=!0,this._cancelRequested){this.cancel();return}void 0!==this.options.onHeaderLoaded&&this.options.onHeaderLoaded(this)}).catch(e=>{this._isDone=!0,this.error=e,this.cancel(),void 0!==this.options.onHeaderError&&this.options.onHeaderError(this)})}loadGame(){return new Promise(async e=>{if(void 0===this.gameServer||void 0===this.header)throw"no game server or header";let n=this.options.boot??this.header.boot;if(void 0===n)throw"missing boot parameter in game header";console.log("load game boot...");let N={boot:n,gameServer:this.gameServer},B=await this.options.pluginDriver.hookReduceArg0("loadBoot",[N],(e,n,N)=>(null!==n&&(e.boot=n),e));if(!B||void 0===B.boot||"function"!=typeof B.boot)throw"could not load game boot";return console.log("game boot loaded",B.boot),this.context=B.context,this.boot=B.boot,console.log("boot the game..."),this.game=await B.boot({vm:this.options.vm}),console.log("game booted"),e()}).then(()=>{if(this._isDone=!0,this._cancelRequested){this.cancel();return}void 0!==this.options.onGameLoaded&&this.options.onGameLoaded(this)}).catch(e=>{this._isDone=!0,this.error=e,this.cancel(),void 0!==this.options.onGameError&&this.options.onGameError(this)})}cancel(){if(!this._isDone){this._cancelRequested=!0;return}void 0!==this.gameServer&&(this.gameServer.close(),this.gameServer=void 0)}};let Vo=class Vo{constructor(e,n,N){this._state=0,this._ui={},this._speed=1,this._physicsAccumulator=0,this._frame=0,this._time=0,this._sdkConfig=e,this._options=N,this._pluginDriver=new vi({player:this,vm:this},[eo.defaultPlugin(),...void 0!==this._options.plugins?this._options.plugins:[]]),this._controllerBus=new ui({inputController:e.inputController}),void 0!==N.agents&&(Array.isArray(N.agents)||(N.agents=[N.agents]),N.agents.map((e,n)=>{let N=this._controllerBus.get(n);void 0!==N&&N.loadAgent(e)})),this._tickFromGame=this._tickFromGame.bind(this),void 0!==this._options.onReady&&(this._readyCallback=this._options.onReady),"dataset"in n&&(this._ui.element=n,this._options={...N},void 0===this._options.url&&void 0!==n.dataset.url&&(this._options.url=n.dataset.url),this._attach(),this.play({url:this._options.url}))}get isLoading(){return 1==this._state}get isPlaying(){return 3==this._state}get isPaused(){return 4==this._state}_attach(){if(void 0!==this._ui.element){{let e=document.createElement("div");this._ui.wrapper=e,e.addEventListener("mouseenter",()=>this._onMouseEnter()),e.addEventListener("mousemove",()=>this._onMouseMove()),e.addEventListener("mouseleave",()=>this._onMouseLeave()),e.style.width="100%",e.style.height="100%",e.style.position="relative",e.style.backgroundPosition="center",e.style.backgroundSize="cover",e.style.backgroundColor="black",this._ui.element.appendChild(e)}{let e=document.createElement("div");this._ui.base=e,e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.display="flex",e.style.flexDirection="row",e.style.justifyContent="center",this._ui.wrapper.appendChild(e)}this.resize(),this._ui.overlay=new di(this._ui.wrapper),this._ui.overlay.onPlay=()=>this.play(),this._ui.overlay.onSpeed=e=>this.speed=e,this._resizeListener=()=>this._onResize(),window.addEventListener("resize",this._resizeListener)}}_notifyReady(){void 0!==this._readyCallback&&this._readyCallback()}_loadHeader(e){var n,N;this._options.url=e.url,null==(n=this._loadGameTask)||n.cancel(),this.stop(),this._state=1,null==(N=this._ui.overlay)||N.loading(),this._loadGameTask=new jo({url:this.url,boot:this._options.boot,sdkConfig:this._sdkConfig,pluginDriver:this._pluginDriver,vm:this,onHeaderLoaded:n=>{var N;this._gameServer=n.gameServer,this._header=n.header,this.resize(),void 0!==this._ui.wrapper&&(this._ui.wrapper.style.backgroundImage=void 0!==this._header.previewUrl?`url('${this._gameServer.href(this._header.previewUrl)}')`:""),(e.autoPlay??this._options.autoPlay)===!0?this._play():(this._state=0,null==(N=this._ui.overlay)||N.stopped())},onHeaderError:e=>{void 0!==e.error&&console.error(e.error)},onGameLoaded:e=>{this._game=e.game,this._game.ticker=this._tickFromGame,this.resize(),this._ready()},onGameError:e=>{void 0!==e.error&&console.error(e.error)}}),this._loadGameTask.loadHeader()}_play(){if(4===this._state){this._state=3,this._ui.overlay&&this._ui.overlay.playing(),void 0!==this._game&&this._game.play();return}if(void 0===this._loadGameTask)throw"player not ready for play";if(this._state=1,this._startLoadingDate=new Date,this._ui.overlay&&this._ui.overlay.loading(),void 0!==this._ui.wrapper&&(this._ui.wrapper.style.backgroundImage=""),void 0===this._ui.element)throw"no root HTML element";this._loadGameTask.loadGame()}_onMouseEnter(){this._ui.overlay&&this._ui.overlay.mouseEnter()}_onMouseMove(){this._ui.overlay&&this._ui.overlay.mouseMove()}_onMouseLeave(){this._ui.overlay&&this._ui.overlay.mouseLeave()}get player(){return this}get vm(){return this}get root(){return this._ui.base}get gameServer(){var e;return null==(e=this._loadGameTask)?void 0:e.gameServer}_nativeGameSize(){var e,n,N;let B=null==(e=this._header)?void 0:e.width,et=null==(n=this._header)?void 0:n.height;if(void 0!==B&&void 0!==et)return{width:B,height:et};let ei=(null==(N=this.header)?void 0:N.aspectRatio)??"1/1",[eo,el]=ei.split("/").map(e=>parseInt(e));return void 0!==B?{width:B,height:B*el/eo}:void 0!==et?{width:et*eo/el,height:et}:{width:256,height:256}}_optimalPlayerSize(){let e=this._nativeGameSize(),n=this.scale/this.gameScale;return{width:e.width*n,height:e.height*n}}resize(e,n){if(void 0!==e){"object"==typeof e?(this._options.width=e.width,this._options.height=e.height):(this._options.width=e,this._options.height=n),this.resize();return}if(void 0===this._ui.wrapper)return;let N=this._optimalPlayerSize();this._ui.wrapper.style.aspectRatio=`${N.width}/${N.height}`;let B=this._ui.element,et=this._options.width,ei=this._options.height;"number"==typeof et?B.style.width=`${Math.round(et)}px`:"string"==typeof et&&(B.style.width=et),"number"==typeof ei?B.style.height=`${Math.round(ei)}px`:"string"==typeof ei&&(B.style.height=ei),this._onResize()}_onResize(){void 0!==this._game&&this._game.resize()}get onReady(){return this._readyCallback}set onReady(e){this._readyCallback=e,this.isPlaying&&this._notifyReady()}_ready(){if(1!=this._state)return;this._state=2;let e=1e3-(+new Date-+this._startLoadingDate);if(e>0){setTimeout(()=>this._ready_after_loading(),e);return}this._ready_after_loading()}_ready_after_loading(){2===this._state&&(this._state=3,void 0!==this._game&&(this.scale=this._options.scale??1),this._ui.overlay&&this._ui.overlay.playing(),this._game&&this._game.play(),this._notifyReady())}getController(e){return this._controllerBus.get(e)}get width(){return this._ui.wrapper?this._ui.wrapper.clientWidth:0}set width(e){this.resize({width:e})}get height(){return this._ui.wrapper?this._ui.wrapper.clientHeight:0}set height(e){this.resize({height:e})}get scale(){return this._options.scale??1}set scale(e){this._options.scale=e,this.resize()}get gameWidth(){return this._nativeGameSize().width}get gameHeight(){return this._nativeGameSize().height}get gameScale(){var e;return(null==(e=this._header)?void 0:e.scale)??1}get gameAspectRatio(){var e;return(null==(e=this._header)?void 0:e.aspectRatio)??"1/1"}get resizable(){return!0===this._options.resizable}set resizable(e){this._options.resizable=e}get speed(){return this._speed}set speed(e){this._speed=e}get url(){return this._options.url}set url(e){this._loadHeader({url:e})}get boot(){return this._options.boot}set boot(e){this._options.boot=e}get header(){var e;return null==(e=this._loadGameTask)?void 0:e.header}get autoPlay(){return!0===this._options.autoPlay}set autoPlay(e){this._options.autoPlay=e}get simulated(){return!0===this._options.simulated}set simulated(e){this._options.simulated=e}get frame(){return this._frame}get time(){return this._time}play(e){if("object"==typeof e){this._loadHeader({url:e.url,autoPlay:e.autoPlay});return}if(void 0!==e){this._loadHeader({url:e});return}this._play()}pause(){this.isPlaying&&(void 0!==this._game&&this._game.pause(),this._ui.overlay&&this._ui.overlay.paused(),this._state=4)}stop(){void 0!==this._game&&(this._game.stop(),this._game=void 0),this._ui.overlay&&this._ui.overlay.stopped(),void 0!==this._gameServer&&(this._gameServer.close(),this._gameServer=void 0),this._loadGameTask=void 0,this._speed=1,this._state=0}reload(){this.stop(),this.play()}remove(){this.stop(),void 0!==this._resizeListener&&window.removeEventListener("resize",this._resizeListener),this._ui.overlay&&(this._ui.overlay.remove(),this._ui.overlay=void 0),this._ui.wrapper&&(this._ui.wrapper.remove(),this._ui.wrapper=void 0)}saveState(){var e;return{isGameOver:!1,physicsAccumulator:this._physicsAccumulator,game:null==(e=this._game)?void 0:e.saveState(),controllers:this._controllerBus.saveState()}}loadState(e){var n;this._physicsAccumulator=(null==e?void 0:e.physicsAccumulator)??0,null==(n=this._game)||n.loadState(null==e?void 0:e.game),this._controllerBus.loadState((null==e?void 0:e.controllers)??[{},{}])}_tickFromGame(e){if(void 0!==this.ticker){this.ticker(e);return}this.simulated||this.tick(e)}tick(e){if(void 0!==this._game){for(this._physicsAccumulator+=e*this.speed;this._physicsAccumulator>.01;)this._tickOneFrame(.01,!1),this._physicsAccumulator-=.01;this._tickOneFrame(.01,!0),this._game.saveState().isGameOver&&this._game.loadState()}}_tickOneFrame(e,n){if(void 0===this._game)return;this._time+=e,this._frame++;let N=this._game.getStateForAgent();this._game.tick(this._controllerBus.inputs(N),e,n)}};function ja(e){return"length"in e}let $o=class $o{constructor(){this._inputs={left:!1,right:!1,up:!1,down:!1},this._keyDownListener=e=>this._onKey(e,!0),this._keyUpListener=e=>this._onKey(e,!1),document.addEventListener("keydown",this._keyDownListener,!1),document.addEventListener("keyup",this._keyUpListener,!1)}_onKey(e,n){"ArrowDown"===e.code||"KeyS"===e.code?("ArrowDown"===e.code&&e.preventDefault(),this._inputs.down=n):"ArrowUp"===e.code||"KeyW"===e.code?("ArrowUp"===e.code&&e.preventDefault(),this._inputs.up=n):"ArrowLeft"===e.code||"KeyA"===e.code?("ArrowLeft"===e.code&&e.preventDefault(),this._inputs.left=n):("ArrowRight"===e.code||"KeyD"===e.code)&&("ArrowRight"===e.code&&e.preventDefault(),this._inputs.right=n)}remove(){document.removeEventListener("keydown",this._keyDownListener),document.removeEventListener("keyup",this._keyUpListener)}get inputs(){return this._inputs}};var th="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof N.g?N.g:"u">typeof self?self:{};function or(e){throw Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var tp={exports:{}};tp.exports=(function t(e,n,N){function i(et,ei){if(!n[et]){if(!e[et]){if(!ei&&or)return or(et,!0);if(B)return B(et,!0);var eo=Error("Cannot find module '"+et+"'");throw eo.code="MODULE_NOT_FOUND",eo}var el=n[et]={exports:{}};e[et][0].call(el.exports,function(n){return i(e[et][1][n]||n)},el,el.exports,t,e,n,N)}return n[et].exports}for(var B=or,et=0;et<N.length;et++)i(N[et]);return i})({1:[function(e,n,N){var B=e("./utils"),et=e("./support"),ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";N.encode=function(e){for(var n,N,et,eo,el,eu,ec,ef=[],eh=0,ep=e.length,ed=ep,e_="string"!==B.getTypeOf(e);eh<e.length;)ed=ep-eh,et=e_?(n=e[eh++],N=eh<ep?e[eh++]:0,eh<ep?e[eh++]:0):(n=e.charCodeAt(eh++),N=eh<ep?e.charCodeAt(eh++):0,eh<ep?e.charCodeAt(eh++):0),eo=n>>2,el=(3&n)<<4|N>>4,eu=1<ed?(15&N)<<2|et>>6:64,ec=2<ed?63&et:64,ef.push(ei.charAt(eo)+ei.charAt(el)+ei.charAt(eu)+ei.charAt(ec));return ef.join("")},N.decode=function(e){var n,N,B,eo,el,eu,ec=0,ef=0,eh="data:";if(e.substr(0,eh.length)===eh)throw Error("Invalid base64 input, it looks like a data url.");var ep,ed=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===ei.charAt(64)&&ed--,e.charAt(e.length-2)===ei.charAt(64)&&ed--,ed%1!=0)throw Error("Invalid base64 input, bad content length.");for(ep=et.uint8array?new Uint8Array(0|ed):Array(0|ed);ec<e.length;)n=ei.indexOf(e.charAt(ec++))<<2|(eo=ei.indexOf(e.charAt(ec++)))>>4,N=(15&eo)<<4|(el=ei.indexOf(e.charAt(ec++)))>>2,B=(3&el)<<6|(eu=ei.indexOf(e.charAt(ec++))),ep[ef++]=n,64!==el&&(ep[ef++]=N),64!==eu&&(ep[ef++]=B);return ep}},{"./support":30,"./utils":32}],2:[function(e,n,N){var B=e("./external"),et=e("./stream/DataWorker"),ei=e("./stream/Crc32Probe"),eo=e("./stream/DataLengthProbe");function h(e,n,N,B,et){this.compressedSize=e,this.uncompressedSize=n,this.crc32=N,this.compression=B,this.compressedContent=et}h.prototype={getContentWorker:function(){var e=new et(B.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new eo("data_length")),n=this;return e.on("end",function(){if(this.streamInfo.data_length!==n.uncompressedSize)throw Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new et(B.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(e,n,N){return e.pipe(new ei).pipe(new eo("uncompressedSize")).pipe(n.compressWorker(N)).pipe(new eo("compressedSize")).withStreamInfo("compression",n)},n.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,N){var B=e("./stream/GenericWorker");N.STORE={magic:"\x00\x00",compressWorker:function(){return new B("STORE compression")},uncompressWorker:function(){return new B("STORE decompression")}},N.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,N){var B=e("./utils"),et=function(){for(var e,n=[],N=0;N<256;N++){e=N;for(var B=0;B<8;B++)e=1&e?3988292384^e>>>1:e>>>1;n[N]=e}return n}();n.exports=function(e,n){return void 0!==e&&e.length?"string"!==B.getTypeOf(e)?function(e,n,N,B){var ei=B+N;e^=-1;for(var eo=B;eo<ei;eo++)e=e>>>8^et[255&(e^n[eo])];return -1^e}(0|n,e,e.length,0):function(e,n,N,B){var ei=B+N;e^=-1;for(var eo=B;eo<ei;eo++)e=e>>>8^et[255&(e^n.charCodeAt(eo))];return -1^e}(0|n,e,e.length,0):0}},{"./utils":32}],5:[function(e,n,N){N.base64=!1,N.binary=!1,N.dir=!1,N.createFolders=!0,N.date=null,N.compression=null,N.compressionOptions=null,N.comment=null,N.unixPermissions=null,N.dosPermissions=null},{}],6:[function(e,n,N){var B=null;B="u">typeof Promise?Promise:e("lie"),n.exports={Promise:B}},{lie:37}],7:[function(e,n,N){var B="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Uint32Array,et=e("pako"),ei=e("./utils"),eo=e("./stream/GenericWorker"),el=B?"uint8array":"array";function w(e,n){eo.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=n,this.meta={}}N.magic="\b\x00",ei.inherits(w,eo),w.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(ei.transformTo(el,e.data),!1)},w.prototype.flush=function(){eo.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},w.prototype.cleanUp=function(){eo.prototype.cleanUp.call(this),this._pako=null},w.prototype._createPako=function(){this._pako=new et[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(n){e.push({data:n,meta:e.meta})}},N.compressWorker=function(e){return new w("Deflate",e)},N.uncompressWorker=function(){return new w("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,N){function a(e,n){var N,B="";for(N=0;N<n;N++)B+=String.fromCharCode(255&e),e>>>=8;return B}function i(e,n,N,et,eu,ec){var ef,eh,ep,ed,e_=e.file,eg=e.compression,em=ec!==ei.utf8encode,eb=B.transformTo("string",ec(e_.name)),ey=B.transformTo("string",ei.utf8encode(e_.name)),ev=e_.comment,ek=B.transformTo("string",ec(ev)),eA=B.transformTo("string",ei.utf8encode(ev)),eL=ey.length!==e_.name.length,ex=eA.length!==ev.length,ew="",eT="",eO="",eE=e_.dir,eS=e_.date,eN={crc32:0,compressedSize:0,uncompressedSize:0};n&&!N||(eN.crc32=e.crc32,eN.compressedSize=e.compressedSize,eN.uncompressedSize=e.uncompressedSize);var eI=0;n&&(eI|=8),!em&&(eL||ex)&&(eI|=2048);var eR=0,eU=0;eE&&(eR|=16),"UNIX"===eu?(eU=798,eR|=(eh=ef=e_.unixPermissions,ef||(eh=eE?16893:33204),(65535&eh)<<16)):(eU=20,eR|=63&(e_.dosPermissions||0)),ep=(eS.getUTCHours()<<6|eS.getUTCMinutes())<<5|eS.getUTCSeconds()/2,ed=(eS.getUTCFullYear()-1980<<4|eS.getUTCMonth()+1)<<5|eS.getUTCDate(),eL&&(eT=a(1,1)+a(eo(eb),4)+ey,ew+="up"+a(eT.length,2)+eT),ex&&(eO=a(1,1)+a(eo(ek),4)+eA,ew+="uc"+a(eO.length,2)+eO);var eC="";return eC+=`
\0`+a(eI,2)+eg.magic+a(ep,2)+a(ed,2)+a(eN.crc32,4)+a(eN.compressedSize,4)+a(eN.uncompressedSize,4)+a(eb.length,2)+a(ew.length,2),{fileRecord:el.LOCAL_FILE_HEADER+eC+eb+ew,dirRecord:el.CENTRAL_FILE_HEADER+a(eU,2)+eC+a(ek.length,2)+"\x00\x00\x00\x00"+a(eR,4)+a(et,4)+eb+ew+ek}}var B=e("../utils"),et=e("../stream/GenericWorker"),ei=e("../utf8"),eo=e("../crc32"),el=e("../signature");function L(e,n,N,B){et.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=n,this.zipPlatform=N,this.encodeFileName=B,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}B.inherits(L,et),L.prototype.push=function(e){var n=e.meta.percent||0,N=this.entriesCount,B=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,et.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:N?(n+100*(N-B-1))/N:100}}))},L.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var n=this.streamFiles&&!e.file.dir;if(n){var N=i(e,n,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:N.fileRecord,meta:{percent:0}})}else this.accumulate=!0},L.prototype.closedSource=function(e){this.accumulate=!1;var n=this.streamFiles&&!e.file.dir,N=i(e,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(N.dirRecord),n)this.push({data:el.DATA_DESCRIPTOR+a(e.crc32,4)+a(e.compressedSize,4)+a(e.uncompressedSize,4),meta:{percent:100}});else for(this.push({data:N.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},L.prototype.flush=function(){for(var e,n,N,et,ei=this.bytesWritten,eo=0;eo<this.dirRecords.length;eo++)this.push({data:this.dirRecords[eo],meta:{percent:100}});var eu=this.bytesWritten-ei,ec=(e=this.dirRecords.length,n=this.zipComment,N=this.encodeFileName,et=B.transformTo("string",N(n)),el.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+a(e,2)+a(e,2)+a(eu,4)+a(ei,4)+a(et.length,2)+et);this.push({data:ec,meta:{percent:100}})},L.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},L.prototype.registerPrevious=function(e){this._sources.push(e);var n=this;return e.on("data",function(e){n.processChunk(e)}),e.on("end",function(){n.closedSource(n.previous.streamInfo),n._sources.length?n.prepareNextSource():n.end()}),e.on("error",function(e){n.error(e)}),this},L.prototype.resume=function(){return!!et.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},L.prototype.error=function(e){var n=this._sources;if(!et.prototype.error.call(this,e))return!1;for(var N=0;N<n.length;N++)try{n[N].error(e)}catch{}return!0},L.prototype.lock=function(){et.prototype.lock.call(this);for(var e=this._sources,n=0;n<e.length;n++)e[n].lock()},n.exports=L},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,N){var B=e("../compressions"),et=e("./ZipFileWorker");N.generateWorker=function(e,n,N){var ei=new et(n.streamFiles,N,n.platform,n.encodeFileName),eo=0;try{e.forEach(function(e,N){eo++;var et=function(e,n){var N=e||n,et=B[N];if(!et)throw Error(N+" is not a valid compression method !");return et}(N.options.compression,n.compression),el=N.options.compressionOptions||n.compressionOptions||{},eu=N.dir,ec=N.date;N._compressWorker(et,el).withStreamInfo("file",{name:e,dir:eu,date:ec,comment:N.comment||"",unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions}).pipe(ei)}),ei.entriesCount=eo}catch(e){ei.error(e)}return ei}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,N){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new a;for(var n in this)"function"!=typeof this[n]&&(e[n]=this[n]);return e}}(a.prototype=e("./object")).loadAsync=e("./load"),a.support=e("./support"),a.defaults=e("./defaults"),a.version="3.10.1",a.loadAsync=function(e,n){return new a().loadAsync(e,n)},a.external=e("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,N){var B=e("./utils"),et=e("./external"),ei=e("./utf8"),eo=e("./zipEntries"),el=e("./stream/Crc32Probe"),eu=e("./nodejsUtils");n.exports=function(e,n){var N=this;return n=B.extend(n||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:ei.utf8decode}),eu.isNode&&eu.isStream(e)?et.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):B.prepareContent("the loaded zip file",e,!0,n.optimizedBinaryString,n.base64).then(function(e){var N=new eo(n);return N.load(e),N}).then(function(e){var N=[et.Promise.resolve(e)],B=e.files;if(n.checkCRC32)for(var ei=0;ei<B.length;ei++)N.push(function(e){return new et.Promise(function(n,N){var B=e.decompressed.getContentWorker().pipe(new el);B.on("error",function(e){N(e)}).on("end",function(){B.streamInfo.crc32!==e.decompressed.crc32?N(Error("Corrupted zip : CRC32 mismatch")):n()}).resume()})}(B[ei]));return et.Promise.all(N)}).then(function(e){for(var et=e.shift(),ei=et.files,eo=0;eo<ei.length;eo++){var el=ei[eo],eu=el.fileNameStr,ec=B.resolve(el.fileNameStr);N.file(ec,el.decompressed,{binary:!0,optimizedBinaryString:!0,date:el.date,dir:el.dir,comment:el.fileCommentStr.length?el.fileCommentStr:null,unixPermissions:el.unixPermissions,dosPermissions:el.dosPermissions,createFolders:n.createFolders}),el.dir||(N.file(ec).unsafeOriginalName=eu)}return et.zipComment.length&&(N.comment=et.zipComment),N})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,N){var B=e("../utils"),et=e("../stream/GenericWorker");function l(e,n){et.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(n)}B.inherits(l,et),l.prototype._bindStream=function(e){var n=this;(this._stream=e).pause(),e.on("data",function(e){n.push({data:e,meta:{percent:0}})}).on("error",function(e){n.isPaused?this.generatedError=e:n.error(e)}).on("end",function(){n.isPaused?n._upstreamEnded=!0:n.end()})},l.prototype.pause=function(){return!!et.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!et.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,N){var B=e("readable-stream").Readable;function i(e,n,N){B.call(this,n),this._helper=e;var et=this;e.on("data",function(e,n){et.push(e)||et._helper.pause(),N&&N(n)}).on("error",function(e){et.emit("error",e)}).on("end",function(){et.push(null)})}e("../utils").inherits(i,B),i.prototype._read=function(){this._helper.resume()},n.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,n,N){n.exports={isNode:"u">typeof ec,newBufferFrom:function(e,n){if(ec.from&&ec.from!==Uint8Array.from)return ec.from(e,n);if("number"==typeof e)throw Error('The "data" argument must not be a number');return new ec(e,n)},allocBuffer:function(e){if(ec.alloc)return ec.alloc(e);var n=new ec(e);return n.fill(0),n},isBuffer:function(e){return ec.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,n,N){function a(e,n,N){var B,eo=et.getTypeOf(n),ef=et.extend(N||{},el);ef.date=ef.date||new Date,null!==ef.compression&&(ef.compression=ef.compression.toUpperCase()),"string"==typeof ef.unixPermissions&&(ef.unixPermissions=parseInt(ef.unixPermissions,8)),ef.unixPermissions&&16384&ef.unixPermissions&&(ef.dir=!0),ef.dosPermissions&&16&ef.dosPermissions&&(ef.dir=!0),ef.dir&&(e=b(e)),ef.createFolders&&(B=m(e))&&R.call(this,B,!0);var ed="string"===eo&&!1===ef.binary&&!1===ef.base64;N&&void 0!==N.binary||(ef.binary=!ed),(n instanceof eu&&0===n.uncompressedSize||ef.dir||!n||0===n.length)&&(ef.base64=!1,ef.binary=!0,n="",ef.compression="STORE",eo="string");var e_=null;e_=n instanceof eu||n instanceof ei?n:eh.isNode&&eh.isStream(n)?new ep(e,n):et.prepareContent(e,n,ef.binary,ef.optimizedBinaryString,ef.base64);var eg=new ec(e,e_,ef);this.files[e]=eg}var B=e("./utf8"),et=e("./utils"),ei=e("./stream/GenericWorker"),eo=e("./stream/StreamHelper"),el=e("./defaults"),eu=e("./compressedObject"),ec=e("./zipObject"),ef=e("./generate"),eh=e("./nodejsUtils"),ep=e("./nodejs/NodejsStreamInputAdapter"),m=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var n=e.lastIndexOf("/");return 0<n?e.substring(0,n):""},b=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},R=function(e,n){return n=void 0!==n?n:el.createFolders,e=b(e),this.files[e]||a.call(this,e,null,{dir:!0,createFolders:n}),this.files[e]};function M(e){return"[object RegExp]"===Object.prototype.toString.call(e)}n.exports={load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var n,N,B;for(n in this.files)B=this.files[n],(N=n.slice(this.root.length,n.length))&&n.slice(0,this.root.length)===this.root&&e(N,B)},filter:function(e){var n=[];return this.forEach(function(N,B){e(N,B)&&n.push(B)}),n},file:function(e,n,N){if(1!=arguments.length)return e=this.root+e,a.call(this,e,n,N),this;if(M(e)){var B=e;return this.filter(function(e,n){return!n.dir&&B.test(e)})}var et=this.files[this.root+e];return et&&!et.dir?et:null},folder:function(e){if(!e)return this;if(M(e))return this.filter(function(n,N){return N.dir&&e.test(n)});var n=this.root+e,N=R.call(this,n),B=this.clone();return B.root=N.name,B},remove:function(e){e=this.root+e;var n=this.files[e];if(n||("/"!==e.slice(-1)&&(e+="/"),n=this.files[e]),n&&!n.dir)delete this.files[e];else for(var N=this.filter(function(n,N){return N.name.slice(0,e.length)===e}),B=0;B<N.length;B++)delete this.files[N[B].name];return this},generate:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var n,N={};try{if((N=et.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:B.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),"binarystring"===N.type&&(N.type="string"),!N.type)throw Error("No output type specified.");et.checkSupport(N.type),"darwin"!==N.platform&&"freebsd"!==N.platform&&"linux"!==N.platform&&"sunos"!==N.platform||(N.platform="UNIX"),"win32"===N.platform&&(N.platform="DOS");var el=N.comment||this.comment||"";n=ef.generateWorker(this,N,el)}catch(e){(n=new ei("error")).error(e)}return new eo(n,N.type||"string",N.mimeType)},generateAsync:function(e,n){return this.generateInternalStream(e).accumulate(n)},generateNodeStream:function(e,n){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(n)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,N){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,N){var B=e("./DataReader");function i(e){B.call(this,e);for(var n=0;n<this.data.length;n++)e[n]=255&e[n]}e("../utils").inherits(i,B),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var n=e.charCodeAt(0),N=e.charCodeAt(1),B=e.charCodeAt(2),et=e.charCodeAt(3),ei=this.length-4;0<=ei;--ei)if(this.data[ei]===n&&this.data[ei+1]===N&&this.data[ei+2]===B&&this.data[ei+3]===et)return ei-this.zero;return -1},i.prototype.readAndCheckSignature=function(e){var n=e.charCodeAt(0),N=e.charCodeAt(1),B=e.charCodeAt(2),et=e.charCodeAt(3),ei=this.readData(4);return n===ei[0]&&N===ei[1]&&B===ei[2]&&et===ei[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var n=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,n},n.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,n,N){var B=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var n,N=0;for(this.checkOffset(e),n=this.index+e-1;n>=this.index;n--)N=(N<<8)+this.byteAt(n);return this.index+=e,N},readString:function(e){return B.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},n.exports=i},{"../utils":32}],19:[function(e,n,N){var B=e("./Uint8ArrayReader");function i(e){B.call(this,e)}e("../utils").inherits(i,B),i.prototype.readData=function(e){this.checkOffset(e);var n=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,n},n.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,N){var B=e("./DataReader");function i(e){B.call(this,e)}e("../utils").inherits(i,B),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var n=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,n},n.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,n,N){var B=e("./ArrayReader");function i(e){B.call(this,e)}e("../utils").inherits(i,B),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var n=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,n},n.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,N){var B=e("../utils"),et=e("../support"),ei=e("./ArrayReader"),eo=e("./StringReader"),el=e("./NodeBufferReader"),eu=e("./Uint8ArrayReader");n.exports=function(e){var n=B.getTypeOf(e);return B.checkSupport(n),"string"!==n||et.uint8array?"nodebuffer"===n?new el(e):et.uint8array?new eu(B.transformTo("uint8array",e)):new ei(B.transformTo("array",e)):new eo(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,N){N.LOCAL_FILE_HEADER="PK\x03\x04",N.CENTRAL_FILE_HEADER="PK\x01\x02",N.CENTRAL_DIRECTORY_END="PK\x05\x06",N.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",N.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",N.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,N){var B=e("./GenericWorker"),et=e("../utils");function l(e){B.call(this,"ConvertWorker to "+e),this.destType=e}et.inherits(l,B),l.prototype.processChunk=function(e){this.push({data:et.transformTo(this.destType,e.data),meta:e.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,N){var B=e("./GenericWorker"),et=e("../crc32");function l(){B.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,B),l.prototype.processChunk=function(e){this.streamInfo.crc32=et(e.data,this.streamInfo.crc32||0),this.push(e)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,N){var B=e("../utils"),et=e("./GenericWorker");function l(e){et.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}B.inherits(l,et),l.prototype.processChunk=function(e){if(e){var n=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=n+e.data.length}et.prototype.processChunk.call(this,e)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,N){var B=e("../utils"),et=e("./GenericWorker");function l(e){et.call(this,"DataWorker");var n=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){n.dataIsReady=!0,n.data=e,n.max=e&&e.length||0,n.type=B.getTypeOf(e),n.isPaused||n._tickAndRepeat()},function(e){n.error(e)})}B.inherits(l,et),l.prototype.cleanUp=function(){et.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!et.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,B.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(B.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,n=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,n);break;case"uint8array":e=this.data.subarray(this.index,n);break;case"array":case"nodebuffer":e=this.data.slice(this.index,n)}return this.index=n,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,N){function a(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,n){return this._listeners[e].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,n){if(this._listeners[e])for(var N=0;N<this._listeners[e].length;N++)this._listeners[e][N].call(this,n)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var n=this;return e.on("data",function(e){n.processChunk(e)}),e.on("end",function(){n.end()}),e.on("error",function(e){n.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,n){return this.extraStreamInfo[e]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},n.exports=a},{}],29:[function(e,n,N){var B=e("../utils"),et=e("./ConvertWorker"),ei=e("./GenericWorker"),eo=e("../base64"),el=e("../support"),eu=e("../external"),ef=null;if(el.nodestream)try{ef=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(e,n,N){var eo=n;switch(n){case"blob":case"arraybuffer":eo="uint8array";break;case"base64":eo="string"}try{this._internalType=eo,this._outputType=n,this._mimeType=N,B.checkSupport(eo),this._worker=e.pipe(new et(eo)),e.lock()}catch(e){this._worker=new ei("error"),this._worker.error(e)}}_.prototype={accumulate:function(e){var n;return n=this,new eu.Promise(function(N,et){var ei=[],el=n._internalType,eu=n._outputType,ef=n._mimeType;n.on("data",function(n,N){ei.push(n),e&&e(N)}).on("error",function(e){ei=[],et(e)}).on("end",function(){try{var e=function(e,n,N){switch(e){case"blob":return B.newBlob(B.transformTo("arraybuffer",n),N);case"base64":return eo.encode(n);default:return B.transformTo(e,n)}}(eu,function(e,n){var N,B=0,et=null,ei=0;for(N=0;N<n.length;N++)ei+=n[N].length;switch(e){case"string":return n.join("");case"array":return Array.prototype.concat.apply([],n);case"uint8array":for(et=new Uint8Array(ei),N=0;N<n.length;N++)et.set(n[N],B),B+=n[N].length;return et;case"nodebuffer":return ec.concat(n);default:throw Error("concat : unsupported type '"+e+"'")}}(el,ei),ef);N(e)}catch(e){et(e)}ei=[]}).resume()})},on:function(e,n){var N=this;return"data"===e?this._worker.on(e,function(e){n.call(N,e.data,e.meta)}):this._worker.on(e,function(){B.delay(n,arguments,N)}),this},resume:function(){return B.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(B.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+" is not supported by this method");return new ef(this,{objectMode:"nodebuffer"!==this._outputType},e)}},n.exports=_},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,N){if(N.base64=!0,N.array=!0,N.string=!0,N.arraybuffer="u">typeof ArrayBuffer&&"u">typeof Uint8Array,N.nodebuffer="u">typeof ec,N.uint8array="u">typeof Uint8Array,typeof ArrayBuffer>"u")N.blob=!1;else{var B=new ArrayBuffer(0);try{N.blob=0===new Blob([B],{type:"application/zip"}).size}catch{try{var et=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);et.append(B),N.blob=0===et.getBlob("application/zip").size}catch{N.blob=!1}}}try{N.nodestream=!!e("readable-stream").Readable}catch{N.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,N){for(var B=e("./utils"),et=e("./support"),ei=e("./nodejsUtils"),eo=e("./stream/GenericWorker"),el=Array(256),eu=0;eu<256;eu++)el[eu]=252<=eu?6:248<=eu?5:240<=eu?4:224<=eu?3:192<=eu?2:1;function d(){eo.call(this,"utf-8 decode"),this.leftOver=null}function L(){eo.call(this,"utf-8 encode")}el[254]=el[254]=1,N.utf8encode=function(e){return et.nodebuffer?ei.newBufferFrom(e,"utf-8"):function(e){var n,N,B,ei,eo,el=e.length,eu=0;for(ei=0;ei<el;ei++)(64512&(N=e.charCodeAt(ei)))==55296&&ei+1<el&&(64512&(B=e.charCodeAt(ei+1)))==56320&&(N=65536+(N-55296<<10)+(B-56320),ei++),eu+=N<128?1:N<2048?2:N<65536?3:4;for(n=et.uint8array?new Uint8Array(eu):Array(eu),ei=eo=0;eo<eu;ei++)(64512&(N=e.charCodeAt(ei)))==55296&&ei+1<el&&(64512&(B=e.charCodeAt(ei+1)))==56320&&(N=65536+(N-55296<<10)+(B-56320),ei++),N<128?n[eo++]=N:(N<2048?n[eo++]=192|N>>>6:(N<65536?n[eo++]=224|N>>>12:(n[eo++]=240|N>>>18,n[eo++]=128|N>>>12&63),n[eo++]=128|N>>>6&63),n[eo++]=128|63&N);return n}(e)},N.utf8decode=function(e){return et.nodebuffer?B.transformTo("nodebuffer",e).toString("utf-8"):function(e){var n,N,et,ei,eo=e.length,eu=Array(2*eo);for(n=N=0;n<eo;)if((et=e[n++])<128)eu[N++]=et;else if(4<(ei=el[et]))eu[N++]=65533,n+=ei-1;else{for(et&=2===ei?31:3===ei?15:7;1<ei&&n<eo;)et=et<<6|63&e[n++],ei--;1<ei?eu[N++]=65533:et<65536?eu[N++]=et:(et-=65536,eu[N++]=55296|et>>10&1023,eu[N++]=56320|1023&et)}return eu.length!==N&&(eu.subarray?eu=eu.subarray(0,N):eu.length=N),B.applyFromCharCode(eu)}(e=B.transformTo(et.uint8array?"uint8array":"array",e))},B.inherits(d,eo),d.prototype.processChunk=function(e){var n=B.transformTo(et.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(et.uint8array){var ei=n;(n=new Uint8Array(ei.length+this.leftOver.length)).set(this.leftOver,0),n.set(ei,this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}var eo=function(e,n){var N;for((n=n||e.length)>e.length&&(n=e.length),N=n-1;0<=N&&(192&e[N])==128;)N--;return N<0||0===N?n:N+el[e[N]]>n?N:n}(n),eu=n;eo!==n.length&&(et.uint8array?(eu=n.subarray(0,eo),this.leftOver=n.subarray(eo,n.length)):(eu=n.slice(0,eo),this.leftOver=n.slice(eo,n.length))),this.push({data:N.utf8decode(eu),meta:e.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:N.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},N.Utf8DecodeWorker=d,B.inherits(L,eo),L.prototype.processChunk=function(e){this.push({data:N.utf8encode(e.data),meta:e.meta})},N.Utf8EncodeWorker=L},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,N){var B=e("./support"),et=e("./base64"),ei=e("./nodejsUtils"),eo=e("./external");function h(e){return e}function w(e,n){for(var N=0;N<e.length;++N)n[N]=255&e.charCodeAt(N);return n}e("setimmediate"),N.newBlob=function(e,n){N.checkSupport("blob");try{return new Blob([e],{type:n})}catch{try{var B=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return B.append(e),B.getBlob(n)}catch{throw Error("Bug : can't construct the Blob.")}}};var el={stringifyByChunk:function(e,n,N){var B=[],et=0,ei=e.length;if(ei<=N)return String.fromCharCode.apply(null,e);for(;et<ei;)"array"===n||"nodebuffer"===n?B.push(String.fromCharCode.apply(null,e.slice(et,Math.min(et+N,ei)))):B.push(String.fromCharCode.apply(null,e.subarray(et,Math.min(et+N,ei)))),et+=N;return B.join("")},stringifyByChar:function(e){for(var n="",N=0;N<e.length;N++)n+=String.fromCharCode(e[N]);return n},applyCanBeUsed:{uint8array:function(){try{return B.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return B.nodebuffer&&1===String.fromCharCode.apply(null,ei.allocBuffer(1)).length}catch{return!1}}()}};function L(e){var n=65536,B=N.getTypeOf(e),et=!0;if("uint8array"===B?et=el.applyCanBeUsed.uint8array:"nodebuffer"===B&&(et=el.applyCanBeUsed.nodebuffer),et)for(;1<n;)try{return el.stringifyByChunk(e,B,n)}catch{n=Math.floor(n/2)}return el.stringifyByChar(e)}function _(e,n){for(var N=0;N<e.length;N++)n[N]=e[N];return n}N.applyFromCharCode=L;var eu={};eu.string={string:h,array:function(e){return w(e,Array(e.length))},arraybuffer:function(e){return eu.string.uint8array(e).buffer},uint8array:function(e){return w(e,new Uint8Array(e.length))},nodebuffer:function(e){return w(e,ei.allocBuffer(e.length))}},eu.array={string:L,array:h,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return ei.newBufferFrom(e)}},eu.arraybuffer={string:function(e){return L(new Uint8Array(e))},array:function(e){return _(new Uint8Array(e),Array(e.byteLength))},arraybuffer:h,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return ei.newBufferFrom(new Uint8Array(e))}},eu.uint8array={string:L,array:function(e){return _(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:h,nodebuffer:function(e){return ei.newBufferFrom(e)}},eu.nodebuffer={string:L,array:function(e){return _(e,Array(e.length))},arraybuffer:function(e){return eu.nodebuffer.uint8array(e).buffer},uint8array:function(e){return _(e,new Uint8Array(e.length))},nodebuffer:h},N.transformTo=function(e,n){return(n=n||"",e)?(N.checkSupport(e),eu[N.getTypeOf(n)][e](n)):n},N.resolve=function(e){for(var n=e.split("/"),N=[],B=0;B<n.length;B++){var et=n[B];"."===et||""===et&&0!==B&&B!==n.length-1||(".."===et?N.pop():N.push(et))}return N.join("/")},N.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":B.nodebuffer&&ei.isBuffer(e)?"nodebuffer":B.uint8array&&e instanceof Uint8Array?"uint8array":B.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},N.checkSupport=function(e){if(!B[e.toLowerCase()])throw Error(e+" is not supported by this platform")},N.MAX_VALUE_16BITS=65535,N.MAX_VALUE_32BITS=-1,N.pretty=function(e){var n,N,B="";for(N=0;N<(e||"").length;N++)B+="\\x"+((n=e.charCodeAt(N))<16?"0":"")+n.toString(16).toUpperCase();return B},N.delay=function(e,n,N){setImmediate(function(){e.apply(N||null,n||[])})},N.inherits=function(e,n){function b(){}b.prototype=n.prototype,e.prototype=new b},N.extend=function(){var e,n,N={};for(e=0;e<arguments.length;e++)for(n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&void 0===N[n]&&(N[n]=arguments[e][n]);return N},N.prepareContent=function(e,n,ei,el,eu){return eo.Promise.resolve(n).then(function(e){return B.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"u">typeof FileReader?new eo.Promise(function(n,N){var B=new FileReader;B.onload=function(e){n(e.target.result)},B.onerror=function(e){N(e.target.error)},B.readAsArrayBuffer(e)}):e}).then(function(n){var ec,ef=N.getTypeOf(n);return ef?("arraybuffer"===ef?n=N.transformTo("uint8array",n):"string"===ef&&(eu?n=et.decode(n):ei&&!0!==el&&(n=w(ec=n,B.uint8array?new Uint8Array(ec.length):Array(ec.length)))),n):eo.Promise.reject(Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,N){var B=e("./reader/readerFor"),et=e("./utils"),ei=e("./signature"),eo=e("./zipEntry"),el=e("./support");function w(e){this.files=[],this.loadOptions=e}w.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var n=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+et.pretty(n)+", expected "+et.pretty(e)+")")}},isSignature:function(e,n){var N=this.reader.index;this.reader.setIndex(e);var B=this.reader.readString(4)===n;return this.reader.setIndex(N),B},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),n=el.uint8array?"uint8array":"array",N=et.transformTo(n,e);this.zipComment=this.loadOptions.decodeFileName(N)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,n,N,B=this.zip64EndOfCentralSize-44;0<B;)e=this.reader.readInt(2),n=this.reader.readInt(4),N=this.reader.readData(n),this.zip64ExtensibleData[e]={id:e,length:n,value:N}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,n;for(e=0;e<this.files.length;e++)n=this.files[e],this.reader.setIndex(n.localHeaderOffset),this.checkSignature(ei.LOCAL_FILE_HEADER),n.readLocalPart(this.reader),n.handleUTF8(),n.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(ei.CENTRAL_FILE_HEADER);)(e=new eo({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(ei.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,ei.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var n=e;if(this.checkSignature(ei.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===et.MAX_VALUE_16BITS||this.diskWithCentralDirStart===et.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===et.MAX_VALUE_16BITS||this.centralDirRecords===et.MAX_VALUE_16BITS||this.centralDirSize===et.MAX_VALUE_32BITS||this.centralDirOffset===et.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(ei.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(ei.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,ei.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(ei.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(ei.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var N=this.centralDirOffset+this.centralDirSize;this.zip64&&(N+=20+(12+this.zip64EndOfCentralSize));var B=n-N;if(0<B)this.isSignature(n,ei.CENTRAL_FILE_HEADER)||(this.reader.zero=B);else if(B<0)throw Error("Corrupted zip: missing "+Math.abs(B)+" bytes.")},prepareReader:function(e){this.reader=B(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=w},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,N){var B=e("./reader/readerFor"),et=e("./utils"),ei=e("./compressedObject"),eo=e("./crc32"),el=e("./utf8"),eu=e("./compressions"),ec=e("./support");function L(e,n){this.options=e,this.loadOptions=n}L.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(e){var n,N;if(e.skip(22),this.fileNameLength=e.readInt(2),N=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(N),-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(n=function(e){for(var n in eu)if(Object.prototype.hasOwnProperty.call(eu,n)&&eu[n].magic===e)return eu[n];return null}(this.compressionMethod)))throw Error("Corrupted zip : compression "+et.pretty(this.compressionMethod)+" unknown (inner file : "+et.transformTo("string",this.fileName)+")");this.decompressed=new ei(this.compressedSize,this.uncompressedSize,this.crc32,n,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var n=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");e.skip(n),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=B(this.extraFields[1].value);this.uncompressedSize===et.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===et.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===et.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===et.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var n,N,B,et=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<et;)n=e.readInt(2),N=e.readInt(2),B=e.readData(N),this.extraFields[n]={id:n,length:N,value:B};e.setIndex(et)},handleUTF8:function(){var e=ec.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=el.utf8decode(this.fileName),this.fileCommentStr=el.utf8decode(this.fileComment);else{var n=this.findExtraFieldUnicodePath();if(null!==n)this.fileNameStr=n;else{var N=et.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(N)}var B=this.findExtraFieldUnicodeComment();if(null!==B)this.fileCommentStr=B;else{var ei=et.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(ei)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var n=B(e.value);return 1!==n.readInt(1)||eo(this.fileName)!==n.readInt(4)?null:el.utf8decode(n.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var n=B(e.value);return 1!==n.readInt(1)||eo(this.fileComment)!==n.readInt(4)?null:el.utf8decode(n.readData(e.length-5))}return null}},n.exports=L},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,N){function a(e,n,N){this.name=e,this.dir=N.dir,this.date=N.date,this.comment=N.comment,this.unixPermissions=N.unixPermissions,this.dosPermissions=N.dosPermissions,this._data=n,this._dataBinary=N.binary,this.options={compression:N.compression,compressionOptions:N.compressionOptions}}var B=e("./stream/StreamHelper"),et=e("./stream/DataWorker"),ei=e("./utf8"),eo=e("./compressedObject"),el=e("./stream/GenericWorker");a.prototype={internalStream:function(e){var n=null,N="string";try{if(!e)throw Error("No output type specified.");var et="string"===(N=e.toLowerCase())||"text"===N;"binarystring"!==N&&"text"!==N||(N="string"),n=this._decompressWorker();var eo=!this._dataBinary;eo&&!et&&(n=n.pipe(new ei.Utf8EncodeWorker)),!eo&&et&&(n=n.pipe(new ei.Utf8DecodeWorker))}catch(e){(n=new el("error")).error(e)}return new B(n,N,"")},async:function(e,n){return this.internalStream(e).accumulate(n)},nodeStream:function(e,n){return this.internalStream(e||"nodebuffer").toNodejsStream(n)},_compressWorker:function(e,n){if(this._data instanceof eo&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var N=this._decompressWorker();return this._dataBinary||(N=N.pipe(new ei.Utf8EncodeWorker)),eo.createWorkerFrom(N,e,n)},_decompressWorker:function(){return this._data instanceof eo?this._data.getContentWorker():this._data instanceof el?this._data:new et(this._data)}};for(var eu=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],L=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},ec=0;ec<eu.length;ec++)a.prototype[eu[ec]]=L;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,N){(function(e){var N,B,et=e.MutationObserver||e.WebKitMutationObserver;if(et){var ei=0,eo=new et(E),el=e.document.createTextNode("");eo.observe(el,{characterData:!0}),N=function(){el.data=ei=++ei%2}}else if(e.setImmediate||void 0===e.MessageChannel)N="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var n=e.document.createElement("script");n.onreadystatechange=function(){E(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},e.document.documentElement.appendChild(n)}:function(){setTimeout(E,0)};else{var eu=new e.MessageChannel;eu.port1.onmessage=E,N=function(){eu.port2.postMessage(0)}}var ec=[];function E(){var e,n;B=!0;for(var N=ec.length;N;){for(n=ec,ec=[],e=-1;++e<N;)n[e]();N=ec.length}B=!1}n.exports=function(e){1!==ec.push(e)||B||N()}}).call(this,"u">typeof th?th:"u">typeof self?self:"u">typeof window?window:{})},{}],37:[function(e,n,N){var B=e("immediate");function i(){}var et={},ei=["REJECTED"],eo=["FULFILLED"],el=["PENDING"];function d(e){if("function"!=typeof e)throw TypeError("resolver must be a function");this.state=el,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function L(e,n,N){this.promise=e,"function"==typeof n&&(this.onFulfilled=n,this.callFulfilled=this.otherCallFulfilled),"function"==typeof N&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function _(e,n,N){B(function(){var B;try{B=n(N)}catch(n){return et.reject(e,n)}B===e?et.reject(e,TypeError("Cannot resolve promise with itself")):et.resolve(e,B)})}function E(e){var n=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof n)return function(){n.apply(e,arguments)}}function f(e,n){var N=!1;function K(n){N||(N=!0,et.reject(e,n))}function G(n){N||(N=!0,et.resolve(e,n))}var B=m(function(){n(G,K)});"error"===B.status&&K(B.value)}function m(e,n){var N={};try{N.value=e(n),N.status="success"}catch(e){N.status="error",N.value=e}return N}(n.exports=d).prototype.finally=function(e){if("function"!=typeof e)return this;var n=this.constructor;return this.then(function(N){return n.resolve(e()).then(function(){return N})},function(N){return n.resolve(e()).then(function(){throw N})})},d.prototype.catch=function(e){return this.then(null,e)},d.prototype.then=function(e,n){if("function"!=typeof e&&this.state===eo||"function"!=typeof n&&this.state===ei)return this;var N=new this.constructor(i);return this.state!==el?_(N,this.state===eo?e:n,this.outcome):this.queue.push(new L(N,e,n)),N},L.prototype.callFulfilled=function(e){et.resolve(this.promise,e)},L.prototype.otherCallFulfilled=function(e){_(this.promise,this.onFulfilled,e)},L.prototype.callRejected=function(e){et.reject(this.promise,e)},L.prototype.otherCallRejected=function(e){_(this.promise,this.onRejected,e)},et.resolve=function(e,n){var N=m(E,n);if("error"===N.status)return et.reject(e,N.value);var B=N.value;if(B)f(e,B);else{e.state=eo,e.outcome=n;for(var ei=-1,el=e.queue.length;++ei<el;)e.queue[ei].callFulfilled(n)}return e},et.reject=function(e,n){e.state=ei,e.outcome=n;for(var N=-1,B=e.queue.length;++N<B;)e.queue[N].callRejected(n);return e},d.resolve=function(e){return e instanceof this?e:et.resolve(new this(i),e)},d.reject=function(e){var n=new this(i);return et.reject(n,e)},d.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var N=e.length,B=!1;if(!N)return this.resolve([]);for(var ei=Array(N),eo=0,el=-1,eu=new this(i);++el<N;)(function(e,el){n.resolve(e).then(function(e){ei[el]=e,++eo!==N||B||(B=!0,et.resolve(eu,ei))},function(e){B||(B=!0,et.reject(eu,e))})})(e[el],el);return eu},d.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var n,N=e.length,B=!1;if(!N)return this.resolve([]);for(var ei=-1,eo=new this(i);++ei<N;)n=e[ei],this.resolve(n).then(function(e){B||(B=!0,et.resolve(eo,e))},function(e){B||(B=!0,et.reject(eo,e))});return eo}},{immediate:36}],38:[function(e,n,N){var B={};(0,e("./lib/utils/common").assign)(B,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=B},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,N){var B=e("./zlib/deflate"),et=e("./utils/common"),ei=e("./utils/strings"),eo=e("./zlib/messages"),el=e("./zlib/zstream"),eu=Object.prototype.toString;function f(e){if(!(this instanceof f))return new f(e);this.options=et.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var n,N=this.options;N.raw&&0<N.windowBits?N.windowBits=-N.windowBits:N.gzip&&0<N.windowBits&&N.windowBits<16&&(N.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new el,this.strm.avail_out=0;var ec=B.deflateInit2(this.strm,N.level,N.method,N.windowBits,N.memLevel,N.strategy);if(0!==ec)throw Error(eo[ec]);if(N.header&&B.deflateSetHeader(this.strm,N.header),N.dictionary){if(n="string"==typeof N.dictionary?ei.string2buf(N.dictionary):"[object ArrayBuffer]"===eu.call(N.dictionary)?new Uint8Array(N.dictionary):N.dictionary,0!==(ec=B.deflateSetDictionary(this.strm,n)))throw Error(eo[ec]);this._dict_set=!0}}function m(e,n){var N=new f(n);if(N.push(e,!0),N.err)throw N.msg||eo[N.err];return N.result}f.prototype.push=function(e,n){var N,eo,el=this.strm,ec=this.options.chunkSize;if(this.ended)return!1;eo=n===~~n?n:!0===n?4:0,"string"==typeof e?el.input=ei.string2buf(e):"[object ArrayBuffer]"===eu.call(e)?el.input=new Uint8Array(e):el.input=e,el.next_in=0,el.avail_in=el.input.length;do{if(0===el.avail_out&&(el.output=new et.Buf8(ec),el.next_out=0,el.avail_out=ec),1!==(N=B.deflate(el,eo))&&0!==N)return this.onEnd(N),this.ended=!0,!1;0!==el.avail_out&&(0!==el.avail_in||4!==eo&&2!==eo)||("string"===this.options.to?this.onData(ei.buf2binstring(et.shrinkBuf(el.output,el.next_out))):this.onData(et.shrinkBuf(el.output,el.next_out)))}while((0<el.avail_in||0===el.avail_out)&&1!==N);return 4===eo?(N=B.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,0===N):2!==eo||(this.onEnd(0),el.avail_out=0,!0)},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},N.Deflate=f,N.deflate=m,N.deflateRaw=function(e,n){return(n=n||{}).raw=!0,m(e,n)},N.gzip=function(e,n){return(n=n||{}).gzip=!0,m(e,n)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,N){var B=e("./zlib/inflate"),et=e("./utils/common"),ei=e("./utils/strings"),eo=e("./zlib/constants"),el=e("./zlib/messages"),eu=e("./zlib/zstream"),ec=e("./zlib/gzheader"),ef=Object.prototype.toString;function _(e){if(!(this instanceof _))return new _(e);this.options=et.assign({chunkSize:16384,windowBits:0,to:""},e||{});var n=this.options;n.raw&&0<=n.windowBits&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),!(0<=n.windowBits&&n.windowBits<16)||e&&e.windowBits||(n.windowBits+=32),15<n.windowBits&&n.windowBits<48&&!(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eu,this.strm.avail_out=0;var N=B.inflateInit2(this.strm,n.windowBits);if(N!==eo.Z_OK)throw Error(el[N]);this.header=new ec,B.inflateGetHeader(this.strm,this.header)}function E(e,n){var N=new _(n);if(N.push(e,!0),N.err)throw N.msg||el[N.err];return N.result}_.prototype.push=function(e,n){var N,el,eu,ec,eh,ep,ed=this.strm,e_=this.options.chunkSize,eg=this.options.dictionary,em=!1;if(this.ended)return!1;el=n===~~n?n:!0===n?eo.Z_FINISH:eo.Z_NO_FLUSH,"string"==typeof e?ed.input=ei.binstring2buf(e):"[object ArrayBuffer]"===ef.call(e)?ed.input=new Uint8Array(e):ed.input=e,ed.next_in=0,ed.avail_in=ed.input.length;do{if(0===ed.avail_out&&(ed.output=new et.Buf8(e_),ed.next_out=0,ed.avail_out=e_),(N=B.inflate(ed,eo.Z_NO_FLUSH))===eo.Z_NEED_DICT&&eg&&(ep="string"==typeof eg?ei.string2buf(eg):"[object ArrayBuffer]"===ef.call(eg)?new Uint8Array(eg):eg,N=B.inflateSetDictionary(this.strm,ep)),N===eo.Z_BUF_ERROR&&!0===em&&(N=eo.Z_OK,em=!1),N!==eo.Z_STREAM_END&&N!==eo.Z_OK)return this.onEnd(N),this.ended=!0,!1;ed.next_out&&(0!==ed.avail_out&&N!==eo.Z_STREAM_END&&(0!==ed.avail_in||el!==eo.Z_FINISH&&el!==eo.Z_SYNC_FLUSH)||("string"===this.options.to?(eu=ei.utf8border(ed.output,ed.next_out),ec=ed.next_out-eu,eh=ei.buf2string(ed.output,eu),ed.next_out=ec,ed.avail_out=e_-ec,ec&&et.arraySet(ed.output,ed.output,eu,ec,0),this.onData(eh)):this.onData(et.shrinkBuf(ed.output,ed.next_out)))),0===ed.avail_in&&0===ed.avail_out&&(em=!0)}while((0<ed.avail_in||0===ed.avail_out)&&N!==eo.Z_STREAM_END);return N===eo.Z_STREAM_END&&(el=eo.Z_FINISH),el===eo.Z_FINISH?(N=B.inflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===eo.Z_OK):el!==eo.Z_SYNC_FLUSH||(this.onEnd(eo.Z_OK),ed.avail_out=0,!0)},_.prototype.onData=function(e){this.chunks.push(e)},_.prototype.onEnd=function(e){e===eo.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},N.Inflate=_,N.inflate=E,N.inflateRaw=function(e,n){return(n=n||{}).raw=!0,E(e,n)},N.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,N){var B="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Int32Array;N.assign=function(e){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var N=n.shift();if(N){if("object"!=typeof N)throw TypeError(N+"must be non-object");for(var B in N)N.hasOwnProperty(B)&&(e[B]=N[B])}}return e},N.shrinkBuf=function(e,n){return e.length===n?e:e.subarray?e.subarray(0,n):(e.length=n,e)};var et={arraySet:function(e,n,N,B,et){if(n.subarray&&e.subarray)e.set(n.subarray(N,N+B),et);else for(var ei=0;ei<B;ei++)e[et+ei]=n[N+ei]},flattenChunks:function(e){var n,N,B,et,ei,eo;for(n=B=0,N=e.length;n<N;n++)B+=e[n].length;for(eo=new Uint8Array(B),n=et=0,N=e.length;n<N;n++)ei=e[n],eo.set(ei,et),et+=ei.length;return eo}},ei={arraySet:function(e,n,N,B,et){for(var ei=0;ei<B;ei++)e[et+ei]=n[N+ei]},flattenChunks:function(e){return[].concat.apply([],e)}};N.setTyped=function(e){e?(N.Buf8=Uint8Array,N.Buf16=Uint16Array,N.Buf32=Int32Array,N.assign(N,et)):(N.Buf8=Array,N.Buf16=Array,N.Buf32=Array,N.assign(N,ei))},N.setTyped(B)},{}],42:[function(e,n,N){var B=e("./common"),et=!0,ei=!0;try{String.fromCharCode.apply(null,[0])}catch{et=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ei=!1}for(var eo=new B.Buf8(256),el=0;el<256;el++)eo[el]=252<=el?6:248<=el?5:240<=el?4:224<=el?3:192<=el?2:1;function w(e,n){if(n<65537&&(e.subarray&&ei||!e.subarray&&et))return String.fromCharCode.apply(null,B.shrinkBuf(e,n));for(var N="",eo=0;eo<n;eo++)N+=String.fromCharCode(e[eo]);return N}eo[254]=eo[254]=1,N.string2buf=function(e){var n,N,et,ei,eo,el=e.length,eu=0;for(ei=0;ei<el;ei++)(64512&(N=e.charCodeAt(ei)))==55296&&ei+1<el&&(64512&(et=e.charCodeAt(ei+1)))==56320&&(N=65536+(N-55296<<10)+(et-56320),ei++),eu+=N<128?1:N<2048?2:N<65536?3:4;for(n=new B.Buf8(eu),ei=eo=0;eo<eu;ei++)(64512&(N=e.charCodeAt(ei)))==55296&&ei+1<el&&(64512&(et=e.charCodeAt(ei+1)))==56320&&(N=65536+(N-55296<<10)+(et-56320),ei++),N<128?n[eo++]=N:(N<2048?n[eo++]=192|N>>>6:(N<65536?n[eo++]=224|N>>>12:(n[eo++]=240|N>>>18,n[eo++]=128|N>>>12&63),n[eo++]=128|N>>>6&63),n[eo++]=128|63&N);return n},N.buf2binstring=function(e){return w(e,e.length)},N.binstring2buf=function(e){for(var n=new B.Buf8(e.length),N=0,et=n.length;N<et;N++)n[N]=e.charCodeAt(N);return n},N.buf2string=function(e,n){var N,B,et,ei,el=n||e.length,eu=Array(2*el);for(N=B=0;N<el;)if((et=e[N++])<128)eu[B++]=et;else if(4<(ei=eo[et]))eu[B++]=65533,N+=ei-1;else{for(et&=2===ei?31:3===ei?15:7;1<ei&&N<el;)et=et<<6|63&e[N++],ei--;1<ei?eu[B++]=65533:et<65536?eu[B++]=et:(et-=65536,eu[B++]=55296|et>>10&1023,eu[B++]=56320|1023&et)}return w(eu,B)},N.utf8border=function(e,n){var N;for((n=n||e.length)>e.length&&(n=e.length),N=n-1;0<=N&&(192&e[N])==128;)N--;return N<0||0===N?n:N+eo[e[N]]>n?N:n}},{"./common":41}],43:[function(e,n,N){n.exports=function(e,n,N,B){for(var et=65535&e|0,ei=e>>>16&65535|0,eo=0;0!==N;){for(N-=eo=2e3<N?2e3:N;ei=ei+(et=et+n[B++]|0)|0,--eo;);et%=65521,ei%=65521}return et|ei<<16|0}},{}],44:[function(e,n,N){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,N){var B=function(){for(var e,n=[],N=0;N<256;N++){e=N;for(var B=0;B<8;B++)e=1&e?3988292384^e>>>1:e>>>1;n[N]=e}return n}();n.exports=function(e,n,N,et){var ei=et+N;e^=-1;for(var eo=et;eo<ei;eo++)e=e>>>8^B[255&(e^n[eo])];return -1^e}},{}],46:[function(e,n,N){var B,et=e("../utils/common"),ei=e("./trees"),eo=e("./adler32"),el=e("./crc32"),eu=e("./messages");function me(e,n){return e.msg=eu[n],n}function ve(e){return(e<<1)-(4<e?9:0)}function z(e){for(var n=e.length;0<=--n;)e[n]=0}function I(e){var n=e.state,N=n.pending;N>e.avail_out&&(N=e.avail_out),0!==N&&(et.arraySet(e.output,n.pending_buf,n.pending_out,N,e.next_out),e.next_out+=N,n.pending_out+=N,e.total_out+=N,e.avail_out-=N,n.pending-=N,0===n.pending&&(n.pending_out=0))}function C(e,n){ei._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,I(e.strm)}function ye(e,n){e.pending_buf[e.pending++]=n}function be(e,n){e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=255&n}function Ue(e,n){var N,B,et=e.max_chain_length,ei=e.strstart,eo=e.prev_length,el=e.nice_match,eu=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,ec=e.window,ef=e.w_mask,eh=e.prev,ep=e.strstart+258,ed=ec[ei+eo-1],e_=ec[ei+eo];e.prev_length>=e.good_match&&(et>>=2),el>e.lookahead&&(el=e.lookahead);do if(ec[(N=n)+eo]===e_&&ec[N+eo-1]===ed&&ec[N]===ec[ei]&&ec[++N]===ec[ei+1]){ei+=2,N++;do;while(ec[++ei]===ec[++N]&&ec[++ei]===ec[++N]&&ec[++ei]===ec[++N]&&ec[++ei]===ec[++N]&&ec[++ei]===ec[++N]&&ec[++ei]===ec[++N]&&ec[++ei]===ec[++N]&&ec[++ei]===ec[++N]&&ei<ep);if(B=258-(ep-ei),ei=ep-258,eo<B){if(e.match_start=n,el<=(eo=B))break;ed=ec[ei+eo-1],e_=ec[ei+eo]}}while((n=eh[n&ef])>eu&&0!=--et);return eo<=e.lookahead?eo:e.lookahead}function He(e){var n,N,B,ei,eu,ec,ef,eh,ep,ed,e_=e.w_size;do{if(ei=e.window_size-e.lookahead-e.strstart,e.strstart>=e_+(e_-262)){for(et.arraySet(e.window,e.window,e_,e_,0),e.match_start-=e_,e.strstart-=e_,e.block_start-=e_,n=N=e.hash_size;B=e.head[--n],e.head[n]=e_<=B?B-e_:0,--N;);for(n=N=e_;B=e.prev[--n],e.prev[n]=e_<=B?B-e_:0,--N;);ei+=e_}if(0===e.strm.avail_in)break;if(ec=e.strm,ef=e.window,eh=e.strstart+e.lookahead,ed=void 0,(ep=ei)<(ed=ec.avail_in)&&(ed=ep),N=0===ed?0:(ec.avail_in-=ed,et.arraySet(ef,ec.input,ec.next_in,ed,eh),1===ec.state.wrap?ec.adler=eo(ec.adler,ef,ed,eh):2===ec.state.wrap&&(ec.adler=el(ec.adler,ef,ed,eh)),ec.next_in+=ed,ec.total_in+=ed,ed),e.lookahead+=N,e.lookahead+e.insert>=3)for(eu=e.strstart-e.insert,e.ins_h=e.window[eu],e.ins_h=(e.ins_h<<e.hash_shift^e.window[eu+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[eu+3-1])&e.hash_mask,e.prev[eu&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=eu,eu++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function st(e,n){for(var N,B;;){if(e.lookahead<262){if(He(e),e.lookahead<262&&0===n)return 1;if(0===e.lookahead)break}if(N=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==N&&e.strstart-N<=e.w_size-262&&(e.match_length=Ue(e,N)),e.match_length>=3){if(B=ei._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask}else B=ei._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(B&&(C(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===n?(C(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(C(e,!1),0===e.strm.avail_out)?1:2}function Ze(e,n){for(var N,B,et;;){if(e.lookahead<262){if(He(e),e.lookahead<262&&0===n)return 1;if(0===e.lookahead)break}if(N=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==N&&e.prev_length<e.max_lazy_match&&e.strstart-N<=e.w_size-262&&(e.match_length=Ue(e,N),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(et=e.strstart+e.lookahead-3,B=ei._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=et&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,B&&(C(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((B=ei._tr_tally(e,0,e.window[e.strstart-1]))&&C(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(B=ei._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===n?(C(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(C(e,!1),0===e.strm.avail_out)?1:2}function ae(e,n,N,B,et){this.good_length=e,this.max_lazy=n,this.nice_length=N,this.max_chain=B,this.func=et}function le(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new et.Buf16(1146),this.dyn_dtree=new et.Buf16(122),this.bl_tree=new et.Buf16(78),z(this.dyn_ltree),z(this.dyn_dtree),z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new et.Buf16(16),this.heap=new et.Buf16(573),z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new et.Buf16(573),z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Pe(e){var n;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(n=e.state).pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?42:113,e.adler=2===n.wrap?0:1,n.last_flush=0,ei._tr_init(n),0):me(e,-2)}function xe(e){var n,N=Pe(e);return 0===N&&((n=e.state).window_size=2*n.w_size,z(n.head),n.max_lazy_match=B[n.level].max_lazy,n.good_match=B[n.level].good_length,n.nice_match=B[n.level].nice_length,n.max_chain_length=B[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),N}function Ge(e,n,N,B,ei,eo){if(!e)return -2;var el=1;if(-1===n&&(n=6),B<0?(el=0,B=-B):15<B&&(el=2,B-=16),ei<1||9<ei||8!==N||B<8||15<B||n<0||9<n||eo<0||4<eo)return me(e,-2);8===B&&(B=9);var eu=new le;return(e.state=eu).strm=e,eu.wrap=el,eu.gzhead=null,eu.w_bits=B,eu.w_size=1<<eu.w_bits,eu.w_mask=eu.w_size-1,eu.hash_bits=ei+7,eu.hash_size=1<<eu.hash_bits,eu.hash_mask=eu.hash_size-1,eu.hash_shift=~~((eu.hash_bits+3-1)/3),eu.window=new et.Buf8(2*eu.w_size),eu.head=new et.Buf16(eu.hash_size),eu.prev=new et.Buf16(eu.w_size),eu.lit_bufsize=1<<ei+6,eu.pending_buf_size=4*eu.lit_bufsize,eu.pending_buf=new et.Buf8(eu.pending_buf_size),eu.d_buf=1*eu.lit_bufsize,eu.l_buf=3*eu.lit_bufsize,eu.level=n,eu.strategy=eo,eu.method=N,xe(e)}B=[new ae(0,0,0,0,function(e,n){var N=65535;for(65535>e.pending_buf_size-5&&(N=e.pending_buf_size-5);;){if(e.lookahead<=1){if(He(e),0===e.lookahead&&0===n)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var B=e.block_start+N;if((0===e.strstart||e.strstart>=B)&&(e.lookahead=e.strstart-B,e.strstart=B,C(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-262&&(C(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===n?(C(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(C(e,!1),e.strm.avail_out),1)}),new ae(4,4,8,4,st),new ae(4,5,16,8,st),new ae(4,6,32,32,st),new ae(4,4,16,16,Ze),new ae(8,16,32,32,Ze),new ae(8,16,128,128,Ze),new ae(8,32,128,256,Ze),new ae(32,128,258,1024,Ze),new ae(32,258,258,4096,Ze)],N.deflateInit=function(e,n){return Ge(e,n,8,15,8,0)},N.deflateInit2=Ge,N.deflateReset=xe,N.deflateResetKeep=Pe,N.deflateSetHeader=function(e,n){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=n,0):-2},N.deflate=function(e,n){var N,et,eo,eu;if(!e||!e.state||5<n||n<0)return e?me(e,-2):-2;if(et=e.state,!e.output||!e.input&&0!==e.avail_in||666===et.status&&4!==n)return me(e,0===e.avail_out?-5:-2);if(et.strm=e,N=et.last_flush,et.last_flush=n,42===et.status){if(2===et.wrap)e.adler=0,ye(et,31),ye(et,139),ye(et,8),et.gzhead?(ye(et,(et.gzhead.text?1:0)+(et.gzhead.hcrc?2:0)+(et.gzhead.extra?4:0)+(et.gzhead.name?8:0)+(et.gzhead.comment?16:0)),ye(et,255&et.gzhead.time),ye(et,et.gzhead.time>>8&255),ye(et,et.gzhead.time>>16&255),ye(et,et.gzhead.time>>24&255),ye(et,9===et.level?2:2<=et.strategy||et.level<2?4:0),ye(et,255&et.gzhead.os),et.gzhead.extra&&et.gzhead.extra.length&&(ye(et,255&et.gzhead.extra.length),ye(et,et.gzhead.extra.length>>8&255)),et.gzhead.hcrc&&(e.adler=el(e.adler,et.pending_buf,et.pending,0)),et.gzindex=0,et.status=69):(ye(et,0),ye(et,0),ye(et,0),ye(et,0),ye(et,0),ye(et,9===et.level?2:2<=et.strategy||et.level<2?4:0),ye(et,3),et.status=113);else{var ec=8+(et.w_bits-8<<4)<<8;ec|=(2<=et.strategy||et.level<2?0:et.level<6?1:6===et.level?2:3)<<6,0!==et.strstart&&(ec|=32),ec+=31-ec%31,et.status=113,be(et,ec),0!==et.strstart&&(be(et,e.adler>>>16),be(et,65535&e.adler)),e.adler=1}}if(69===et.status){if(et.gzhead.extra){for(eo=et.pending;et.gzindex<(65535&et.gzhead.extra.length)&&(et.pending!==et.pending_buf_size||(et.gzhead.hcrc&&et.pending>eo&&(e.adler=el(e.adler,et.pending_buf,et.pending-eo,eo)),I(e),eo=et.pending,et.pending!==et.pending_buf_size));)ye(et,255&et.gzhead.extra[et.gzindex]),et.gzindex++;et.gzhead.hcrc&&et.pending>eo&&(e.adler=el(e.adler,et.pending_buf,et.pending-eo,eo)),et.gzindex===et.gzhead.extra.length&&(et.gzindex=0,et.status=73)}else et.status=73}if(73===et.status){if(et.gzhead.name){eo=et.pending;do{if(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>eo&&(e.adler=el(e.adler,et.pending_buf,et.pending-eo,eo)),I(e),eo=et.pending,et.pending===et.pending_buf_size)){eu=1;break}eu=et.gzindex<et.gzhead.name.length?255&et.gzhead.name.charCodeAt(et.gzindex++):0,ye(et,eu)}while(0!==eu);et.gzhead.hcrc&&et.pending>eo&&(e.adler=el(e.adler,et.pending_buf,et.pending-eo,eo)),0===eu&&(et.gzindex=0,et.status=91)}else et.status=91}if(91===et.status){if(et.gzhead.comment){eo=et.pending;do{if(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>eo&&(e.adler=el(e.adler,et.pending_buf,et.pending-eo,eo)),I(e),eo=et.pending,et.pending===et.pending_buf_size)){eu=1;break}eu=et.gzindex<et.gzhead.comment.length?255&et.gzhead.comment.charCodeAt(et.gzindex++):0,ye(et,eu)}while(0!==eu);et.gzhead.hcrc&&et.pending>eo&&(e.adler=el(e.adler,et.pending_buf,et.pending-eo,eo)),0===eu&&(et.status=103)}else et.status=103}if(103===et.status&&(et.gzhead.hcrc?(et.pending+2>et.pending_buf_size&&I(e),et.pending+2<=et.pending_buf_size&&(ye(et,255&e.adler),ye(et,e.adler>>8&255),e.adler=0,et.status=113)):et.status=113),0!==et.pending){if(I(e),0===e.avail_out)return et.last_flush=-1,0}else if(0===e.avail_in&&ve(n)<=ve(N)&&4!==n)return me(e,-5);if(666===et.status&&0!==e.avail_in)return me(e,-5);if(0!==e.avail_in||0!==et.lookahead||0!==n&&666!==et.status){var ef=2===et.strategy?function(e,n){for(var N;;){if(0===e.lookahead&&(He(e),0===e.lookahead)){if(0===n)return 1;break}if(e.match_length=0,N=ei._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,N&&(C(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===n?(C(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(C(e,!1),0===e.strm.avail_out)?1:2}(et,n):3===et.strategy?function(e,n){for(var N,B,et,eo,el=e.window;;){if(e.lookahead<=258){if(He(e),e.lookahead<=258&&0===n)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(B=el[et=e.strstart-1])===el[++et]&&B===el[++et]&&B===el[++et]){eo=e.strstart+258;do;while(B===el[++et]&&B===el[++et]&&B===el[++et]&&B===el[++et]&&B===el[++et]&&B===el[++et]&&B===el[++et]&&B===el[++et]&&et<eo);e.match_length=258-(eo-et),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(N=ei._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(N=ei._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),N&&(C(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===n?(C(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(C(e,!1),0===e.strm.avail_out)?1:2}(et,n):B[et.level].func(et,n);if(3!==ef&&4!==ef||(et.status=666),1===ef||3===ef)return 0===e.avail_out&&(et.last_flush=-1),0;if(2===ef&&(1===n?ei._tr_align(et):5!==n&&(ei._tr_stored_block(et,0,0,!1),3===n&&(z(et.head),0===et.lookahead&&(et.strstart=0,et.block_start=0,et.insert=0))),I(e),0===e.avail_out))return et.last_flush=-1,0}return 4!==n?0:et.wrap<=0?1:(2===et.wrap?(ye(et,255&e.adler),ye(et,e.adler>>8&255),ye(et,e.adler>>16&255),ye(et,e.adler>>24&255),ye(et,255&e.total_in),ye(et,e.total_in>>8&255),ye(et,e.total_in>>16&255),ye(et,e.total_in>>24&255)):(be(et,e.adler>>>16),be(et,65535&e.adler)),I(e),0<et.wrap&&(et.wrap=-et.wrap),0!==et.pending?0:1)},N.deflateEnd=function(e){var n;return e&&e.state?42!==(n=e.state.status)&&69!==n&&73!==n&&91!==n&&103!==n&&113!==n&&666!==n?me(e,-2):(e.state=null,113===n?me(e,-3):0):-2},N.deflateSetDictionary=function(e,n){var N,B,ei,el,eu,ec,ef,eh,ep=n.length;if(!e||!e.state||2===(el=(N=e.state).wrap)||1===el&&42!==N.status||N.lookahead)return -2;for(1===el&&(e.adler=eo(e.adler,n,ep,0)),N.wrap=0,ep>=N.w_size&&(0===el&&(z(N.head),N.strstart=0,N.block_start=0,N.insert=0),eh=new et.Buf8(N.w_size),et.arraySet(eh,n,ep-N.w_size,N.w_size,0),n=eh,ep=N.w_size),eu=e.avail_in,ec=e.next_in,ef=e.input,e.avail_in=ep,e.next_in=0,e.input=n,He(N);N.lookahead>=3;){for(B=N.strstart,ei=N.lookahead-2;N.ins_h=(N.ins_h<<N.hash_shift^N.window[B+3-1])&N.hash_mask,N.prev[B&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=B,B++,--ei;);N.strstart=B,N.lookahead=2,He(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=2,N.match_available=0,e.next_in=ec,e.input=ef,e.avail_in=eu,N.wrap=el,0},N.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,N){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,N){n.exports=function(e,n){var N,B,et,ei,eo,el,eu,ec,ef,eh,ep,ed,e_,eg,em,eb,ey,ev,ek,eA,eL,ex,ew,eT,eO;N=e.state,B=e.next_in,eT=e.input,et=B+(e.avail_in-5),ei=e.next_out,eO=e.output,eo=ei-(n-e.avail_out),el=ei+(e.avail_out-257),eu=N.dmax,ec=N.wsize,ef=N.whave,eh=N.wnext,ep=N.window,ed=N.hold,e_=N.bits,eg=N.lencode,em=N.distcode,eb=(1<<N.lenbits)-1,ey=(1<<N.distbits)-1;e:do for(e_<15&&(ed+=eT[B++]<<e_,e_+=8,ed+=eT[B++]<<e_,e_+=8),ev=eg[ed&eb];;){if(ed>>>=ek=ev>>>24,e_-=ek,0==(ek=ev>>>16&255))eO[ei++]=65535&ev;else{if(!(16&ek)){if(!(64&ek)){ev=eg[(65535&ev)+(ed&(1<<ek)-1)];continue}if(32&ek){N.mode=12;break e}e.msg="invalid literal/length code",N.mode=30;break e}for(eA=65535&ev,(ek&=15)&&(e_<ek&&(ed+=eT[B++]<<e_,e_+=8),eA+=ed&(1<<ek)-1,ed>>>=ek,e_-=ek),e_<15&&(ed+=eT[B++]<<e_,e_+=8,ed+=eT[B++]<<e_,e_+=8),ev=em[ed&ey];;){if(ed>>>=ek=ev>>>24,e_-=ek,!(16&(ek=ev>>>16&255))){if(!(64&ek)){ev=em[(65535&ev)+(ed&(1<<ek)-1)];continue}e.msg="invalid distance code",N.mode=30;break e}if(eL=65535&ev,e_<(ek&=15)&&(ed+=eT[B++]<<e_,(e_+=8)<ek&&(ed+=eT[B++]<<e_,e_+=8)),eu<(eL+=ed&(1<<ek)-1)){e.msg="invalid distance too far back",N.mode=30;break e}if(ed>>>=ek,e_-=ek,(ek=ei-eo)<eL){if(ef<(ek=eL-ek)&&N.sane){e.msg="invalid distance too far back",N.mode=30;break e}if(ew=ep,(ex=0)===eh){if(ex+=ec-ek,ek<eA){for(eA-=ek;eO[ei++]=ep[ex++],--ek;);ex=ei-eL,ew=eO}}else if(eh<ek){if(ex+=ec+eh-ek,(ek-=eh)<eA){for(eA-=ek;eO[ei++]=ep[ex++],--ek;);if(ex=0,eh<eA){for(eA-=ek=eh;eO[ei++]=ep[ex++],--ek;);ex=ei-eL,ew=eO}}}else if(ex+=eh-ek,ek<eA){for(eA-=ek;eO[ei++]=ep[ex++],--ek;);ex=ei-eL,ew=eO}for(;2<eA;)eO[ei++]=ew[ex++],eO[ei++]=ew[ex++],eO[ei++]=ew[ex++],eA-=3;eA&&(eO[ei++]=ew[ex++],1<eA&&(eO[ei++]=ew[ex++]))}else{for(ex=ei-eL;eO[ei++]=eO[ex++],eO[ei++]=eO[ex++],eO[ei++]=eO[ex++],2<(eA-=3););eA&&(eO[ei++]=eO[ex++],1<eA&&(eO[ei++]=eO[ex++]))}break}}break}while(B<et&&ei<el);B-=eA=e_>>3,ed&=(1<<(e_-=eA<<3))-1,e.next_in=B,e.next_out=ei,e.avail_in=B<et?et-B+5:5-(B-et),e.avail_out=ei<el?el-ei+257:257-(ei-el),N.hold=ed,N.bits=e_}},{}],49:[function(e,n,N){var B=e("../utils/common"),et=e("./adler32"),ei=e("./crc32"),eo=e("./inffast"),el=e("./inftrees");function b(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new B.Buf16(320),this.work=new B.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function M(e){var n;return e&&e.state?(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new B.Buf32(852),n.distcode=n.distdyn=new B.Buf32(592),n.sane=1,n.back=-1,0):-2}function K(e){var n;return e&&e.state?((n=e.state).wsize=0,n.whave=0,n.wnext=0,M(e)):-2}function G(e,n){var N,B;return e&&e.state?(B=e.state,n<0?(N=0,n=-n):(N=1+(n>>4),n<48&&(n&=15)),n&&(n<8||15<n)?-2:(null!==B.window&&B.wbits!==n&&(B.window=null),B.wrap=N,B.wbits=n,K(e))):-2}function W(e,n){var N,B;return e?(B=new R,(e.state=B).window=null,0!==(N=G(e,n))&&(e.state=null),N):-2}var eu,ec,ef=!0;function he(e,n,N,et){var ei,eo=e.state;return null===eo.window&&(eo.wsize=1<<eo.wbits,eo.wnext=0,eo.whave=0,eo.window=new B.Buf8(eo.wsize)),et>=eo.wsize?(B.arraySet(eo.window,n,N-eo.wsize,eo.wsize,0),eo.wnext=0,eo.whave=eo.wsize):(et<(ei=eo.wsize-eo.wnext)&&(ei=et),B.arraySet(eo.window,n,N-et,ei,eo.wnext),(et-=ei)?(B.arraySet(eo.window,n,N-et,et,0),eo.wnext=et,eo.whave=eo.wsize):(eo.wnext+=ei,eo.wnext===eo.wsize&&(eo.wnext=0),eo.whave<eo.wsize&&(eo.whave+=ei))),0}N.inflateReset=K,N.inflateReset2=G,N.inflateResetKeep=M,N.inflateInit=function(e){return W(e,15)},N.inflateInit2=W,N.inflate=function(e,n){var N,eh,ep,ed,e_,eg,em,eb,ey,ev,ek,eA,eL,ex,ew,eT,eO,eE,eS,eN,eI,eR,eU,eC,eM=0,eP=new B.Buf8(4),eD=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return -2;12===(N=e.state).mode&&(N.mode=13),e_=e.next_out,ep=e.output,em=e.avail_out,ed=e.next_in,eh=e.input,eg=e.avail_in,eb=N.hold,ey=N.bits,ev=eg,ek=em,eR=0;e:for(;;)switch(N.mode){case 1:if(0===N.wrap){N.mode=13;break}for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(2&N.wrap&&35615===eb){eP[N.check=0]=255&eb,eP[1]=eb>>>8&255,N.check=ei(N.check,eP,2,0),ey=eb=0,N.mode=2;break}if(N.flags=0,N.head&&(N.head.done=!1),!(1&N.wrap)||(((255&eb)<<8)+(eb>>8))%31){e.msg="incorrect header check",N.mode=30;break}if((15&eb)!=8){e.msg="unknown compression method",N.mode=30;break}if(ey-=4,eI=8+(15&(eb>>>=4)),0===N.wbits)N.wbits=eI;else if(eI>N.wbits){e.msg="invalid window size",N.mode=30;break}N.dmax=1<<eI,e.adler=N.check=1,N.mode=512&eb?10:12,ey=eb=0;break;case 2:for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(N.flags=eb,(255&N.flags)!=8){e.msg="unknown compression method",N.mode=30;break}if(57344&N.flags){e.msg="unknown header flags set",N.mode=30;break}N.head&&(N.head.text=eb>>8&1),512&N.flags&&(eP[0]=255&eb,eP[1]=eb>>>8&255,N.check=ei(N.check,eP,2,0)),ey=eb=0,N.mode=3;case 3:for(;ey<32;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.head&&(N.head.time=eb),512&N.flags&&(eP[0]=255&eb,eP[1]=eb>>>8&255,eP[2]=eb>>>16&255,eP[3]=eb>>>24&255,N.check=ei(N.check,eP,4,0)),ey=eb=0,N.mode=4;case 4:for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.head&&(N.head.xflags=255&eb,N.head.os=eb>>8),512&N.flags&&(eP[0]=255&eb,eP[1]=eb>>>8&255,N.check=ei(N.check,eP,2,0)),ey=eb=0,N.mode=5;case 5:if(1024&N.flags){for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.length=eb,N.head&&(N.head.extra_len=eb),512&N.flags&&(eP[0]=255&eb,eP[1]=eb>>>8&255,N.check=ei(N.check,eP,2,0)),ey=eb=0}else N.head&&(N.head.extra=null);N.mode=6;case 6:if(1024&N.flags&&(eg<(eA=N.length)&&(eA=eg),eA&&(N.head&&(eI=N.head.extra_len-N.length,N.head.extra||(N.head.extra=Array(N.head.extra_len)),B.arraySet(N.head.extra,eh,ed,eA,eI)),512&N.flags&&(N.check=ei(N.check,eh,eA,ed)),eg-=eA,ed+=eA,N.length-=eA),N.length))break e;N.length=0,N.mode=7;case 7:if(2048&N.flags){if(0===eg)break e;for(eA=0;eI=eh[ed+eA++],N.head&&eI&&N.length<65536&&(N.head.name+=String.fromCharCode(eI)),eI&&eA<eg;);if(512&N.flags&&(N.check=ei(N.check,eh,eA,ed)),eg-=eA,ed+=eA,eI)break e}else N.head&&(N.head.name=null);N.length=0,N.mode=8;case 8:if(4096&N.flags){if(0===eg)break e;for(eA=0;eI=eh[ed+eA++],N.head&&eI&&N.length<65536&&(N.head.comment+=String.fromCharCode(eI)),eI&&eA<eg;);if(512&N.flags&&(N.check=ei(N.check,eh,eA,ed)),eg-=eA,ed+=eA,eI)break e}else N.head&&(N.head.comment=null);N.mode=9;case 9:if(512&N.flags){for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eb!==(65535&N.check)){e.msg="header crc mismatch",N.mode=30;break}ey=eb=0}N.head&&(N.head.hcrc=N.flags>>9&1,N.head.done=!0),e.adler=N.check=0,N.mode=12;break;case 10:for(;ey<32;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}e.adler=N.check=b(eb),ey=eb=0,N.mode=11;case 11:if(0===N.havedict)return e.next_out=e_,e.avail_out=em,e.next_in=ed,e.avail_in=eg,N.hold=eb,N.bits=ey,2;e.adler=N.check=1,N.mode=12;case 12:if(5===n||6===n)break e;case 13:if(N.last){eb>>>=7&ey,ey-=7&ey,N.mode=27;break}for(;ey<3;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}switch(N.last=1&eb,ey-=1,3&(eb>>>=1)){case 0:N.mode=14;break;case 1:if(function(e){if(ef){var n;for(eu=new B.Buf32(512),ec=new B.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(el(1,e.lens,0,288,eu,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;el(2,e.lens,0,32,ec,0,e.work,{bits:5}),ef=!1}e.lencode=eu,e.lenbits=9,e.distcode=ec,e.distbits=5}(N),N.mode=20,6!==n)break;eb>>>=2,ey-=2;break e;case 2:N.mode=17;break;case 3:e.msg="invalid block type",N.mode=30}eb>>>=2,ey-=2;break;case 14:for(eb>>>=7&ey,ey-=7&ey;ey<32;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if((65535&eb)!=(eb>>>16^65535)){e.msg="invalid stored block lengths",N.mode=30;break}if(N.length=65535&eb,ey=eb=0,N.mode=15,6===n)break e;case 15:N.mode=16;case 16:if(eA=N.length){if(eg<eA&&(eA=eg),em<eA&&(eA=em),0===eA)break e;B.arraySet(ep,eh,ed,eA,e_),eg-=eA,ed+=eA,em-=eA,e_+=eA,N.length-=eA;break}N.mode=12;break;case 17:for(;ey<14;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(N.nlen=257+(31&eb),eb>>>=5,ey-=5,N.ndist=1+(31&eb),eb>>>=5,ey-=5,N.ncode=4+(15&eb),eb>>>=4,ey-=4,286<N.nlen||30<N.ndist){e.msg="too many length or distance symbols",N.mode=30;break}N.have=0,N.mode=18;case 18:for(;N.have<N.ncode;){for(;ey<3;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.lens[eD[N.have++]]=7&eb,eb>>>=3,ey-=3}for(;N.have<19;)N.lens[eD[N.have++]]=0;if(N.lencode=N.lendyn,N.lenbits=7,eU={bits:N.lenbits},eR=el(0,N.lens,0,19,N.lencode,0,N.work,eU),N.lenbits=eU.bits,eR){e.msg="invalid code lengths set",N.mode=30;break}N.have=0,N.mode=19;case 19:for(;N.have<N.nlen+N.ndist;){for(;eT=(eM=N.lencode[eb&(1<<N.lenbits)-1])>>>16&255,eO=65535&eM,!((ew=eM>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eO<16)eb>>>=ew,ey-=ew,N.lens[N.have++]=eO;else{if(16===eO){for(eC=ew+2;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eb>>>=ew,ey-=ew,0===N.have){e.msg="invalid bit length repeat",N.mode=30;break}eI=N.lens[N.have-1],eA=3+(3&eb),eb>>>=2,ey-=2}else if(17===eO){for(eC=ew+3;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}ey-=ew,eI=0,eA=3+(7&(eb>>>=ew)),eb>>>=3,ey-=3}else{for(eC=ew+7;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}ey-=ew,eI=0,eA=11+(127&(eb>>>=ew)),eb>>>=7,ey-=7}if(N.have+eA>N.nlen+N.ndist){e.msg="invalid bit length repeat",N.mode=30;break}for(;eA--;)N.lens[N.have++]=eI}}if(30===N.mode)break;if(0===N.lens[256]){e.msg="invalid code -- missing end-of-block",N.mode=30;break}if(N.lenbits=9,eU={bits:N.lenbits},eR=el(1,N.lens,0,N.nlen,N.lencode,0,N.work,eU),N.lenbits=eU.bits,eR){e.msg="invalid literal/lengths set",N.mode=30;break}if(N.distbits=6,N.distcode=N.distdyn,eU={bits:N.distbits},eR=el(2,N.lens,N.nlen,N.ndist,N.distcode,0,N.work,eU),N.distbits=eU.bits,eR){e.msg="invalid distances set",N.mode=30;break}if(N.mode=20,6===n)break e;case 20:N.mode=21;case 21:if(6<=eg&&258<=em){e.next_out=e_,e.avail_out=em,e.next_in=ed,e.avail_in=eg,N.hold=eb,N.bits=ey,eo(e,ek),e_=e.next_out,ep=e.output,em=e.avail_out,ed=e.next_in,eh=e.input,eg=e.avail_in,eb=N.hold,ey=N.bits,12===N.mode&&(N.back=-1);break}for(N.back=0;eT=(eM=N.lencode[eb&(1<<N.lenbits)-1])>>>16&255,eO=65535&eM,!((ew=eM>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eT&&!(240&eT)){for(eE=ew,eS=eT,eN=eO;eT=(eM=N.lencode[eN+((eb&(1<<eE+eS)-1)>>eE)])>>>16&255,eO=65535&eM,!(eE+(ew=eM>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}eb>>>=eE,ey-=eE,N.back+=eE}if(eb>>>=ew,ey-=ew,N.back+=ew,N.length=eO,0===eT){N.mode=26;break}if(32&eT){N.back=-1,N.mode=12;break}if(64&eT){e.msg="invalid literal/length code",N.mode=30;break}N.extra=15&eT,N.mode=22;case 22:if(N.extra){for(eC=N.extra;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.length+=eb&(1<<N.extra)-1,eb>>>=N.extra,ey-=N.extra,N.back+=N.extra}N.was=N.length,N.mode=23;case 23:for(;eT=(eM=N.distcode[eb&(1<<N.distbits)-1])>>>16&255,eO=65535&eM,!((ew=eM>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(!(240&eT)){for(eE=ew,eS=eT,eN=eO;eT=(eM=N.distcode[eN+((eb&(1<<eE+eS)-1)>>eE)])>>>16&255,eO=65535&eM,!(eE+(ew=eM>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}eb>>>=eE,ey-=eE,N.back+=eE}if(eb>>>=ew,ey-=ew,N.back+=ew,64&eT){e.msg="invalid distance code",N.mode=30;break}N.offset=eO,N.extra=15&eT,N.mode=24;case 24:if(N.extra){for(eC=N.extra;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.offset+=eb&(1<<N.extra)-1,eb>>>=N.extra,ey-=N.extra,N.back+=N.extra}if(N.offset>N.dmax){e.msg="invalid distance too far back",N.mode=30;break}N.mode=25;case 25:if(0===em)break e;if(eA=ek-em,N.offset>eA){if((eA=N.offset-eA)>N.whave&&N.sane){e.msg="invalid distance too far back",N.mode=30;break}eL=eA>N.wnext?(eA-=N.wnext,N.wsize-eA):N.wnext-eA,eA>N.length&&(eA=N.length),ex=N.window}else ex=ep,eL=e_-N.offset,eA=N.length;for(em<eA&&(eA=em),em-=eA,N.length-=eA;ep[e_++]=ex[eL++],--eA;);0===N.length&&(N.mode=21);break;case 26:if(0===em)break e;ep[e_++]=N.length,em--,N.mode=21;break;case 27:if(N.wrap){for(;ey<32;){if(0===eg)break e;eg--,eb|=eh[ed++]<<ey,ey+=8}if(ek-=em,e.total_out+=ek,N.total+=ek,ek&&(e.adler=N.check=N.flags?ei(N.check,ep,ek,e_-ek):et(N.check,ep,ek,e_-ek)),ek=em,(N.flags?eb:b(eb))!==N.check){e.msg="incorrect data check",N.mode=30;break}ey=eb=0}N.mode=28;case 28:if(N.wrap&&N.flags){for(;ey<32;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eb!==(4294967295&N.total)){e.msg="incorrect length check",N.mode=30;break}ey=eb=0}N.mode=29;case 29:eR=1;break e;case 30:eR=-3;break e;case 31:return -4;default:return -2}return e.next_out=e_,e.avail_out=em,e.next_in=ed,e.avail_in=eg,N.hold=eb,N.bits=ey,(N.wsize||ek!==e.avail_out&&N.mode<30&&(N.mode<27||4!==n))&&he(e,e.output,e.next_out,ek-e.avail_out)?(N.mode=31,-4):(ev-=e.avail_in,ek-=e.avail_out,e.total_in+=ev,e.total_out+=ek,N.total+=ek,N.wrap&&ek&&(e.adler=N.check=N.flags?ei(N.check,ep,ek,e.next_out-ek):et(N.check,ep,ek,e.next_out-ek)),e.data_type=N.bits+(N.last?64:0)+(12===N.mode?128:0)+(20===N.mode||15===N.mode?256:0),(0==ev&&0===ek||4===n)&&0===eR&&(eR=-5),eR)},N.inflateEnd=function(e){if(!e||!e.state)return -2;var n=e.state;return n.window&&(n.window=null),e.state=null,0},N.inflateGetHeader=function(e,n){var N;return e&&e.state&&2&(N=e.state).wrap?((N.head=n).done=!1,0):-2},N.inflateSetDictionary=function(e,n){var N,B=n.length;return e&&e.state?0!==(N=e.state).wrap&&11!==N.mode?-2:11===N.mode&&et(1,n,B,0)!==N.check?-3:he(e,n,B,B)?(N.mode=31,-4):(N.havedict=1,0):-2},N.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,N){var B=e("../utils/common"),et=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ei=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],eo=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],el=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(e,n,N,eu,ec,ef,eh,ep){var ed,e_,eg,em,eb,ey,ev,ek,eA,eL=ep.bits,ex=0,ew=0,eT=0,eO=0,eE=0,eS=0,eN=0,eI=0,eR=0,eU=0,eC=null,eM=0,eP=new B.Buf16(16),eD=new B.Buf16(16),eB=null,eK=0;for(ex=0;ex<=15;ex++)eP[ex]=0;for(ew=0;ew<eu;ew++)eP[n[N+ew]]++;for(eE=eL,eO=15;1<=eO&&0===eP[eO];eO--);if(eO<eE&&(eE=eO),0===eO)return ec[ef++]=20971520,ec[ef++]=20971520,ep.bits=1,0;for(eT=1;eT<eO&&0===eP[eT];eT++);for(eE<eT&&(eE=eT),ex=eI=1;ex<=15;ex++)if(eI<<=1,(eI-=eP[ex])<0)return -1;if(0<eI&&(0===e||1!==eO))return -1;for(eD[1]=0,ex=1;ex<15;ex++)eD[ex+1]=eD[ex]+eP[ex];for(ew=0;ew<eu;ew++)0!==n[N+ew]&&(eh[eD[n[N+ew]]++]=ew);if(ey=0===e?(eC=eB=eh,19):1===e?(eC=et,eM-=257,eB=ei,eK-=257,256):(eC=eo,eB=el,-1),ex=eT,eb=ef,eN=ew=eU=0,eg=-1,em=(eR=1<<(eS=eE))-1,1===e&&852<eR||2===e&&592<eR)return 1;for(;;){for(ev=ex-eN,eA=eh[ew]<ey?(ek=0,eh[ew]):eh[ew]>ey?(ek=eB[eK+eh[ew]],eC[eM+eh[ew]]):(ek=96,0),ed=1<<ex-eN,eT=e_=1<<eS;ec[eb+(eU>>eN)+(e_-=ed)]=ev<<24|ek<<16|eA|0,0!==e_;);for(ed=1<<ex-1;eU&ed;)ed>>=1;if(0!==ed?(eU&=ed-1,eU+=ed):eU=0,ew++,0==--eP[ex]){if(ex===eO)break;ex=n[N+eh[ew]]}if(eE<ex&&(eU&em)!==eg){for(0===eN&&(eN=eE),eb+=eT,eI=1<<(eS=ex-eN);eS+eN<eO&&!((eI-=eP[eS+eN])<=0);)eS++,eI<<=1;if(eR+=1<<eS,1===e&&852<eR||2===e&&592<eR)return 1;ec[eg=eU&em]=eE<<24|eS<<16|eb-ef|0}}return 0!==eU&&(ec[eb+eU]=ex-eN<<24|4194304),ep.bits=eE,0}},{"../utils/common":41}],51:[function(e,n,N){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,N){var B=e("../utils/common");function u(e){for(var n=e.length;0<=--n;)e[n]=0}var et=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ei=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],eo=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],el=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],eu=Array(576);u(eu);var ec=Array(60);u(ec);var ef=Array(512);u(ef);var eh=Array(256);u(eh);var ep=Array(29);u(ep);var ed,e_,eg,em=Array(30);function z(e,n,N,B,et){this.static_tree=e,this.extra_bits=n,this.extra_base=N,this.elems=B,this.max_length=et,this.has_stree=e&&e.length}function I(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}function C(e){return e<256?ef[e]:ef[256+(e>>>7)]}function ye(e,n){e.pending_buf[e.pending++]=255&n,e.pending_buf[e.pending++]=n>>>8&255}function be(e,n,N){e.bi_valid>16-N?(e.bi_buf|=n<<e.bi_valid&65535,ye(e,e.bi_buf),e.bi_buf=n>>16-e.bi_valid,e.bi_valid+=N-16):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=N)}function Ue(e,n,N){be(e,N[2*n],N[2*n+1])}function He(e,n){for(var N=0;N|=1&e,e>>>=1,N<<=1,0<--n;);return N>>>1}function st(e,n,N){var B,et,ei=Array(16),eo=0;for(B=1;B<=15;B++)ei[B]=eo=eo+N[B-1]<<1;for(et=0;et<=n;et++){var el=e[2*et+1];0!==el&&(e[2*et]=He(ei[el]++,el))}}function Ze(e){var n;for(n=0;n<286;n++)e.dyn_ltree[2*n]=0;for(n=0;n<30;n++)e.dyn_dtree[2*n]=0;for(n=0;n<19;n++)e.bl_tree[2*n]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function ae(e){8<e.bi_valid?ye(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function le(e,n,N,B){var et=2*n,ei=2*N;return e[et]<e[ei]||e[et]===e[ei]&&B[n]<=B[N]}function Pe(e,n,N){for(var B=e.heap[N],et=N<<1;et<=e.heap_len&&(et<e.heap_len&&le(n,e.heap[et+1],e.heap[et],e.depth)&&et++,!le(n,B,e.heap[et],e.depth));)e.heap[N]=e.heap[et],N=et,et<<=1;e.heap[N]=B}function xe(e,n,N){var B,eo,el,eu,ec=0;if(0!==e.last_lit)for(;B=e.pending_buf[e.d_buf+2*ec]<<8|e.pending_buf[e.d_buf+2*ec+1],eo=e.pending_buf[e.l_buf+ec],ec++,0===B?Ue(e,eo,n):(Ue(e,(el=eh[eo])+256+1,n),0!==(eu=et[el])&&be(e,eo-=ep[el],eu),Ue(e,el=C(--B),N),0!==(eu=ei[el])&&be(e,B-=em[el],eu)),ec<e.last_lit;);Ue(e,256,n)}function Ge(e,n){var N,B,et,ei=n.dyn_tree,eo=n.stat_desc.static_tree,el=n.stat_desc.has_stree,eu=n.stat_desc.elems,ec=-1;for(e.heap_len=0,e.heap_max=573,N=0;N<eu;N++)0!==ei[2*N]?(e.heap[++e.heap_len]=ec=N,e.depth[N]=0):ei[2*N+1]=0;for(;e.heap_len<2;)ei[2*(et=e.heap[++e.heap_len]=ec<2?++ec:0)]=1,e.depth[et]=0,e.opt_len--,el&&(e.static_len-=eo[2*et+1]);for(n.max_code=ec,N=e.heap_len>>1;1<=N;N--)Pe(e,ei,N);for(et=eu;N=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Pe(e,ei,1),B=e.heap[1],e.heap[--e.heap_max]=N,e.heap[--e.heap_max]=B,ei[2*et]=ei[2*N]+ei[2*B],e.depth[et]=(e.depth[N]>=e.depth[B]?e.depth[N]:e.depth[B])+1,ei[2*N+1]=ei[2*B+1]=et,e.heap[1]=et++,Pe(e,ei,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,n){var N,B,et,ei,eo,el,eu=n.dyn_tree,ec=n.max_code,ef=n.stat_desc.static_tree,eh=n.stat_desc.has_stree,ep=n.stat_desc.extra_bits,ed=n.stat_desc.extra_base,e_=n.stat_desc.max_length,eg=0;for(ei=0;ei<=15;ei++)e.bl_count[ei]=0;for(eu[2*e.heap[e.heap_max]+1]=0,N=e.heap_max+1;N<573;N++)e_<(ei=eu[2*eu[2*(B=e.heap[N])+1]+1]+1)&&(ei=e_,eg++),eu[2*B+1]=ei,ec<B||(e.bl_count[ei]++,eo=0,ed<=B&&(eo=ep[B-ed]),el=eu[2*B],e.opt_len+=el*(ei+eo),eh&&(e.static_len+=el*(ef[2*B+1]+eo)));if(0!==eg){do{for(ei=e_-1;0===e.bl_count[ei];)ei--;e.bl_count[ei]--,e.bl_count[ei+1]+=2,e.bl_count[e_]--,eg-=2}while(0<eg);for(ei=e_;0!==ei;ei--)for(B=e.bl_count[ei];0!==B;)ec<(et=e.heap[--N])||(eu[2*et+1]!==ei&&(e.opt_len+=(ei-eu[2*et+1])*eu[2*et],eu[2*et+1]=ei),B--)}}(e,n),st(ei,ec,e.bl_count)}function g(e,n,N){var B,et,ei=-1,eo=n[1],el=0,eu=7,ec=4;for(0===eo&&(eu=138,ec=3),n[2*(N+1)+1]=65535,B=0;B<=N;B++)et=eo,eo=n[2*(B+1)+1],++el<eu&&et===eo||(el<ec?e.bl_tree[2*et]+=el:0!==et?(et!==ei&&e.bl_tree[2*et]++,e.bl_tree[32]++):el<=10?e.bl_tree[34]++:e.bl_tree[36]++,ei=et,ec=(el=0)===eo?(eu=138,3):et===eo?(eu=6,3):(eu=7,4))}function ge(e,n,N){var B,et,ei=-1,eo=n[1],el=0,eu=7,ec=4;for(0===eo&&(eu=138,ec=3),B=0;B<=N;B++)if(et=eo,eo=n[2*(B+1)+1],!(++el<eu&&et===eo)){if(el<ec)for(;Ue(e,et,e.bl_tree),0!=--el;);else 0!==et?(et!==ei&&(Ue(e,et,e.bl_tree),el--),Ue(e,16,e.bl_tree),be(e,el-3,2)):el<=10?(Ue(e,17,e.bl_tree),be(e,el-3,3)):(Ue(e,18,e.bl_tree),be(e,el-11,7));ei=et,ec=(el=0)===eo?(eu=138,3):et===eo?(eu=6,3):(eu=7,4)}}u(em);var eb=!1;function A(e,n,N,et){be(e,0+(et?1:0),3),ae(e),ye(e,N),ye(e,~N),B.arraySet(e.pending_buf,e.window,n,N,e.pending),e.pending+=N}N._tr_init=function(e){eb||(function(){var e,n,N,B,el,eb=Array(16);for(B=N=0;B<28;B++)for(ep[B]=N,e=0;e<1<<et[B];e++)eh[N++]=B;for(eh[N-1]=B,B=el=0;B<16;B++)for(em[B]=el,e=0;e<1<<ei[B];e++)ef[el++]=B;for(el>>=7;B<30;B++)for(em[B]=el<<7,e=0;e<1<<ei[B]-7;e++)ef[256+el++]=B;for(n=0;n<=15;n++)eb[n]=0;for(e=0;e<=143;)eu[2*e+1]=8,e++,eb[8]++;for(;e<=255;)eu[2*e+1]=9,e++,eb[9]++;for(;e<=279;)eu[2*e+1]=7,e++,eb[7]++;for(;e<=287;)eu[2*e+1]=8,e++,eb[8]++;for(st(eu,287,eb),e=0;e<30;e++)ec[2*e+1]=5,ec[2*e]=He(e,5);ed=new z(eu,et,257,286,15),e_=new z(ec,ei,0,30,15),eg=new z([],eo,0,19,7)}(),eb=!0),e.l_desc=new I(e.dyn_ltree,ed),e.d_desc=new I(e.dyn_dtree,e_),e.bl_desc=new I(e.bl_tree,eg),e.bi_buf=0,e.bi_valid=0,Ze(e)},N._tr_stored_block=A,N._tr_flush_block=function(e,n,N,B){var et,ei,eo=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var n,N=4093624447;for(n=0;n<=31;n++,N>>>=1)if(1&N&&0!==e.dyn_ltree[2*n])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==e.dyn_ltree[2*n])return 1;return 0}(e)),Ge(e,e.l_desc),Ge(e,e.d_desc),eo=function(e){var n;for(g(e,e.dyn_ltree,e.l_desc.max_code),g(e,e.dyn_dtree,e.d_desc.max_code),Ge(e,e.bl_desc),n=18;3<=n&&0===e.bl_tree[2*el[n]+1];n--);return e.opt_len+=3*(n+1)+5+5+4,n}(e),et=e.opt_len+3+7>>>3,(ei=e.static_len+3+7>>>3)<=et&&(et=ei)):et=ei=N+5,N+4<=et&&-1!==n?A(e,n,N,B):4===e.strategy||ei===et?(be(e,2+(B?1:0),3),xe(e,eu,ec)):(be(e,4+(B?1:0),3),function(e,n,N,B){var et;for(be(e,n-257,5),be(e,N-1,5),be(e,B-4,4),et=0;et<B;et++)be(e,e.bl_tree[2*el[et]+1],3);ge(e,e.dyn_ltree,n-1),ge(e,e.dyn_dtree,N-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,eo+1),xe(e,e.dyn_ltree,e.dyn_dtree)),Ze(e),B&&ae(e)},N._tr_tally=function(e,n,N){return e.pending_buf[e.d_buf+2*e.last_lit]=n>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&n,e.pending_buf[e.l_buf+e.last_lit]=255&N,e.last_lit++,0===n?e.dyn_ltree[2*N]++:(e.matches++,n--,e.dyn_ltree[2*(eh[N]+256+1)]++,e.dyn_dtree[2*C(n)]++),e.last_lit===e.lit_bufsize-1},N._tr_align=function(e){be(e,2,3),Ue(e,256,eu),16===e.bi_valid?(ye(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,n,N){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,N){(function(e){!function(e,n){if(!e.setImmediate){var N,B,et,ei,eo=1,el={},ec=!1,ef=e.document,eh=Object.getPrototypeOf&&Object.getPrototypeOf(e);eh=eh&&eh.setTimeout?eh:e,N="[object process]"===({}).toString.call(e.process)?function(e){eu.nextTick(function(){R(e)})}:!function(){if(e.postMessage&&!e.importScripts){var n=!0,N=e.onmessage;return e.onmessage=function(){n=!1},e.postMessage("","*"),e.onmessage=N,n}}()?e.MessageChannel?((et=new MessageChannel).port1.onmessage=function(e){R(e.data)},function(e){et.port2.postMessage(e)}):ef&&"onreadystatechange"in ef.createElement("script")?(B=ef.documentElement,function(e){var n=ef.createElement("script");n.onreadystatechange=function(){R(e),n.onreadystatechange=null,B.removeChild(n),n=null},B.appendChild(n)}):function(e){setTimeout(R,0,e)}:(ei="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",M,!1):e.attachEvent("onmessage",M),function(n){e.postMessage(ei+n,"*")}),eh.setImmediate=function(e){"function"!=typeof e&&(e=Function(""+e));for(var n=Array(arguments.length-1),B=0;B<n.length;B++)n[B]=arguments[B+1];var et={callback:e,args:n};return el[eo]=et,N(eo),eo++},eh.clearImmediate=b}function b(e){delete el[e]}function R(e){if(ec)setTimeout(R,0,e);else{var n=el[e];if(n){ec=!0;try{!function(e){var n=e.callback,N=e.args;switch(N.length){case 0:n();break;case 1:n(N[0]);break;case 2:n(N[0],N[1]);break;case 3:n(N[0],N[1],N[2]);break;default:n.apply(void 0,N)}}(n)}finally{b(e),ec=!1}}}}function M(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(ei)&&R(+n.data.slice(ei.length))}}(typeof self>"u"?void 0===e?this:e:self)}).call(this,"u">typeof th?th:"u">typeof self?self:"u">typeof window?window:{})},{}]},{},[10])(10);var td=tp.exports;let t_=td&&td.__esModule&&Object.prototype.hasOwnProperty.call(td,"default")?td.default:td;function Da(e){return fetch(e).then(e=>e.ok?e.blob():Promise.reject(e.status)).then(e=>e.text())}let Zo=class Zo{constructor(e){this.baseUrl=e}href(e){return`${this.baseUrl}/${e}`}get(e){return Da(this.href(e))}ready(e){e&&e()}close(e){e&&e(null)}};let qo=class qo{ready(e){throw Error("Method not implemented.")}close(e){throw Error("Method not implemented.")}};let Wo=class Wo extends qo{constructor(e){super(),this._zip=void 0,this._isClosed=!1,this._task=Da(e).then(t_.loadAsync).then(e=>{this._isClosed||(this._zip=e,this._task=void 0,this._notifyReady())})}href(e){return e}get(e){return new Promise((n,N)=>{if(void 0===this._zip){N(void 0);return}let B=this._zip.file(e);if(!B){N(void 0);return}B.async("string").then(e=>{n(e)}).catch(N)})}ready(e){this._readyCallback=e,void 0===this._task&&this._notifyReady()}_notifyReady(){void 0!==this._readyCallback&&this._readyCallback()}close(e){this._isClosed=!0,this._task=void 0,this._zip=void 0,void 0!==e&&e(null)}};let tg={inputController:()=>new $o,fileServer:e=>new Zo(e),zipServer:e=>new Wo(e)},tm=class extends el.Component{componentDidMount(){var e,n,N,B;let et,ei;void 0===this._player&&(this._player=(e={element:this.props._ref.current,url:this.props.url,boot:this.props.boot,splashart:this.props.splashart,width:this.props.width,height:this.props.height,scale:this.props.scale,resizable:this.props.resizable,autoPlay:this.props.autoPlay,speed:this.props.speed,onReady:this.props.onReady},n=void 0,ei={url:"",resizable:!0,speed:1},void 0===e||ja(e)||"className"in e?et=e:n=e,void 0!==n&&(ei={...ei,...n}),null==et&&(et=void 0!==ei.element?ei.element:document.getElementsByClassName("moroboxai-player")),ja(et)?Array.prototype.map.call(et,e=>{var n;return n=ei,new Vo(tg,e,n)}):(N=et,B=ei,new Vo(tg,N,B))),void 0!==this.props.onMount&&this.props.onMount(this._player))}componentDidUpdate(e){void 0!==this._player&&(void 0!==this.props.width&&this.props.width!=e.width&&this._player.resize({width:this.props.width,height:this._player.height}),void 0!==this.props.height&&this.props.height!=e.height&&this._player.resize({width:this._player.width,height:this.props.height}),void 0!==this.props.scale&&this.props.scale!=e.scale&&(this._player.scale=this.props.scale),void 0!==this.props.speed&&this.props.speed!=e.speed&&(this._player.speed=this.props.speed),void 0!==this.props.resizable&&this.props.resizable!=e.resizable&&(this._player.resizable=this.props.resizable),void 0!==this.props.boot&&this.props.boot!=e.boot&&(this._player.boot=this.props.boot),void 0!==this.props.autoPlay&&this.props.autoPlay!=e.autoPlay&&(this._player.autoPlay=this.props.autoPlay),void 0!==this.props.url&&this.props.url!=e.url&&this._player.play({url:this.props.url}))}componentWillUnmount(){if(void 0!==this._player){console.log("unmount player from",this);let e=this._player;this._player.remove(),this._player=void 0,void 0!==this.props.onUnmount&&this.props.onUnmount(e)}}getModel(){return this._player}render(){let e={style:{backgroundSize:"cover"}};return void 0!==this.props.url&&(e["data-url"]=this.props.url),void 0!==this.props.splashart&&(e.style.backgroundImage=`url('${this.props.splashart}')`),ep.jsx("div",{className:this.props.className??"",ref:this.props._ref,...e})}},tb=(0,el.memo)(tm);let nl=class nl extends el.Component{constructor(e){super(e),this._refContainer=el.createRef()}render(){return ep.jsx(tb,{_ref:this._refContainer,...this.props})}};let ty=(0,el.memo)(nl)}}]);