"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[890],{6396:function(e,n,N){let C;N.d(n,{ZP:function(){return ty}});var et,ei,eo,eu=N(7294),ec=N(3454),ef=N(1876).Buffer,eh={exports:{}},ep={};eh.exports=function(){if(ei)return ep;ei=1;var e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),N=Object.prototype.hasOwnProperty,C=eu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,et={key:!0,ref:!0,__self:!0,__source:!0};function i(n,ei,eo){var eu,ec={},ef=null,eh=null;for(eu in void 0!==eo&&(ef=""+eo),void 0!==ei.key&&(ef=""+ei.key),void 0!==ei.ref&&(eh=ei.ref),ei)N.call(ei,eu)&&!et.hasOwnProperty(eu)&&(ec[eu]=ei[eu]);if(n&&n.defaultProps)for(eu in ei=n.defaultProps)void 0===ec[eu]&&(ec[eu]=ei[eu]);return{$$typeof:e,type:n,key:ef,ref:eh,props:ec,_owner:C.current}}return ep.Fragment=n,ep.jsx=i,ep.jsxs=i,ep}();var ed=eh.exports;let e_=["saveState","loadState","inputs"];let $a=class $a{constructor(e,n){this._fun=e,this._context=n}saveState(){return void 0!==this._context.saveState?this._context.saveState():{}}loadState(e){void 0!==this._context.loadState&&this._context.loadState(e)}inputs(e){return void 0!==this._context.inputs?this._context.inputs(e):{}}};var eg=function(e){var n={};function t(N){if(n[N])return n[N].exports;var C=n[N]={i:N,l:!1,exports:{}};return e[N].call(C.exports,C,C.exports,t),C.l=!0,C.exports}return t.m=e,t.c=n,t.d=function(e,n,N){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:N})},t.r=function(e){"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n||4&n&&"object"==typeof e&&e&&e.__esModule)return e;var N=Object.create(null);if(t.r(N),Object.defineProperty(N,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var C in e)t.d(N,C,(function(n){return e[n]}).bind(null,C));return N},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=34)}([function(e,n,N){/**
  @license MIT
  
  Copyright © 2017-2018 Benoit Giannangeli
  Copyright © 2017-2018 Daurnimator
  Copyright © 1994–2017 Lua.org, PUC-Rio.
  */let C=N(5);e.exports.FENGARI_AUTHORS=C.FENGARI_AUTHORS,e.exports.FENGARI_COPYRIGHT=C.FENGARI_COPYRIGHT,e.exports.FENGARI_RELEASE=C.FENGARI_RELEASE,e.exports.FENGARI_VERSION=C.FENGARI_VERSION,e.exports.FENGARI_VERSION_MAJOR=C.FENGARI_VERSION_MAJOR,e.exports.FENGARI_VERSION_MINOR=C.FENGARI_VERSION_MINOR,e.exports.FENGARI_VERSION_NUM=C.FENGARI_VERSION_NUM,e.exports.FENGARI_VERSION_RELEASE=C.FENGARI_VERSION_RELEASE,e.exports.luastring_eq=C.luastring_eq,e.exports.luastring_indexOf=C.luastring_indexOf,e.exports.luastring_of=C.luastring_of,e.exports.to_jsstring=C.to_jsstring,e.exports.to_luastring=C.to_luastring,e.exports.to_uristring=C.to_uristring;let et=N(3),ei=N(2),eo=N(7),eu=N(17);e.exports.luaconf=et,e.exports.lua=ei,e.exports.lauxlib=eo,e.exports.lualib=eu},function(e,n,N){let C,et,ei;if(C="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e){let n=0,N=e.length,C=new Uint8Array(N);for(;N>n;)C[n]=e[n++];return C},"function"==typeof new Uint8Array().indexOf)et=function(e,n,N){return e.indexOf(n,N)};else{let e=[].indexOf;if(0!==e.call(new Uint8Array(1),0))throw Error("missing .indexOf");et=function(n,N,C){return e.call(n,N,C)}}ei="function"==typeof Uint8Array.of?Uint8Array.of.bind(Uint8Array):function(){return C(arguments)};let i=function(e){return e instanceof Uint8Array},eo="cannot convert invalid utf8 to javascript string",eu=";,/?:@&=+$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,-_.!~*'()#".split("").reduce(function(e,n){return e[n.charCodeAt(0)]=!0,e},{}),ec={},w=function(e,n){if("string"!=typeof e)throw TypeError("to_luastring expects a javascript string");if(n){let n=ec[e];if(i(n))return n}let N=e.length,et=Array(N),ei=0;for(let n=0;n<N;++n){let C=e.charCodeAt(n);if(C<=127)et[ei++]=C;else if(C<=2047)et[ei++]=192|C>>6,et[ei++]=128|63&C;else{if(C>=55296&&C<=56319&&n+1<N){let N=e.charCodeAt(n+1);N>=56320&&N<=57343&&(n++,C=1024*(C-55296)+N+9216)}C<=65535?et[ei++]=224|C>>12:(et[ei++]=240|C>>18,et[ei++]=128|C>>12&63),et[ei++]=128|C>>6&63,et[ei++]=128|63&C}}return et=C(et),n&&(ec[e]=et),et};e.exports.luastring_from=C,e.exports.luastring_indexOf=et,e.exports.luastring_of=ei,e.exports.is_luastring=i,e.exports.luastring_eq=function(e,n){if(e!==n){let N=e.length;if(N!==n.length)return!1;for(let C=0;C<N;C++)if(e[C]!==n[C])return!1}return!0},e.exports.to_jsstring=function(e,n,N,C){if(!i(e))throw TypeError("to_jsstring expects a Uint8Array");N=void 0===N?e.length:Math.min(e.length,N);let et="";for(let ei=void 0!==n?n:0;ei<N;){let n=e[ei++];if(n<128)et+=String.fromCharCode(n);else if(n<194||n>244){if(!C)throw RangeError(eo);et+="�"}else if(n<=223){if(ei>=N){if(!C)throw RangeError(eo);et+="�";continue}let eu=e[ei++];if((192&eu)!=128){if(!C)throw RangeError(eo);et+="�";continue}et+=String.fromCharCode(((31&n)<<6)+(63&eu))}else if(n<=239){if(ei+1>=N){if(!C)throw RangeError(eo);et+="�";continue}let eu=e[ei++];if((192&eu)!=128){if(!C)throw RangeError(eo);et+="�";continue}let ec=e[ei++];if((192&ec)!=128){if(!C)throw RangeError(eo);et+="�";continue}let ef=((15&n)<<12)+((63&eu)<<6)+(63&ec);ef<=65535?et+=String.fromCharCode(ef):et+=String.fromCharCode(55296+((ef-=65536)>>10),ef%1024+56320)}else{if(ei+2>=N){if(!C)throw RangeError(eo);et+="�";continue}let eu=e[ei++];if((192&eu)!=128){if(!C)throw RangeError(eo);et+="�";continue}let ec=e[ei++];if((192&ec)!=128){if(!C)throw RangeError(eo);et+="�";continue}let ef=e[ei++];if((192&ef)!=128){if(!C)throw RangeError(eo);et+="�";continue}let eh=((7&n)<<18)+((63&eu)<<12)+((63&ec)<<6)+(63&ef);et+=String.fromCharCode(55296+((eh-=65536)>>10),eh%1024+56320)}}return et},e.exports.to_uristring=function(e){if(!i(e))throw TypeError("to_uristring expects a Uint8Array");let n="";for(let N=0;N<e.length;N++){let C=e[N];eu[C]?n+=String.fromCharCode(C):n+="%"+(C<16?"0":"")+C.toString(16)}return n},e.exports.to_luastring=w,e.exports.from_userstring=function(e){if(!i(e)){if("string"!=typeof e)throw TypeError("expects an array of bytes or javascript string");e=w(e)}return e};let ef=w("\x1bLua");e.exports.LUA_SIGNATURE=ef,e.exports.LUA_VERSION_MAJOR="5",e.exports.LUA_VERSION_MINOR="3",e.exports.LUA_VERSION_NUM=503,e.exports.LUA_VERSION_RELEASE="4",e.exports.LUA_VERSION="Lua 5.3",e.exports.LUA_RELEASE="Lua 5.3.4",e.exports.LUA_COPYRIGHT="Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio",e.exports.LUA_AUTHORS="R. Ierusalimschy, L. H. de Figueiredo, W. Celes";let eh={LUA_TNONE:-1,LUA_TNIL:0,LUA_TBOOLEAN:1,LUA_TLIGHTUSERDATA:2,LUA_TNUMBER:3,LUA_TSTRING:4,LUA_TTABLE:5,LUA_TFUNCTION:6,LUA_TUSERDATA:7,LUA_TTHREAD:8,LUA_NUMTAGS:9};eh.LUA_TSHRSTR=0|eh.LUA_TSTRING,eh.LUA_TLNGSTR=16|eh.LUA_TSTRING,eh.LUA_TNUMFLT=0|eh.LUA_TNUMBER,eh.LUA_TNUMINT=16|eh.LUA_TNUMBER,eh.LUA_TLCL=0|eh.LUA_TFUNCTION,eh.LUA_TLCF=16|eh.LUA_TFUNCTION,eh.LUA_TCCL=32|eh.LUA_TFUNCTION;let{LUAI_MAXSTACK:ep}=N(3),ed=-ep-1e3;e.exports.LUA_HOOKCALL=0,e.exports.LUA_HOOKCOUNT=3,e.exports.LUA_HOOKLINE=2,e.exports.LUA_HOOKRET=1,e.exports.LUA_HOOKTAILCALL=4,e.exports.LUA_MASKCALL=1,e.exports.LUA_MASKCOUNT=8,e.exports.LUA_MASKLINE=4,e.exports.LUA_MASKRET=2,e.exports.LUA_MINSTACK=20,e.exports.LUA_MULTRET=-1,e.exports.LUA_OPADD=0,e.exports.LUA_OPBAND=7,e.exports.LUA_OPBNOT=13,e.exports.LUA_OPBOR=8,e.exports.LUA_OPBXOR=9,e.exports.LUA_OPDIV=5,e.exports.LUA_OPEQ=0,e.exports.LUA_OPIDIV=6,e.exports.LUA_OPLE=2,e.exports.LUA_OPLT=1,e.exports.LUA_OPMOD=3,e.exports.LUA_OPMUL=2,e.exports.LUA_OPPOW=4,e.exports.LUA_OPSHL=10,e.exports.LUA_OPSHR=11,e.exports.LUA_OPSUB=1,e.exports.LUA_OPUNM=12,e.exports.LUA_REGISTRYINDEX=ed,e.exports.LUA_RIDX_GLOBALS=2,e.exports.LUA_RIDX_LAST=2,e.exports.LUA_RIDX_MAINTHREAD=1,e.exports.constant_types=eh,e.exports.lua_Debug=class{constructor(){this.event=NaN,this.name=null,this.namewhat=null,this.what=null,this.source=null,this.currentline=NaN,this.linedefined=NaN,this.lastlinedefined=NaN,this.nups=NaN,this.nparams=NaN,this.isvararg=NaN,this.istailcall=NaN,this.short_src=null,this.i_ci=null}},e.exports.lua_upvalueindex=function(e){return ed-e},e.exports.thread_status={LUA_OK:0,LUA_YIELD:1,LUA_ERRRUN:2,LUA_ERRSYNTAX:3,LUA_ERRMEM:4,LUA_ERRGCMM:5,LUA_ERRERR:6}},function(e,n,N){let C=N(1),et=N(18),ei=N(11),eo=N(8),eu=N(12);e.exports.LUA_AUTHORS=C.LUA_AUTHORS,e.exports.LUA_COPYRIGHT=C.LUA_COPYRIGHT,e.exports.LUA_ERRERR=C.thread_status.LUA_ERRERR,e.exports.LUA_ERRGCMM=C.thread_status.LUA_ERRGCMM,e.exports.LUA_ERRMEM=C.thread_status.LUA_ERRMEM,e.exports.LUA_ERRRUN=C.thread_status.LUA_ERRRUN,e.exports.LUA_ERRSYNTAX=C.thread_status.LUA_ERRSYNTAX,e.exports.LUA_HOOKCALL=C.LUA_HOOKCALL,e.exports.LUA_HOOKCOUNT=C.LUA_HOOKCOUNT,e.exports.LUA_HOOKLINE=C.LUA_HOOKLINE,e.exports.LUA_HOOKRET=C.LUA_HOOKRET,e.exports.LUA_HOOKTAILCALL=C.LUA_HOOKTAILCALL,e.exports.LUA_MASKCALL=C.LUA_MASKCALL,e.exports.LUA_MASKCOUNT=C.LUA_MASKCOUNT,e.exports.LUA_MASKLINE=C.LUA_MASKLINE,e.exports.LUA_MASKRET=C.LUA_MASKRET,e.exports.LUA_MINSTACK=C.LUA_MINSTACK,e.exports.LUA_MULTRET=C.LUA_MULTRET,e.exports.LUA_NUMTAGS=C.constant_types.LUA_NUMTAGS,e.exports.LUA_OK=C.thread_status.LUA_OK,e.exports.LUA_OPADD=C.LUA_OPADD,e.exports.LUA_OPBAND=C.LUA_OPBAND,e.exports.LUA_OPBNOT=C.LUA_OPBNOT,e.exports.LUA_OPBOR=C.LUA_OPBOR,e.exports.LUA_OPBXOR=C.LUA_OPBXOR,e.exports.LUA_OPDIV=C.LUA_OPDIV,e.exports.LUA_OPEQ=C.LUA_OPEQ,e.exports.LUA_OPIDIV=C.LUA_OPIDIV,e.exports.LUA_OPLE=C.LUA_OPLE,e.exports.LUA_OPLT=C.LUA_OPLT,e.exports.LUA_OPMOD=C.LUA_OPMOD,e.exports.LUA_OPMUL=C.LUA_OPMUL,e.exports.LUA_OPPOW=C.LUA_OPPOW,e.exports.LUA_OPSHL=C.LUA_OPSHL,e.exports.LUA_OPSHR=C.LUA_OPSHR,e.exports.LUA_OPSUB=C.LUA_OPSUB,e.exports.LUA_OPUNM=C.LUA_OPUNM,e.exports.LUA_REGISTRYINDEX=C.LUA_REGISTRYINDEX,e.exports.LUA_RELEASE=C.LUA_RELEASE,e.exports.LUA_RIDX_GLOBALS=C.LUA_RIDX_GLOBALS,e.exports.LUA_RIDX_LAST=C.LUA_RIDX_LAST,e.exports.LUA_RIDX_MAINTHREAD=C.LUA_RIDX_MAINTHREAD,e.exports.LUA_SIGNATURE=C.LUA_SIGNATURE,e.exports.LUA_TNONE=C.constant_types.LUA_TNONE,e.exports.LUA_TNIL=C.constant_types.LUA_TNIL,e.exports.LUA_TBOOLEAN=C.constant_types.LUA_TBOOLEAN,e.exports.LUA_TLIGHTUSERDATA=C.constant_types.LUA_TLIGHTUSERDATA,e.exports.LUA_TNUMBER=C.constant_types.LUA_TNUMBER,e.exports.LUA_TSTRING=C.constant_types.LUA_TSTRING,e.exports.LUA_TTABLE=C.constant_types.LUA_TTABLE,e.exports.LUA_TFUNCTION=C.constant_types.LUA_TFUNCTION,e.exports.LUA_TUSERDATA=C.constant_types.LUA_TUSERDATA,e.exports.LUA_TTHREAD=C.constant_types.LUA_TTHREAD,e.exports.LUA_VERSION=C.LUA_VERSION,e.exports.LUA_VERSION_MAJOR=C.LUA_VERSION_MAJOR,e.exports.LUA_VERSION_MINOR=C.LUA_VERSION_MINOR,e.exports.LUA_VERSION_NUM=C.LUA_VERSION_NUM,e.exports.LUA_VERSION_RELEASE=C.LUA_VERSION_RELEASE,e.exports.LUA_YIELD=C.thread_status.LUA_YIELD,e.exports.lua_Debug=C.lua_Debug,e.exports.lua_upvalueindex=C.lua_upvalueindex,e.exports.lua_absindex=et.lua_absindex,e.exports.lua_arith=et.lua_arith,e.exports.lua_atpanic=et.lua_atpanic,e.exports.lua_atnativeerror=et.lua_atnativeerror,e.exports.lua_call=et.lua_call,e.exports.lua_callk=et.lua_callk,e.exports.lua_checkstack=et.lua_checkstack,e.exports.lua_close=eu.lua_close,e.exports.lua_compare=et.lua_compare,e.exports.lua_concat=et.lua_concat,e.exports.lua_copy=et.lua_copy,e.exports.lua_createtable=et.lua_createtable,e.exports.lua_dump=et.lua_dump,e.exports.lua_error=et.lua_error,e.exports.lua_gc=et.lua_gc,e.exports.lua_getallocf=et.lua_getallocf,e.exports.lua_getextraspace=et.lua_getextraspace,e.exports.lua_getfield=et.lua_getfield,e.exports.lua_getglobal=et.lua_getglobal,e.exports.lua_gethook=ei.lua_gethook,e.exports.lua_gethookcount=ei.lua_gethookcount,e.exports.lua_gethookmask=ei.lua_gethookmask,e.exports.lua_geti=et.lua_geti,e.exports.lua_getinfo=ei.lua_getinfo,e.exports.lua_getlocal=ei.lua_getlocal,e.exports.lua_getmetatable=et.lua_getmetatable,e.exports.lua_getstack=ei.lua_getstack,e.exports.lua_gettable=et.lua_gettable,e.exports.lua_gettop=et.lua_gettop,e.exports.lua_getupvalue=et.lua_getupvalue,e.exports.lua_getuservalue=et.lua_getuservalue,e.exports.lua_insert=et.lua_insert,e.exports.lua_isboolean=et.lua_isboolean,e.exports.lua_iscfunction=et.lua_iscfunction,e.exports.lua_isfunction=et.lua_isfunction,e.exports.lua_isinteger=et.lua_isinteger,e.exports.lua_islightuserdata=et.lua_islightuserdata,e.exports.lua_isnil=et.lua_isnil,e.exports.lua_isnone=et.lua_isnone,e.exports.lua_isnoneornil=et.lua_isnoneornil,e.exports.lua_isnumber=et.lua_isnumber,e.exports.lua_isproxy=et.lua_isproxy,e.exports.lua_isstring=et.lua_isstring,e.exports.lua_istable=et.lua_istable,e.exports.lua_isthread=et.lua_isthread,e.exports.lua_isuserdata=et.lua_isuserdata,e.exports.lua_isyieldable=eo.lua_isyieldable,e.exports.lua_len=et.lua_len,e.exports.lua_load=et.lua_load,e.exports.lua_newstate=eu.lua_newstate,e.exports.lua_newtable=et.lua_newtable,e.exports.lua_newthread=eu.lua_newthread,e.exports.lua_newuserdata=et.lua_newuserdata,e.exports.lua_next=et.lua_next,e.exports.lua_pcall=et.lua_pcall,e.exports.lua_pcallk=et.lua_pcallk,e.exports.lua_pop=et.lua_pop,e.exports.lua_pushboolean=et.lua_pushboolean,e.exports.lua_pushcclosure=et.lua_pushcclosure,e.exports.lua_pushcfunction=et.lua_pushcfunction,e.exports.lua_pushfstring=et.lua_pushfstring,e.exports.lua_pushglobaltable=et.lua_pushglobaltable,e.exports.lua_pushinteger=et.lua_pushinteger,e.exports.lua_pushjsclosure=et.lua_pushjsclosure,e.exports.lua_pushjsfunction=et.lua_pushjsfunction,e.exports.lua_pushlightuserdata=et.lua_pushlightuserdata,e.exports.lua_pushliteral=et.lua_pushliteral,e.exports.lua_pushlstring=et.lua_pushlstring,e.exports.lua_pushnil=et.lua_pushnil,e.exports.lua_pushnumber=et.lua_pushnumber,e.exports.lua_pushstring=et.lua_pushstring,e.exports.lua_pushthread=et.lua_pushthread,e.exports.lua_pushvalue=et.lua_pushvalue,e.exports.lua_pushvfstring=et.lua_pushvfstring,e.exports.lua_rawequal=et.lua_rawequal,e.exports.lua_rawget=et.lua_rawget,e.exports.lua_rawgeti=et.lua_rawgeti,e.exports.lua_rawgetp=et.lua_rawgetp,e.exports.lua_rawlen=et.lua_rawlen,e.exports.lua_rawset=et.lua_rawset,e.exports.lua_rawseti=et.lua_rawseti,e.exports.lua_rawsetp=et.lua_rawsetp,e.exports.lua_register=et.lua_register,e.exports.lua_remove=et.lua_remove,e.exports.lua_replace=et.lua_replace,e.exports.lua_resume=eo.lua_resume,e.exports.lua_rotate=et.lua_rotate,e.exports.lua_setallof=eo.lua_setallof,e.exports.lua_setfield=et.lua_setfield,e.exports.lua_setglobal=et.lua_setglobal,e.exports.lua_sethook=ei.lua_sethook,e.exports.lua_seti=et.lua_seti,e.exports.lua_setlocal=ei.lua_setlocal,e.exports.lua_setmetatable=et.lua_setmetatable,e.exports.lua_settable=et.lua_settable,e.exports.lua_settop=et.lua_settop,e.exports.lua_setupvalue=et.lua_setupvalue,e.exports.lua_setuservalue=et.lua_setuservalue,e.exports.lua_status=et.lua_status,e.exports.lua_stringtonumber=et.lua_stringtonumber,e.exports.lua_toboolean=et.lua_toboolean,e.exports.lua_todataview=et.lua_todataview,e.exports.lua_tointeger=et.lua_tointeger,e.exports.lua_tointegerx=et.lua_tointegerx,e.exports.lua_tojsstring=et.lua_tojsstring,e.exports.lua_tolstring=et.lua_tolstring,e.exports.lua_tonumber=et.lua_tonumber,e.exports.lua_tonumberx=et.lua_tonumberx,e.exports.lua_topointer=et.lua_topointer,e.exports.lua_toproxy=et.lua_toproxy,e.exports.lua_tostring=et.lua_tostring,e.exports.lua_tothread=et.lua_tothread,e.exports.lua_touserdata=et.lua_touserdata,e.exports.lua_type=et.lua_type,e.exports.lua_typename=et.lua_typename,e.exports.lua_upvalueid=et.lua_upvalueid,e.exports.lua_upvaluejoin=et.lua_upvaluejoin,e.exports.lua_version=et.lua_version,e.exports.lua_xmove=et.lua_xmove,e.exports.lua_yield=eo.lua_yield,e.exports.lua_yieldk=eo.lua_yieldk,e.exports.lua_tocfunction=et.lua_tocfunction},function(e,n,N){let C={},{LUA_VERSION_MAJOR:et,LUA_VERSION_MINOR:ei,to_luastring:eo}=N(1);e.exports.LUA_PATH_SEP=";",e.exports.LUA_PATH_MARK="?",e.exports.LUA_EXEC_DIR="!";let eu=et+"."+ei;e.exports.LUA_VDIR=eu;{e.exports.LUA_DIRSEP="/";let n="./lua/"+eu+"/";e.exports.LUA_LDIR=n,e.exports.LUA_JSDIR=n;let N=eo(n+"?.lua;"+n+"?/init.lua;./?.lua;./?/init.lua");e.exports.LUA_PATH_DEFAULT=N;let C=eo(n+"?.js;"+n+"loadall.js;./?.js");e.exports.LUA_JSPATH_DEFAULT=C}let ec=C.LUA_COMPAT_FLOATSTRING||!1,ef=C.LUAI_MAXSTACK||1e6,eh=C.LUA_IDSIZE||59,ep=C.LUAL_BUFFERSIZE||8192,L=function(e,n){for(var N=Math.min(3,Math.ceil(Math.abs(n)/1023)),C=e,et=0;et<N;et++)C*=Math.pow(2,Math.floor((n+et)/N));return C};e.exports.LUAI_MAXSTACK=ef,e.exports.LUA_COMPAT_FLOATSTRING=ec,e.exports.LUA_IDSIZE=eh,e.exports.LUA_INTEGER_FMT="%d",e.exports.LUA_INTEGER_FRMLEN="",e.exports.LUA_MAXINTEGER=2147483647,e.exports.LUA_MININTEGER=-2147483648,e.exports.LUA_NUMBER_FMT="%.14g",e.exports.LUA_NUMBER_FRMLEN="",e.exports.LUAL_BUFFERSIZE=ep,e.exports.frexp=function(e){if(0===e)return[e,0];var n=new DataView(new ArrayBuffer(8));n.setFloat64(0,e);var N=n.getUint32(0)>>>20&2047;0===N&&(n.setFloat64(0,18446744073709552e3*e),N=(n.getUint32(0)>>>20&2047)-64);var C=N-1022;return[L(e,-C),C]},e.exports.ldexp=L,e.exports.lua_getlocaledecpoint=function(){return 46},e.exports.lua_integer2str=function(e){return String(e)},e.exports.lua_number2str=function(e){return String(Number(e.toPrecision(14)))},e.exports.lua_numbertointeger=function(e){return e>=-2147483648&&e<2147483648&&e},e.exports.luai_apicheck=function(e,n){if(!n)throw Error(n)}},function(e,n,N){let{luai_apicheck:C}=N(3),s=function(e){if(!e)throw Error("assertion failed")};e.exports.lua_assert=s,e.exports.luai_apicheck=C||function(e,n){return s(n)},e.exports.api_check=function(e,n,N){return C(e,n&&N)},e.exports.LUAI_MAXCCALLS=200,e.exports.LUA_MINBUFFER=32,e.exports.luai_nummod=function(e,n,N){let C=n%N;return C*N<0&&(C+=N),C},e.exports.MAX_INT=2147483647,e.exports.MIN_INT=-2147483648},function(e,n,N){let C=N(1),et=`Fengari 0.1.4  Copyright (C) 2017-2018 B. Giannangeli, Daurnimator
Based on: `+C.LUA_COPYRIGHT;e.exports.FENGARI_AUTHORS="B. Giannangeli, Daurnimator",e.exports.FENGARI_COPYRIGHT=et,e.exports.FENGARI_RELEASE="Fengari 0.1.4",e.exports.FENGARI_VERSION="Fengari 0.1",e.exports.FENGARI_VERSION_MAJOR="0",e.exports.FENGARI_VERSION_MINOR="1",e.exports.FENGARI_VERSION_NUM=1,e.exports.FENGARI_VERSION_RELEASE="4",e.exports.is_luastring=C.is_luastring,e.exports.luastring_eq=C.luastring_eq,e.exports.luastring_from=C.luastring_from,e.exports.luastring_indexOf=C.luastring_indexOf,e.exports.luastring_of=C.luastring_of,e.exports.to_jsstring=C.to_jsstring,e.exports.to_luastring=C.to_luastring,e.exports.to_uristring=C.to_uristring,e.exports.from_userstring=C.from_userstring},function(e,n,N){let{LUA_OPADD:C,LUA_OPBAND:et,LUA_OPBNOT:ei,LUA_OPBOR:eo,LUA_OPBXOR:eu,LUA_OPDIV:ec,LUA_OPIDIV:ef,LUA_OPMOD:eh,LUA_OPMUL:ep,LUA_OPPOW:ed,LUA_OPSHL:e_,LUA_OPSHR:eg,LUA_OPSUB:em,LUA_OPUNM:eb,constant_types:{LUA_NUMTAGS:ey,LUA_TBOOLEAN:ev,LUA_TCCL:ek,LUA_TFUNCTION:eA,LUA_TLCF:eL,LUA_TLCL:ex,LUA_TLIGHTUSERDATA:ew,LUA_TLNGSTR:eT,LUA_TNIL:eO,LUA_TNUMBER:eE,LUA_TNUMFLT:eS,LUA_TNUMINT:eN,LUA_TSHRSTR:eI,LUA_TSTRING:eR,LUA_TTABLE:eU,LUA_TTHREAD:eC,LUA_TUSERDATA:eM},from_userstring:eP,luastring_indexOf:eD,luastring_of:eB,to_jsstring:eK,to_luastring:eF}=N(1),{lisdigit:eV,lisprint:eG,lisspace:ej,lisxdigit:ez}=N(22),eH=N(11),e$=N(8),eX=N(12),{luaS_bless:eq,luaS_new:eW}=N(10),eZ=N(9),{LUA_COMPAT_FLOATSTRING:eY,ldexp:eJ,lua_integer2str:eQ,lua_number2str:e0}=N(3),e1=N(15),{MAX_INT:e2,luai_nummod:e3,lua_assert:e5}=N(4),e4=N(14),e8=ey+1;let ce=class ce{constructor(e,n){this.type=e,this.value=n}ttype(){return 63&this.type}ttnov(){return 15&this.type}checktag(e){return this.type===e}checktype(e){return this.ttnov()===e}ttisnumber(){return this.checktype(eE)}ttisfloat(){return this.checktag(eS)}ttisinteger(){return this.checktag(eN)}ttisnil(){return this.checktag(eO)}ttisboolean(){return this.checktag(ev)}ttislightuserdata(){return this.checktag(ew)}ttisstring(){return this.checktype(eR)}ttisshrstring(){return this.checktag(eI)}ttislngstring(){return this.checktag(eT)}ttistable(){return this.checktag(eU)}ttisfunction(){return this.checktype(eA)}ttisclosure(){return(31&this.type)===eA}ttisCclosure(){return this.checktag(ek)}ttisLclosure(){return this.checktag(ex)}ttislcf(){return this.checktag(eL)}ttisfulluserdata(){return this.checktag(eM)}ttisthread(){return this.checktag(eC)}ttisdeadkey(){return this.checktag(e8)}l_isfalse(){return this.ttisnil()||this.ttisboolean()&&!1===this.value}setfltvalue(e){this.type=eS,this.value=e}chgfltvalue(e){e5(this.type==eS),this.value=e}setivalue(e){this.type=eN,this.value=e}chgivalue(e){e5(this.type==eN),this.value=e}setnilvalue(){this.type=eO,this.value=null}setfvalue(e){this.type=eL,this.value=e}setpvalue(e){this.type=ew,this.value=e}setbvalue(e){this.type=ev,this.value=e}setsvalue(e){this.type=eT,this.value=e}setuvalue(e){this.type=eM,this.value=e}setthvalue(e){this.type=eC,this.value=e}setclLvalue(e){this.type=ex,this.value=e}setclCvalue(e){this.type=ek,this.value=e}sethvalue(e){this.type=eU,this.value=e}setdeadvalue(){this.type=e8,this.value=null}setfrom(e){this.type=e.type,this.value=e.value}tsvalue(){return e5(this.ttisstring()),this.value}svalue(){return this.tsvalue().getstr()}vslen(){return this.tsvalue().tsslen()}jsstring(e,n){return eK(this.svalue(),e,n,!0)}};let Ne=function(e,n,N){e.stack[n].setsvalue(N)},e6=new ce(eO,null);Object.freeze(e6),e.exports.luaO_nilobject=e6;let nt=class nt{constructor(e,n){this.id=e.l_G.id_counter++,this.p=null,this.nupvalues=n,this.upvals=Array(n)}};let dt=class dt{constructor(e,n,N){for(this.id=e.l_G.id_counter++,this.f=n,this.nupvalues=N,this.upvalue=Array(N);N--;)this.upvalue[N]=new ce(eO,null)}};let xt=class xt{constructor(e,n){this.id=e.l_G.id_counter++,this.metatable=null,this.uservalue=new ce(eO,null),this.len=n,this.data=Object.create(null)}};let e9=eF("..."),e7=eF('[string "'),ta=eF('"]'),Ce=function(e){return eV(e)?e-48:(223&e)-55},De=function(e,n){let N=1;if(e5(n<=1114111),n<128)e[7]=n;else{let C=63;do e[8-N++]=128|63&n,n>>=6,C>>=1;while(n>C);e[8-N]=~C<<1|n}return N},Fe=function(e,n){let N="x"===n?function(e){let n,N=0,C=0,et=0,ei=0,eo=0,eu=!1;for(;ej(e[N]);)N++;if(((n=45===e[N])||43===e[N])&&N++,48!==e[N]||120!==e[N+1]&&88!==e[N+1])return null;for(N+=2;;N++)if(46===e[N]){if(eu)break;eu=!0}else{if(!ez(e[N]))break;0===et&&48===e[N]?ei++:++et<=30?C=16*C+Ce(e[N]):eo++,eu&&eo--}if(ei+et===0)return null;if(eo*=4,112===e[N]||80===e[N]){let n,C=0;if(((n=45===e[++N])||43===e[N])&&N++,!eV(e[N]))return null;for(;eV(e[N]);)C=10*C+e[N++]-48;n&&(C=-C),eo+=C}return n&&(C=-C),{n:eJ(C,eo),i:N}}(e):function(e){try{e=eK(e)}catch{return null}let n=/^[\t\v\f \n\r]*[+-]?(?:[0-9]+\.?[0-9]*|\.[0-9]*)(?:[eE][+-]?[0-9]+)?/.exec(e);if(!n)return null;let N=parseFloat(n[0]);return isNaN(N)?null:{n:N,i:n[0].length}}(e);if(null===N)return null;for(;ej(e[N.i]);)N.i++;return N.i===e.length||0===e[N.i]?N:null},ti=[46,120,88,110,78],to={46:".",120:"x",88:"x",110:"n",78:"n"},tl=Math.floor(e2/10),tu=e2%10,vt=function(e,n){let N;if(n.ttisinteger())N=eF(eQ(n.value));else{let e=e0(n.value);!eY&&/^[-0123456789]+$/.test(e)&&(e+=".0"),N=eF(e)}n.setsvalue(eq(e,N))},yt=function(e,n){e$.luaD_inctop(e),Ne(e,e.top-1,eW(e,n))},Rt=function(e,n,N){let C,et=0,ei=0,eo=0;for(;-1!=(C=eD(n,37,ei));){switch(yt(e,n.subarray(ei,C)),n[C+1]){case 115:{let n=N[eo++];if(null===n)n=eF("(null)",!0);else{let e=eD(n=eP(n),0);-1!==e&&(n=n.subarray(0,e))}yt(e,n);break}case 99:{let n=N[eo++];eG(n)?yt(e,eB(n)):lt(e,eF("<\\%d>",!0),n);break}case 100:case 73:e$.luaD_inctop(e),e.stack[e.top-1].setivalue(N[eo++]),vt(e,e.stack[e.top-1]);break;case 102:e$.luaD_inctop(e),e.stack[e.top-1].setfltvalue(N[eo++]),vt(e,e.stack[e.top-1]);break;case 112:{let n=N[eo++];if(n instanceof eX.lua_State||n instanceof eZ.Table||n instanceof xt||n instanceof nt||n instanceof dt)yt(e,eF("0x"+n.id.toString(16)));else switch(typeof n){case"undefined":yt(e,eF("undefined"));break;case"number":yt(e,eF("Number("+n+")"));break;case"string":yt(e,eF("String("+JSON.stringify(n)+")"));break;case"boolean":yt(e,eF(n?"Boolean(true)":"Boolean(false)"));break;case"object":if(null===n){yt(e,eF("null"));break}case"function":{let N=e.l_G.ids.get(n);N||(N=e.l_G.id_counter++,e.l_G.ids.set(n,N)),yt(e,eF("0x"+N.toString(16)));break}default:yt(e,eF("<id NYI>"))}break}case 85:{let n=new Uint8Array(8),C=De(n,N[eo++]);yt(e,n.subarray(8-C));break}case 37:yt(e,eF("%",!0));break;default:eH.luaG_runerror(e,eF("invalid option '%%%c' to 'lua_pushfstring'"),n[C+1])}et+=2,ei=C+2}return e$.luaD_checkstack(e,1),yt(e,n.subarray(ei)),et>0&&e1.luaV_concat(e,et+1),e.stack[e.top-1].svalue()},lt=function(e,n,...N){return Rt(e,n,N)},pt=function(e,n,N,ec){switch(n){case C:return N+ec|0;case em:return N-ec|0;case ep:return e1.luaV_imul(N,ec);case eh:return e1.luaV_mod(e,N,ec);case ef:return e1.luaV_div(e,N,ec);case et:return N&ec;case eo:return N|ec;case eu:return N^ec;case e_:return e1.luaV_shiftl(N,ec);case eg:return e1.luaV_shiftl(N,-ec);case eb:return 0-N|0;case ei:return -1^N;default:e5(0)}},At=function(e,n,N,et){switch(n){case C:return N+et;case em:return N-et;case ep:return N*et;case ec:return N/et;case ed:return Math.pow(N,et);case ef:return Math.floor(N/et);case eb:return-N;case eh:return e3(e,N,et);default:e5(0)}};e.exports.CClosure=dt,e.exports.LClosure=nt,e.exports.LUA_TDEADKEY=e8,e.exports.LUA_TPROTO=ey,e.exports.LocVar=class{constructor(){this.varname=null,this.startpc=NaN,this.endpc=NaN}},e.exports.TValue=ce,e.exports.Udata=xt,e.exports.UTF8BUFFSZ=8,e.exports.luaO_arith=function(e,n,N,ef,eh){let ep="number"==typeof eh?e.stack[eh]:eh;switch(n){case et:case eo:case eu:case e_:case eg:case ei:{let C,et;if(!1!==(C=e1.tointeger(N))&&!1!==(et=e1.tointeger(ef)))return void ep.setivalue(pt(e,n,C,et));break}case ec:case ed:{let C,et;if(!1!==(C=e1.tonumber(N))&&!1!==(et=e1.tonumber(ef)))return void ep.setfltvalue(At(e,n,C,et));break}default:{let C,et;if(N.ttisinteger()&&ef.ttisinteger())return void ep.setivalue(pt(e,n,N.value,ef.value));if(!1!==(C=e1.tonumber(N))&&!1!==(et=e1.tonumber(ef)))return void ep.setfltvalue(At(e,n,C,et))}}e5(null!==e),e4.luaT_trybinTM(e,N,ef,eh,n-C+e4.TMS.TM_ADD)},e.exports.luaO_chunkid=function(e,n){let N,C=e.length;if(61===e[0])C<n?(N=new Uint8Array(C-1)).set(e.subarray(1)):(N=new Uint8Array(n)).set(e.subarray(1,n+1));else if(64===e[0])C<=n?(N=new Uint8Array(C-1)).set(e.subarray(1)):((N=new Uint8Array(n)).set(e9),n-=e9.length,N.set(e.subarray(C-n),e9.length));else{N=new Uint8Array(n);let et=eD(e,10);N.set(e7);let ei=e7.length;C<(n-=e7.length+e9.length+ta.length)&&-1===et?(N.set(e,ei),ei+=e.length):(-1!==et&&(C=et),C>n&&(C=n),N.set(e.subarray(0,C),ei),ei+=C,N.set(e9,ei),ei+=e9.length),N.set(ta,ei),ei+=ta.length,N=N.subarray(0,ei)}return N},e.exports.luaO_hexavalue=Ce,e.exports.luaO_int2fb=function(e){let n=0;if(e<8)return e;for(;e>=128;)e=e+15>>4,n+=4;for(;e>=16;)e=e+1>>1,n++;return n+1<<3|e-8},e.exports.luaO_pushfstring=lt,e.exports.luaO_pushvfstring=Rt,e.exports.luaO_str2num=function(e,n){let N=function(e){let n,N=0,C=0,et=!0;for(;ej(e[N]);)N++;if(((n=45===e[N])||43===e[N])&&N++,48!==e[N]||120!==e[N+1]&&88!==e[N+1])for(;N<e.length&&eV(e[N]);N++){let ei=e[N]-48;if(C>=tl&&(C>tl||ei>tu+n))return null;C=10*C+ei|0,et=!1}else for(N+=2;N<e.length&&ez(e[N]);N++)C=16*C+Ce(e[N])|0,et=!1;for(;N<e.length&&ej(e[N]);)N++;return et||N!==e.length&&0!==e[N]?null:{n:0|(n?-C:C),i:N}}(e);return null!==N?(n.setivalue(N.n),N.i+1):null!==(N=function(e){let n=e.length,N=0;for(let C=0;C<n;C++){let n=e[C];if(-1!==ti.indexOf(n)){N=n;break}}let C=to[N];return"n"===C?null:Fe(e,C)}(e))?(n.setfltvalue(N.n),N.i+1):0},e.exports.luaO_tostring=vt,e.exports.luaO_utf8esc=De,e.exports.numarith=At,e.exports.pushobj2s=function(e,n){e.stack[e.top++]=new ce(n.type,n.value)},e.exports.pushsvalue2s=function(e,n){e.stack[e.top++]=new ce(eT,n)},e.exports.setobjs2s=function(e,n,N){e.stack[n].setfrom(e.stack[N])},e.exports.setobj2s=function(e,n,N){e.stack[n].setfrom(N)},e.exports.setsvalue2s=Ne},function(e,n,N){let C,et;let{LUAL_BUFFERSIZE:ei}=N(3),{LUA_ERRERR:eo,LUA_MULTRET:eu,LUA_REGISTRYINDEX:ec,LUA_SIGNATURE:ef,LUA_TBOOLEAN:eh,LUA_TLIGHTUSERDATA:ep,LUA_TNIL:ed,LUA_TNONE:e_,LUA_TNUMBER:eg,LUA_TSTRING:em,LUA_TTABLE:eb,LUA_VERSION_NUM:ey,lua_Debug:ev,lua_absindex:ek,lua_atpanic:eA,lua_call:eL,lua_checkstack:ex,lua_concat:ew,lua_copy:eT,lua_createtable:eO,lua_error:eE,lua_getfield:eS,lua_getinfo:eN,lua_getmetatable:eI,lua_getstack:eR,lua_gettop:eU,lua_insert:eC,lua_isinteger:eM,lua_isnil:eP,lua_isnumber:eD,lua_isstring:eB,lua_istable:eK,lua_len:eF,lua_load:eV,lua_newstate:eG,lua_newtable:ej,lua_next:ez,lua_pcall:eH,lua_pop:e$,lua_pushboolean:eX,lua_pushcclosure:eq,lua_pushcfunction:eW,lua_pushfstring:eZ,lua_pushinteger:eY,lua_pushliteral:eJ,lua_pushlstring:eQ,lua_pushnil:e0,lua_pushstring:e1,lua_pushvalue:e2,lua_pushvfstring:e3,lua_rawequal:e5,lua_rawget:e4,lua_rawgeti:e8,lua_rawlen:e6,lua_rawseti:e9,lua_remove:e7,lua_setfield:ta,lua_setglobal:ti,lua_setmetatable:to,lua_settop:tl,lua_toboolean:tu,lua_tointeger:tc,lua_tointegerx:tf,lua_tojsstring:th,lua_tolstring:tp,lua_tonumber:td,lua_tonumberx:t_,lua_topointer:tg,lua_tostring:tm,lua_touserdata:tb,lua_type:ty,lua_typename:tv,lua_version:tk}=N(2),{from_userstring:tA,luastring_eq:tL,to_luastring:tx,to_uristring:tw}=N(5),tT=eo+1,tO=tx("_LOADED"),tE=tx("_PRELOAD"),tS=tx("FILE*"),tN=tx("__name"),tI=tx("__tostring"),tR=new Uint8Array(0);let U=class U{constructor(){this.L=null,this.b=tR,this.n=0}};let pe=function(e,n,N){if(0===N||!eK(e,-1))return 0;for(e0(e);ez(e,-2);){if(ty(e,-2)===em){if(e5(e,n,-1))return e$(e,1),1;if(pe(e,n,N-1))return e7(e,-2),eJ(e,"."),eC(e,-2),ew(e,3),1}e$(e,1)}return 0},He=function(e,n){let N=eU(e);if(eN(e,tx("f"),n),eS(e,ec,tO),pe(e,N+1,2)){let n=tm(e,-1);return 95===n[0]&&71===n[1]&&46===n[2]&&(e1(e,n.subarray(3)),e7(e,-2)),eT(e,-1,N+1),e$(e,2),1}return tl(e,N),0},Qe=function(e,n){He(e,n)?(eZ(e,tx("function '%s'"),tm(e,-1)),e7(e,-2)):0!==n.namewhat.length?eZ(e,tx("%s '%s'"),n.namewhat,n.name):n.what&&109===n.what[0]?eJ(e,"main chunk"):n.what&&76===n.what[0]?eZ(e,tx("function <%s:%d>"),n.short_src,n.linedefined):eJ(e,"?")},kt=function(e){throw Error("PANIC: unprotected error in call to Lua API ("+th(e,-1)+")")},J=function(e,n,N){let C=new ev;return eR(e,0,C)?(eN(e,tx("n"),C),tL(C.namewhat,tx("method"))&&0==--n?G(e,tx("calling '%s' on bad self (%s)"),C.name,N):(null===C.name&&(C.name=He(e,C)?tm(e,-1):tx("?")),G(e,tx("bad argument #%d to '%s' (%s)"),n,C.name,N))):G(e,tx("bad argument #%d (%s)"),n,N)},Z=function(e,n,N){let C;C=$e(e,n,tN)===em?tm(e,-1):ty(e,n)===ep?tx("light userdata",!0):ct(e,n);let et=eZ(e,tx("%s expected, got %s"),N,C);return J(e,n,et)},ke=function(e,n){let N=new ev;eR(e,n,N)&&(eN(e,tx("Sl",!0),N),N.currentline>0)?eZ(e,tx("%s:%d: "),N.short_src,N.currentline):e1(e,tx(""))},G=function(e,n,...N){return ke(e,1),e3(e,n,N),ew(e,2),eE(e)},Te=function(e,n,N,C){if(n)return eX(e,1),1;{let n,et;return e0(e),C?(n=C.message,et=-C.errno):(n="Success",et=0),N?eZ(e,tx("%s: %s"),N,tx(n)):e1(e,tx(n)),eY(e,et),3}},fe=function(e,n){return eS(e,ec,n)},Me=function(e,n,N){let C=tb(e,n);return null!==C&&eI(e,n)?(fe(e,N),e5(e,-1,-2)||(C=null),e$(e,2),C):null},tt=function(e,n,N){Z(e,n,tv(e,N))},ct=function(e,n){return tv(e,ty(e,n))},at=function(e,n){let N=tp(e,n);return null!=N||tt(e,n,em),N},Bt=function(e,n,N){return 0>=ty(e,n)?null===N?null:tA(N):at(e,n)},Et=function(e,n){let N=t_(e,n);return!1===N&&tt(e,n,eg),N},wt=function(e,n){let N=tf(e,n);return!1===N&&(eD(e,n)?J(e,n,tx("number has no integer representation",!0)):tt(e,n,eg)),N},Ct=function(e,n){let N=e.n+n;if(e.b.length<N){let n=Math.max(2*e.b.length,N),C=new Uint8Array(n);C.set(e.b),e.b=C}return e.b.subarray(e.n,N)},Mt=function(e,n){n.L=e,n.b=tR},Zt=function(e,n,N){N>0&&(n=tA(n),Ct(e,N).set(n.subarray(0,N)),$t(e,N))},Dt=function(e,n){Zt(e,n=tA(n),n.length)},qt=function(e){eQ(e.L,e.b,e.n),e.n=0,e.b=tR},$t=function(e,n){e.n+=n},j=function(e,n,N,C){return 0>=ty(e,N)?C:n(e,N)},Le=function(e,n){let N=n.string;return n.string=null,N},Ye=function(e,n,N,C,et){return eV(e,Le,{string:n},C,et)},Je=function(e,n,N,C){return Ye(e,n,0,C,null)},ot=function(e,n){return Je(e,n,n.length,n)},$e=function(e,n,N){if(eI(e,n)){e1(e,N);let n=e4(e,-2);return n===ed?e$(e,2):e7(e,-2),n}return ed},qe=function(e,n,N){return n=ek(e,n),$e(e,n,N)!==ed&&(e2(e,n),eL(e,1,1),!0)},tU=tx("%I"),tC=tx("%f"),ht=function(e,n,N){var C=N>>>0,et=n.length,ei=e.length+1-et;e:for(;C<ei;C++){for(let N=0;N<et;N++)if(e[C+N]!==n[N])continue e;return C}return -1},k=function(e,n,N){return eS(e,n,N)===eb||(e$(e,1),n=ek(e,n),ej(e),e2(e,-1),ta(e,n,N),!1)},se=function(e,n,N){for(let C in re(e,N,tx("too many upvalues",!0)),n){for(let n=0;n<N;n++)e2(e,-N);eq(e,n[C],N),ta(e,-(N+2),tx(C))}e$(e,N)},re=function(e,n,N){ex(e,n)||(N?G(e,tx("stack overflow (%s)"),N):G(e,tx("stack overflow",!0)))},Ee=function(e,n,N,C){let et=C.message,ei=tm(e,N).subarray(1);return eZ(e,tx("cannot %s %s: %s"),tx(n),ei,tx(et)),e7(e,N),tT},tM=[239,187,191],ft=function(e){let n=function(e){let n;e.n=0;let N=0;do{if(null===(n=C(e))||n!==tM[N])return n;N++,e.buff[e.n++]=n}while(N<tM.length);return e.n=0,C(e)}(e);if(35===n){do n=C(e);while(n&&10!==n);return{skipped:!0,c:C(e)}}return{skipped:!1,c:n}};{let P=class P{constructor(){this.n=NaN,this.f=null,this.buff=new Uint8Array(1024),this.pos=0,this.err=void 0}};let ne=function(e,n){if(null!==n.f&&n.n>0){let e=n.n;return n.n=0,n.f=n.f.subarray(n.pos),n.buff.subarray(0,e)}let N=n.f;return n.f=null,N};C=function(e){return e.pos<e.f.length?e.f[e.pos++]:null},et=function(e,n,N){let C=new P,et=eU(e)+1;if(null===n)throw Error("Can't read stdin in the browser");{eZ(e,tx("@%s"),n);let N=tw(n),ei=new XMLHttpRequest;if(ei.open("GET",N,!1),typeof window>"u"&&(ei.responseType="arraybuffer"),ei.send(),!(ei.status>=200&&ei.status<=299))return C.err=ei.status,Ee(e,"open",et,{message:`${ei.status}: ${ei.statusText}`});"string"==typeof ei.response?C.f=tx(ei.response):C.f=new Uint8Array(ei.response)}let ei=ft(C);ei.c===ef[0]&&n||ei.skipped&&(C.buff[C.n++]=10),null!==ei.c&&(C.buff[C.n++]=ei.c);let eo=eV(e,ne,C,tm(e,-1),N),eu=C.err;return eu?(tl(e,et),Ee(e,"read",et,eu)):(e7(e,et),eo)}}let Lt=function(e,n){return et(e,n,null)},Ut=function(e,n,N){let C=tk(e);72!=N&&G(e,tx("core and library have incompatible numeric types")),C!=tk(null)?G(e,tx("multiple Lua VMs detected")):C!==n&&G(e,tx("version mismatch: app. needs %f, Lua core provides %f"),n,C)};e.exports.LUA_ERRFILE=tT,e.exports.LUA_FILEHANDLE=tS,e.exports.LUA_LOADED_TABLE=tO,e.exports.LUA_NOREF=-2,e.exports.LUA_PRELOAD_TABLE=tE,e.exports.LUA_REFNIL=-1,e.exports.luaL_Buffer=U,e.exports.luaL_addchar=function(e,n){Ct(e,1),e.b[e.n++]=n},e.exports.luaL_addlstring=Zt,e.exports.luaL_addsize=$t,e.exports.luaL_addstring=Dt,e.exports.luaL_addvalue=function(e){let n=e.L,N=tm(n,-1);Zt(e,N,N.length),e$(n,1)},e.exports.luaL_argcheck=function(e,n,N,C){n||J(e,N,C)},e.exports.luaL_argerror=J,e.exports.luaL_buffinit=Mt,e.exports.luaL_buffinitsize=function(e,n,N){return Mt(e,n),Ct(n,N)},e.exports.luaL_callmeta=qe,e.exports.luaL_checkany=function(e,n){ty(e,n)===e_&&J(e,n,tx("value expected",!0))},e.exports.luaL_checkinteger=wt,e.exports.luaL_checklstring=at,e.exports.luaL_checknumber=Et,e.exports.luaL_checkoption=function(e,n,N,C){let et=null!==N?Bt(e,n,N):at(e,n);for(let e=0;C[e];e++)if(tL(C[e],et))return e;return J(e,n,eZ(e,tx("invalid option '%s'"),et))},e.exports.luaL_checkstack=re,e.exports.luaL_checkstring=at,e.exports.luaL_checktype=function(e,n,N){ty(e,n)!==N&&tt(e,n,N)},e.exports.luaL_checkudata=function(e,n,N){let C=Me(e,n,N);return null===C&&Z(e,n,N),C},e.exports.luaL_checkversion=function(e){Ut(e,ey,72)},e.exports.luaL_checkversion_=Ut,e.exports.luaL_dofile=function(e,n){return Lt(e,n)||eH(e,0,eu,0)},e.exports.luaL_dostring=function(e,n){return ot(e,n)||eH(e,0,eu,0)},e.exports.luaL_error=G,e.exports.luaL_execresult=function(e,n){let N,C;if(null===n)return eX(e,1),eJ(e,"exit"),eY(e,0),3;if(n.status)N="exit",C=n.status;else{if(!n.signal)return Te(e,0,null,n);N="signal",C=n.signal}return e0(e),eJ(e,N),eY(e,C),3},e.exports.luaL_fileresult=Te,e.exports.luaL_getmetafield=$e,e.exports.luaL_getmetatable=fe,e.exports.luaL_getsubtable=k,e.exports.luaL_gsub=function(e,n,N,C){let et,ei=new U;for(Mt(e,ei);(et=ht(n,N))>=0;)Zt(ei,n,et),Dt(ei,C),n=n.subarray(et+N.length);return Dt(ei,n),qt(ei),tm(e,-1)},e.exports.luaL_len=function(e,n){eF(e,n);let N=tf(e,-1);return!1===N&&G(e,tx("object length is not an integer",!0)),e$(e,1),N},e.exports.luaL_loadbuffer=Je,e.exports.luaL_loadbufferx=Ye,e.exports.luaL_loadfile=Lt,e.exports.luaL_loadfilex=et,e.exports.luaL_loadstring=ot,e.exports.luaL_newlib=function(e,n){eO(e),se(e,n,0)},e.exports.luaL_newlibtable=function(e){eO(e)},e.exports.luaL_newmetatable=function(e,n){return fe(e,n)!==ed?0:(e$(e,1),eO(e,0,2),e1(e,n),ta(e,-2,tN),e2(e,-1),ta(e,ec,n),1)},e.exports.luaL_newstate=function(){let e=eG();return e&&eA(e,kt),e},e.exports.luaL_opt=j,e.exports.luaL_optinteger=function(e,n,N){return j(e,wt,n,N)},e.exports.luaL_optlstring=Bt,e.exports.luaL_optnumber=function(e,n,N){return j(e,Et,n,N)},e.exports.luaL_optstring=Bt,e.exports.luaL_prepbuffer=function(e){return Ct(e,ei)},e.exports.luaL_prepbuffsize=Ct,e.exports.luaL_pushresult=qt,e.exports.luaL_pushresultsize=function(e,n){$t(e,n),qt(e)},e.exports.luaL_ref=function(e,n){let N;return eP(e,-1)?(e$(e,1),-1):(n=ek(e,n),e8(e,n,0),N=tc(e,-1),e$(e,1),0!==N?(e8(e,n,N),e9(e,n,0)):N=e6(e,n)+1,e9(e,n,N),N)},e.exports.luaL_requiref=function(e,n,N,C){k(e,ec,tO),eS(e,-1,n),tu(e,-1)||(e$(e,1),eW(e,N),e1(e,n),eL(e,1,1),e2(e,-1),ta(e,-3,n)),e7(e,-2),C&&(e2(e,-1),ti(e,n))},e.exports.luaL_setfuncs=se,e.exports.luaL_setmetatable=function(e,n){fe(e,n),to(e,-2)},e.exports.luaL_testudata=Me,e.exports.luaL_tolstring=function(e,n){if(qe(e,n,tI))eB(e,-1)||G(e,tx("'__tostring' must return a string"));else switch(ty(e,n)){case eg:eM(e,n)?eZ(e,tU,tc(e,n)):eZ(e,tC,td(e,n));break;case em:e2(e,n);break;case eh:eJ(e,tu(e,n)?"true":"false");break;case ed:eJ(e,"nil");break;default:{let N=$e(e,n,tN),C=N===em?tm(e,-1):ct(e,n);eZ(e,tx("%s: %p"),C,tg(e,n)),N!==ed&&e7(e,-2)}}return tp(e,-1)},e.exports.luaL_traceback=function(e,n,N,C){let et=new ev,ei=eU(e),eo=function(e){let n=new ev,N=1,C=1;for(;eR(e,C,n);)N=C,C*=2;for(;N<C;){let et=Math.floor((N+C)/2);eR(e,et,n)?N=et+1:C=et}return C-1}(n),eu=eo-C>21?10:-1;for(N&&eZ(e,tx(`%s
`),N),re(e,10,null),eJ(e,"stack traceback:");eR(n,C++,et);)0==eu--?(eJ(e,`
	...`),C=eo-11+1):(eN(n,tx("Slnt",!0),et),eZ(e,tx(`
	%s:`),et.short_src),et.currentline>0&&eJ(e,`${et.currentline}:`),eJ(e," in "),Qe(e,et),et.istailcall&&eJ(e,`
	(...tail calls..)`),ew(e,eU(e)-ei));ew(e,eU(e)-ei)},e.exports.luaL_typename=ct,e.exports.luaL_unref=function(e,n,N){N>=0&&(n=ek(e,n),e8(e,n,0),e9(e,n,N),eY(e,N),e9(e,n,0))},e.exports.luaL_where=ke,e.exports.lua_writestringerror=function(){for(let e=0;e<arguments.length;e++){let n=arguments[e];do{let e=/([^\n]*)\n?([\d\D]*)/.exec(n);console.error(e[1]),n=e[2]}while(""!==n)}}},function(e,n,N){let{LUA_HOOKCALL:C,LUA_HOOKRET:et,LUA_HOOKTAILCALL:ei,LUA_MASKCALL:eo,LUA_MASKLINE:eu,LUA_MASKRET:ec,LUA_MINSTACK:ef,LUA_MULTRET:eh,LUA_SIGNATURE:ep,constant_types:{LUA_TCCL:ed,LUA_TLCF:e_,LUA_TLCL:eg,LUA_TNIL:em},thread_status:{LUA_ERRMEM:eb,LUA_ERRERR:ey,LUA_ERRRUN:ev,LUA_ERRSYNTAX:ek,LUA_OK:eA,LUA_YIELD:eL},lua_Debug:ex,luastring_indexOf:ew,to_luastring:eT}=N(1),eO=N(18),eE=N(11),eS=N(13),{api_check:eN,lua_assert:eI,LUAI_MAXCCALLS:eR}=N(4),eU=N(6),eC=N(16),eM=N(23),eP=N(12),{luaS_newliteral:eD}=N(10),eB=N(14),{LUAI_MAXSTACK:eK}=N(3),eF=N(36),eV=N(15),{MBuffer:eG}=N(19),Ue=function(e,n){if(e.top<n)for(;e.top<n;)e.stack[e.top++]=new eU.TValue(em,null);else for(;e.top>n;)delete e.stack[--e.top]},Xe=function(e,n,N){let C=e.top;for(;e.top<N+1;)e.stack[e.top++]=new eU.TValue(em,null);switch(n){case eb:eU.setsvalue2s(e,N,eD(e,"not enough memory"));break;case ey:eU.setsvalue2s(e,N,eD(e,"error in error handling"));break;default:eU.setobjs2s(e,N,C-1)}for(;e.top>N+1;)delete e.stack[--e.top]},ej=eK+200,Ze=function(e,n){eI(n<=eK||n==ej),eI(e.stack_last==e.stack.length-eP.EXTRA_STACK),e.stack.length=n,e.stack_last=n-eP.EXTRA_STACK},ae=function(e,n){let N=e.stack.length;if(N>eK)q(e,ey);else{let C=e.top+n+eP.EXTRA_STACK,et=2*N;et>eK&&(et=eK),et<C&&(et=C),et>eK?(Ze(e,ej),eE.luaG_runerror(e,eT("stack overflow",!0))):Ze(e,et)}},le=function(e,n){e.stack_last-e.top<=n&&ae(e,n)},Pe=function(e){let n=function(e){let n=e.top;for(let N=e.ci;null!==N;N=N.previous)n<N.top&&(n=N.top);return eI(n<=e.stack_last),n+1}(e),N=n+Math.floor(n/8)+2*eP.EXTRA_STACK;N>eK&&(N=eK),e.stack.length>eK&&eP.luaE_freeCI(e),n<=eK-eP.EXTRA_STACK&&N<e.stack.length&&Ze(e,N)},xe=function(e,n,N){let et=e.stack[n];switch(et.type){case ed:case e_:{let ei=et.type===ed?et.value.f:et.value;le(e,ef);let eu=eP.luaE_extendCI(e);eu.funcOff=n,eu.nresults=N,eu.func=et,eu.top=e.top+ef,eI(eu.top<=e.stack_last),eu.callstatus=0,e.hookmask&eo&&ge(e,C,-1);let ec=ei(e);if("number"!=typeof ec||ec<0||(0|ec)!==ec)throw Error("invalid return value from JS function (expected integer)");return eO.api_checknelems(e,ec),ze(e,eu,e.top-ec,ec),!0}case eg:{let C,ei=et.value.p,eu=e.top-n-1,ec=ei.maxstacksize;if(le(e,ec),ei.is_vararg)C=A(e,ei,eu);else{for(;eu<ei.numparams;eu++)e.stack[e.top++]=new eU.TValue(em,null);C=n+1}let ef=eP.luaE_extendCI(e);return ef.funcOff=n,ef.nresults=N,ef.func=et,ef.l_base=C,ef.top=C+ec,Ue(e,ef.top),ef.l_code=ei.code,ef.l_savedpc=0,ef.callstatus=eP.CIST_LUA,e.hookmask&eo&&te(e,ef),!1}default:return le(e,1),S(e,n,et),xe(e,n,N)}},ze=function(e,n,N,C){let ei=n.nresults;e.hookmask&(ec|eu)&&(e.hookmask&ec&&ge(e,et,-1),e.oldpc=n.previous.l_savedpc);let eo=n.funcOff;return e.ci=n.previous,e.ci.next=null,g(e,N,eo,C,ei)},g=function(e,n,N,C,et){switch(et){case 0:break;case 1:0===C?e.stack[N].setnilvalue():eU.setobjs2s(e,N,n);break;case eh:for(let et=0;et<C;et++)eU.setobjs2s(e,N+et,n+et);for(let n=e.top;n>=N+C;n--)delete e.stack[n];return e.top=N+C,!1;default:{let ei;if(et<=C)for(ei=0;ei<et;ei++)eU.setobjs2s(e,N+ei,n+ei);else{for(ei=0;ei<C;ei++)eU.setobjs2s(e,N+ei,n+ei);for(;ei<et;ei++)N+ei>=e.top?e.stack[N+ei]=new eU.TValue(em,null):e.stack[N+ei].setnilvalue()}}}let ei=N+et;for(let n=e.top;n>=ei;n--)delete e.stack[n];return e.top=ei,!0},ge=function(e,n,N){let C=e.hook;if(C&&e.allowhook){let et=e.ci,ei=e.top,eo=et.top,eu=new ex;eu.event=n,eu.currentline=N,eu.i_ci=et,le(e,ef),et.top=e.top+ef,eI(et.top<=e.stack_last),e.allowhook=0,et.callstatus|=eP.CIST_HOOKED,C(e,eu),eI(!e.allowhook),e.allowhook=1,et.top=eo,Ue(e,ei),et.callstatus&=~eP.CIST_HOOKED}},te=function(e,n){let N=C;n.l_savedpc++,n.previous.callstatus&eP.CIST_LUA&&n.previous.l_code[n.previous.l_savedpc-1].opcode==eC.OpCodesI.OP_TAILCALL&&(n.callstatus|=eP.CIST_TAIL,N=ei),ge(e,N,-1),n.l_savedpc--},A=function(e,n,N){let C,et=n.numparams,ei=e.top-N,eo=e.top;for(C=0;C<et&&C<N;C++)eU.pushobj2s(e,e.stack[ei+C]),e.stack[ei+C].setnilvalue();for(;C<et;C++)e.stack[e.top++]=new eU.TValue(em,null);return eo},S=function(e,n,N){let C=eB.luaT_gettmbyobj(e,N,eB.TMS.TM_CALL);C.ttisfunction(C)||eE.luaG_typeerror(e,N,eT("call",!0)),eU.pushobj2s(e,e.stack[e.top-1]);for(let N=e.top-2;N>n;N--)eU.setobjs2s(e,N,N-1);eU.setobj2s(e,n,C)},v=function(e,n,N){++e.nCcalls>=eR&&(e.nCcalls===eR?eE.luaG_runerror(e,eT("JS stack overflow",!0)):e.nCcalls>=eR+(eR>>3)&&q(e,ey)),xe(e,n,N)||eV.luaV_execute(e),e.nCcalls--},q=function(e,n){if(e.errorJmp)throw e.errorJmp.status=n,e.errorJmp;{let N=e.l_G;if(e.status=n,!N.mainthread.errorJmp){let C=N.panic;throw C&&(Xe(e,n,e.top),e.ci.top<e.top&&(e.ci.top=e.top),C(e)),Error(`Aborted ${n}`)}N.mainthread.stack[N.mainthread.top++]=e.stack[e.top-1],q(N.mainthread,n)}},oe=function(e,n,N){let C=e.nCcalls,et={status:eA,previous:e.errorJmp};e.errorJmp=et;try{n(e,N)}catch(n){if(et.status===eA){let N=e.l_G.atnativeerror;if(N)try{if(et.status=eA,eO.lua_pushcfunction(e,N),eO.lua_pushlightuserdata(e,n),xt(e,e.top-2,1),0!==e.errfunc){let n=e.errfunc;eU.pushobj2s(e,e.stack[e.top-1]),eU.setobjs2s(e,e.top-2,n),xt(e,e.top-2,1)}et.status=ev}catch{et.status===eA&&(et.status=-1)}else et.status=-1}}return e.errorJmp=et.previous,e.nCcalls=C,et.status},O=function(e,n){let N=e.ci;eI(null!==N.c_k&&0===e.nny),eI(N.callstatus&eP.CIST_YPCALL||n===eL),N.callstatus&eP.CIST_YPCALL&&(N.callstatus&=~eP.CIST_YPCALL,e.errfunc=N.c_old_errfunc),N.nresults===eh&&e.ci.top<e.top&&(e.ci.top=e.top);let C=(0,N.c_k)(e,n,N.c_ctx);eO.api_checknelems(e,C),ze(e,N,e.top-C,C)},ee=function(e,n){for(null!==n&&O(e,n);e.ci!==e.base_ci;)e.ci.callstatus&eP.CIST_LUA?(eV.luaV_finishOp(e),eV.luaV_execute(e)):O(e,eL)},ce=function(e,n){let N=function(e){for(let n=e.ci;null!==n;n=n.previous)if(n.callstatus&eP.CIST_YPCALL)return n;return null}(e);if(null===N)return 0;let C=N.extra;return eS.luaF_close(e,C),Xe(e,n,C),e.ci=N,e.allowhook=N.callstatus&eP.CIST_OAH,e.nny=0,Pe(e),e.errfunc=N.c_old_errfunc,1},Ne=function(e,n,N){let C=eD(e,n);if(0===N)eU.pushsvalue2s(e,C),eN(e,e.top<=e.ci.top,"stack overflow");else{for(let n=1;n<N;n++)delete e.stack[--e.top];eU.setsvalue2s(e,e.top-1,C)}return ev},Ve=function(e,n){let N=e.top-n,C=e.ci;e.status===eA?xe(e,N-1,eh)||eV.luaV_execute(e):(eI(e.status===eL),e.status=eA,C.funcOff=C.extra,C.func=e.stack[C.funcOff],C.callstatus&eP.CIST_LUA?eV.luaV_execute(e):(null!==C.c_k&&(n=C.c_k(e,eL,C.c_ctx),eO.api_checknelems(e,n),N=e.top-n),ze(e,C,N,n)),ee(e,null))},nt=function(e,n,N,C){let et=e.ci;return eO.api_checknelems(e,n),e.nny>0&&(e!==e.l_G.mainthread?eE.luaG_runerror(e,eT("attempt to yield across a JS-call boundary",!0)):eE.luaG_runerror(e,eT("attempt to yield from outside a coroutine",!0))),e.status=eL,et.extra=et.funcOff,et.callstatus&eP.CIST_LUA?eN(e,null===C,"hooks cannot continue after yielding"):(et.c_k=C,null!==C&&(et.c_ctx=N),et.funcOff=e.top-n-1,et.func=e.stack[et.funcOff],q(e,eL)),eI(et.callstatus&eP.CIST_HOOKED),0},dt=function(e,n,N,C,et){let ei=e.ci,eo=e.allowhook,eu=e.nny,ec=e.errfunc;e.errfunc=et;let ef=oe(e,n,N);return ef!==eA&&(eS.luaF_close(e,C),Xe(e,ef,C),e.ci=ei,e.allowhook=eo,e.nny=eu,Pe(e)),e.errfunc=ec,ef},xt=function(e,n,N){e.nny++,v(e,n,N),e.nny--},Ot=function(e,n,N){n&&-1===ew(n,N[0])&&(eU.luaO_pushfstring(e,eT("attempt to load a %s chunk (mode is '%s')"),N,n),q(e,ek))},St=function(e,n){let N,C=n.z.zgetc();C===ep[0]?(Ot(e,n.mode,eT("binary",!0)),N=eF.luaU_undump(e,n.z,n.name)):(Ot(e,n.mode,eT("text",!0)),N=eM.luaY_parser(e,n.z,n.buff,n.dyd,n.name,C)),eI(N.nupvalues===N.p.upvalues.length),eS.luaF_initupvals(e,N)};e.exports.adjust_top=Ue,e.exports.luaD_call=v,e.exports.luaD_callnoyield=xt,e.exports.luaD_checkstack=le,e.exports.luaD_growstack=ae,e.exports.luaD_hook=ge,e.exports.luaD_inctop=function(e){le(e,1),e.stack[e.top++]=new eU.TValue(em,null)},e.exports.luaD_pcall=dt,e.exports.luaD_poscall=ze,e.exports.luaD_precall=xe,e.exports.luaD_protectedparser=function(e,n,N,C){let et=new class{constructor(e,n,N){this.z=e,this.buff=new eG,this.dyd=new eM.Dyndata,this.mode=N,this.name=n}}(n,N,C);e.nny++;let ei=dt(e,St,et,e.top,e.errfunc);return e.nny--,ei},e.exports.luaD_rawrunprotected=oe,e.exports.luaD_reallocstack=Ze,e.exports.luaD_throw=q,e.exports.lua_isyieldable=function(e){return 0===e.nny},e.exports.lua_resume=function(e,n,N){let C=e.nny;if(e.status===eA){if(e.ci!==e.base_ci)return Ne(e,"cannot resume non-suspended coroutine",N)}else if(e.status!==eL)return Ne(e,"cannot resume dead coroutine",N);if(e.nCcalls=n?n.nCcalls+1:1,e.nCcalls>=eR)return Ne(e,"JS stack overflow",N);e.nny=0,eO.api_checknelems(e,e.status===eA?N+1:N);let et=oe(e,Ve,N);if(-1===et)et=ev;else{for(;et>eL&&ce(e,et);)et=oe(e,ee,et);et>eL?(e.status=et,Xe(e,et,e.top),e.ci.top=e.top):eI(et===e.status)}return e.nny=C,e.nCcalls--,eI(e.nCcalls===(n?n.nCcalls:0)),et},e.exports.lua_yield=function(e,n){nt(e,n,0,null)},e.exports.lua_yieldk=nt},function(e,n,N){let{constant_types:{LUA_TBOOLEAN:C,LUA_TCCL:et,LUA_TLCF:ei,LUA_TLCL:eo,LUA_TLIGHTUSERDATA:eu,LUA_TLNGSTR:ec,LUA_TNIL:ef,LUA_TNUMFLT:eh,LUA_TNUMINT:ep,LUA_TSHRSTR:ed,LUA_TTABLE:e_,LUA_TTHREAD:eg,LUA_TUSERDATA:em},to_luastring:eb}=N(1),{lua_assert:ey}=N(4),ev=N(11),ek=N(6),{luaS_hashlongstr:eA,TString:eL}=N(10),ex=N(12),ew=new WeakMap,X=function(e){let n=ew.get(e);return n||(n={},ew.set(e,n)),n},V=function(e,n){switch(n.type){case ef:return ev.luaG_runerror(e,eb("table index is nil",!0));case eh:if(isNaN(n.value))return ev.luaG_runerror(e,eb("table index is NaN",!0));case ep:case C:case e_:case eo:case ei:case et:case em:case eg:return n.value;case ed:case ec:return eA(n.tsvalue());case eu:{let N=n.value;switch(typeof N){case"string":return"*"+N;case"number":return"#"+N;case"boolean":return N?"?true":"?false";case"function":return X(N);case"object":if(N instanceof ex.lua_State&&N.l_G===e.l_G||N instanceof Q||N instanceof ek.Udata||N instanceof ek.LClosure||N instanceof ek.CClosure)return X(N);default:return N}}default:throw Error("unknown key type: "+n.type)}};let Q=class Q{constructor(e){this.id=e.l_G.id_counter++,this.strong=new Map,this.dead_strong=new Map,this.dead_weak=void 0,this.f=void 0,this.l=void 0,this.metatable=null,this.flags=-1}};let he=function(e,n,N,C){e.dead_strong.clear(),e.dead_weak=void 0;let et=null,ei={key:N,value:C,p:et=e.l,n:void 0};e.f||(e.f=ei),et&&(et.n=ei),e.strong.set(n,ei),e.l=ei},F=function(e,n){let N=e.strong.get(n);if(N){N.key.setdeadvalue(),N.value=void 0;let C=N.n,et=N.p;N.p=void 0,et&&(et.n=C),C&&(C.p=et),e.f===N&&(e.f=C),e.l===N&&(e.l=et),e.strong.delete(n),("object"==typeof n?null!==n:"function"==typeof n)?(e.dead_weak||(e.dead_weak=new WeakMap),e.dead_weak.set(n,N)):e.dead_strong.set(n,N)}},ie=function(e,n){let N=e.strong.get(n);return N?N.value:ek.luaO_nilobject},y=function(e,n){return ey("number"==typeof n&&(0|n)===n),ie(e,n)};e.exports.invalidateTMcache=function(e){e.flags=0},e.exports.luaH_get=function(e,n,N){return ey(N instanceof ek.TValue),N.ttisnil()||N.ttisfloat()&&isNaN(N.value)?ek.luaO_nilobject:ie(n,V(e,N))},e.exports.luaH_getint=y,e.exports.luaH_getn=function(e){let n=0,N=e.strong.size+1;for(;N-n>1;){let C=Math.floor((n+N)/2);y(e,C).ttisnil()?N=C:n=C}return n},e.exports.luaH_getstr=function(e,n){return ey(n instanceof eL),ie(e,eA(n))},e.exports.luaH_setfrom=function(e,n,N,C){ey(N instanceof ek.TValue);let et=V(e,N);if(C.ttisnil())return void F(n,et);let ei=n.strong.get(et);if(ei)ei.value.setfrom(C);else{let e=N.value;he(n,et,N.ttisfloat()&&(0|e)===e?new ek.TValue(ep,e):new ek.TValue(N.type,e),new ek.TValue(C.type,C.value))}},e.exports.luaH_setint=function(e,n,N){if(ey("number"==typeof n&&(0|n)===n&&N instanceof ek.TValue),N.ttisnil())return void F(e,n);let C=e.strong.get(n);if(C)C.value.setfrom(N);else{let C=new ek.TValue(ep,n);he(e,n,C,new ek.TValue(N.type,N.value))}},e.exports.luaH_new=function(e){return new Q(e)},e.exports.luaH_next=function(e,n,N){let C,et=e.stack[N];if(et.type===ef){if(!(C=n.f))return!1}else{let N=V(e,et);if(C=n.strong.get(N)){if(!(C=C.n))return!1}else{if(!(C=n.dead_weak&&n.dead_weak.get(N)||n.dead_strong.get(N)))return ev.luaG_runerror(e,eb("invalid key to 'next'"));do if(!(C=C.n))return!1;while(C.key.ttisdeadkey())}}return ek.setobj2s(e,N,C.key),ek.setobj2s(e,N+1,C.value),!0},e.exports.Table=Q},function(e,n,N){let{is_luastring:C,luastring_eq:et,luastring_from:ei,to_luastring:eo}=N(1),{lua_assert:eu}=N(4);let u=class u{constructor(e,n){this.hash=null,this.realstring=n}getstr(){return this.realstring}tsslen(){return this.realstring.length}};let h=function(e){eu(C(e));let n=e.length,N="|";for(let C=0;C<n;C++)N+=e[C].toString(16);return N},w=function(e,n){return eu(n instanceof Uint8Array),new u(e,n)};e.exports.luaS_eqlngstr=function(e,n){return eu(e instanceof u),eu(n instanceof u),e==n||et(e.realstring,n.realstring)},e.exports.luaS_hash=h,e.exports.luaS_hashlongstr=function(e){return eu(e instanceof u),null===e.hash&&(e.hash=h(e.getstr())),e.hash},e.exports.luaS_bless=w,e.exports.luaS_new=function(e,n){return w(e,ei(n))},e.exports.luaS_newliteral=function(e,n){return w(e,eo(n))},e.exports.TString=u},function(e,n,N){let{LUA_HOOKCOUNT:C,LUA_HOOKLINE:et,LUA_MASKCOUNT:ei,LUA_MASKLINE:eo,constant_types:{LUA_TBOOLEAN:eu,LUA_TNIL:ec,LUA_TTABLE:ef},thread_status:{LUA_ERRRUN:eh,LUA_YIELD:ep},from_userstring:ed,luastring_eq:e_,luastring_indexOf:eg,to_luastring:em}=N(1),{api_check:eb,lua_assert:ey}=N(4),{LUA_IDSIZE:ev}=N(3),ek=N(18),eA=N(8),eL=N(13),ex=N(20),ew=N(6),eT=N(16),eO=N(12),eE=N(9),eS=N(14),eN=N(15),ie=function(e){return ey(e.callstatus&eO.CIST_LUA),e.l_savedpc-1},y=function(e){return 0!==e.func.value.p.lineinfo.length?e.func.value.p.lineinfo[ie(e)]:-1},Y=function(e){if(e.status===ep){let n=e.ci,N=n.funcOff;n.func=e.stack[n.extra],n.funcOff=n.extra,n.extra=N}},de=function(e,n){ey(n<e.upvalues.length);let N=e.upvalues[n].name;return null===N?em("?",!0):N.getstr()},_e=function(e,n,N){let C,et=null;if(n.callstatus&eO.CIST_LUA){if(N<0){var ei;let e;return ei=-N,e=n.func.value.p.numparams,ei>=n.l_base-n.funcOff-e?null:{pos:n.funcOff+e+ei,name:em("(*vararg)",!0)}}C=n.l_base,et=eL.luaF_getlocalname(n.func.value.p,N,ie(n))}else C=n.funcOff+1;if(null===et){if(!((n===e.ci?e.top:n.next.funcOff)-C>=N&&N>0))return null;et=em("(*temporary)",!0)}return{pos:C+(N-1),name:et}},me=function(e,n){if(null===n||n instanceof ew.CClosure)e.source=em("=[JS]",!0),e.linedefined=-1,e.lastlinedefined=-1,e.what=em("J",!0);else{let N=n.p;e.source=N.source?N.source.getstr():em("=?",!0),e.linedefined=N.linedefined,e.lastlinedefined=N.lastlinedefined,e.what=0===e.linedefined?em("main",!0):em("Lua",!0)}e.short_src=ew.luaO_chunkid(e.source,ev)},ve=function(e,n){let N={name:null,funcname:null};return null===n?null:n.callstatus&eO.CIST_FIN?(N.name=em("__gc",!0),N.funcname=em("metamethod",!0),N):!(n.callstatus&eO.CIST_TAIL)&&n.previous.callstatus&eO.CIST_LUA?ye(e,n.previous):null},K=function(e,n,N){let C={name:null,funcname:null};if(eT.ISK(N)){let n=e.k[eT.INDEXK(N)];if(n.ttisstring())return C.name=n.svalue(),C}else{let C=B(e,n,N);if(C&&99===C.funcname[0])return C}return C.name=em("?",!0),C},I=function(e,n){return e<n?-1:e},B=function(e,n,N){let C={name:eL.luaF_getlocalname(e,N+1,n),funcname:null};if(C.name)return C.funcname=em("local",!0),C;let et=function(e,n,N){let C=-1,et=0,ei=eT.OpCodesI;for(let eo=0;eo<n;eo++){let eu=e.code[eo],ec=eu.A;switch(eu.opcode){case ei.OP_LOADNIL:{let e=eu.B;ec<=N&&N<=ec+e&&(C=I(eo,et));break}case ei.OP_TFORCALL:N>=ec+2&&(C=I(eo,et));break;case ei.OP_CALL:case ei.OP_TAILCALL:N>=ec&&(C=I(eo,et));break;case ei.OP_JMP:{let e=eo+1+eu.sBx;eo<e&&e<=n&&e>et&&(et=e);break}default:eT.testAMode(eu.opcode)&&N===ec&&(C=I(eo,et))}}return C}(e,n,N),ei=eT.OpCodesI;if(-1!==et){let n=e.code[et];switch(n.opcode){case ei.OP_MOVE:{let N=n.B;if(N<n.A)return B(e,et,N);break}case ei.OP_GETTABUP:case ei.OP_GETTABLE:{let N=n.C,eo=n.B,eu=n.opcode===ei.OP_GETTABLE?eL.luaF_getlocalname(e,eo+1,et):de(e,eo);return C.name=K(e,et,N).name,C.funcname=eu&&e_(eu,ex.LUA_ENV)?em("global",!0):em("field",!0),C}case ei.OP_GETUPVAL:return C.name=de(e,n.B),C.funcname=em("upvalue",!0),C;case ei.OP_LOADK:case ei.OP_LOADKX:{let N=n.opcode===ei.OP_LOADK?n.Bx:e.code[et+1].Ax;if(e.k[N].ttisstring())return C.name=e.k[N].svalue(),C.funcname=em("constant",!0),C;break}case ei.OP_SELF:{let N=n.C;return C.name=K(e,et,N).name,C.funcname=em("method",!0),C}}}return null},ye=function(e,n){let N={name:null,funcname:null},C=0,et=n.func.value.p,ei=ie(n),eo=et.code[ei],eu=eT.OpCodesI;if(n.callstatus&eO.CIST_HOOKED)return N.name=em("?",!0),N.funcname=em("hook",!0),N;switch(eo.opcode){case eu.OP_CALL:case eu.OP_TAILCALL:return B(et,ei,eo.A);case eu.OP_TFORCALL:return N.name=em("for iterator",!0),N.funcname=em("for iterator",!0),N;case eu.OP_SELF:case eu.OP_GETTABUP:case eu.OP_GETTABLE:C=eS.TMS.TM_INDEX;break;case eu.OP_SETTABUP:case eu.OP_SETTABLE:C=eS.TMS.TM_NEWINDEX;break;case eu.OP_ADD:C=eS.TMS.TM_ADD;break;case eu.OP_SUB:C=eS.TMS.TM_SUB;break;case eu.OP_MUL:C=eS.TMS.TM_MUL;break;case eu.OP_MOD:C=eS.TMS.TM_MOD;break;case eu.OP_POW:C=eS.TMS.TM_POW;break;case eu.OP_DIV:C=eS.TMS.TM_DIV;break;case eu.OP_IDIV:C=eS.TMS.TM_IDIV;break;case eu.OP_BAND:C=eS.TMS.TM_BAND;break;case eu.OP_BOR:C=eS.TMS.TM_BOR;break;case eu.OP_BXOR:C=eS.TMS.TM_BXOR;break;case eu.OP_SHL:C=eS.TMS.TM_SHL;break;case eu.OP_SHR:C=eS.TMS.TM_SHR;break;case eu.OP_UNM:C=eS.TMS.TM_UNM;break;case eu.OP_BNOT:C=eS.TMS.TM_BNOT;break;case eu.OP_LEN:C=eS.TMS.TM_LEN;break;case eu.OP_CONCAT:C=eS.TMS.TM_CONCAT;break;case eu.OP_EQ:C=eS.TMS.TM_EQ;break;case eu.OP_LT:C=eS.TMS.TM_LT;break;case eu.OP_LE:C=eS.TMS.TM_LE;break;default:return null}return N.name=e.l_G.tmname[C].getstr(),N.funcname=em("metamethod",!0),N},be=function(e,n){let N=e.ci,C=null;if(N.callstatus&eO.CIST_LUA){C=function(e,n,N){let C=n.func.value;for(let e=0;e<C.nupvalues;e++)if(C.upvals[e]===N)return{name:de(C.p,e),funcname:em("upvalue",!0)};return null}(0,N,n);let et=function(e,n,N){for(let C=n.l_base;C<n.top;C++)if(e.stack[C]===N)return C;return!1}(e,N,n);!C&&et&&(C=B(N.func.value.p,ie(N),et-N.l_base))}return C?ew.luaO_pushfstring(e,em(" (%s '%s')",!0),C.funcname,C.name):em("",!0)},Ue=function(e,n,N){let C=eS.luaT_objtypename(e,n);st(e,em("attempt to %s a %s value%s",!0),N,C,be(e,n))},Xe=function(e,n,N,C){let et;return et=N?ew.luaO_chunkid(N.getstr(),ev):em("?",!0),ew.luaO_pushfstring(e,em("%s:%d: %s",!0),et,C,n)},st=function(e,n,...N){let C=e.ci,et=ew.luaO_pushvfstring(e,n,N);C.callstatus&eO.CIST_LUA&&Xe(e,et,C.func.value.p.source,y(C)),Ze(e)},Ze=function(e){if(0!==e.errfunc){let n=e.errfunc;ew.pushobj2s(e,e.stack[e.top-1]),ew.setobjs2s(e,e.top-2,n),eA.luaD_callnoyield(e,e.top-2,1)}eA.luaD_throw(e,eh)};e.exports.luaG_addinfo=Xe,e.exports.luaG_concaterror=function(e,n,N){(n.ttisstring()||eN.cvt2str(n))&&(n=N),Ue(e,n,em("concatenate",!0))},e.exports.luaG_errormsg=Ze,e.exports.luaG_opinterror=function(e,n,N,C){!1===eN.tonumber(n)&&(N=n),Ue(e,N,C)},e.exports.luaG_ordererror=function(e,n,N){let C=eS.luaT_objtypename(e,n),et=eS.luaT_objtypename(e,N);e_(C,et)?st(e,em("attempt to compare two %s values",!0),C):st(e,em("attempt to compare %s with %s",!0),C,et)},e.exports.luaG_runerror=st,e.exports.luaG_tointerror=function(e,n,N){!1===eN.tointeger(n)&&(N=n),st(e,em("number%s has no integer representation",!0),be(e,N))},e.exports.luaG_traceexec=function(e){let n=e.ci,N=e.hookmask,eu=0==--e.hookcount&&N&ei;if(eu)e.hookcount=e.basehookcount;else if(!(N&eo))return;if(n.callstatus&eO.CIST_HOOKYIELD)n.callstatus&=~eO.CIST_HOOKYIELD;else{if(eu&&eA.luaD_hook(e,C,-1),N&eo){let N=n.func.value.p,C=n.l_savedpc-1,ei=0!==N.lineinfo.length?N.lineinfo[C]:-1;(0===C||n.l_savedpc<=e.oldpc||ei!==(0!==N.lineinfo.length?N.lineinfo[e.oldpc-1]:-1))&&eA.luaD_hook(e,et,ei)}e.oldpc=n.l_savedpc,e.status===ep&&(eu&&(e.hookcount=1),n.l_savedpc--,n.callstatus|=eO.CIST_HOOKYIELD,n.funcOff=e.top-1,n.func=e.stack[n.funcOff],eA.luaD_throw(e,ep))}},e.exports.luaG_typeerror=Ue,e.exports.lua_gethook=function(e){return e.hook},e.exports.lua_gethookcount=function(e){return e.basehookcount},e.exports.lua_gethookmask=function(e){return e.hookmask},e.exports.lua_getinfo=function(e,n,N){let C,et,ei,eo;return n=ed(n),Y(e),62===n[0]?(ei=null,eo=e.stack[e.top-1],eb(e,eo.ttisfunction(),"function expected"),n=n.subarray(1),e.top--):(eo=(ei=N.i_ci).func,ey(ei.func.ttisfunction())),C=function(e,n,N,C,et){let ei=1;for(;n.length>0;n=n.subarray(1))switch(n[0]){case 83:me(N,C);break;case 108:N.currentline=et&&et.callstatus&eO.CIST_LUA?y(et):-1;break;case 117:N.nups=null===C?0:C.nupvalues,null===C||C instanceof ew.CClosure?(N.isvararg=!0,N.nparams=0):(N.isvararg=C.p.is_vararg,N.nparams=C.p.numparams);break;case 116:N.istailcall=et?et.callstatus&eO.CIST_TAIL:0;break;case 110:{let n=ve(e,et);null===n?(N.namewhat=em("",!0),N.name=null):(N.namewhat=n.funcname,N.name=n.name);break}case 76:case 102:break;default:ei=0}return ei}(e,n,N,et=eo.ttisclosure()?eo.value:null,ei),eg(n,102)>=0&&(ew.pushobj2s(e,eo),eb(e,e.top<=e.ci.top,"stack overflow")),Y(e),eg(n,76)>=0&&function(e,n){if(null===n||n instanceof ew.CClosure)e.stack[e.top]=new ew.TValue(ec,null),ek.api_incr_top(e);else{let N=n.p.lineinfo,C=eE.luaH_new(e);e.stack[e.top]=new ew.TValue(ef,C),ek.api_incr_top(e);let et=new ew.TValue(eu,!0);for(let e=0;e<N.length;e++)eE.luaH_setint(C,N[e],et)}}(e,et),C},e.exports.lua_getlocal=function(e,n,N){let C;if(Y(e),null===n)C=e.stack[e.top-1].ttisLclosure()?eL.luaF_getlocalname(e.stack[e.top-1].value.p,N,0):null;else{let et=_e(e,n.i_ci,N);et?(C=et.name,ew.pushobj2s(e,e.stack[et.pos]),eb(e,e.top<=e.ci.top,"stack overflow")):C=null}return Y(e),C},e.exports.lua_getstack=function(e,n,N){let C,et;if(n<0)return 0;for(C=e.ci;n>0&&C!==e.base_ci;C=C.previous)n--;return 0===n&&C!==e.base_ci?(et=1,N.i_ci=C):et=0,et},e.exports.lua_sethook=function(e,n,N,C){null!==n&&0!==N||(N=0,n=null),e.ci.callstatus&eO.CIST_LUA&&(e.oldpc=e.ci.l_savedpc),e.hook=n,e.basehookcount=C,e.hookcount=e.basehookcount,e.hookmask=N},e.exports.lua_setlocal=function(e,n,N){let C;Y(e);let et=_e(e,n.i_ci,N);return et?(C=et.name,ew.setobjs2s(e,et.pos,e.top-1),delete e.stack[--e.top]):C=null,Y(e),C}},function(e,n,N){let{LUA_MINSTACK:C,LUA_RIDX_GLOBALS:et,LUA_RIDX_MAINTHREAD:ei,constant_types:{LUA_NUMTAGS:eo,LUA_TNIL:eu,LUA_TTABLE:ec,LUA_TTHREAD:ef},thread_status:{LUA_OK:eh}}=N(1),ep=N(6),ed=N(8),e_=N(18),eg=N(9),em=N(14),eb=2*C;let b=class b{constructor(){this.func=null,this.funcOff=NaN,this.top=NaN,this.previous=null,this.next=null,this.l_base=NaN,this.l_code=null,this.l_savedpc=NaN,this.c_k=null,this.c_old_errfunc=null,this.c_ctx=null,this.nresults=NaN,this.callstatus=NaN}};let R=class R{constructor(e){this.id=e.id_counter++,this.base_ci=new b,this.top=NaN,this.stack_last=NaN,this.oldpc=NaN,this.l_G=e,this.stack=null,this.ci=null,this.errorJmp=null,this.nCcalls=0,this.hook=null,this.hookmask=0,this.basehookcount=0,this.allowhook=1,this.hookcount=this.basehookcount,this.nny=1,this.status=eh,this.errfunc=0}};let M=function(e){e.ci.next=null},H=function(e,n){e.stack=Array(eb),e.top=0,e.stack_last=eb-5;let N=e.base_ci;N.next=N.previous=null,N.callstatus=0,N.funcOff=e.top,N.func=e.stack[e.top],e.stack[e.top++]=new ep.TValue(eu,null),N.top=e.top+C,e.ci=N},z=function(e){e.ci=e.base_ci,M(e),e.stack=null},W=function(e){let n,N=e.l_G;H(e),n=eg.luaH_new(e),N.l_registry.sethvalue(n),eg.luaH_setint(n,ei,new ep.TValue(ef,e)),eg.luaH_setint(n,et,new ep.TValue(ec,eg.luaH_new(e))),em.luaT_init(e),N.version=e_.lua_version(null)};e.exports.lua_State=R,e.exports.CallInfo=b,e.exports.CIST_OAH=1,e.exports.CIST_LUA=2,e.exports.CIST_HOOKED=4,e.exports.CIST_FRESH=8,e.exports.CIST_YPCALL=16,e.exports.CIST_TAIL=32,e.exports.CIST_HOOKYIELD=64,e.exports.CIST_LEQ=128,e.exports.CIST_FIN=256,e.exports.EXTRA_STACK=5,e.exports.lua_close=function(e){z(e=e.l_G.mainthread)},e.exports.lua_newstate=function(){let e=new class{constructor(){this.id_counter=1,this.ids=new WeakMap,this.mainthread=null,this.l_registry=new ep.TValue(eu,null),this.panic=null,this.atnativeerror=null,this.version=null,this.tmname=Array(em.TMS.TM_N),this.mt=Array(eo)}},n=new R(e);return e.mainthread=n,ed.luaD_rawrunprotected(n,W,null)!==eh&&(n=null),n},e.exports.lua_newthread=function(e){let n=e.l_G,N=new R(n);return e.stack[e.top]=new ep.TValue(ef,N),e_.api_incr_top(e),N.hookmask=e.hookmask,N.basehookcount=e.basehookcount,N.hook=e.hook,N.hookcount=N.basehookcount,H(N),N},e.exports.luaE_extendCI=function(e){let n=new b;return e.ci.next=n,n.previous=e.ci,n.next=null,e.ci=n,n},e.exports.luaE_freeCI=M,e.exports.luaE_freethread=function(e,n){z(n)}},function(e,n,N){let{constant_types:{LUA_TNIL:C}}=N(1),et=N(6);e.exports.MAXUPVAL=255,e.exports.Proto=class{constructor(e){this.id=e.l_G.id_counter++,this.k=[],this.p=[],this.code=[],this.cache=null,this.lineinfo=[],this.upvalues=[],this.numparams=0,this.is_vararg=!1,this.maxstacksize=0,this.locvars=[],this.linedefined=0,this.lastlinedefined=0,this.source=null}},e.exports.luaF_findupval=function(e,n){return e.stack[n]},e.exports.luaF_close=function(e,n){for(let N=n;N<e.top;N++){let n=e.stack[N];e.stack[N]=new et.TValue(n.type,n.value)}},e.exports.luaF_getlocalname=function(e,n,N){for(let C=0;C<e.locvars.length&&e.locvars[C].startpc<=N;C++)if(N<e.locvars[C].endpc&&0==--n)return e.locvars[C].varname.getstr();return null},e.exports.luaF_initupvals=function(e,n){for(let e=0;e<n.nupvalues;e++)n.upvals[e]=new et.TValue(C,null)},e.exports.luaF_newLclosure=function(e,n){return new et.LClosure(e,n)}},function(e,n,N){let{constant_types:{LUA_TTABLE:C,LUA_TUSERDATA:et},to_luastring:ei}=N(1),{lua_assert:eo}=N(4),eu=N(6),ec=N(8),ef=N(12),{luaS_bless:eh,luaS_new:ep}=N(10),ed=N(9),e_=N(11),eg=N(15),em=["no value","nil","boolean","userdata","number","string","table","function","userdata","thread","proto"].map(e=>ei(e)),m=function(e){return em[e+1]},eb={TM_INDEX:0,TM_NEWINDEX:1,TM_GC:2,TM_MODE:3,TM_LEN:4,TM_EQ:5,TM_ADD:6,TM_SUB:7,TM_MUL:8,TM_MOD:9,TM_POW:10,TM_DIV:11,TM_IDIV:12,TM_BAND:13,TM_BOR:14,TM_BXOR:15,TM_SHL:16,TM_SHR:17,TM_UNM:18,TM_BNOT:19,TM_LT:20,TM_LE:21,TM_CONCAT:22,TM_CALL:23,TM_N:24},ey=ei("__name",!0),M=function(e,n,N,C,et,ei){let eo=e.top;if(eu.pushobj2s(e,n),eu.pushobj2s(e,N),eu.pushobj2s(e,C),ei||eu.pushobj2s(e,et),e.ci.callstatus&ef.CIST_LUA?ec.luaD_call(e,eo,ei):ec.luaD_callnoyield(e,eo,ei),ei){let n=e.stack[e.top-1];delete e.stack[--e.top],et.setfrom(n)}},H=function(e,n,N,C,et){let ei=W(e,n,et);return ei.ttisnil()&&(ei=W(e,N,et)),!ei.ttisnil()&&(M(e,ei,n,N,C,1),!0)},z=function(e,n,N){let C=ed.luaH_getstr(e,N);return eo(n<=eb.TM_EQ),C.ttisnil()?(e.flags|=1<<n,null):C},W=function(e,n,N){let ei;switch(n.ttnov()){case C:case et:ei=n.value.metatable;break;default:ei=e.l_G.mt[n.ttnov()]}return ei?ed.luaH_getstr(ei,e.l_G.tmname[N]):eu.luaO_nilobject};e.exports.fasttm=function(e,n,N){return null===n||n.flags&1<<N?null:z(n,N,e.l_G.tmname[N])},e.exports.TMS=eb,e.exports.luaT_callTM=M,e.exports.luaT_callbinTM=H,e.exports.luaT_trybinTM=function(e,n,N,C,et){if(!H(e,n,N,C,et))switch(et){case eb.TM_CONCAT:return e_.luaG_concaterror(e,n,N);case eb.TM_BAND:case eb.TM_BOR:case eb.TM_BXOR:case eb.TM_SHL:case eb.TM_SHR:case eb.TM_BNOT:{let C=eg.tonumber(n),et=eg.tonumber(N);return!1!==C&&!1!==et?e_.luaG_tointerror(e,n,N):e_.luaG_opinterror(e,n,N,ei("perform bitwise operation on",!0))}default:return e_.luaG_opinterror(e,n,N,ei("perform arithmetic on",!0))}},e.exports.luaT_callorderTM=function(e,n,N,C){let et=new eu.TValue;return H(e,n,N,et,C)?!et.l_isfalse():null},e.exports.luaT_gettm=z,e.exports.luaT_gettmbyobj=W,e.exports.luaT_init=function(e){e.l_G.tmname[eb.TM_INDEX]=new ep(e,ei("__index",!0)),e.l_G.tmname[eb.TM_NEWINDEX]=new ep(e,ei("__newindex",!0)),e.l_G.tmname[eb.TM_GC]=new ep(e,ei("__gc",!0)),e.l_G.tmname[eb.TM_MODE]=new ep(e,ei("__mode",!0)),e.l_G.tmname[eb.TM_LEN]=new ep(e,ei("__len",!0)),e.l_G.tmname[eb.TM_EQ]=new ep(e,ei("__eq",!0)),e.l_G.tmname[eb.TM_ADD]=new ep(e,ei("__add",!0)),e.l_G.tmname[eb.TM_SUB]=new ep(e,ei("__sub",!0)),e.l_G.tmname[eb.TM_MUL]=new ep(e,ei("__mul",!0)),e.l_G.tmname[eb.TM_MOD]=new ep(e,ei("__mod",!0)),e.l_G.tmname[eb.TM_POW]=new ep(e,ei("__pow",!0)),e.l_G.tmname[eb.TM_DIV]=new ep(e,ei("__div",!0)),e.l_G.tmname[eb.TM_IDIV]=new ep(e,ei("__idiv",!0)),e.l_G.tmname[eb.TM_BAND]=new ep(e,ei("__band",!0)),e.l_G.tmname[eb.TM_BOR]=new ep(e,ei("__bor",!0)),e.l_G.tmname[eb.TM_BXOR]=new ep(e,ei("__bxor",!0)),e.l_G.tmname[eb.TM_SHL]=new ep(e,ei("__shl",!0)),e.l_G.tmname[eb.TM_SHR]=new ep(e,ei("__shr",!0)),e.l_G.tmname[eb.TM_UNM]=new ep(e,ei("__unm",!0)),e.l_G.tmname[eb.TM_BNOT]=new ep(e,ei("__bnot",!0)),e.l_G.tmname[eb.TM_LT]=new ep(e,ei("__lt",!0)),e.l_G.tmname[eb.TM_LE]=new ep(e,ei("__le",!0)),e.l_G.tmname[eb.TM_CONCAT]=new ep(e,ei("__concat",!0)),e.l_G.tmname[eb.TM_CALL]=new ep(e,ei("__call",!0))},e.exports.luaT_objtypename=function(e,n){let N;if(n.ttistable()&&null!==(N=n.value.metatable)||n.ttisfulluserdata()&&null!==(N=n.value.metatable)){let n=ed.luaH_getstr(N,eh(e,ey));if(n.ttisstring())return n.svalue()}return m(n.ttnov())},e.exports.ttypename=m},function(e,n,N){let{LUA_MASKLINE:C,LUA_MASKCOUNT:et,LUA_MULTRET:ei,constant_types:{LUA_TBOOLEAN:eo,LUA_TLCF:eu,LUA_TLIGHTUSERDATA:ec,LUA_TLNGSTR:ef,LUA_TNIL:eh,LUA_TNUMBER:ep,LUA_TNUMFLT:ed,LUA_TNUMINT:e_,LUA_TSHRSTR:eg,LUA_TTABLE:em,LUA_TUSERDATA:eb},to_luastring:ey}=N(1),{INDEXK:ev,ISK:ek,LFIELDS_PER_FLUSH:eA,OpCodesI:{OP_ADD:eL,OP_BAND:ex,OP_BNOT:ew,OP_BOR:eT,OP_BXOR:eO,OP_CALL:eE,OP_CLOSURE:eS,OP_CONCAT:eN,OP_DIV:eI,OP_EQ:eR,OP_EXTRAARG:eU,OP_FORLOOP:eC,OP_FORPREP:eM,OP_GETTABLE:eP,OP_GETTABUP:eD,OP_GETUPVAL:eB,OP_IDIV:eK,OP_JMP:eF,OP_LE:eV,OP_LEN:eG,OP_LOADBOOL:ej,OP_LOADK:ez,OP_LOADKX:eH,OP_LOADNIL:e$,OP_LT:eX,OP_MOD:eq,OP_MOVE:eW,OP_MUL:eZ,OP_NEWTABLE:eY,OP_NOT:eJ,OP_POW:eQ,OP_RETURN:e0,OP_SELF:e1,OP_SETLIST:e2,OP_SETTABLE:e3,OP_SETTABUP:e5,OP_SETUPVAL:e4,OP_SHL:e8,OP_SHR:e6,OP_SUB:e9,OP_TAILCALL:e7,OP_TEST:ta,OP_TESTSET:ti,OP_TFORCALL:to,OP_TFORLOOP:tl,OP_UNM:tu,OP_VARARG:tc}}=N(16),{LUA_MAXINTEGER:tf,LUA_MININTEGER:th,lua_numbertointeger:tp}=N(3),{lua_assert:td,luai_nummod:t_}=N(4),tg=N(6),tm=N(13),tb=N(12),{luaS_bless:ty,luaS_eqlngstr:tv,luaS_hashlongstr:tk}=N(10),tA=N(8),tL=N(14),tx=N(9),tw=N(11),c=function(e,n,N){return n+N.A},x=function(e,n,N){return n+N.B},p=function(e,n,N,C){return ek(C.B)?N[ev(C.B)]:e.stack[n+C.B]},T=function(e,n,N,C){return ek(C.C)?N[ev(C.C)]:e.stack[n+C.C]},$=function(e,n,N,C){let et=N.A;0!==et&&tm.luaF_close(e,n.l_base+et-1),n.l_savedpc+=N.sBx+C},U=function(e,n){$(e,n,n.l_code[n.l_savedpc],1)},pe=function(e,n,N){if(n.ttisnumber()&&N.ttisnumber())return G(n,N)?1:0;if(n.ttisstring()&&N.ttisstring())return 0>fe(n.tsvalue(),N.tsvalue())?1:0;{let C=tL.luaT_callorderTM(e,n,N,tL.TMS.TM_LT);return null===C&&tw.luaG_ordererror(e,n,N),C?1:0}},He=function(e,n,N){let C;return n.ttisnumber()&&N.ttisnumber()?Te(n,N)?1:0:n.ttisstring()&&N.ttisstring()?0>=fe(n.tsvalue(),N.tsvalue())?1:0:null!==(C=tL.luaT_callorderTM(e,n,N,tL.TMS.TM_LE))?C?1:0:(e.ci.callstatus|=tb.CIST_LEQ,C=tL.luaT_callorderTM(e,N,n,tL.TMS.TM_LT),e.ci.callstatus^=tb.CIST_LEQ,null===C&&tw.luaG_ordererror(e,n,N),C?0:1)},Qe=function(e,n,N){let C;if(n.ttype()!==N.ttype())return n.ttnov()!==N.ttnov()||n.ttnov()!==ep?0:n.value===N.value?1:0;switch(n.ttype()){case eh:return 1;case eo:return n.value==N.value?1:0;case ec:case e_:case ed:case eu:return n.value===N.value?1:0;case eg:case ef:return tv(n.tsvalue(),N.tsvalue())?1:0;case eb:case em:if(n.value===N.value)return 1;if(null===e)return 0;null===(C=tL.fasttm(e,n.value.metatable,tL.TMS.TM_EQ))&&(C=tL.fasttm(e,N.value.metatable,tL.TMS.TM_EQ));break;default:return n.value===N.value?1:0}if(null===C)return 0;let et=new tg.TValue;return tL.luaT_callTM(e,C,n,N,et,1),et.l_isfalse()?0:1},kt=function(e,n){let N=!1,C=J(e,n<0?2:1);if(!1===C){let et=ke(e);if(!1===et)return!1;0<et?(C=tf,n<0&&(N=!0)):(C=th,n>=0&&(N=!0))}return{stopnow:N,ilimit:C}},J=function(e,n){if(e.ttisfloat()){let N=e.value,C=Math.floor(N);if(N!==C){if(0===n)return!1;n>1&&(C+=1)}return tp(C)}if(e.ttisinteger())return e.value;if(wt(e)){let N=new tg.TValue;if(tg.luaO_str2num(e.svalue(),N)===e.vslen()+1)return J(N,n)}return!1},Z=function(e){return e.ttisinteger()?e.value:J(e,0)},ke=function(e){if(e.ttnov()===ep)return e.value;if(wt(e)){let n=new tg.TValue;if(tg.luaO_str2num(e.svalue(),n)===e.vslen()+1)return n.value}return!1},G=function(e,n){return e.value<n.value},Te=function(e,n){return e.value<=n.value},fe=function(e,n){let N=tk(e),C=tk(n);return N===C?0:N<C?-1:1},Me=function(e,n,N){let C;switch(N.ttype()){case em:{let et=N.value;if(null!==(C=tL.fasttm(e,et.metatable,tL.TMS.TM_LEN)))break;return void n.setivalue(tx.luaH_getn(et))}case eg:case ef:return void n.setivalue(N.vslen());default:(C=tL.luaT_gettmbyobj(e,N,tL.TMS.TM_LEN)).ttisnil()&&tw.luaG_typeerror(e,N,ey("get length of",!0))}tL.luaT_callTM(e,C,N,N,n,1)},tT=Math.imul||function(e,n){let N=65535&e,C=65535&n;return N*C+((e>>>16&65535)*C+N*(n>>>16&65535)<<16>>>0)|0},ct=function(e,n,N){return 0===N&&tw.luaG_runerror(e,ey("attempt to divide by zero")),0|Math.floor(n/N)},at=function(e,n,N){return 0===N&&tw.luaG_runerror(e,ey("attempt to perform 'n%%0'")),n-Math.floor(n/N)*N|0},_t=function(e,n){return n<0?n<=-32?0:e>>>-n:n>=32?0:e<<n},Bt=function(e,n,N,C){let et=e.cache;if(null!==et){let ei=e.upvalues,eo=ei.length;for(let e=0;e<eo;e++){let eo=ei[e].instack?N[C+ei[e].idx]:n[ei[e].idx];if(et.upvals[e]!==eo)return null}}return et},gt=function(e,n,N,C,et){let ei=n.upvalues.length,eo=n.upvalues,eu=new tg.LClosure(e,ei);eu.p=n,e.stack[et].setclLvalue(eu);for(let n=0;n<ei;n++)eo[n].instack?eu.upvals[n]=tm.luaF_findupval(e,C+eo[n].idx):eu.upvals[n]=N[eo[n].idx];n.cache=eu},Et=function(e){return e.ttisnumber()},wt=function(e){return e.ttisstring()},Ct=function(e,n){let N=e.stack[n];return!!N.ttisstring()||!!Et(N)&&(tg.luaO_tostring(e,N),!0)},Mt=function(e){return e.ttisstring()&&0===e.vslen()},Zt=function(e,n,N,C){let et=0;do{let ei=e.stack[n-N],eo=ei.vslen(),eu=ei.svalue();C.set(eu,et),et+=eo}while(--N>0)},Dt=function(e,n){td(n>=2);do{let N=e.top,C=2;if((e.stack[N-2].ttisstring()||Et(e.stack[N-2]))&&Ct(e,N-1)){if(Mt(e.stack[N-1]))Ct(e,N-2);else if(Mt(e.stack[N-2]))tg.setobjs2s(e,N-2,N-1);else{let et=e.stack[N-1].vslen();for(C=1;C<n&&Ct(e,N-C-1);C++)et+=e.stack[N-C-1].vslen();let ei=new Uint8Array(et);Zt(e,N,C,ei);let eo=ty(e,ei);tg.setsvalue2s(e,N-C,eo)}}else tL.luaT_trybinTM(e,e.stack[N-2],e.stack[N-1],e.stack[N-2],tL.TMS.TM_CONCAT);for(n-=C-1;e.top>N-(C-1);)delete e.stack[--e.top]}while(n>1)},qt=function(e,n,N,C){for(let et=0;et<2e3;et++){let et;if(n.ttistable()){let ei=tx.luaH_get(e,n.value,N);if(!ei.ttisnil())return void tg.setobj2s(e,C,ei);if(null===(et=tL.fasttm(e,n.value.metatable,tL.TMS.TM_INDEX)))return void e.stack[C].setnilvalue()}else(et=tL.luaT_gettmbyobj(e,n,tL.TMS.TM_INDEX)).ttisnil()&&tw.luaG_typeerror(e,n,ey("index",!0));if(et.ttisfunction())return void tL.luaT_callTM(e,et,n,N,e.stack[C],1);n=et}tw.luaG_runerror(e,ey("'__index' chain too long; possible loop",!0))},$t=function(e,n,N,C){for(let et=0;et<2e3;et++){let et;if(n.ttistable()){let ei=n.value;if(!tx.luaH_get(e,ei,N).ttisnil()||null===(et=tL.fasttm(e,ei.metatable,tL.TMS.TM_NEWINDEX)))return tx.luaH_setfrom(e,ei,N,C),void tx.invalidateTMcache(ei)}else(et=tL.luaT_gettmbyobj(e,n,tL.TMS.TM_NEWINDEX)).ttisnil()&&tw.luaG_typeerror(e,n,ey("index",!0));if(et.ttisfunction())return void tL.luaT_callTM(e,et,n,N,C,0);n=et}tw.luaG_runerror(e,ey("'__newindex' chain too long; possible loop",!0))};e.exports.cvt2str=Et,e.exports.cvt2num=wt,e.exports.luaV_gettable=qt,e.exports.luaV_concat=Dt,e.exports.luaV_div=ct,e.exports.luaV_equalobj=Qe,e.exports.luaV_execute=function(e){let n=e.ci;for(n.callstatus|=tb.CIST_FRESH;;){td(n===e.ci);let N=n.func.value,eo=N.p.k,eu=n.l_base,ec=n.l_code[n.l_savedpc++];e.hookmask&(C|et)&&tw.luaG_traceexec(e);let ef=c(0,eu,ec);switch(ec.opcode){case eW:tg.setobjs2s(e,ef,x(0,eu,ec));break;case ez:{let n=eo[ec.Bx];tg.setobj2s(e,ef,n);break}case eH:{td(n.l_code[n.l_savedpc].opcode===eU);let N=eo[n.l_code[n.l_savedpc++].Ax];tg.setobj2s(e,ef,N);break}case ej:e.stack[ef].setbvalue(0!==ec.B),0!==ec.C&&n.l_savedpc++;break;case e$:for(let n=0;n<=ec.B;n++)e.stack[ef+n].setnilvalue();break;case eB:{let n=ec.B;tg.setobj2s(e,ef,N.upvals[n]);break}case eD:{let n=N.upvals[ec.B],C=T(e,eu,eo,ec);qt(e,n,C,ef);break}case eP:{let n=e.stack[x(0,eu,ec)],N=T(e,eu,eo,ec);qt(e,n,N,ef);break}case e5:{let n=N.upvals[ec.A],C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);$t(e,n,C,et);break}case e4:N.upvals[ec.B].setfrom(e.stack[ef]);break;case e3:{let n=e.stack[ef],N=p(e,eu,eo,ec),C=T(e,eu,eo,ec);$t(e,n,N,C);break}case eY:e.stack[ef].sethvalue(tx.luaH_new(e));break;case e1:{let n=x(0,eu,ec),N=T(e,eu,eo,ec);tg.setobjs2s(e,ef+1,n),qt(e,e.stack[n],N,ef);break}case eL:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);C.ttisinteger()&&et.ttisinteger()?e.stack[ef].setivalue(C.value+et.value|0):!1!==(n=ke(C))&&!1!==(N=ke(et))?e.stack[ef].setfltvalue(n+N):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_ADD);break}case e9:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);C.ttisinteger()&&et.ttisinteger()?e.stack[ef].setivalue(C.value-et.value|0):!1!==(n=ke(C))&&!1!==(N=ke(et))?e.stack[ef].setfltvalue(n-N):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_SUB);break}case eZ:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);C.ttisinteger()&&et.ttisinteger()?e.stack[ef].setivalue(tT(C.value,et.value)):!1!==(n=ke(C))&&!1!==(N=ke(et))?e.stack[ef].setfltvalue(n*N):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_MUL);break}case eq:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);C.ttisinteger()&&et.ttisinteger()?e.stack[ef].setivalue(at(e,C.value,et.value)):!1!==(n=ke(C))&&!1!==(N=ke(et))?e.stack[ef].setfltvalue(t_(e,n,N)):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_MOD);break}case eQ:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);!1!==(n=ke(C))&&!1!==(N=ke(et))?e.stack[ef].setfltvalue(Math.pow(n,N)):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_POW);break}case eI:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);!1!==(n=ke(C))&&!1!==(N=ke(et))?e.stack[ef].setfltvalue(n/N):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_DIV);break}case eK:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);C.ttisinteger()&&et.ttisinteger()?e.stack[ef].setivalue(ct(e,C.value,et.value)):!1!==(n=ke(C))&&!1!==(N=ke(et))?e.stack[ef].setfltvalue(Math.floor(n/N)):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_IDIV);break}case ex:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);!1!==(n=Z(C))&&!1!==(N=Z(et))?e.stack[ef].setivalue(n&N):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_BAND);break}case eT:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);!1!==(n=Z(C))&&!1!==(N=Z(et))?e.stack[ef].setivalue(n|N):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_BOR);break}case eO:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);!1!==(n=Z(C))&&!1!==(N=Z(et))?e.stack[ef].setivalue(n^N):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_BXOR);break}case e8:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);!1!==(n=Z(C))&&!1!==(N=Z(et))?e.stack[ef].setivalue(_t(n,N)):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_SHL);break}case e6:{let n,N,C=p(e,eu,eo,ec),et=T(e,eu,eo,ec);!1!==(n=Z(C))&&!1!==(N=Z(et))?e.stack[ef].setivalue(_t(n,-N)):tL.luaT_trybinTM(e,C,et,e.stack[ef],tL.TMS.TM_SHR);break}case tu:{let n,N=e.stack[x(0,eu,ec)];N.ttisinteger()?e.stack[ef].setivalue(0|-N.value):!1!==(n=ke(N))?e.stack[ef].setfltvalue(-n):tL.luaT_trybinTM(e,N,N,e.stack[ef],tL.TMS.TM_UNM);break}case ew:{let n=e.stack[x(0,eu,ec)];n.ttisinteger()?e.stack[ef].setivalue(~n.value):tL.luaT_trybinTM(e,n,n,e.stack[ef],tL.TMS.TM_BNOT);break}case eJ:{let n=e.stack[x(0,eu,ec)];e.stack[ef].setbvalue(n.l_isfalse());break}case eG:Me(e,e.stack[ef],e.stack[x(0,eu,ec)]);break;case eN:{let N=ec.B,C=ec.C;e.top=eu+C+1,Dt(e,C-N+1);let et=eu+N;tg.setobjs2s(e,ef,et),tA.adjust_top(e,n.top);break}case eF:$(e,n,ec,0);break;case eR:Qe(e,p(e,eu,eo,ec),T(e,eu,eo,ec))!==ec.A?n.l_savedpc++:U(e,n);break;case eX:pe(e,p(e,eu,eo,ec),T(e,eu,eo,ec))!==ec.A?n.l_savedpc++:U(e,n);break;case eV:He(e,p(e,eu,eo,ec),T(e,eu,eo,ec))!==ec.A?n.l_savedpc++:U(e,n);break;case ta:(ec.C?e.stack[ef].l_isfalse():!e.stack[ef].l_isfalse())?n.l_savedpc++:U(e,n);break;case ti:{let N=x(0,eu,ec),C=e.stack[N];(ec.C?C.l_isfalse():!C.l_isfalse())?n.l_savedpc++:(tg.setobjs2s(e,ef,N),U(e,n));break}case eE:{let N=ec.B,C=ec.C-1;if(0!==N&&tA.adjust_top(e,ef+N),!tA.luaD_precall(e,ef,C)){n=e.ci;continue}C>=0&&tA.adjust_top(e,n.top);break}case e7:{let C=ec.B;if(0!==C&&tA.adjust_top(e,ef+C),!tA.luaD_precall(e,ef,ei)){let C=e.ci,et=C.previous,ei=C.func,eo=C.funcOff,eu=et.funcOff,ec=C.l_base+ei.value.p.numparams;N.p.p.length>0&&tm.luaF_close(e,et.l_base);for(let n=0;eo+n<ec;n++)tg.setobjs2s(e,eu+n,eo+n);et.l_base=eu+(C.l_base-eo),et.top=eu+(e.top-eo),tA.adjust_top(e,et.top),et.l_code=C.l_code,et.l_savedpc=C.l_savedpc,et.callstatus|=tb.CIST_TAIL,et.next=null,n=e.ci=et,td(e.top===et.l_base+e.stack[eu].value.p.maxstacksize);continue}break}case e0:{N.p.p.length>0&&tm.luaF_close(e,eu);let C=tA.luaD_poscall(e,n,ef,0!==ec.B?ec.B-1:e.top-ef);if(n.callstatus&tb.CIST_FRESH)return;n=e.ci,C&&tA.adjust_top(e,n.top),td(n.callstatus&tb.CIST_LUA),td(n.l_code[n.l_savedpc-1].opcode===eE);continue}case eC:if(e.stack[ef].ttisinteger()){let N=e.stack[ef+2].value,C=e.stack[ef].value+N|0,et=e.stack[ef+1].value;(0<N?C<=et:et<=C)&&(n.l_savedpc+=ec.sBx,e.stack[ef].chgivalue(C),e.stack[ef+3].setivalue(C))}else{let N=e.stack[ef+2].value,C=e.stack[ef].value+N,et=e.stack[ef+1].value;(0<N?C<=et:et<=C)&&(n.l_savedpc+=ec.sBx,e.stack[ef].chgfltvalue(C),e.stack[ef+3].setfltvalue(C))}break;case eM:{let N,C=e.stack[ef],et=e.stack[ef+1],ei=e.stack[ef+2];if(C.ttisinteger()&&ei.ttisinteger()&&(N=kt(et,ei.value))){let e=N.stopnow?0:C.value;et.value=N.ilimit,C.value=e-ei.value|0}else{let n,N,eo;!1===(n=ke(et))&&tw.luaG_runerror(e,ey("'for' limit must be a number",!0)),e.stack[ef+1].setfltvalue(n),!1===(N=ke(ei))&&tw.luaG_runerror(e,ey("'for' step must be a number",!0)),e.stack[ef+2].setfltvalue(N),!1===(eo=ke(C))&&tw.luaG_runerror(e,ey("'for' initial value must be a number",!0)),e.stack[ef].setfltvalue(eo-N)}n.l_savedpc+=ec.sBx;break}case to:{let N=ef+3;tg.setobjs2s(e,N+2,ef+2),tg.setobjs2s(e,N+1,ef+1),tg.setobjs2s(e,N,ef),tA.adjust_top(e,N+3),tA.luaD_call(e,N,ec.C),tA.adjust_top(e,n.top),ef=c(0,eu,ec=n.l_code[n.l_savedpc++]),td(ec.opcode===tl)}case tl:e.stack[ef+1].ttisnil()||(tg.setobjs2s(e,ef,ef+1),n.l_savedpc+=ec.sBx);break;case e2:{let N=ec.B,C=ec.C;0===N&&(N=e.top-ef-1),0===C&&(td(n.l_code[n.l_savedpc].opcode===eU),C=n.l_code[n.l_savedpc++].Ax);let et=e.stack[ef].value,ei=(C-1)*eA+N;for(;N>0;N--)tx.luaH_setint(et,ei--,e.stack[ef+N]);tA.adjust_top(e,n.top);break}case eS:{let n=N.p.p[ec.Bx],C=Bt(n,N.upvals,e.stack,eu);null===C?gt(e,n,N.upvals,eu,ef):e.stack[ef].setclLvalue(C);break}case tc:{let C,et=ec.B-1,ei=eu-n.funcOff-N.p.numparams-1;for(ei<0&&(ei=0),et<0&&(et=ei,tA.luaD_checkstack(e,ei),tA.adjust_top(e,ef+ei)),C=0;C<et&&C<ei;C++)tg.setobjs2s(e,ef+C,eu-ei+C);for(;C<et;C++)e.stack[ef+C].setnilvalue();break}case eU:throw Error("invalid opcode")}}},e.exports.luaV_finishOp=function(e){let n=e.ci,N=n.l_base,C=n.l_code[n.l_savedpc-1],et=C.opcode;switch(et){case eL:case e9:case eZ:case eI:case eK:case ex:case eT:case eO:case e8:case e6:case eq:case eQ:case tu:case ew:case eG:case eD:case eP:case e1:tg.setobjs2s(e,N+C.A,e.top-1),delete e.stack[--e.top];break;case eV:case eX:case eR:{let N=!e.stack[e.top-1].l_isfalse();delete e.stack[--e.top],n.callstatus&tb.CIST_LEQ&&(td(et===eV),n.callstatus^=tb.CIST_LEQ,N=!N),td(n.l_code[n.l_savedpc].opcode===eF),!!C.A!==N&&n.l_savedpc++;break}case eN:{let et=e.top-1,ei=et-1-(N+C.B);tg.setobjs2s(e,et-2,et),ei>1&&(e.top=et-1,Dt(e,ei)),tg.setobjs2s(e,n.l_base+C.A,e.top-1),tA.adjust_top(e,n.top);break}case to:td(n.l_code[n.l_savedpc].opcode===tl),tA.adjust_top(e,n.top);break;case eE:C.C-1>=0&&tA.adjust_top(e,n.top)}},e.exports.luaV_imul=tT,e.exports.luaV_lessequal=He,e.exports.luaV_lessthan=pe,e.exports.luaV_mod=at,e.exports.luaV_objlen=Me,e.exports.luaV_rawequalobj=function(e,n){return Qe(null,e,n)},e.exports.luaV_shiftl=_t,e.exports.luaV_tointeger=J,e.exports.settable=$t,e.exports.tointeger=Z,e.exports.tonumber=ke},function(e,n,N){let C=[96,113,65,84,80,80,92,108,60,16,60,84,108,124,124,124,124,124,124,124,124,124,124,124,124,96,96,96,96,104,34,188,188,188,132,228,84,84,16,98,98,4,98,20,81,80,23],s=function(e,n){return~(-1<<e)<<n},a=function(e,n){return~s(e,n)},i=function(e,n,N,C){return e.code=e.code&a(C,N)|n<<N&s(C,N),u(e)},l=function(e,n){return i(e,n,14,18)},u=function(e){if("number"==typeof e)return{code:e,opcode:e>>0&s(6,0),A:e>>6&s(8,0),B:e>>23&s(9,0),C:e>>14&s(9,0),Bx:e>>14&s(18,0),Ax:e>>6&s(26,0),sBx:(e>>14&s(18,0))-131071};{let n=e.code;return e.opcode=n>>0&s(6,0),e.A=n>>6&s(8,0),e.B=n>>23&s(9,0),e.C=n>>14&s(9,0),e.Bx=n>>14&s(18,0),e.Ax=n>>6&s(26,0),e.sBx=(n>>14&s(18,0))-131071,e}};e.exports.BITRK=256,e.exports.CREATE_ABC=function(e,n,N,C){return u(e<<0|n<<6|N<<23|C<<14)},e.exports.CREATE_ABx=function(e,n,N){return u(e<<0|n<<6|N<<14)},e.exports.CREATE_Ax=function(e,n){return u(e<<0|n<<6)},e.exports.GET_OPCODE=function(e){return e.opcode},e.exports.GETARG_A=function(e){return e.A},e.exports.GETARG_B=function(e){return e.B},e.exports.GETARG_C=function(e){return e.C},e.exports.GETARG_Bx=function(e){return e.Bx},e.exports.GETARG_Ax=function(e){return e.Ax},e.exports.GETARG_sBx=function(e){return e.sBx},e.exports.INDEXK=function(e){return -257&e},e.exports.ISK=function(e){return 256&e},e.exports.LFIELDS_PER_FLUSH=50,e.exports.MAXARG_A=255,e.exports.MAXARG_Ax=67108863,e.exports.MAXARG_B=511,e.exports.MAXARG_Bx=262143,e.exports.MAXARG_C=511,e.exports.MAXARG_sBx=131071,e.exports.MAXINDEXRK=255,e.exports.NO_REG=255,e.exports.OpArgK=3,e.exports.OpArgN=0,e.exports.OpArgR=2,e.exports.OpArgU=1,e.exports.OpCodes=["MOVE","LOADK","LOADKX","LOADBOOL","LOADNIL","GETUPVAL","GETTABUP","GETTABLE","SETTABUP","SETUPVAL","SETTABLE","NEWTABLE","SELF","ADD","SUB","MUL","MOD","POW","DIV","IDIV","BAND","BOR","BXOR","SHL","SHR","UNM","BNOT","NOT","LEN","CONCAT","JMP","EQ","LT","LE","TEST","TESTSET","CALL","TAILCALL","RETURN","FORLOOP","FORPREP","TFORCALL","TFORLOOP","SETLIST","CLOSURE","VARARG","EXTRAARG"],e.exports.OpCodesI={OP_MOVE:0,OP_LOADK:1,OP_LOADKX:2,OP_LOADBOOL:3,OP_LOADNIL:4,OP_GETUPVAL:5,OP_GETTABUP:6,OP_GETTABLE:7,OP_SETTABUP:8,OP_SETUPVAL:9,OP_SETTABLE:10,OP_NEWTABLE:11,OP_SELF:12,OP_ADD:13,OP_SUB:14,OP_MUL:15,OP_MOD:16,OP_POW:17,OP_DIV:18,OP_IDIV:19,OP_BAND:20,OP_BOR:21,OP_BXOR:22,OP_SHL:23,OP_SHR:24,OP_UNM:25,OP_BNOT:26,OP_NOT:27,OP_LEN:28,OP_CONCAT:29,OP_JMP:30,OP_EQ:31,OP_LT:32,OP_LE:33,OP_TEST:34,OP_TESTSET:35,OP_CALL:36,OP_TAILCALL:37,OP_RETURN:38,OP_FORLOOP:39,OP_FORPREP:40,OP_TFORCALL:41,OP_TFORLOOP:42,OP_SETLIST:43,OP_CLOSURE:44,OP_VARARG:45,OP_EXTRAARG:46},e.exports.POS_A=6,e.exports.POS_Ax=6,e.exports.POS_B=23,e.exports.POS_Bx=14,e.exports.POS_C=14,e.exports.POS_OP=0,e.exports.RKASK=function(e){return 256|e},e.exports.SETARG_A=function(e,n){return i(e,n,6,8)},e.exports.SETARG_Ax=function(e,n){return i(e,n,6,26)},e.exports.SETARG_B=function(e,n){return i(e,n,23,9)},e.exports.SETARG_Bx=l,e.exports.SETARG_C=function(e,n){return i(e,n,14,9)},e.exports.SETARG_sBx=function(e,n){return l(e,n+131071)},e.exports.SET_OPCODE=function(e,n){return e.code=e.code&a(6,0)|n<<0&s(6,0),u(e)},e.exports.SIZE_A=8,e.exports.SIZE_Ax=26,e.exports.SIZE_B=9,e.exports.SIZE_Bx=18,e.exports.SIZE_C=9,e.exports.SIZE_OP=6,e.exports.fullins=u,e.exports.getBMode=function(e){return C[e]>>4&3},e.exports.getCMode=function(e){return C[e]>>2&3},e.exports.getOpMode=function(e){return 3&C[e]},e.exports.iABC=0,e.exports.iABx=1,e.exports.iAsBx=2,e.exports.iAx=3,e.exports.testAMode=function(e){return 64&C[e]},e.exports.testTMode=function(e){return 128&C[e]}},function(e,n,N){let{LUA_VERSION_MAJOR:C,LUA_VERSION_MINOR:et}=N(2);e.exports.LUA_VERSUFFIX="_"+C+"_"+et,e.exports.lua_assert=function(e){},e.exports.luaopen_base=N(24).luaopen_base,e.exports.LUA_COLIBNAME="coroutine",e.exports.luaopen_coroutine=N(25).luaopen_coroutine,e.exports.LUA_TABLIBNAME="table",e.exports.luaopen_table=N(26).luaopen_table,e.exports.LUA_OSLIBNAME="os",e.exports.luaopen_os=N(27).luaopen_os,e.exports.LUA_STRLIBNAME="string",e.exports.luaopen_string=N(28).luaopen_string,e.exports.LUA_UTF8LIBNAME="utf8",e.exports.luaopen_utf8=N(29).luaopen_utf8,e.exports.LUA_BITLIBNAME="bit32",e.exports.LUA_MATHLIBNAME="math",e.exports.luaopen_math=N(30).luaopen_math,e.exports.LUA_DBLIBNAME="debug",e.exports.luaopen_debug=N(31).luaopen_debug,e.exports.LUA_LOADLIBNAME="package",e.exports.luaopen_package=N(32).luaopen_package,e.exports.LUA_FENGARILIBNAME="fengari",e.exports.luaopen_fengari=N(33).luaopen_fengari;let ei=N(39);e.exports.luaL_openlibs=ei.luaL_openlibs},function(e,n,N){let{LUA_MULTRET:C,LUA_OPBNOT:et,LUA_OPEQ:ei,LUA_OPLE:eo,LUA_OPLT:eu,LUA_OPUNM:ec,LUA_REGISTRYINDEX:ef,LUA_RIDX_GLOBALS:eh,LUA_VERSION_NUM:ep,constant_types:{LUA_NUMTAGS:ed,LUA_TBOOLEAN:e_,LUA_TCCL:eg,LUA_TFUNCTION:em,LUA_TLCF:eb,LUA_TLCL:ey,LUA_TLIGHTUSERDATA:ev,LUA_TLNGSTR:ek,LUA_TNIL:eA,LUA_TNONE:eL,LUA_TNUMFLT:ex,LUA_TNUMINT:ew,LUA_TSHRSTR:eT,LUA_TTABLE:eO,LUA_TTHREAD:eE,LUA_TUSERDATA:eS},thread_status:{LUA_OK:eN},from_userstring:eI,to_luastring:eR}=N(1),{api_check:eU}=N(4),eC=N(11),eM=N(8),{luaU_dump:eP}=N(37),eD=N(13),eB=N(6),eK=N(12),{luaS_bless:eF,luaS_new:eV,luaS_newliteral:eG}=N(10),ej=N(14),{LUAI_MAXSTACK:ez}=N(3),eH=N(15),e$=N(9),{ZIO:eX}=N(19),eq=eB.TValue,eW=eB.CClosure,xe=function(e){e.top++,eU(e,e.top<=e.ci.top,"stack overflow")},ze=function(e,n){eU(e,n<e.top-e.ci.funcOff,"not enough elements in the stack")},g=function(e){if(!e)throw TypeError("invalid argument")},ge=function(e){g("number"==typeof e&&(0|e)===e)},te=function(e){return e!==eB.luaO_nilobject},A=function(e,n){let N=e.ci;if(n>0){let C=N.funcOff+n;return eU(e,n<=N.top-(N.funcOff+1),"unacceptable index"),C>=e.top?eB.luaO_nilobject:e.stack[C]}return n>ef?(eU(e,0!==n&&-n<=e.top,"invalid index"),e.stack[e.top+n]):n===ef?e.l_G.l_registry:(eU(e,(n=ef-n)<=eD.MAXUPVAL+1,"upvalue index too large"),N.func.ttislcf()?eB.luaO_nilobject:n<=N.func.value.nupvalues?N.func.value.upvalue[n-1]:eB.luaO_nilobject)},S=function(e,n){let N=e.ci;if(n>0){let C=N.funcOff+n;return eU(e,n<=N.top-(N.funcOff+1),"unacceptable index"),C>=e.top?null:C}if(n>ef)return eU(e,0!==n&&-n<=e.top,"invalid index"),e.top+n;throw Error("attempt to use pseudo-index")},v=function(e,n){let N,C=e.ci.funcOff;n>=0?(eU(e,n<=e.stack_last-(C+1),"new top too large"),N=C+1+n):(eU(e,-(n+1)<=e.top-(C+1),"invalid new top"),N=e.top+n+1),eM.adjust_top(e,N)},q=function(e,n){v(e,-n-1)},oe=function(e,n,N){for(;n<N;n++,N--){let C=e.stack[n],et=new eq(C.type,C.value);eB.setobjs2s(e,n,N),eB.setobj2s(e,N,et)}},O=function(e,n,N){let C=e.top-1,et=S(e,n),ei=e.stack[et];eU(e,te(ei)&&n>ef,"index not in the stack"),eU(e,(N>=0?N:-N)<=C-et+1,"invalid 'n'");let eo=N>=0?C-N:et-N-1;oe(e,et,eo),oe(e,eo+1,e.top-1),oe(e,et,e.top-1)},ee=function(e,n,N){let C=A(e,n);A(e,N).setfrom(C)},ce=function(e,n,N){if(g("function"==typeof n),ge(N),0===N)e.stack[e.top]=new eq(eb,n);else{ze(e,N),eU(e,N<=eD.MAXUPVAL,"upvalue index too large");let C=new eW(e,n,N);for(let n=0;n<N;n++)C.upvalue[n].setfrom(e.stack[e.top-N+n]);for(let n=1;n<N;n++)delete e.stack[--e.top];N>0&&--e.top,e.stack[e.top].setclCvalue(C)}xe(e)},Ve=function(e,n){ce(e,n,0)},dt=function(e,n,N){let C=eV(e,eI(N));ze(e,1),eB.pushsvalue2s(e,C),eU(e,e.top<=e.ci.top,"stack overflow"),eH.settable(e,n,e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top],delete e.stack[--e.top]},xt=function(e,n){dt(e,e$.luaH_getint(e.l_G.l_registry.value,eh),n)},Ot=function(e,n,N){let C=eV(e,eI(N));return eB.pushsvalue2s(e,C),eU(e,e.top<=e.ci.top,"stack overflow"),eH.luaV_gettable(e,n,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},St=function(e,n,N){let C=A(e,n);return ge(N),eU(e,C.ttistable(),"table expected"),eB.pushobj2s(e,e$.luaH_getint(C.value,N)),eU(e,e.top<=e.ci.top,"stack overflow"),e.stack[e.top-1].ttnov()},D=function(e,n,N){let C=new eB.TValue(eO,e$.luaH_new(e));e.stack[e.top]=C,xe(e)},Ce=function(e,n,N){switch(ge(N),n.ttype()){case eg:{let e=n.value;return 1<=N&&N<=e.nupvalues?{name:eR("",!0),val:e.upvalue[N-1]}:null}case ey:{let e=n.value,C=e.p;if(!(1<=N&&N<=C.upvalues.length))return null;let et=C.upvalues[N-1].name;return{name:et?et.getstr():eR("(*no name)",!0),val:e.upvals[N-1]}}default:return null}},De=function(e,n){let N=A(e,n);if(!N.ttisstring()){if(!eH.cvt2str(N))return null;eB.luaO_tostring(e,N)}return N.svalue()},Se=function(e,n){return eH.tointeger(A(e,n))},je=function(e,n){return eH.tonumber(A(e,n))},eZ=new WeakMap,bt=function(e,n){eM.luaD_callnoyield(e,n.funcOff,n.nresults)},vt=function(e,n){let N=A(e,n);return te(N)?N.ttnov():eL},eY=eR("?"),Rt=function(e,n,N){eU(e,N===C||e.ci.top-e.top>=N-n,"results from function overflow current stack size")},lt=function(e,n,N,et,ei){eU(e,null===ei||!(e.ci.callstatus&eK.CIST_LUA),"cannot use continuations inside hooks"),ze(e,n+1),eU(e,e.status===eN,"cannot do calls on non-normal thread"),Rt(e,n,N);let eo=e.top-(n+1);null!==ei&&0===e.nny?(e.ci.c_k=ei,e.ci.c_ctx=et,eM.luaD_call(e,eo,N)):eM.luaD_callnoyield(e,eo,N),N===C&&e.ci.top<e.top&&(e.ci.top=e.top)},pt=function(e,n,N,et,ei,eo){let eu,ec;eU(e,null===eo||!(e.ci.callstatus&eK.CIST_LUA),"cannot use continuations inside hooks"),ze(e,n+1),eU(e,e.status===eN,"cannot do calls on non-normal thread"),Rt(e,n,N),ec=0===et?0:S(e,et);let ef=e.top-(n+1);if(null===eo||e.nny>0)eu=eM.luaD_pcall(e,bt,{funcOff:ef,nresults:N},ef,ec);else{let n=e.ci;n.c_k=eo,n.c_ctx=ei,n.extra=ef,n.c_old_errfunc=e.errfunc,e.errfunc=ec,n.callstatus&=~eK.CIST_OAH|e.allowhook,n.callstatus|=eK.CIST_YPCALL,eM.luaD_call(e,ef,N),n.callstatus&=~eK.CIST_YPCALL,e.errfunc=n.c_old_errfunc,eu=eN}return N===C&&e.ci.top<e.top&&(e.ci.top=e.top),eu},At=function(e,n,N){let C=A(e,n);eU(e,C.ttisLclosure(),"Lua function expected");let et=C.value;return ge(N),eU(e,1<=N&&N<=et.p.upvalues.length,"invalid upvalue index"),{f:et,i:N-1}};e.exports.api_incr_top=xe,e.exports.api_checknelems=ze,e.exports.lua_absindex=function(e,n){return n>0||n<=ef?n:e.top-e.ci.funcOff+n},e.exports.lua_arith=function(e,n){n!==ec&&n!==et?ze(e,2):(ze(e,1),eB.pushobj2s(e,e.stack[e.top-1]),eU(e,e.top<=e.ci.top,"stack overflow")),eB.luaO_arith(e,n,e.stack[e.top-2],e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top]},e.exports.lua_atpanic=function(e,n){let N=e.l_G.panic;return e.l_G.panic=n,N},e.exports.lua_atnativeerror=function(e,n){let N=e.l_G.atnativeerror;return e.l_G.atnativeerror=n,N},e.exports.lua_call=function(e,n,N){lt(e,n,N,0,null)},e.exports.lua_callk=lt,e.exports.lua_checkstack=function(e,n){let N,C=e.ci;return eU(e,n>=0,"negative 'n'"),e.stack_last-e.top>n?N=!0:e.top+eK.EXTRA_STACK>ez-n?N=!1:(eM.luaD_growstack(e,n),N=!0),N&&C.top<e.top+n&&(C.top=e.top+n),N},e.exports.lua_compare=function(e,n,N,C){let et=A(e,n),ec=A(e,N),ef=0;if(te(et)&&te(ec))switch(C){case ei:ef=eH.luaV_equalobj(e,et,ec);break;case eu:ef=eH.luaV_lessthan(e,et,ec);break;case eo:ef=eH.luaV_lessequal(e,et,ec);break;default:eU(e,!1,"invalid option")}return ef},e.exports.lua_concat=function(e,n){ze(e,n),n>=2?eH.luaV_concat(e,n):0===n&&(eB.pushsvalue2s(e,eF(e,eR("",!0))),eU(e,e.top<=e.ci.top,"stack overflow"))},e.exports.lua_copy=ee,e.exports.lua_createtable=D,e.exports.lua_dump=function(e,n,N,C){ze(e,1);let et=e.stack[e.top-1];return et.ttisLclosure()?eP(e,et.value.p,n,N,C):1},e.exports.lua_error=function(e){ze(e,1),eC.luaG_errormsg(e)},e.exports.lua_gc=function(){},e.exports.lua_getallocf=function(){return console.warn("lua_getallocf is not available"),0},e.exports.lua_getextraspace=function(){return console.warn("lua_getextraspace is not available"),0},e.exports.lua_getfield=function(e,n,N){return Ot(e,A(e,n),N)},e.exports.lua_getglobal=function(e,n){return Ot(e,e$.luaH_getint(e.l_G.l_registry.value,eh),n)},e.exports.lua_geti=function(e,n,N){let C=A(e,n);return ge(N),e.stack[e.top]=new eq(ew,N),xe(e),eH.luaV_gettable(e,C,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},e.exports.lua_getmetatable=function(e,n){let N,C=A(e,n),et=!1;switch(C.ttnov()){case eO:case eS:N=C.value.metatable;break;default:N=e.l_G.mt[C.ttnov()]}return null!=N&&(e.stack[e.top]=new eq(eO,N),xe(e),et=!0),et},e.exports.lua_gettable=function(e,n){let N=A(e,n);return eH.luaV_gettable(e,N,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},e.exports.lua_gettop=function(e){return e.top-(e.ci.funcOff+1)},e.exports.lua_getupvalue=function(e,n,N){let C=Ce(0,A(e,n),N);if(C){let n=C.name,N=C.val;return eB.pushobj2s(e,N),eU(e,e.top<=e.ci.top,"stack overflow"),n}return null},e.exports.lua_getuservalue=function(e,n){let N=A(e,n);eU(e,N.ttisfulluserdata(),"full userdata expected");let C=N.value.uservalue;return e.stack[e.top]=new eq(C.type,C.value),xe(e),e.stack[e.top-1].ttnov()},e.exports.lua_insert=function(e,n){O(e,n,1)},e.exports.lua_isboolean=function(e,n){return vt(e,n)===e_},e.exports.lua_iscfunction=function(e,n){let N=A(e,n);return N.ttislcf(N)||N.ttisCclosure()},e.exports.lua_isfunction=function(e,n){return vt(e,n)===em},e.exports.lua_isinteger=function(e,n){return A(e,n).ttisinteger()},e.exports.lua_islightuserdata=function(e,n){return vt(e,n)===ev},e.exports.lua_isnil=function(e,n){return vt(e,n)===eA},e.exports.lua_isnone=function(e,n){return vt(e,n)===eL},e.exports.lua_isnoneornil=function(e,n){return 0>=vt(e,n)},e.exports.lua_isnumber=function(e,n){return!1!==eH.tonumber(A(e,n))},e.exports.lua_isproxy=function(e,n){let N=eZ.get(e);return!!N&&(null===n||n.l_G===N)},e.exports.lua_isstring=function(e,n){let N=A(e,n);return N.ttisstring()||eH.cvt2str(N)},e.exports.lua_istable=function(e,n){return A(e,n).ttistable()},e.exports.lua_isthread=function(e,n){return vt(e,n)===eE},e.exports.lua_isuserdata=function(e,n){let N=A(e,n);return N.ttisfulluserdata(N)||N.ttislightuserdata()},e.exports.lua_len=function(e,n){let N=A(e,n),C=new eq;eH.luaV_objlen(e,C,N),e.stack[e.top]=C,xe(e)},e.exports.lua_load=function(e,n,N,C,et){C=C?eI(C):eY,null!==et&&(et=eI(et));let ei=new eX(e,n,N),eo=eM.luaD_protectedparser(e,ei,C,et);if(eo===eN){let n=e.stack[e.top-1].value;if(n.nupvalues>=1){let N=e$.luaH_getint(e.l_G.l_registry.value,eh);n.upvals[0].setfrom(N)}}return eo},e.exports.lua_newtable=function(e){D(e)},e.exports.lua_newuserdata=function(e,n){let N=new eB.Udata(e,n);return e.stack[e.top]=new eB.TValue(eS,N),xe(e),N.data},e.exports.lua_next=function(e,n){let N=A(e,n);return eU(e,N.ttistable(),"table expected"),e.stack[e.top]=new eq,e$.luaH_next(e,N.value,e.top-1)?(xe(e),1):(delete e.stack[e.top],delete e.stack[--e.top],0)},e.exports.lua_pcall=function(e,n,N,C){return pt(e,n,N,C,0,null)},e.exports.lua_pcallk=pt,e.exports.lua_pop=q,e.exports.lua_pushboolean=function(e,n){e.stack[e.top]=new eq(e_,!!n),xe(e)},e.exports.lua_pushcclosure=ce,e.exports.lua_pushcfunction=Ve,e.exports.lua_pushfstring=function(e,n,...N){return n=eI(n),eB.luaO_pushvfstring(e,n,N)},e.exports.lua_pushglobaltable=function(e){St(e,ef,eh)},e.exports.lua_pushinteger=function(e,n){ge(n),e.stack[e.top]=new eq(ew,n),xe(e)},e.exports.lua_pushjsclosure=ce,e.exports.lua_pushjsfunction=Ve,e.exports.lua_pushlightuserdata=function(e,n){e.stack[e.top]=new eq(ev,n),xe(e)},e.exports.lua_pushliteral=function(e,n){if(null==n)e.stack[e.top]=new eq(eA,null),e.top++;else{g("string"==typeof n);let N=eG(e,n);eB.pushsvalue2s(e,N),n=N.getstr()}return eU(e,e.top<=e.ci.top,"stack overflow"),n},e.exports.lua_pushlstring=function(e,n,N){let C;return ge(N),0===N?C=eF(e,n=eR("",!0)):(eU(e,(n=eI(n)).length>=N,"invalid length to lua_pushlstring"),C=eV(e,n.subarray(0,N))),eB.pushsvalue2s(e,C),eU(e,e.top<=e.ci.top,"stack overflow"),C.value},e.exports.lua_pushnil=function(e){e.stack[e.top]=new eq(eA,null),xe(e)},e.exports.lua_pushnumber=function(e,n){g("number"==typeof n),e.stack[e.top]=new eq(ex,n),xe(e)},e.exports.lua_pushstring=function(e,n){if(null==n)e.stack[e.top]=new eq(eA,null),e.top++;else{let N=eV(e,eI(n));eB.pushsvalue2s(e,N),n=N.getstr()}return eU(e,e.top<=e.ci.top,"stack overflow"),n},e.exports.lua_pushthread=function(e){return e.stack[e.top]=new eq(eE,e),xe(e),e.l_G.mainthread===e},e.exports.lua_pushvalue=function(e,n){eB.pushobj2s(e,A(e,n)),eU(e,e.top<=e.ci.top,"stack overflow")},e.exports.lua_pushvfstring=function(e,n,N){return n=eI(n),eB.luaO_pushvfstring(e,n,N)},e.exports.lua_rawequal=function(e,n,N){let C=A(e,n),et=A(e,N);return te(C)&&te(et)?eH.luaV_equalobj(null,C,et):0},e.exports.lua_rawget=function(e,n){let N=A(e,n);return eU(e,N.ttistable(N),"table expected"),eB.setobj2s(e,e.top-1,e$.luaH_get(e,N.value,e.stack[e.top-1])),e.stack[e.top-1].ttnov()},e.exports.lua_rawgeti=St,e.exports.lua_rawgetp=function(e,n,N){let C=A(e,n);eU(e,C.ttistable(),"table expected");let et=new eq(ev,N);return eB.pushobj2s(e,e$.luaH_get(e,C.value,et)),eU(e,e.top<=e.ci.top,"stack overflow"),e.stack[e.top-1].ttnov()},e.exports.lua_rawlen=function(e,n){let N=A(e,n);switch(N.ttype()){case eT:case ek:return N.vslen();case eS:return N.value.len;case eO:return e$.luaH_getn(N.value);default:return 0}},e.exports.lua_rawset=function(e,n){ze(e,2);let N=A(e,n);eU(e,N.ttistable(),"table expected");let C=e.stack[e.top-2],et=e.stack[e.top-1];e$.luaH_setfrom(e,N.value,C,et),e$.invalidateTMcache(N.value),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_rawseti=function(e,n,N){ge(N),ze(e,1);let C=A(e,n);eU(e,C.ttistable(),"table expected"),e$.luaH_setint(C.value,N,e.stack[e.top-1]),delete e.stack[--e.top]},e.exports.lua_rawsetp=function(e,n,N){ze(e,1);let C=A(e,n);eU(e,C.ttistable(),"table expected");let et=new eq(ev,N),ei=e.stack[e.top-1];e$.luaH_setfrom(e,C.value,et,ei),delete e.stack[--e.top]},e.exports.lua_register=function(e,n,N){Ve(e,N),xt(e,n)},e.exports.lua_remove=function(e,n){O(e,n,-1),q(e,1)},e.exports.lua_replace=function(e,n){ee(e,-1,n),q(e,1)},e.exports.lua_rotate=O,e.exports.lua_setallocf=function(){return console.warn("lua_setallocf is not available"),0},e.exports.lua_setfield=function(e,n,N){dt(e,A(e,n),N)},e.exports.lua_setglobal=xt,e.exports.lua_seti=function(e,n,N){ge(N),ze(e,1);let C=A(e,n);e.stack[e.top]=new eq(ew,N),xe(e),eH.settable(e,C,e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_setmetatable=function(e,n){let N;ze(e,1);let C=A(e,n);switch(e.stack[e.top-1].ttisnil()?N=null:(eU(e,e.stack[e.top-1].ttistable(),"table expected"),N=e.stack[e.top-1].value),C.ttnov()){case eS:case eO:C.value.metatable=N;break;default:e.l_G.mt[C.ttnov()]=N}return delete e.stack[--e.top],!0},e.exports.lua_settable=function(e,n){ze(e,2);let N=A(e,n);eH.settable(e,N,e.stack[e.top-2],e.stack[e.top-1]),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_settop=v,e.exports.lua_setupvalue=function(e,n,N){let C=A(e,n);ze(e,1);let et=Ce(0,C,N);if(et){let n=et.name;return et.val.setfrom(e.stack[e.top-1]),delete e.stack[--e.top],n}return null},e.exports.lua_setuservalue=function(e,n){ze(e,1);let N=A(e,n);eU(e,N.ttisfulluserdata(),"full userdata expected"),N.value.uservalue.setfrom(e.stack[e.top-1]),delete e.stack[--e.top]},e.exports.lua_status=function(e){return e.status},e.exports.lua_stringtonumber=function(e,n){let N=new eq,C=eB.luaO_str2num(n,N);return 0!==C&&(e.stack[e.top]=N,xe(e)),C},e.exports.lua_toboolean=function(e,n){return!A(e,n).l_isfalse()},e.exports.lua_tocfunction=function(e,n){let N=A(e,n);return N.ttislcf()||N.ttisCclosure()?N.value:null},e.exports.lua_todataview=function(e,n){let N=De(e,n);return new DataView(N.buffer,N.byteOffset,N.byteLength)},e.exports.lua_tointeger=function(e,n){let N=Se(e,n);return!1===N?0:N},e.exports.lua_tointegerx=Se,e.exports.lua_tojsstring=function(e,n){let N=A(e,n);if(!N.ttisstring()){if(!eH.cvt2str(N))return null;eB.luaO_tostring(e,N)}return N.jsstring()},e.exports.lua_tolstring=De,e.exports.lua_tonumber=function(e,n){let N=je(e,n);return!1===N?0:N},e.exports.lua_tonumberx=je,e.exports.lua_topointer=function(e,n){let N=A(e,n);switch(N.ttype()){case eO:case ey:case eg:case eb:case eE:case eS:case ev:return N.value;default:return null}},e.exports.lua_toproxy=function(e,n){var N,C,et;let ei,eo=A(e,n);return N=e.l_G,C=eo.type,et=eo.value,ei=function(e){eU(e,e instanceof eK.lua_State&&N===e.l_G,"must be from same global state"),e.stack[e.top]=new eq(C,et),xe(e)},eZ.set(ei,N),ei},e.exports.lua_tostring=De,e.exports.lua_tothread=function(e,n){let N=A(e,n);return N.ttisthread()?N.value:null},e.exports.lua_touserdata=function(e,n){let N=A(e,n);switch(N.ttnov()){case eS:return N.value.data;case ev:return N.value;default:return null}},e.exports.lua_type=vt,e.exports.lua_typename=function(e,n){return eU(e,eL<=n&&n<ed,"invalid tag"),ej.ttypename(n)},e.exports.lua_upvalueid=function(e,n,N){let C=A(e,n);switch(C.ttype()){case ey:{let C=At(e,n,N);return C.f.upvals[C.i]}case eg:{let n=C.value;return eU(e,(0|N)===N&&N>0&&N<=n.nupvalues,"invalid upvalue index"),n.upvalue[N-1]}default:return eU(e,!1,"closure expected"),null}},e.exports.lua_upvaluejoin=function(e,n,N,C,et){let ei=At(e,n,N),eo=At(e,C,et),eu=eo.f.upvals[eo.i];ei.f.upvals[ei.i]=eu},e.exports.lua_version=function(e){return null===e?ep:e.l_G.version},e.exports.lua_xmove=function(e,n,N){if(e!==n){ze(e,N),eU(e,e.l_G===n.l_G,"moving among independent states"),eU(e,n.ci.top-n.top>=N,"stack overflow"),e.top-=N;for(let C=0;C<N;C++)n.stack[n.top]=new eB.TValue,eB.setobj2s(n,n.top,e.stack[e.top+C]),delete e.stack[e.top+C],n.top++}}},function(e,n,N){let{lua_assert:C}=N(4),s=function(e){let n=e.reader(e.L,e.data);if(null===n)return -1;C(n instanceof Uint8Array,"Should only load binary of array of bytes");let N=n.length;return 0===N?-1:(e.buffer=n,e.off=0,e.n=N-1,e.buffer[e.off++])};e.exports.EOZ=-1,e.exports.luaZ_buffer=function(e){return e.buffer.subarray(0,e.n)},e.exports.luaZ_buffremove=function(e,n){e.n-=n},e.exports.luaZ_fill=s,e.exports.luaZ_read=function(e,n,N,C){for(;C;){if(0===e.n){if(-1===s(e))return C;e.n++,e.off--}let et=C<=e.n?C:e.n;for(let C=0;C<et;C++)n[N++]=e.buffer[e.off++];e.n-=et,0===e.n&&(e.buffer=null),C-=et}return 0},e.exports.luaZ_resetbuffer=function(e){e.n=0},e.exports.luaZ_resizebuffer=function(e,n,N){let C=new Uint8Array(N);n.buffer&&C.set(n.buffer),n.buffer=C},e.exports.MBuffer=class{constructor(){this.buffer=null,this.n=0}},e.exports.ZIO=class{constructor(e,n,N){this.L=e,C("function"==typeof n,"ZIO requires a reader"),this.reader=n,this.data=N,this.n=0,this.buffer=null,this.off=0}zgetc(){return this.n-- >0?this.buffer[this.off++]:s(this)}}},function(e,n,N){let{constant_types:{LUA_TBOOLEAN:C,LUA_TLNGSTR:et},thread_status:{LUA_ERRSYNTAX:ei},to_luastring:eo}=N(1),{LUA_MINBUFFER:eu,MAX_INT:ec,lua_assert:ef}=N(4),eh=N(11),ep=N(8),{lisdigit:ed,lislalnum:e_,lislalpha:eg,lisspace:em,lisxdigit:eb}=N(22),ey=N(6),{luaS_bless:ev,luaS_hash:ek,luaS_hashlongstr:eA,luaS_new:eL}=N(10),ex=N(9),{EOZ:ew,luaZ_buffer:eT,luaZ_buffremove:eO,luaZ_resetbuffer:eE,luaZ_resizebuffer:eS}=N(19),eN=eo("_ENV",!0),eI=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","//","..","...","==",">=","<=","~=","<<",">>","::","<eof>","<number>","<integer>","<name>","<string>"].map((e,n)=>eo(e));let Y=class Y{constructor(){this.r=NaN,this.i=NaN,this.ts=null}};let de=class de{constructor(){this.token=NaN,this.seminfo=new Y}};let _e=function(e,n){let N=e.buff;if(N.n+1>N.buffer.length){N.buffer.length>=ec/2&&Ze(e,eo("lexical element too long",!0),0);let n=2*N.buffer.length;eS(e.L,N,n)}N.buffer[N.n++]=n<0?255+n+1:n},me=function(e,n){if(n<257)return ey.luaO_pushfstring(e.L,eo("'%c'",!0),n);{let N=eI[n-257];return n<289?ey.luaO_pushfstring(e.L,eo("'%s'",!0),N):N}},ve=function(e){return 10===e.current||13===e.current},K=function(e){e.current=e.z.zgetc()},I=function(e){_e(e,e.current),K(e)},eR=new ey.TValue(C,!0),ye=function(e,n){let N=e.L,C=eL(N,n),ei=e.h.strong.get(eA(C));if(ei)C=ei.key.tsvalue();else{let n=new ey.TValue(et,C);ex.luaH_setfrom(N,e.h,n,eR)}return C},be=function(e){let n=e.current;ef(ve(e)),K(e),ve(e)&&e.current!==n&&K(e),++e.linenumber>=ec&&Ze(e,eo("chunk has too many lines",!0),0)},Ue=function(e,n){return e.current===n&&(K(e),!0)},Xe=function(e,n){return(e.current===n[0].charCodeAt(0)||e.current===n[1].charCodeAt(0))&&(I(e),!0)},st=function(e,n){let N="Ee",C=e.current;for(ef(ed(e.current)),I(e),48===C&&Xe(e,"xX")&&(N="Pp");;)if(Xe(e,N)&&Xe(e,"-+"),eb(e.current))I(e);else{if(46!==e.current)break;I(e)}let et=new ey.TValue;return 0===ey.luaO_str2num(eT(e.buff),et)&&Ze(e,eo("malformed number",!0),290),et.ttisinteger()?(n.i=et.value,291):(ef(et.ttisfloat()),n.r=et.value,290)},Ze=function(e,n,N){n=eh.luaG_addinfo(e.L,n,e.source,e.linenumber),N&&ey.luaO_pushfstring(e.L,eo("%s near %s"),n,function(e,n){switch(n){case 292:case 293:case 290:case 291:return ey.luaO_pushfstring(e.L,eo("'%s'",!0),eT(e.buff));default:return me(e,n)}}(e,N)),ep.luaD_throw(e.L,ei)},ae=function(e){let n=0,N=e.current;for(ef(91===N||93===N),I(e);61===e.current;)I(e),n++;return e.current===N?n:-n-1},le=function(e,n,N){let C=e.linenumber;I(e),ve(e)&&be(e);let et=!1;for(;!et;)switch(e.current){case ew:Ze(e,eo(`unfinished long ${n?"string":"comment"} (starting at line ${C})`),289);break;case 93:ae(e)===N&&(I(e),et=!0);break;case 10:case 13:_e(e,10),be(e),n||eE(e.buff);break;default:n?I(e):K(e)}n&&(n.ts=ye(e,e.buff.buffer.subarray(2+N,e.buff.n-(2+N))))},Pe=function(e,n,N){n||(e.current!==ew&&I(e),Ze(e,N,293))},xe=function(e){return I(e),Pe(e,eb(e.current),eo("hexadecimal digit expected",!0)),ey.luaO_hexavalue(e.current)},ze=function(e){let n=xe(e);return n=(n<<4)+xe(e),eO(e.buff,2),n},g=function(e){let n=new Uint8Array(ey.UTF8BUFFSZ),N=ey.luaO_utf8esc(n,function(e){let n=4;I(e),Pe(e,123===e.current,eo("missing '{'",!0));let N=xe(e);for(I(e);eb(e.current);)n++,N=(N<<4)+ey.luaO_hexavalue(e.current),Pe(e,N<=1114111,eo("UTF-8 value too large",!0)),I(e);return Pe(e,125===e.current,eo("missing '}'",!0)),K(e),eO(e.buff,n),N}(e));for(;N>0;N--)_e(e,n[ey.UTF8BUFFSZ-N])},ge=function(e){let n,N=0;for(n=0;n<3&&ed(e.current);n++)N=10*N+e.current-48,I(e);return Pe(e,N<=255,eo("decimal escape too large",!0)),eO(e.buff,n),N},te=function(e,n,N){for(I(e);e.current!==n;)switch(e.current){case ew:Ze(e,eo("unfinished string",!0),289);break;case 10:case 13:Ze(e,eo("unfinished string",!0),293);break;case 92:{let n,N;switch(I(e),e.current){case 97:N=7,n="read_save";break;case 98:N=8,n="read_save";break;case 102:N=12,n="read_save";break;case 110:N=10,n="read_save";break;case 114:N=13,n="read_save";break;case 116:N=9,n="read_save";break;case 118:N=11,n="read_save";break;case 120:N=ze(e),n="read_save";break;case 117:g(e),n="no_save";break;case 10:case 13:be(e),N=10,n="only_save";break;case 92:case 34:case 39:N=e.current,n="read_save";break;case ew:n="no_save";break;case 122:for(eO(e.buff,1),K(e);em(e.current);)ve(e)?be(e):K(e);n="no_save";break;default:Pe(e,ed(e.current),eo("invalid escape sequence",!0)),N=ge(e),n="only_save"}"read_save"===n&&K(e),"read_save"!==n&&"only_save"!==n||(eO(e.buff,1),_e(e,N));break}default:I(e)}I(e),N.ts=ye(e,e.buff.buffer.subarray(1,e.buff.n-1))},eU=Object.create(null);eI.forEach((e,n)=>eU[ek(e)]=n);let S=function(e,n){for(eE(e.buff);;)switch(ef("number"==typeof e.current),e.current){case 10:case 13:be(e);break;case 32:case 12:case 9:case 11:K(e);break;case 45:if(K(e),45!==e.current)return 45;if(K(e),91===e.current){let n=ae(e);if(eE(e.buff),n>=0){le(e,null,n),eE(e.buff);break}}for(;!ve(e)&&e.current!==ew;)K(e);break;case 91:{let N=ae(e);return N>=0?(le(e,n,N),293):(-1!==N&&Ze(e,eo("invalid long string delimiter",!0),293),91)}case 61:return K(e),Ue(e,61)?282:61;case 60:return K(e),Ue(e,61)?284:Ue(e,60)?286:60;case 62:return K(e),Ue(e,61)?283:Ue(e,62)?287:62;case 47:return K(e),Ue(e,47)?279:47;case 126:return K(e),Ue(e,61)?285:126;case 58:return K(e),Ue(e,58)?288:58;case 34:case 39:return te(e,e.current,n),293;case 46:return I(e),Ue(e,46)?Ue(e,46)?281:280:ed(e.current)?st(e,n):46;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return st(e,n);case ew:return 289;default:if(eg(e.current)){do I(e);while(e_(e.current));let N=ye(e,eT(e.buff));n.ts=N;let C=eU[eA(N)];return void 0!==C&&C<=22?C+257:292}{let n=e.current;return K(e),n}}};e.exports.FIRST_RESERVED=257,e.exports.LUA_ENV=eN,e.exports.LexState=class{constructor(){this.current=NaN,this.linenumber=NaN,this.lastline=NaN,this.t=new de,this.lookahead=new de,this.fs=null,this.L=null,this.z=null,this.buff=null,this.h=null,this.dyd=null,this.source=null,this.envn=null}},e.exports.RESERVED={TK_AND:257,TK_BREAK:258,TK_DO:259,TK_ELSE:260,TK_ELSEIF:261,TK_END:262,TK_FALSE:263,TK_FOR:264,TK_FUNCTION:265,TK_GOTO:266,TK_IF:267,TK_IN:268,TK_LOCAL:269,TK_NIL:270,TK_NOT:271,TK_OR:272,TK_REPEAT:273,TK_RETURN:274,TK_THEN:275,TK_TRUE:276,TK_UNTIL:277,TK_WHILE:278,TK_IDIV:279,TK_CONCAT:280,TK_DOTS:281,TK_EQ:282,TK_GE:283,TK_LE:284,TK_NE:285,TK_SHL:286,TK_SHR:287,TK_DBCOLON:288,TK_EOS:289,TK_FLT:290,TK_INT:291,TK_NAME:292,TK_STRING:293},e.exports.isreserved=function(e){let n=eU[eA(e)];return void 0!==n&&n<=22},e.exports.luaX_lookahead=function(e){return ef(289===e.lookahead.token),e.lookahead.token=S(e,e.lookahead.seminfo),e.lookahead.token},e.exports.luaX_newstring=ye,e.exports.luaX_next=function(e){e.lastline=e.linenumber,289!==e.lookahead.token?(e.t.token=e.lookahead.token,e.t.seminfo.i=e.lookahead.seminfo.i,e.t.seminfo.r=e.lookahead.seminfo.r,e.t.seminfo.ts=e.lookahead.seminfo.ts,e.lookahead.token=289):e.t.token=S(e,e.t.seminfo)},e.exports.luaX_setinput=function(e,n,N,C,et){n.t={token:0,seminfo:new Y},n.L=e,n.current=et,n.lookahead={token:289,seminfo:new Y},n.z=N,n.fs=null,n.linenumber=1,n.lastline=1,n.source=C,n.envn=ev(e,eN),eS(e,n.buff,eu)},e.exports.luaX_syntaxerror=function(e,n){Ze(e,n,e.t.token)},e.exports.luaX_token2str=me,e.exports.luaX_tokens=eI},function(e,n,N){let C,et,ei;let{lua:eo,lauxlib:eu,lualib:ec,to_luastring:ef}=N(0),{LUA_MULTRET:eh,LUA_OK:ep,LUA_REGISTRYINDEX:ed,LUA_RIDX_MAINTHREAD:e_,LUA_TBOOLEAN:eg,LUA_TFUNCTION:em,LUA_TLIGHTUSERDATA:eb,LUA_TNIL:ey,LUA_TNONE:ev,LUA_TNUMBER:ek,LUA_TSTRING:eA,LUA_TTABLE:eL,LUA_TTHREAD:ex,LUA_TUSERDATA:ew,lua_atnativeerror:eT,lua_call:eO,lua_getfield:eE,lua_gettable:eS,lua_gettop:eN,lua_isnil:eI,lua_isproxy:eR,lua_newuserdata:eU,lua_pcall:eC,lua_pop:eM,lua_pushboolean:eP,lua_pushcfunction:eD,lua_pushinteger:eB,lua_pushlightuserdata:eK,lua_pushliteral:eF,lua_pushnil:eV,lua_pushnumber:eG,lua_pushstring:ej,lua_pushvalue:ez,lua_rawgeti:eH,lua_rawgetp:e$,lua_rawsetp:eX,lua_rotate:eq,lua_setfield:eW,lua_settable:eZ,lua_settop:eY,lua_toboolean:eJ,lua_tojsstring:eQ,lua_tonumber:e0,lua_toproxy:e1,lua_tothread:e2,lua_touserdata:e3,lua_type:e5}=eo,{luaL_argerror:e4,luaL_checkany:e8,luaL_checkoption:e6,luaL_checkstack:e9,luaL_checkudata:e7,luaL_error:ta,luaL_getmetafield:ti,luaL_newlib:to,luaL_newmetatable:tl,luaL_requiref:tu,luaL_setfuncs:tc,luaL_setmetatable:tf,luaL_testudata:th,luaL_tolstring:tp}=eu,{luaopen_base:td}=ec,t_="u">typeof window?window:"u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this");if("u">typeof Reflect)C=Reflect.apply,et=Reflect.construct,ei=Reflect.deleteProperty;else{let e=Function.apply,n=Function.bind;C=function(n,N,C){return e.call(n,N,C)},et=function(e,N){switch(N.length){case 0:return new e;case 1:return new e(N[0]);case 2:return new e(N[0],N[1]);case 3:return new e(N[0],N[1],N[2]);case 4:return new e(N[0],N[1],N[2],N[3])}let C=[null];return C.push.apply(C,N),new(n.apply(e,C))},ei=Function("t","k","delete t[k]")}let tg=String.prototype.concat.bind(""),We=function(e){return"object"==typeof e?null!==e:"function"==typeof e},tm=ef("js object"),vt=function(e,n){let N=th(e,n,tm);return N?N.data:void 0},yt=function(e,n){return e7(e,n,tm).data},Rt=function(e,n){eU(e).data=n,tf(e,tm)},lt=function(e){eH(e,ed,e_);let n=e2(e,-1);return eM(e,1),n},tb=new WeakMap,At=function(e,n){switch(typeof n){case"undefined":eV(e);break;case"number":eG(e,n);break;case"string":ej(e,ef(n));break;case"boolean":eP(e,n);break;case"symbol":eK(e,n);break;case"function":if(eR(n,e)){n(e);break}case"object":if(null===n){if(e$(e,ed,null)!==ew)throw Error("js library not loaded into lua_State");break}default:{let N=tb.get(lt(e));if(!N)throw Error("js library not loaded into lua_State");let C=N.get(n);C?C(e):(Rt(e,n),C=e1(e,-1),N.set(n,C))}}},o=function(e){let n=e3(e,1);return At(e,n),1},c=function(e,n){switch(e5(e,n)){case ev:case ey:return;case eg:return eJ(e,n);case eb:return e3(e,n);case ek:return e0(e,n);case eA:return eQ(e,n);case ew:{let N=vt(e,n);if(void 0!==N)return N}default:return J(e,e1(e,n))}},x=function(e,n){let N=eC(e,n,1,0),C=c(e,-1);if(eM(e,1),N===ep)return C;throw C},p=function(e,n,N,C,et){if(!We(C))throw TypeError("`args` argument must be an object");let ei=+C.length;ei>=0||(ei=0),e9(e,2+ei,null);let eo=eN(e);n(e),At(e,N);for(let n=0;n<ei;n++)At(e,C[n]);if(eC(e,1+ei,et,0)===ep){let n=eN(e)-eo,N=Array(n);for(let C=0;C<n;C++)N[C]=c(e,eo+C+1);return eY(e,eo),N}{let n=c(e,-1);throw eY(e,eo),n}},T=function(e){return eS(e,1),1},$=function(e,n,N){return e9(e,3,null),eD(e,T),n(e),At(e,N),x(e,2)},U=function(e,n,N){if(e9(e,3,null),eD(e,T),n(e),At(e,N),eC(e,2,1,0)===ep){let n=eI(e,-1);return eM(e,1),!n}{let n=c(e,-1);throw eM(e,1),n}},pe=function(e,n,N,C){if(e9(e,4,null),eD(e,function(e){return eZ(e,1),0}),n(e),At(e,N),At(e,C),eC(e,3,0,0)!==ep){let n=c(e,-1);throw eM(e,1),n}},He=function(e,n,N){if(e9(e,4,null),eD(e,function(e){return eZ(e,1),0}),n(e),At(e,N),eV(e),eC(e,3,0,0)!==ep){let n=c(e,-1);throw eM(e,1),n}},Qe=function(e,n){return e9(e,2,null),eD(e,function(e){return tp(e,1),1}),n(e),x(e,1)},kt=function(){let e=this.L;e9(e,3,null);let n=eN(e);if(this.iter(e),this.state(e),this.last(e),eC(e,2,eh,0)===ep){let N;if(this.last=e1(e,n+1),eI(e,-1))N={done:!0,value:void 0};else{let C=eN(e)-n,et=Array(C);for(let N=0;N<C;N++)et[N]=c(e,n+N+1);N={done:!1,value:et}}return eY(e,n),N}{let n=c(e,-1);throw eM(e,1),n}},J=function(e,n){let N=lt(e),Me=function(){return p(N,n,this,arguments,1)[0]};Me.apply=function(e,C){return p(N,n,e,C,1)[0]},Me.invoke=function(e,C){return p(N,n,e,C,eh)},Me.get=function(e){return $(N,n,e)},Me.has=function(e){return U(N,n,e)},Me.set=function(e,C){return pe(N,n,e,C)},Me.delete=function(e){return He(N,n,e)},Me.toString=function(){return Qe(N,n)},"function"==typeof Symbol&&(Me[Symbol.toStringTag]="Fengari object",Me[Symbol.iterator]=function(){return function(e,n){if(e9(e,1,null),eD(e,function(e){return tu(e,ef("_G"),td,0),eE(e,-1,ef("pairs")),n(e),eO(e,1,3),3}),eC(e,0,3,0)===ep){let n=e1(e,-3),N=e1(e,-2),C=e1(e,-1);return eM(e,3),{L:e,iter:n,state:N,last:C,next:kt}}{let n=c(e,-1);throw eM(e,1),n}}(N,n)},Symbol.toPrimitive&&(Me[Symbol.toPrimitive]=function(e){if("string"===e)return Qe(N,n)}));let C=tb.get(N);if(!C)throw Error("js library not loaded into lua_State");return C.set(Me,n),Me},ty={new:function(e){let n=c(e,1),N=eN(e)-1,C=Array(N);for(let n=0;n<N;n++)C[n]=c(e,n+2);return At(e,et(n,C)),1},tonumber:function(e){let n=c(e,1);return eG(e,+n),1},tostring:function(e){let n=c(e,1);return eF(e,tg(n)),1},instanceof:function(e){let n=c(e,1),N=c(e,2);return eP(e,n instanceof N),1},typeof:function(e){let n=c(e,1);return eF(e,typeof n),1}};if("function"==typeof Symbol&&Symbol.iterator){let G=function(e,n){let N=yt(e,n),et=N[Symbol.iterator];et||e4(e,n,ef("object not iterable"));let ei=C(et,N,[]);return We(ei)||e4(e,n,ef("Result of the Symbol.iterator method is not an object")),ei},Te=function(e){let n=c(e,1).next();return n.done?0:(At(e,n.value),1)};ty.of=function(e){let n=G(e,1);return eD(e,Te),At(e,n),2}}if("function"==typeof Proxy&&"function"==typeof Symbol){let e=Symbol("lua_State"),n=Symbol("fengari-proxy"),N={apply:function(N,C,et){return p(N[e],N[n],C,et,1)[0]},construct:function(N,C){let et=N[e],ei=N[n],eo=C.length;e9(et,2+eo,null),ei(et);let eu=eN(et);if(ti(et,eu,ef("construct"))===ey)throw eM(et,1),TypeError("not a constructor");eq(et,eu,1);for(let e=0;e<eo;e++)At(et,C[e]);return x(et,1+eo)},defineProperty:function(N,C,et){let ei=N[e],eo=N[n];return e9(ei,4,null),eo(ei),ti(ei,-1,ef("defineProperty"))===ey?(eM(ei,1),!1):(eq(ei,-2,1),At(ei,C),At(ei,et),x(ei,3))},deleteProperty:function(N,C){return He(N[e],N[n],C)},get:function(N,C){return $(N[e],N[n],C)},getOwnPropertyDescriptor:function(N,C){let et=N[e],ei=N[n];if(e9(et,3,null),ei(et),ti(et,-1,ef("getOwnPropertyDescriptor"))!==ey)return eq(et,-2,1),At(et,C),x(et,2);eM(et,1)},getPrototypeOf:function(N){let C=N[e],et=N[n];return e9(C,2,null),et(C),ti(C,-1,ef("getPrototypeOf"))===ey?(eM(C,1),null):(eq(C,-2,1),x(C,1))},has:function(N,C){return U(N[e],N[n],C)},ownKeys:function(N){let C=N[e],et=N[n];if(e9(C,2,null),et(C),ti(C,-1,ef("ownKeys"))===ey)throw eM(C,1),Error("ownKeys unknown for fengari object");return eq(C,-2,1),x(C,1)},set:function(N,C,et){return pe(N[e],N[n],C,et),!0},setPrototypeOf:function(N,C){let et=N[e],ei=N[n];return e9(et,3,null),ei(et),ti(et,-1,ef("setPrototypeOf"))===ey?(eM(et,1),!1):(eq(et,-2,1),At(et,C),x(et,2))}},Me=function(){let e=(function(){}).bind();return delete e.length,delete e.name,e},C=Function("return ()=>void 0;"),ct=function(){let e=C();return delete e.length,delete e.name,e},at=function(C,et,ei){let eo;let eu=lt(C);switch(ei){case"function":eo=Me();break;case"arrow_function":eo=ct();break;case"object":eo={};break;default:throw TypeError("invalid type to createproxy")}return eo[n]=et,eo[e]=eu,new Proxy(eo,N)},et=["function","arrow_function","object"],ei=et.map(e=>ef(e));ty.createproxy=function(e){e8(e,1);let n=et[e6(e,2,ei[0],ei)],N=at(e,e1(e,1),n);return At(e,N),1}}let tv={__index:function(e){let n=yt(e,1),N=c(e,2);return At(e,n[N]),1},__newindex:function(e){let n=yt(e,1),N=c(e,2),C=c(e,3);return void 0===C?ei(n,N):n[N]=C,0},__tostring:function(e){let n=tg(yt(e,1));return ej(e,ef(n)),1},__call:function(e){let n,N=yt(e,1),et=eN(e)-1,ei=Array(Math.max(0,et-1));if(et>0&&(n=c(e,2),et-- >0))for(let n=0;n<et;n++)ei[n]=c(e,n+3);return At(e,C(N,n,ei)),1},__pairs:function(e){let n,N,et,ei,eo=yt(e,1);if("function"!=typeof Symbol||void 0===(n=eo[Symbol.for("__pairs")]))N=function(e){if(this.index>=this.keys.length)return;let n=this.keys[this.index++];return[n,this.object[n]]},et={object:eo,keys:Object.keys(eo),index:0};else{let eu=C(n,eo,[]);void 0===eu&&ta(e,ef("bad '__pairs' result (object with keys 'iter', 'state', 'first' expected)")),void 0===(N=eu.iter)&&ta(e,ef("bad '__pairs' result (object.iter is missing)")),et=eu.state,ei=eu.first}return eD(e,function(){let n=c(e,1),et=c(e,2),ei=C(N,n,[et]);if(void 0===ei)return 0;Array.isArray(ei)||ta(e,ef("bad iterator result (Array or undefined expected)")),e9(e,ei.length,null);for(let n=0;n<ei.length;n++)At(e,ei[n]);return ei.length}),At(e,et),At(e,ei),3},__len:function(e){let n,N=yt(e,1);return At(e,"function"!=typeof Symbol||void 0===(n=N[Symbol.for("__len")])?N.length:C(n,N,[])),1}};e.exports.FENGARI_INTEROP_VERSION="0.1",e.exports.FENGARI_INTEROP_VERSION_NUM=1,e.exports.FENGARI_INTEROP_RELEASE="0.1.2",e.exports.checkjs=yt,e.exports.testjs=vt,e.exports.pushjs=Rt,e.exports.push=At,e.exports.tojs=c,e.exports.luaopen_js=function(e){return tb.set(lt(e),new WeakMap),eT(e,o),to(e,ty),eF(e,"0.1"),eW(e,-2,ef("_VERSION")),eB(e,1),eW(e,-2,ef("_VERSION_NUM")),eF(e,"0.1.2"),eW(e,-2,ef("_RELEASE")),tl(e,tm),tc(e,tv,0),eM(e,1),Rt(e,null),ez(e,-1),eX(e,ed,null),eW(e,-2,ef("null")),At(e,t_),eW(e,-2,ef("global")),1}},function(e,n,N){let{luastring_of:C}=N(1),et=C(0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,22,22,22,22,22,22,22,22,22,22,4,4,4,4,4,4,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,5,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);e.exports.lisdigit=function(e){return(2&et[e+1])!=0},e.exports.lislalnum=function(e){return(3&et[e+1])!=0},e.exports.lislalpha=function(e){return(1&et[e+1])!=0},e.exports.lisprint=function(e){return(4&et[e+1])!=0},e.exports.lisspace=function(e){return(8&et[e+1])!=0},e.exports.lisxdigit=function(e){return(16&et[e+1])!=0}},function(e,n,N){let{LUA_MULTRET:C,to_luastring:et}=N(1),{BinOpr:{OPR_ADD:ei,OPR_AND:eo,OPR_BAND:eu,OPR_BOR:ec,OPR_BXOR:ef,OPR_CONCAT:eh,OPR_DIV:ep,OPR_EQ:ed,OPR_GE:e_,OPR_GT:eg,OPR_IDIV:em,OPR_LE:eb,OPR_LT:ey,OPR_MOD:ev,OPR_MUL:ek,OPR_NE:eA,OPR_NOBINOPR:eL,OPR_OR:ex,OPR_POW:ew,OPR_SHL:eT,OPR_SHR:eO,OPR_SUB:eE},UnOpr:{OPR_BNOT:eS,OPR_LEN:eN,OPR_MINUS:eI,OPR_NOT:eR,OPR_NOUNOPR:eU},NO_JUMP:eC,getinstruction:eM,luaK_checkstack:eP,luaK_codeABC:eD,luaK_codeABx:eB,luaK_codeAsBx:eK,luaK_codek:eF,luaK_concat:eV,luaK_dischargevars:eG,luaK_exp2RK:ej,luaK_exp2anyreg:ez,luaK_exp2anyregup:eH,luaK_exp2nextreg:e$,luaK_exp2val:eX,luaK_fixline:eq,luaK_getlabel:eW,luaK_goiffalse:eZ,luaK_goiftrue:eY,luaK_indexed:eJ,luaK_infix:eQ,luaK_intK:e0,luaK_jump:e1,luaK_jumpto:e2,luaK_nil:e3,luaK_patchclose:e5,luaK_patchlist:e4,luaK_patchtohere:e8,luaK_posfix:e6,luaK_prefix:e9,luaK_reserveregs:e7,luaK_ret:ta,luaK_self:ti,luaK_setlist:to,luaK_setmultret:tl,luaK_setoneret:tu,luaK_setreturns:tc,luaK_storevar:tf,luaK_stringK:th}=N(35),tp=N(8),td=N(13),t_=N(20),{LUAI_MAXCCALLS:tg,MAX_INT:tm,lua_assert:tb}=N(4),ty=N(6),{OpCodesI:{OP_CALL:tv,OP_CLOSURE:tk,OP_FORLOOP:tA,OP_FORPREP:tL,OP_GETUPVAL:tx,OP_MOVE:tw,OP_NEWTABLE:tT,OP_SETTABLE:tO,OP_TAILCALL:tE,OP_TFORCALL:tS,OP_TFORLOOP:tN,OP_VARARG:tI},LFIELDS_PER_FLUSH:tR,SETARG_B:tU,SETARG_C:tC,SET_OPCODE:tM}=N(16),{luaS_eqlngstr:tP,luaS_new:tD,luaS_newliteral:tB}=N(10),tK=N(9),tF=td.Proto,tV=t_.RESERVED,Me=function(e){return e===tG.VCALL||e===tG.VVARARG},tt=function(e,n){return tP(e,n)};let ct=class ct{constructor(){this.previous=null,this.firstlabel=NaN,this.firstgoto=NaN,this.nactvar=NaN,this.upval=NaN,this.isloop=NaN}};let tG={VVOID:0,VNIL:1,VTRUE:2,VFALSE:3,VK:4,VKFLT:5,VKINT:6,VNONRELOC:7,VLOCAL:8,VUPVAL:9,VINDEXED:10,VJMP:11,VRELOCABLE:12,VCALL:13,VVARARG:14};let _t=class _t{constructor(){this.k=NaN,this.u={ival:NaN,nval:NaN,info:NaN,ind:{idx:NaN,t:NaN,vt:NaN}},this.t=NaN,this.f=NaN}to(e){this.k=e.k,this.u=e.u,this.t=e.t,this.f=e.f}};let Bt=class Bt{constructor(){this.f=null,this.prev=null,this.ls=null,this.bl=null,this.pc=NaN,this.lasttarget=NaN,this.jpc=NaN,this.nk=NaN,this.np=NaN,this.firstlocal=NaN,this.nlocvars=NaN,this.nactvar=NaN,this.nups=NaN,this.freereg=NaN}};let gt=class gt{constructor(){this.arr=[],this.n=NaN,this.size=NaN}};let Et=function(e,n){e.t.token=0,t_.luaX_syntaxerror(e,n)},wt=function(e,n){t_.luaX_syntaxerror(e,ty.luaO_pushfstring(e.L,et("%s expected",!0),t_.luaX_token2str(e,n)))},Ct=function(e,n,N,C){let ei,eo,eu,ec;n>N&&(ei=e.ls.L,eu=0===(eo=e.f.linedefined)?et("main function",!0):ty.luaO_pushfstring(ei,et("function at line %d",!0),eo),ec=ty.luaO_pushfstring(ei,et("too many %s (limit is %d) in %s",!0),C,N,eu),t_.luaX_syntaxerror(e.ls,ec))},Mt=function(e,n){return e.t.token===n&&(t_.luaX_next(e),!0)},Zt=function(e,n){e.t.token!==n&&wt(e,n)},Dt=function(e,n){Zt(e,n),t_.luaX_next(e)},qt=function(e,n,N){n||t_.luaX_syntaxerror(e,N)},$t=function(e,n,N,C){Mt(e,n)||(C===e.linenumber?wt(e,n):t_.luaX_syntaxerror(e,ty.luaO_pushfstring(e.L,et("%s expected (to close %s at line %d)"),t_.luaX_token2str(e,n),t_.luaX_token2str(e,N),C)))},j=function(e){Zt(e,tV.TK_NAME);let n=e.t.seminfo.ts;return t_.luaX_next(e),n},Le=function(e,n,N){e.f=e.t=eC,e.k=n,e.u.info=N},Ye=function(e,n,N){Le(n,tG.VK,th(e.fs,N))},Je=function(e,n){Ye(e,n,j(e))},ot=function(e,n){let N,C;let ei=e.fs,eo=e.dyd,eu=((C=(N=e.fs).f).locvars[N.nlocvars]=new ty.LocVar,C.locvars[N.nlocvars].varname=n,N.nlocvars++);Ct(ei,eo.actvar.n+1-ei.firstlocal,200,et("local variables",!0)),eo.actvar.arr[eo.actvar.n]=new class{constructor(){this.idx=NaN}},eo.actvar.arr[eo.actvar.n].idx=eu,eo.actvar.n++},$e=function(e,n){ot(e,t_.luaX_newstring(e,et(n,!0)))},qe=function(e,n){let N=e.ls.dyd.actvar.arr[e.firstlocal+n].idx;return tb(N<e.nlocvars),e.f.locvars[N]},Ge=function(e,n){let N=e.fs;for(N.nactvar=N.nactvar+n;n;n--)qe(N,N.nactvar-n).startpc=N.pc},rt=function(e,n,N){let C=e.f;return Ct(e,e.nups+1,td.MAXUPVAL,et("upvalues",!0)),C.upvalues[e.nups]={instack:N.k===tG.VLOCAL,idx:N.u.info,name:n},e.nups++},ht=function(e,n,N,C){if(null===e)Le(N,tG.VVOID,0);else{let et=function(e,n){for(let N=e.nactvar-1;N>=0;N--)if(tt(n,qe(e,N).varname))return N;return -1}(e,n);if(et>=0)Le(N,tG.VLOCAL,et),C||function(e,n){let N=e.bl;for(;N.nactvar>n;)N=N.previous;N.upval=1}(e,et);else{let C=function(e,n){let N=e.f.upvalues;for(let C=0;C<e.nups;C++)if(tt(N[C].name,n))return C;return -1}(e,n);if(C<0){if(ht(e.prev,n,N,0),N.k===tG.VVOID)return;C=rt(e,n,N)}Le(N,tG.VUPVAL,C)}}},k=function(e,n){let N=j(e),C=e.fs;if(ht(C,N,n,1),n.k===tG.VVOID){let et=new _t;ht(C,e.envn,n,1),tb(n.k!==tG.VVOID),Ye(e,et,N),eJ(C,n,et)}},se=function(e,n,N,C){let et=e.fs,ei=n-N;if(Me(C.k))++ei<0&&(ei=0),tc(et,C,ei),ei>1&&e7(et,ei-1);else if(C.k!==tG.VVOID&&e$(et,C),ei>0){let e=et.freereg;e7(et,ei),e3(et,e,ei)}N>n&&(e.fs.freereg-=N-n)},re=function(e){let n=e.L;++n.nCcalls,Ct(e.fs,n.nCcalls,tg,et("JS levels",!0))},Ee=function(e){return e.L.nCcalls--},Ae=function(e,n,N){let C=e.fs,ei=e.dyd.gt,eo=ei.arr[n];if(tb(tt(eo.name,N.name)),eo.nactvar<N.nactvar){let n=qe(C,eo.nactvar).varname,N=ty.luaO_pushfstring(e.L,et("<goto %s> at line %d jumps into the scope of local '%s'"),eo.name.getstr(),eo.line,n.getstr());Et(e,N)}e4(C,eo.pc,N.pc);for(let e=n;e<ei.n-1;e++)ei.arr[e]=ei.arr[e+1];ei.n--},we=function(e,n){let N=e.fs.bl,C=e.dyd,et=C.gt.arr[n];for(let ei=N.firstlabel;ei<C.label.n;ei++){let eo=C.label.arr[ei];if(tt(eo.name,et.name))return et.nactvar>eo.nactvar&&(N.upval||C.label.n>N.firstlabel)&&e5(e.fs,et.pc,eo.nactvar),Ae(e,n,eo),!0}return!1},ft=function(e,n,N,C,et){let ei=n.n;return n.arr[ei]=new class{constructor(){this.name=null,this.pc=NaN,this.line=NaN,this.nactvar=NaN}},n.arr[ei].name=N,n.arr[ei].line=C,n.arr[ei].nactvar=e.fs.nactvar,n.arr[ei].pc=et,n.n=ei+1,ei},mt=function(e,n){let N=e.dyd.gt,C=e.fs.bl.firstgoto;for(;C<N.n;)tt(N.arr[C].name,n.name)?Ae(e,C,n):C++},Lt=function(e,n,N){n.isloop=N,n.nactvar=e.nactvar,n.firstlabel=e.ls.dyd.label.n,n.firstgoto=e.ls.dyd.gt.n,n.upval=0,n.previous=e.bl,e.bl=n,tb(e.freereg===e.nactvar)},Ut=function(e,n,N){n.prev=e.fs,n.ls=e,e.fs=n,n.pc=0,n.lasttarget=0,n.jpc=eC,n.freereg=0,n.nk=0,n.np=0,n.nups=0,n.nlocvars=0,n.nactvar=0,n.firstlocal=e.dyd.actvar.n,n.bl=null;let C=n.f;C.source=e.source,C.maxstacksize=2,Lt(n,N,!1)},P=function(e){var n;let N,C,ei,eo=e.bl,eu=e.ls;if(eo.previous&&eo.upval){let n=e1(e);e5(e,n,eo.nactvar),e8(e,n)}eo.isloop&&(N=tB(eu.L,"break"),C=ft(eu,eu.dyd.label,N,0,eu.fs.pc),mt(eu,eu.dyd.label.arr[C])),e.bl=eo.previous,function(e,n){for(e.ls.dyd.actvar.n-=e.nactvar-n;e.nactvar>n;)qe(e,--e.nactvar).endpc=e.pc}(e,eo.nactvar),tb(eo.nactvar===e.nactvar),e.freereg=e.nactvar,eu.dyd.label.n=eo.firstlabel,eo.previous?function(e,n){let N=n.firstgoto,C=e.ls.dyd.gt;for(;N<C.n;){let et=C.arr[N];et.nactvar>n.nactvar&&(n.upval&&e5(e,et.pc,n.nactvar),et.nactvar=n.nactvar),we(e.ls,N)||N++}}(e,eo):eo.firstgoto<eu.dyd.gt.n&&(n=eu.dyd.gt.arr[eo.firstgoto],ei=t_.isreserved(n.name)?"<%s> at line %d not inside a loop":"no visible label '%s' for <goto> at line %d",ei=ty.luaO_pushfstring(eu.L,et(ei),n.name.getstr(),n.line),Et(eu,ei))},ne=function(e){let n=e.fs;ta(n,0,0),P(n),tb(null===n.bl),e.fs=n.prev},Re=function(e,n){switch(e.t.token){case tV.TK_ELSE:case tV.TK_ELSEIF:case tV.TK_END:case tV.TK_EOS:return!0;case tV.TK_UNTIL:return n;default:return!1}},it=function(e){for(;!Re(e,1);){if(e.t.token===tV.TK_RETURN)return void Br(e);Br(e)}},Tt=function(e,n){let N=e.fs,C=new _t;eH(N,n),t_.luaX_next(e),Je(e,C),eJ(N,n,C)},jt=function(e,n){t_.luaX_next(e),cn(e,n),eX(e.fs,n),Dt(e,93)},Xt=function(e,n){let N=e.fs,C=e.fs.freereg,ei=new _t,eo=new _t;e.t.token===tV.TK_NAME?(Ct(N,n.nh,tm,et("items in a constructor",!0)),Je(e,ei)):jt(e,ei),n.nh++,Dt(e,61);let eu=ej(N,ei);cn(e,eo),eD(N,tO,n.t.u.info,eu,ej(N,eo)),N.freereg=C},pn=function(e,n){n.v.k!==tG.VVOID&&(e$(e,n.v),n.v.k=tG.VVOID,n.tostore===tR&&(to(e,n.t.u.info,n.na,n.tostore),n.tostore=0))},bn=function(e,n){cn(e,n.v),Ct(e.fs,n.na,tm,et("items in a constructor",!0)),n.na++,n.tostore++},vn=function(e,n){switch(e.t.token){case tV.TK_NAME:61!==t_.luaX_lookahead(e)?bn(e,n):Xt(e,n);break;case 91:Xt(e,n);break;default:bn(e,n)}},ln=function(e,n){let N=e.fs,et=e.linenumber,ei=eD(N,tT,0,0,0),eo=new class{constructor(){this.v=new _t,this.t=new _t,this.nh=NaN,this.na=NaN,this.tostore=NaN}};eo.na=eo.nh=eo.tostore=0,eo.t=n,Le(n,tG.VRELOCABLE,ei),Le(eo.v,tG.VVOID,0),e$(e.fs,n),Dt(e,123);do{if(tb(eo.v.k===tG.VVOID||eo.tostore>0),125===e.t.token)break;pn(N,eo),vn(e,eo)}while(Mt(e,44)||Mt(e,59));$t(e,125,123,et),0!==eo.tostore&&(Me(eo.v.k)?(tl(N,eo.v),to(N,eo.t.u.info,eo.na,C),eo.na--):(eo.v.k!==tG.VVOID&&e$(N,eo.v),to(N,eo.t.u.info,eo.na,eo.tostore))),tU(N.f.code[ei],ty.luaO_int2fb(eo.na)),tC(N.f.code[ei],ty.luaO_int2fb(eo.nh))},zt=function(e,n,N,C){let ei,eo,eu,ec,ef=new Bt,eh=new ct;ef.f=(ei=e.L,eo=new tF(ei),(eu=e.fs).f.p[eu.np++]=eo,eo),ef.f.linedefined=C,Ut(e,ef,eh),Dt(e,40),N&&($e(e,"self"),Ge(e,1)),function(e){let n=e.fs,N=n.f,C=0;if(N.is_vararg=!1,41!==e.t.token)do switch(e.t.token){case tV.TK_NAME:ot(e,j(e)),C++;break;case tV.TK_DOTS:t_.luaX_next(e),N.is_vararg=!0;break;default:t_.luaX_syntaxerror(e,et("<name> or '...' expected",!0))}while(!N.is_vararg&&Mt(e,44));Ge(e,C),N.numparams=n.nactvar,e7(n,n.nactvar)}(e),Dt(e,41),it(e),ef.f.lastlinedefined=e.linenumber,$t(e,tV.TK_END,tV.TK_FUNCTION,C),ec=e.fs.prev,Le(n,tG.VRELOCABLE,eB(ec,tk,0,ec.np-1)),e$(ec,n),ne(e)},un=function(e,n){let N=1;for(cn(e,n);Mt(e,44);)e$(e.fs,n),cn(e,n),N++;return N},ms=function(e,n,N){let ei,eo=e.fs,eu=new _t;switch(e.t.token){case 40:t_.luaX_next(e),41===e.t.token?eu.k=tG.VVOID:(un(e,eu),tl(eo,eu)),$t(e,41,40,N);break;case 123:ln(e,eu);break;case tV.TK_STRING:Ye(e,eu,e.t.seminfo.ts),t_.luaX_next(e);break;default:t_.luaX_syntaxerror(e,et("function arguments expected",!0))}tb(n.k===tG.VNONRELOC);let ec=n.u.info;Me(eu.k)?ei=C:(eu.k!==tG.VVOID&&e$(eo,eu),ei=eo.freereg-(ec+1)),Le(n,tG.VCALL,eD(eo,tv,ec,ei+1,2)),eq(eo,N),eo.freereg=ec+1},Ur=function(e,n){let N=e.fs,C=e.linenumber;for(!function(e,n){switch(e.t.token){case 40:{let N=e.linenumber;return t_.luaX_next(e),cn(e,n),$t(e,41,40,N),void eG(e.fs,n)}case tV.TK_NAME:return void k(e,n);default:t_.luaX_syntaxerror(e,et("unexpected symbol",!0))}}(e,n);;)switch(e.t.token){case 46:Tt(e,n);break;case 91:{let C=new _t;eH(N,n),jt(e,C),eJ(N,n,C);break}case 58:{let et=new _t;t_.luaX_next(e),Je(e,et),ti(N,n,et),ms(e,n,C);break}case 40:case tV.TK_STRING:case 123:e$(N,n),ms(e,n,C);break;default:return}},tj=[{left:10,right:10},{left:10,right:10},{left:11,right:11},{left:11,right:11},{left:14,right:13},{left:11,right:11},{left:11,right:11},{left:6,right:6},{left:4,right:4},{left:5,right:5},{left:7,right:7},{left:7,right:7},{left:9,right:8},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:2,right:2},{left:1,right:1}],Ir=function(e,n,N){re(e);let C=function(e){switch(e){case tV.TK_NOT:return eR;case 45:return eI;case 126:return eS;case 35:return eN;default:return eU}}(e.t.token);if(C!==eU){let N=e.linenumber;t_.luaX_next(e),Ir(e,n,12),e9(e.fs,C,n,N)}else!function(e,n){switch(e.t.token){case tV.TK_FLT:Le(n,tG.VKFLT,0),n.u.nval=e.t.seminfo.r;break;case tV.TK_INT:Le(n,tG.VKINT,0),n.u.ival=e.t.seminfo.i;break;case tV.TK_STRING:Ye(e,n,e.t.seminfo.ts);break;case tV.TK_NIL:Le(n,tG.VNIL,0);break;case tV.TK_TRUE:Le(n,tG.VTRUE,0);break;case tV.TK_FALSE:Le(n,tG.VFALSE,0);break;case tV.TK_DOTS:{let N=e.fs;qt(e,N.f.is_vararg,et("cannot use '...' outside a vararg function",!0)),Le(n,tG.VVARARG,eD(N,tI,0,1,0));break}case 123:return void ln(e,n);case tV.TK_FUNCTION:return t_.luaX_next(e),void zt(e,n,0,e.linenumber);default:return void Ur(e,n)}t_.luaX_next(e)}(e,n);let eC=function(e){switch(e){case 43:return ei;case 45:return eE;case 42:return ek;case 37:return ev;case 94:return ew;case 47:return ep;case tV.TK_IDIV:return em;case 38:return eu;case 124:return ec;case 126:return ef;case tV.TK_SHL:return eT;case tV.TK_SHR:return eO;case tV.TK_CONCAT:return eh;case tV.TK_NE:return eA;case tV.TK_EQ:return ed;case 60:return ey;case tV.TK_LE:return eb;case 62:return eg;case tV.TK_GE:return e_;case tV.TK_AND:return eo;case tV.TK_OR:return ex;default:return eL}}(e.t.token);for(;eC!==eL&&tj[eC].left>N;){let N=new _t,C=e.linenumber;t_.luaX_next(e),eQ(e.fs,eC,n);let et=Ir(e,N,tj[eC].right);e6(e.fs,eC,n,N,C),eC=et}return Ee(e),eC},cn=function(e,n){Ir(e,n,0)},er=function(e){let n=e.fs;Lt(n,new ct,0),it(e),P(n)};let vs=class vs{constructor(){this.prev=null,this.v=new _t}};let ys=function(e,n,N){var C;let ei=new _t;if(qt(e,(C=n.v.k,tG.VLOCAL<=C&&C<=tG.VINDEXED),et("syntax error",!0)),Mt(e,44)){let C=new vs;C.prev=n,Ur(e,C.v),C.v.k!==tG.VINDEXED&&function(e,n,N){let C=e.fs,et=C.freereg,ei=!1;for(;n;n=n.prev)n.v.k===tG.VINDEXED&&(n.v.u.ind.vt===N.k&&n.v.u.ind.t===N.u.info&&(ei=!0,n.v.u.ind.vt=tG.VLOCAL,n.v.u.ind.t=et),N.k===tG.VLOCAL&&n.v.u.ind.idx===N.u.info&&(ei=!0,n.v.u.ind.idx=et));ei&&(eD(C,N.k===tG.VLOCAL?tw:tx,et,N.u.info,0),e7(C,1))}(e,n,C.v),Ct(e.fs,N+e.L.nCcalls,tg,et("JS levels",!0)),ys(e,C,N+1)}else{Dt(e,61);let C=un(e,ei);if(C===N)return tu(e.fs,ei),void tf(e.fs,n.v,ei);se(e,N,C,ei)}Le(ei,tG.VNONRELOC,e.fs.freereg-1),tf(e.fs,n.v,ei)},ks=function(e){let n=new _t;return cn(e,n),n.k===tG.VNIL&&(n.k=tG.VFALSE),eY(e.fs,n),n.f},Ls=function(e,n){let N,C=e.linenumber;Mt(e,tV.TK_GOTO)?N=j(e):(t_.luaX_next(e),N=tB(e.L,"break"));let et=ft(e,e.dyd.gt,N,C,n);we(e,et)},Da=function(e,n,N){let C,ei=e.fs,eo=e.dyd.label;(function(e,n,N){for(let C=e.bl.firstlabel;C<n.n;C++)if(tt(N,n.arr[C].name)){let ei=ty.luaO_pushfstring(e.ls.L,et("label '%s' already defined on line %d",!0),N.getstr(),n.arr[C].line);Et(e.ls,ei)}})(ei,eo,n),Dt(e,tV.TK_DBCOLON),C=ft(e,eo,n,N,eW(ei)),function(e){for(;59===e.t.token||e.t.token===tV.TK_DBCOLON;)Br(e)}(e),Re(e,0)&&(eo.arr[C].nactvar=ei.bl.nactvar),mt(e,eo.arr[C])},Pr=function(e){let n=new _t;return cn(e,n),e$(e.fs,n),tb(n.k===tG.VNONRELOC),n.u.info},As=function(e,n,N,C,et){let ei,eo=new ct,eu=e.fs;Ge(e,3),Dt(e,tV.TK_DO);let ec=et?eK(eu,tL,n,eC):e1(eu);Lt(eu,eo,0),Ge(e,C),e7(eu,C),er(e),P(eu),e8(eu,ec),et?ei=eK(eu,tA,n,eC):(eD(eu,tS,n,0,C),eq(eu,N),ei=eK(eu,tN,n+2,eC)),e4(eu,ei,ec+1),eq(eu,N)},Ga=function(e,n){let N=e.fs;Lt(N,new ct,1),t_.luaX_next(e);let C=j(e);switch(e.t.token){case 61:let ei,eo;eo=(ei=e.fs).freereg,$e(e,"(for index)"),$e(e,"(for limit)"),$e(e,"(for step)"),ot(e,C),Dt(e,61),Pr(e),Dt(e,44),Pr(e),Mt(e,44)?Pr(e):(eF(ei,ei.freereg,e0(ei,1)),e7(ei,1)),As(e,eo,n,1,1);break;case 44:case tV.TK_IN:!function(e,n){let N=e.fs,C=new _t,et=4,ei=N.freereg;for($e(e,"(for generator)"),$e(e,"(for state)"),$e(e,"(for control)"),ot(e,n);Mt(e,44);)ot(e,j(e)),et++;Dt(e,tV.TK_IN);let eo=e.linenumber;se(e,3,un(e,C),C),eP(N,3),As(e,ei,eo,et-3,0)}(e,C);break;default:t_.luaX_syntaxerror(e,et("'=' or 'in' expected",!0))}$t(e,tV.TK_END,tV.TK_FOR,n),P(N)},ws=function(e,n){let N,C=new ct,et=e.fs,ei=new _t;if(t_.luaX_next(e),cn(e,ei),Dt(e,tV.TK_THEN),e.t.token===tV.TK_GOTO||e.t.token===tV.TK_BREAK){for(eZ(e.fs,ei),Lt(et,C,!1),Ls(e,ei.t);Mt(e,59););if(Re(e,0))return P(et),n;N=e1(et)}else eY(e.fs,ei),Lt(et,C,!1),N=ei.f;return it(e),P(et),e.t.token!==tV.TK_ELSE&&e.t.token!==tV.TK_ELSEIF||(n=eV(et,n,e1(et))),e8(et,N),n},Ka=function(e,n){let N=new _t,C=new _t;t_.luaX_next(e);let et=function(e,n){let N=0;for(k(e,n);46===e.t.token;)Tt(e,n);return 58===e.t.token&&(N=1,Tt(e,n)),N}(e,N);zt(e,C,et,n),tf(e.fs,N,C),eq(e.fs,n)},Br=function(e){let n=e.linenumber;switch(re(e),e.t.token){case 59:t_.luaX_next(e);break;case tV.TK_IF:!function(e,n){let N=e.fs,C=eC;for(C=ws(e,C);e.t.token===tV.TK_ELSEIF;)C=ws(e,C);Mt(e,tV.TK_ELSE)&&er(e),$t(e,tV.TK_END,tV.TK_IF,n),e8(N,C)}(e,n);break;case tV.TK_WHILE:let N,ei,eo,eu;N=e.fs,ei=new ct,t_.luaX_next(e),eo=eW(N),eu=ks(e),Lt(N,ei,1),Dt(e,tV.TK_DO),er(e),e2(N,eo),$t(e,tV.TK_END,tV.TK_WHILE,n),P(N),e8(N,eu);break;case tV.TK_DO:t_.luaX_next(e),er(e),$t(e,tV.TK_END,tV.TK_DO,n);break;case tV.TK_FOR:Ga(e,n);break;case tV.TK_REPEAT:let ec,ef,eh,ep,ed;ef=eW(ec=e.fs),eh=new ct,ep=new ct,Lt(ec,eh,1),Lt(ec,ep,0),t_.luaX_next(e),it(e),$t(e,tV.TK_UNTIL,tV.TK_REPEAT,n),ed=ks(e),ep.upval&&e5(ec,ed,ep.nactvar),P(ec),e4(ec,ed,ef),P(ec);break;case tV.TK_FUNCTION:Ka(e,n);break;case tV.TK_LOCAL:let e_,eg;t_.luaX_next(e),Mt(e,tV.TK_FUNCTION)?(e_=new _t,eg=e.fs,ot(e,j(e)),Ge(e,1),zt(e,e_,0,e.linenumber),qe(eg,e_.u.info).startpc=eg.pc):function(e){let n,N=0,C=new _t;do ot(e,j(e)),N++;while(Mt(e,44));Mt(e,61)?n=un(e,C):(C.k=tG.VVOID,n=0),se(e,N,n,C),Ge(e,N)}(e);break;case tV.TK_DBCOLON:t_.luaX_next(e),Da(e,j(e),n);break;case tV.TK_RETURN:let em,eb,ey,ev;t_.luaX_next(e),ey=e.fs,ev=new _t,Re(e,1)||59===e.t.token?em=eb=0:(eb=un(e,ev),Me(ev.k)?(tl(ey,ev),ev.k===tG.VCALL&&1===eb&&(tM(eM(ey,ev),tE),tb(eM(ey,ev).A===ey.nactvar)),em=ey.nactvar,eb=C):1===eb?em=ez(ey,ev):(e$(ey,ev),em=ey.nactvar,tb(eb===ey.freereg-em))),ta(ey,em,eb),Mt(e,59);break;case tV.TK_BREAK:case tV.TK_GOTO:Ls(e,e1(e.fs));break;default:let ek,eA;ek=e.fs,Ur(e,(eA=new vs).v),61===e.t.token||44===e.t.token?(eA.prev=null,ys(e,eA,1)):(qt(e,eA.v.k===tG.VCALL,et("syntax error",!0)),tC(eM(ek,eA.v),1))}tb(e.fs.f.maxstacksize>=e.fs.freereg&&e.fs.freereg>=e.fs.nactvar),e.fs.freereg=e.fs.nactvar,Ee(e)};e.exports.Dyndata=class{constructor(){this.actvar={arr:[],n:NaN,size:NaN},this.gt=new gt,this.label=new gt}},e.exports.expkind=tG,e.exports.expdesc=_t,e.exports.luaY_parser=function(e,n,N,C,et,ei){let eo,eu,ec=new t_.LexState,ef=new Bt,eh=td.luaF_newLclosure(e,1);return tp.luaD_inctop(e),e.stack[e.top-1].setclLvalue(eh),ec.h=tK.luaH_new(e),tp.luaD_inctop(e),e.stack[e.top-1].sethvalue(ec.h),ef.f=eh.p=new tF(e),ef.f.source=tD(e,et),ec.buff=N,ec.dyd=C,C.actvar.n=C.gt.n=C.label.n=0,t_.luaX_setinput(e,ec,n,ef.f.source,ei),eo=new ct,eu=new _t,Ut(ec,ef,eo),ef.f.is_vararg=!0,Le(eu,tG.VLOCAL,0),rt(ef,ec.envn,eu),t_.luaX_next(ec),it(ec),Zt(ec,tV.TK_EOS),ne(ec),tb(!ef.prev&&1===ef.nups&&!ec.fs),tb(0===C.actvar.n&&0===C.gt.n&&0===C.label.n),delete e.stack[--e.top],eh},e.exports.vkisinreg=function(e){return e===tG.VNONRELOC||e===tG.VLOCAL}},function(e,n,N){let C,et;let{LUA_MULTRET:ei,LUA_OK:eo,LUA_TFUNCTION:eu,LUA_TNIL:ec,LUA_TNONE:ef,LUA_TNUMBER:eh,LUA_TSTRING:ep,LUA_TTABLE:ed,LUA_VERSION:e_,LUA_YIELD:eg,lua_call:em,lua_callk:eb,lua_concat:ey,lua_error:ev,lua_getglobal:ek,lua_geti:eA,lua_getmetatable:eL,lua_gettop:ex,lua_insert:ew,lua_isnil:eT,lua_isnone:eO,lua_isstring:eE,lua_load:eS,lua_next:eN,lua_pcallk:eI,lua_pop:eR,lua_pushboolean:eU,lua_pushcfunction:eC,lua_pushglobaltable:eM,lua_pushinteger:eP,lua_pushliteral:eD,lua_pushnil:eB,lua_pushstring:eK,lua_pushvalue:eF,lua_rawequal:eV,lua_rawget:eG,lua_rawlen:ej,lua_rawset:ez,lua_remove:eH,lua_replace:e$,lua_rotate:eX,lua_setfield:eq,lua_setmetatable:eW,lua_settop:eZ,lua_setupvalue:eY,lua_stringtonumber:eJ,lua_toboolean:eQ,lua_tolstring:e0,lua_tostring:e1,lua_type:e2,lua_typename:e3}=N(2),{luaL_argcheck:e5,luaL_checkany:e4,luaL_checkinteger:e8,luaL_checkoption:e6,luaL_checkstack:e9,luaL_checktype:e7,luaL_error:ta,luaL_getmetafield:ti,luaL_loadbufferx:to,luaL_loadfile:tl,luaL_loadfilex:tu,luaL_optinteger:tc,luaL_optstring:tf,luaL_setfuncs:th,luaL_tolstring:tp,luaL_where:td}=N(7),{to_jsstring:t_,to_luastring:tg}=N(5);if("function"==typeof TextDecoder){let e="",n=new TextDecoder("utf-8");C=function(N){e+=n.decode(N,{stream:!0})};let N=new Uint8Array(0);et=function(){console.log(e+=n.decode(N)),e=""}}else{let e=[];C=function(n){try{n=t_(n)}catch{let e=new Uint8Array(n.length);e.set(n),n=e}e.push(n)},et=function(){console.log.apply(console.log,e),e=[]}}let tm=["stop","restart","collect","count","step","setpause","setstepmul","isrunning"].map(e=>tg(e)),bt=function(e){return e7(e,1,ed),eZ(e,2),eN(e,1)?2:(eB(e),1)},vt=function(e){let n=e8(e,2)+1;return eP(e,n),eA(e,1,n)===ec?1:2},yt=function(e){let n=tc(e,2,1);return eZ(e,1),e2(e,1)===ep&&n>0&&(td(e,n),eF(e,1),ey(e,2)),ev(e)},Rt=function(e,n,N){return n!==eo&&n!==eg?(eU(e,0),eF(e,-2),2):ex(e)-N},lt=function(e,n,N){return n===eo?(0!==N&&(eF(e,N),eY(e,-2,1)||eR(e,1)),1):(eB(e),ew(e,-2),2)},pt=function(e,n){return e9(e,2,"too many nested functions"),eF(e,1),em(e,0,1),eT(e,-1)?(eR(e,1),null):(eE(e,-1)||ta(e,tg("reader function must return a string")),e$(e,5),e1(e,5))},At=function(e,n,N){return ex(e)-1},tb={assert:function(e){return eQ(e,1)?ex(e):(e4(e,1),eH(e,1),eD(e,"assertion failed!"),eZ(e,1),yt(e))},collectgarbage:function(e){e6(e,1,"collect",tm),tc(e,2,0),ta(e,tg("lua_gc not implemented"))},dofile:function(e){let n=tf(e,1,null);return eZ(e,1),tl(e,n)!==eo?ev(e):(eb(e,0,ei,0,At),At(e))},error:yt,getmetatable:function(e){return e4(e,1),eL(e,1)?ti(e,1,tg("__metatable",!0)):eB(e),1},ipairs:function(e){return e4(e,1),eC(e,vt),eF(e,1),eP(e,0),3},load:function(e){let n,N=e1(e,1),C=tf(e,3,"bt"),et=eO(e,4)?0:4;if(null!==N){let et=tf(e,2,N);n=to(e,N,N.length,et,C)}else{let N=tf(e,2,"=(load)");e7(e,1,eu),eZ(e,5),n=eS(e,pt,null,N,C)}return lt(e,n,et)},loadfile:function(e){let n=tf(e,1,null),N=tf(e,2,null),C=eO(e,3)?0:3,et=tu(e,n,N);return lt(e,et,C)},next:bt,pairs:function(e){var n;return n=tg("__pairs",!0),e4(e,1),ti(e,1,n)===ec?(eC(e,bt),eF(e,1),eB(e)):(eF(e,1),em(e,1,3)),3},pcall:function(e){e4(e,1),eU(e,1),ew(e,1);let n=eI(e,ex(e)-2,ei,0,0,Rt);return Rt(e,n,0)},print:function(e){let n=ex(e);ek(e,tg("tostring",!0));for(let N=1;N<=n;N++){eF(e,-1),eF(e,N),em(e,1,1);let n=e0(e,-1);if(null===n)return ta(e,tg("'tostring' must return a string to 'print'"));N>1&&C(tg("	")),C(n),eR(e,1)}return et(),0},rawequal:function(e){return e4(e,1),e4(e,2),eU(e,eV(e,1,2)),1},rawget:function(e){return e7(e,1,ed),e4(e,2),eZ(e,2),eG(e,1),1},rawlen:function(e){let n=e2(e,1);return e5(e,n===ed||n===ep,1,"table or string expected"),eP(e,ej(e,1)),1},rawset:function(e){return e7(e,1,ed),e4(e,2),e4(e,3),eZ(e,3),ez(e,1),1},select:function(e){let n=ex(e);if(e2(e,1)===ep&&35===e1(e,1)[0])return eP(e,n-1),1;{let N=e8(e,1);return N<0?N=n+N:N>n&&(N=n),e5(e,1<=N,1,"index out of range"),n-N}},setmetatable:function(e){let n=e2(e,2);return e7(e,1,ed),e5(e,n===ec||n===ed,2,"nil or table expected"),ti(e,1,tg("__metatable",!0))!==ec?ta(e,tg("cannot change a protected metatable")):(eZ(e,2),eW(e,1),1)},tonumber:function(e){if(0>=e2(e,2)){if(e4(e,1),e2(e,1)===eh)return eZ(e,1),1;{let n=e1(e,1);if(null!==n&&eJ(e,n)===n.length+1)return 1}}else{let n=e8(e,2);e7(e,1,ep);let N=e1(e,1);e5(e,2<=n&&n<=36,2,"base out of range");let C=function(e,n){try{e=t_(e)}catch{return null}let N=/^[\t\v\f \n\r]*([+-]?)0*([0-9A-Za-z]+)[\t\v\f \n\r]*$/.exec(e);if(!N)return null;let C=parseInt(N[1]+N[2],n);return isNaN(C)?null:0|C}(N,n);if(null!==C)return eP(e,C),1}return eB(e),1},tostring:function(e){return e4(e,1),tp(e,1),1},type:function(e){let n=e2(e,1);return e5(e,n!==ef,1,"value expected"),eK(e,e3(e,n)),1},xpcall:function(e){let n=ex(e);e7(e,2,eu),eU(e,1),eF(e,1),eX(e,3,2);let N=eI(e,n-2,ei,2,2,Rt);return Rt(e,N,2)}};e.exports.luaopen_base=function(e){return eM(e),th(e,tb,0),eF(e,-1),eq(e,-2,tg("_G")),eD(e,e_),eq(e,-2,tg("_VERSION")),1}},function(e,n,N){let{LUA_OK:C,LUA_TFUNCTION:et,LUA_TSTRING:ei,LUA_YIELD:eo,lua_Debug:eu,lua_checkstack:ec,lua_concat:ef,lua_error:eh,lua_getstack:ep,lua_gettop:ed,lua_insert:e_,lua_isyieldable:eg,lua_newthread:em,lua_pop:eb,lua_pushboolean:ey,lua_pushcclosure:ev,lua_pushliteral:ek,lua_pushthread:eA,lua_pushvalue:eL,lua_resume:ex,lua_status:ew,lua_tothread:eT,lua_type:eO,lua_upvalueindex:eE,lua_xmove:eS,lua_yield:eN}=N(2),{luaL_argcheck:eI,luaL_checktype:eR,luaL_newlib:eU,luaL_where:eC}=N(7),_e=function(e){let n=eT(e,1);return eI(e,n,1,"thread expected"),n},me=function(e,n,N){if(!ec(n,N))return ek(e,"too many arguments to resume"),-1;if(ew(n)===C&&0===ed(n))return ek(e,"cannot resume dead coroutine"),-1;eS(e,n,N);let et=ex(n,e,N);if(et===C||et===eo){let N=ed(n);return ec(e,N+1)?(eS(n,e,N),N):(eb(n,N),ek(e,"too many results to resume"),-1)}return eS(n,e,1),-1},ve=function(e){let n=eT(e,eE(1)),N=me(e,n,ed(e));return N<0?(eO(e,-1)===ei&&(eC(e,1),e_(e,-2),ef(e,2)),eh(e)):N},K=function(e){eR(e,1,et);let n=em(e);return eL(e,1),eS(e,n,1),1},eM={create:K,isyieldable:function(e){return ey(e,eg(e)),1},resume:function(e){let n=_e(e),N=me(e,n,ed(e)-1);return N<0?(ey(e,0),e_(e,-2),2):(ey(e,1),e_(e,-(N+1)),N+1)},running:function(e){return ey(e,eA(e)),2},status:function(e){let n=_e(e);if(e===n)ek(e,"running");else switch(ew(n)){case eo:ek(e,"suspended");break;case C:ep(n,0,new eu)>0?ek(e,"normal"):0===ed(n)?ek(e,"dead"):ek(e,"suspended");break;default:ek(e,"dead")}return 1},wrap:function(e){return K(e),ev(e,ve,1),1},yield:function(e){return eN(e,ed(e))}};e.exports.luaopen_coroutine=function(e){return eU(e,eM),1}},function(e,n,N){let{LUA_MAXINTEGER:C}=N(3),{LUA_OPEQ:et,LUA_OPLT:ei,LUA_TFUNCTION:eo,LUA_TNIL:eu,LUA_TTABLE:ec,lua_call:ef,lua_checkstack:eh,lua_compare:ep,lua_createtable:ed,lua_geti:e_,lua_getmetatable:eg,lua_gettop:em,lua_insert:eb,lua_isnil:ey,lua_isnoneornil:ev,lua_isstring:ek,lua_pop:eA,lua_pushinteger:eL,lua_pushnil:ex,lua_pushstring:ew,lua_pushvalue:eT,lua_rawget:eO,lua_setfield:eE,lua_seti:eS,lua_settop:eN,lua_toboolean:eI,lua_type:eR}=N(2),{luaL_Buffer:eU,luaL_addlstring:eC,luaL_addvalue:eM,luaL_argcheck:eP,luaL_buffinit:eD,luaL_checkinteger:eB,luaL_checktype:eK,luaL_error:eF,luaL_len:eV,luaL_newlib:eG,luaL_opt:ej,luaL_optinteger:ez,luaL_optlstring:eH,luaL_pushresult:e$,luaL_typename:eX}=N(7),eq=N(17),{to_luastring:eW}=N(5),xe=function(e,n,N){return ew(e,n),eO(e,-N)!==eu},ze=function(e,n,N){if(eR(e,n)!==ec){let C=1;eg(e,n)&&(!(1&N)||xe(e,eW("__index",!0),++C))&&(!(2&N)||xe(e,eW("__newindex",!0),++C))&&(!(4&N)||xe(e,eW("__len",!0),++C))?eA(e,C):eK(e,n,ec)}},g=function(e,n,N){return ze(e,n,4|N),eV(e,n)},ge=function(e,n,N){e_(e,1,N),ek(e,-1)||eF(e,eW("invalid value (%s) at index %d in table for 'concat'"),eX(e,-1),N),eM(n)},te=function(e,n,N){eS(e,1,n),eS(e,1,N)},A=function(e,n,N){if(ey(e,2))return ep(e,n,N,ei);{eT(e,2),eT(e,n-1),eT(e,N-2),ef(e,2,1);let C=eI(e,-1);return eA(e,1),C}},S=function(e,n,N){let C=n,et=N-1;for(;;){for(;e_(e,1,++C),A(e,-1,-2);)C==N-1&&eF(e,eW("invalid order function for sorting")),eA(e,1);for(;e_(e,1,--et),A(e,-3,-1);)et<C&&eF(e,eW("invalid order function for sorting")),eA(e,1);if(et<C)return eA(e,1),te(e,N-1,C),C;te(e,C,et)}},v=function(e,n,N){let C=Math.floor((n-e)/4),et=N%(2*C)+(e+C);return eq.lua_assert(e+C<=et&&et<=n-C),et},q=function(e,n,N,C){for(;n<N;){let et,ei;if(e_(e,1,n),e_(e,1,N),A(e,-1,-2)?te(e,n,N):eA(e,2),N-n==1||(e_(e,1,et=N-n<100||0===C?Math.floor((n+N)/2):v(n,N,C)),e_(e,1,n),A(e,-2,-1)?te(e,et,n):(eA(e,1),e_(e,1,N),A(e,-1,-2)?te(e,et,N):eA(e,2)),N-n==2))return;e_(e,1,et),eT(e,-1),e_(e,1,N-1),te(e,et,N-1),(et=S(e,n,N))-n<N-et?(q(e,n,et-1,C),ei=et-n,n=et+1):(q(e,et+1,N,C),ei=N-et,N=et-1),(N-n)/128>ei&&(C=Math.floor(4294967296*Math.random()))}},eZ={concat:function(e){let n=g(e,1,1),N=eH(e,2,""),C=N.length,et=ez(e,3,1);n=ez(e,4,n);let ei=new eU;for(eD(e,ei);et<n;et++)ge(e,ei,et),eC(ei,N,C);return et===n&&ge(e,ei,et),e$(ei),1},insert:function(e){let n,N=g(e,1,3)+1;switch(em(e)){case 2:n=N;break;case 3:n=eB(e,2),eP(e,1<=n&&n<=N,2,"position out of bounds");for(let C=N;C>n;C--)e_(e,1,C-1),eS(e,1,C);break;default:return eF(e,"wrong number of arguments to 'insert'")}return eS(e,1,n),0},move:function(e){let n=eB(e,2),N=eB(e,3),ei=eB(e,4),eo=ev(e,5)?1:5;if(ze(e,1,1),ze(e,eo,2),N>=n){eP(e,n>0||N<C+n,3,"too many elements to move");let eu=N-n+1;if(eP(e,ei<=C-eu+1,4,"destination wrap around"),ei>N||ei<=n||1!==eo&&1!==ep(e,1,eo,et))for(let N=0;N<eu;N++)e_(e,1,n+N),eS(e,eo,ei+N);else for(let N=eu-1;N>=0;N--)e_(e,1,n+N),eS(e,eo,ei+N)}return eT(e,eo),1},pack:function(e){let n=em(e);ed(e,n,1),eb(e,1);for(let N=n;N>=1;N--)eS(e,1,N);return eL(e,n),eE(e,1,eW("n")),1},remove:function(e){let n=g(e,1,3),N=ez(e,2,n);for(N!==n&&eP(e,1<=N&&N<=n+1,1,"position out of bounds"),e_(e,1,N);N<n;N++)e_(e,1,N+1),eS(e,1,N);return ex(e),eS(e,1,N),1},sort:function(e){let n=g(e,1,3);return n>1&&(eP(e,n<C,1,"array too big"),ev(e,2)||eK(e,2,eo),eN(e,2),q(e,1,n,0)),0},unpack:function(e){let n=ez(e,2,1),N=ej(e,eB,3,eV(e,1));if(n>N)return 0;let C=N-n;if(C>=Number.MAX_SAFE_INTEGER||!eh(e,++C))return eF(e,eW("too many results to unpack"));for(;n<N;n++)e_(e,1,n);return e_(e,1,N),C}};e.exports.luaopen_table=function(e){return eG(e,eZ),1}},function(e,n,N){let{LUA_TNIL:C,LUA_TTABLE:et,lua_close:ei,lua_createtable:eo,lua_getfield:eu,lua_isboolean:ec,lua_isnoneornil:ef,lua_pop:eh,lua_pushboolean:ep,lua_pushfstring:ed,lua_pushinteger:e_,lua_pushliteral:eg,lua_pushnil:em,lua_pushnumber:eb,lua_pushstring:ey,lua_setfield:ev,lua_settop:ek,lua_toboolean:eA,lua_tointegerx:eL}=N(2),{luaL_Buffer:ex,luaL_addchar:ew,luaL_addstring:eT,luaL_argerror:eO,luaL_buffinit:eE,luaL_checkinteger:eS,luaL_checkstring:eN,luaL_checktype:eI,luaL_error:eR,luaL_execresult:eU,luaL_fileresult:eC,luaL_newlib:eM,luaL_optinteger:eP,luaL_optlstring:eD,luaL_optstring:eB,luaL_pushresult:eK}=N(7),{luastring_eq:eF,to_jsstring:eV,to_luastring:eG}=N(5),ej=eG("aAbBcCdDeFhHIjklmMnpPrRStTuUwWxXyYzZ%"),Xe=function(e,n,N){e_(e,N),ev(e,-2,eG(n,!0))},st=function(e,n,N){Xe(e,"sec",N?n.getUTCSeconds():n.getSeconds()),Xe(e,"min",N?n.getUTCMinutes():n.getMinutes()),Xe(e,"hour",N?n.getUTCHours():n.getHours()),Xe(e,"day",N?n.getUTCDate():n.getDate()),Xe(e,"month",(N?n.getUTCMonth():n.getMonth())+1),Xe(e,"year",N?n.getUTCFullYear():n.getFullYear()),Xe(e,"wday",(N?n.getUTCDay():n.getDay())+1),Xe(e,"yday",Math.floor((n-new Date(n.getFullYear(),0,0))/864e5))},ez=Number.MAX_SAFE_INTEGER/2,ae=function(e,n,N,et){let ei=eu(e,-1,eG(n,!0)),eo=eL(e,-1);if(!1===eo){if(ei!==C)return eR(e,eG("field '%s' is not an integer"),n);if(N<0)return eR(e,eG("field '%s' missing in date table"),n);eo=N}else{if(!(-ez<=eo&&eo<=ez))return eR(e,eG("field '%s' is out-of-bound"),n);eo-=et}return eh(e,1),eo},eH={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(e=>eG(e)),shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>eG(e)),months:["January","February","March","April","May","June","July","August","September","October","November","December"].map(e=>eG(e)),shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>eG(e)),AM:eG("AM"),PM:eG("PM"),am:eG("am"),pm:eG("pm"),formats:{c:eG("%a %b %e %H:%M:%S %Y"),D:eG("%m/%d/%y"),F:eG("%Y-%m-%d"),R:eG("%H:%M"),r:eG("%I:%M:%S %p"),T:eG("%H:%M:%S"),X:eG("%T"),x:eG("%D")}},Pe=function(e,n){let N=e.getDay();return"monday"===n&&(0===N?N=6:N--),Math.floor(((e-new Date(e.getFullYear(),0,1))/864e5+7-N)/7)},xe=function(e,n,N){n<10&&ew(e,N),eT(e,eG(String(n)))},ze=function(e,n,N,C){let et=0;for(;et<N.length;)if(37!==N[et])ew(n,N[et++]);else{let ei=g(e,N,++et);switch(N[et]){case 37:ew(n,37);break;case 65:eT(n,eH.days[C.getDay()]);break;case 66:eT(n,eH.months[C.getMonth()]);break;case 67:xe(n,Math.floor(C.getFullYear()/100),48);break;case 68:ze(e,n,eH.formats.D,C);break;case 70:ze(e,n,eH.formats.F,C);break;case 72:xe(n,C.getHours(),48);break;case 73:xe(n,(C.getHours()+11)%12+1,48);break;case 77:xe(n,C.getMinutes(),48);break;case 80:eT(n,12>C.getHours()?eH.am:eH.pm);break;case 82:ze(e,n,eH.formats.R,C);break;case 83:xe(n,C.getSeconds(),48);break;case 84:ze(e,n,eH.formats.T,C);break;case 85:xe(n,Pe(C,"sunday"),48);break;case 87:xe(n,Pe(C,"monday"),48);break;case 88:ze(e,n,eH.formats.X,C);break;case 89:eT(n,eG(String(C.getFullYear())));break;case 90:{let e=C.toString().match(/\(([\w\s]+)\)/);e&&eT(n,eG(e[1]));break}case 97:eT(n,eH.shortDays[C.getDay()]);break;case 98:case 104:eT(n,eH.shortMonths[C.getMonth()]);break;case 99:ze(e,n,eH.formats.c,C);break;case 100:xe(n,C.getDate(),48);break;case 101:xe(n,C.getDate(),32);break;case 106:{let e=Math.floor((C-new Date(C.getFullYear(),0,1))/864e5);e<100&&(e<10&&ew(n,48),ew(n,48)),eT(n,eG(String(e)));break}case 107:xe(n,C.getHours(),32);break;case 108:xe(n,(C.getHours()+11)%12+1,32);break;case 109:xe(n,C.getMonth()+1,48);break;case 110:ew(n,10);break;case 112:eT(n,12>C.getHours()?eH.AM:eH.PM);break;case 114:ze(e,n,eH.formats.r,C);break;case 115:eT(n,eG(String(Math.floor(C/1e3))));break;case 116:ew(n,8);break;case 117:{let e=C.getDay();eT(n,eG(String(0===e?7:e)));break}case 119:eT(n,eG(String(C.getDay())));break;case 120:ze(e,n,eH.formats.x,C);break;case 121:xe(n,C.getFullYear()%100,48);break;case 122:{let e=C.getTimezoneOffset();e>0?ew(n,45):(e=-e,ew(n,43)),xe(n,Math.floor(e/60),48),xe(n,e%60,48)}}et+=ei}},g=function(e,n,N){let C=0,et=1;for(;C<ej.length&&et<=n.length-N;C+=et)if(124===ej[C])et++;else if(eF(n.subarray(N,N+et),ej.subarray(C,C+et)))return et;eO(e,1,ed(e,eG("invalid conversion specifier '%%%s'"),n))},ge=function(e,n){return eS(e,n)},e$={date:function(e){let n=eD(e,1,"%c"),N=ef(e,2)?new Date:new Date(1e3*ge(e,2)),C=!1,et=0;if(33===n[0]&&(C=!0,et++),42===n[et]&&116===n[et+1])eo(e,0,9),st(e,N,C);else{new Uint8Array(4)[0]=37;let C=new ex;eE(e,C),ze(e,C,n,N),eK(C)}return 1},difftime:function(e){let n=ge(e,1),N=ge(e,2);return eb(e,n-N),1},time:function(e){let n;return ef(e,1)?n=new Date:(eI(e,1,et),ek(e,1),n=new Date(ae(e,"year",-1,0),ae(e,"month",-1,1),ae(e,"day",-1,0),ae(e,"hour",12,0),ae(e,"min",0,0),ae(e,"sec",0,0)),st(e,n)),e_(e,Math.floor(n/1e3)),1},clock:function(e){return eb(e,performance.now()/1e3),1}};e.exports.luaopen_os=function(e){return eM(e,e$),1}},function(e,n,N){let{sprintf:C}=N(38),{LUA_INTEGER_FMT:et,LUA_INTEGER_FRMLEN:ei,LUA_MININTEGER:eo,LUA_NUMBER_FMT:eu,LUA_NUMBER_FRMLEN:ec,frexp:ef,lua_getlocaledecpoint:eh}=N(3),{LUA_TBOOLEAN:ep,LUA_TFUNCTION:ed,LUA_TNIL:e_,LUA_TNUMBER:eg,LUA_TSTRING:em,LUA_TTABLE:eb,lua_call:ey,lua_createtable:ev,lua_dump:ek,lua_gettable:eA,lua_gettop:eL,lua_isinteger:ex,lua_isstring:ew,lua_pop:eT,lua_pushcclosure:eO,lua_pushinteger:eE,lua_pushlightuserdata:eS,lua_pushliteral:eN,lua_pushlstring:eI,lua_pushnil:eR,lua_pushnumber:eU,lua_pushstring:eC,lua_pushvalue:eM,lua_remove:eP,lua_setfield:eD,lua_setmetatable:eB,lua_settop:eK,lua_toboolean:eF,lua_tointeger:eV,lua_tonumber:eG,lua_tostring:ej,lua_touserdata:ez,lua_type:eH,lua_upvalueindex:e$}=N(2),{luaL_Buffer:eX,luaL_addchar:eq,luaL_addlstring:eW,luaL_addsize:eZ,luaL_addstring:eY,luaL_addvalue:eJ,luaL_argcheck:eQ,luaL_argerror:e0,luaL_buffinit:e1,luaL_buffinitsize:e2,luaL_checkinteger:e3,luaL_checknumber:e5,luaL_checkstack:e4,luaL_checkstring:e8,luaL_checktype:e6,luaL_error:e9,luaL_newlib:e7,luaL_optinteger:ta,luaL_optstring:ti,luaL_prepbuffsize:to,luaL_pushresult:tl,luaL_pushresultsize:tu,luaL_tolstring:tc,luaL_typename:tf}=N(7),th=N(17),{luastring_eq:tp,luastring_indexOf:td,to_jsstring:t_,to_luastring:tg}=N(5),bt=function(e){let n=td(e,0);return n>-1?n:e.length},vt=function(e,n){return e>=0?e:0-e>n?0:n+e+1},yt=function(e,n,N,C){return eW(C,n,N),0},tm=ec.length+1,lt=function(e,n,N){let et=function(e){if(Object.is(e,1/0))return tg("inf");if(Object.is(e,-1/0))return tg("-inf");if(Number.isNaN(e))return tg("nan");if(0===e){let n=C(eu+"x0p+0",e);return Object.is(e,-0)&&(n="-"+n),tg(n)}{let n="",N=ef(e),et=N[0],ei=N[1];return et<0&&(n+="-",et=-et),tg(n+="0x"+(2*et).toString(16)+C("p%+d",ei-=1))}}(N);if(65===n[tm])for(let e=0;e<et.length;e++){let n=et[e];n>=97&&(et[e]=223&n)}else 97!==n[tm]&&e9(e,tg("modifiers for format '%%a'/'%%A' not implemented"));return et},tb=tg("-+ #0"),At=e=>97<=e&&e<=122||65<=e&&e<=90,o=e=>48<=e&&e<=57,c=e=>0<=e&&e<=31||127===e,x=e=>33<=e&&e<=126,p=e=>97<=e&&e<=122,T=e=>65<=e&&e<=90,$=e=>97<=e&&e<=122||65<=e&&e<=90||48<=e&&e<=57,U=e=>x(e)&&!$(e),pe=e=>32===e||e>=9&&e<=13,He=e=>48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102,Qe=function(e,n,N){switch(eH(e,N)){case em:{let C=ej(e,N);!function(e,n,N){eq(e,34);let C=0;for(;N--;){if(34===n[C]||92===n[C]||10===n[C])eq(e,92),eq(e,n[C]);else if(c(n[C])){let N=""+n[C];o(n[C+1])&&(N="0".repeat(3-N.length)+N),eY(e,tg("\\"+N))}else eq(e,n[C]);C++}eq(e,34)}(n,C,C.length);break}case eg:{let eu;if(ex(e,N)){let n=eV(e,N);eu=tg(C(n===eo?"0x%"+ei+"x":et,n))}else{let n=eG(e,N);!function(e){if(0>td(e,46)){let n=td(e,eh());n&&(e[n]=46)}}(eu=lt(e,tg(`%${ei}a`),n))}eY(n,eu);break}case e_:case ep:tc(e,N),eJ(n);break;default:e0(e,N,tg("value has no literal form"))}},kt=function(e,n,N,C){let et=N;for(;0!==n[et]&&td(tb,n[et])>=0;)et++;et-N>=tb.length&&e9(e,tg("invalid format (repeated flags)")),o(n[et])&&et++,o(n[et])&&et++,46===n[et]&&(o(n[++et])&&et++,o(n[et])&&et++),o(n[et])&&e9(e,tg("invalid format (width or precision too long)")),C[0]=37;for(let e=0;e<et-N+1;e++)C[e+1]=n[N+e];return et},J=function(e,n){let N=e.length,C=n.length,et=e[N-1];for(let et=0;et<C;et++)e[et+N-1]=n[et];e[N+C-1]=et};let Z=class Z{constructor(e){this.L=e,this.islittle=!0,this.maxalign=1}};let G=function(e,n){if(e.off>=e.s.length||!o(e.s[e.off]))return n;{let n=0;do n=10*n+(e.s[e.off++]-48);while(e.off<e.s.length&&o(e.s[e.off])&&n<=214748363.8);return n}},Te=function(e,n,N){let C=G(n,N);return(C>16||C<=0)&&e9(e.L,tg("integral size (%d) out of limits [1,%d]"),C,16),C},fe=function(e,n){let N={opt:n.s[n.off++],size:0};switch(N.opt){case 98:return N.size=1,N.opt=0,N;case 66:return N.size=1,N.opt=1,N;case 104:return N.size=2,N.opt=0,N;case 72:return N.size=2,N.opt=1,N;case 108:case 106:return N.size=4,N.opt=0,N;case 76:case 74:case 84:return N.size=4,N.opt=1,N;case 102:return N.size=4,N.opt=2,N;case 100:case 110:return N.size=8,N.opt=2,N;case 105:return N.size=Te(e,n,4),N.opt=0,N;case 73:return N.size=Te(e,n,4),N.opt=1,N;case 115:return N.size=Te(e,n,4),N.opt=4,N;case 99:return N.size=G(n,-1),-1===N.size&&e9(e.L,tg("missing size for format option 'c'")),N.opt=3,N;case 122:return N.opt=5,N;case 120:return N.size=1,N.opt=6,N;case 88:return N.opt=7,N;case 32:break;case 60:case 61:e.islittle=!0;break;case 62:e.islittle=!1;break;case 33:e.maxalign=Te(e,n,8);break;default:e9(e.L,tg("invalid format option '%c'"),N.opt)}return N.opt=8,N},Me=function(e,n,N){let C={opt:NaN,size:NaN,ntoalign:NaN},et=fe(e,N);C.size=et.size,C.opt=et.opt;let ei=C.size;if(7===C.opt){if(N.off>=N.s.length||0===N.s[N.off])e0(e.L,1,tg("invalid next option for option 'X'"));else{let n=fe(e,N);ei=n.size,3!==(n=n.opt)&&0!==ei||e0(e.L,1,tg("invalid next option for option 'X'"))}}return ei<=1||3===C.opt?C.ntoalign=0:(ei>e.maxalign&&(ei=e.maxalign),ei&ei-1&&e0(e.L,1,tg("format asks for alignment not power of 2")),C.ntoalign=ei-(n&ei-1)&ei-1),C},tt=function(e,n,N,C,et){let ei=to(e,C);ei[N?0:C-1]=255&n;for(let e=1;e<C;e++)n>>=8,ei[N?e:C-1-e]=255&n;if(et&&C>4)for(let e=4;e<C;e++)ei[N?e:C-1-e]=255;eZ(e,C)},ct=function(e,n,N,C,et){let ei=0,eo=C<=4?C:4;for(let e=eo-1;e>=0;e--)ei<<=8,ei|=n[N?e:C-1-e];if(C<4){if(et){let e=1<<8*C-1;ei=(ei^e)-e}}else if(C>4){let eu=!et||ei>=0?0:255;for(let et=eo;et<C;et++)n[N?et:C-1-et]!==eu&&e9(e,tg("%d-byte integer does not fit into Lua Integer"),C)}return ei},at=function(e,n,N,C){th.lua_assert(n.length>=C);let et=new DataView(new ArrayBuffer(C));for(let e=0;e<C;e++)et.setUint8(e,n[e],N);return 4==C?et.getFloat32(0,N):et.getFloat64(0,N)},ty=tg("^$*+?.([%-");let Bt=class Bt{constructor(e){this.src=null,this.src_init=null,this.src_end=null,this.p=null,this.p_end=null,this.L=e,this.matchdepth=NaN,this.level=NaN,this.capture=[]}};let gt=function(e,n){switch(e.p[n++]){case 37:return n===e.p_end&&e9(e.L,tg("malformed pattern (ends with '%%')")),n+1;case 91:94===e.p[n]&&n++;do n===e.p_end&&e9(e.L,tg("malformed pattern (missing ']')")),37===e.p[n++]&&n<e.p_end&&n++;while(93!==e.p[n]);return n+1;default:return n}},Et=function(e,n){switch(n){case 97:return At(e);case 65:return!At(e);case 99:return c(e);case 67:return!c(e);case 100:return o(e);case 68:return!o(e);case 103:return x(e);case 71:return!x(e);case 108:return p(e);case 76:return!p(e);case 112:return U(e);case 80:return!U(e);case 115:return pe(e);case 83:return!pe(e);case 117:return T(e);case 85:return!T(e);case 119:return $(e);case 87:return!$(e);case 120:return He(e);case 88:return!He(e);case 122:return 0===e;case 90:return 0!==e;default:return n===e}},wt=function(e,n,N,C){let et=!0;for(94===e.p[N+1]&&(et=!1,N++);++N<C;)if(37===e.p[N]){if(N++,Et(n,e.p[N]))return et}else if(45===e.p[N+1]&&N+2<C){if(N+=2,e.p[N-2]<=n&&n<=e.p[N])return et}else if(e.p[N]===n)return et;return!et},Ct=function(e,n,N,C){if(n>=e.src_end)return!1;{let et=e.src[n];switch(e.p[N]){case 46:return!0;case 37:return Et(et,e.p[N+1]);case 91:return wt(e,et,N,C-1);default:return e.p[N]===et}}},Mt=function(e,n,N){if(N>=e.p_end-1&&e9(e.L,tg("malformed pattern (missing arguments to '%%b'")),e.src[n]!==e.p[N])return null;{let C=e.p[N],et=e.p[N+1],ei=1;for(;++n<e.src_end;)if(e.src[n]===et){if(0==--ei)return n+1}else e.src[n]===C&&ei++}return null},Zt=function(e,n,N,C){let et=0;for(;Ct(e,n+et,N,C);)et++;for(;et>=0;){let N=Le(e,n+et,C+1);if(N)return N;et--}return null},Dt=function(e,n,N,C){for(;;){let et=Le(e,n,C+1);if(null!==et)return et;if(!Ct(e,n,N,C))return null;n++}},qt=function(e,n,N,C){let et,ei=e.level;return ei>=32&&e9(e.L,tg("too many captures")),e.capture[ei]=e.capture[ei]?e.capture[ei]:{},e.capture[ei].init=n,e.capture[ei].len=C,e.level=ei+1,null===(et=Le(e,n,N))&&e.level--,et},$t=function(e,n,N){let C,et=function(e){let n=e.level;for(n--;n>=0;n--)if(-1===e.capture[n].len)return n;return e9(e.L,tg("invalid pattern capture"))}(e);return e.capture[et].len=n-e.capture[et].init,null===(C=Le(e,n,N))&&(e.capture[et].len=-1),C},j=function(e,n,N){var C,et,ei,eo;N=(C=N-49)<0||C>=e.level||-1===e.capture[C].len?e9(e.L,tg("invalid capture index %%%d"),C+1):C;let eu=e.capture[N].len;return e.src_end-n>=eu&&(et=e.src,ei=e.capture[N].init,eo=e.src,tp(et.subarray(ei,ei+eu),eo.subarray(n,n+eu)))?n+eu:null},Le=function(e,n,N){let C=!1,et=!0;for(0==e.matchdepth--&&e9(e.L,tg("pattern too complex"));et||C;)if(et=!1,N!==e.p_end)switch(C?void 0:e.p[N]){case 40:n=41===e.p[N+1]?qt(e,n,N+2,-2):qt(e,n,N+1,-1);break;case 41:n=$t(e,n,N+1);break;case 36:if(N+1!==e.p_end){C=!0;break}n=e.src.length-n==0?n:null;break;case 37:switch(e.p[N+1]){case 98:null!==(n=Mt(e,n,N+2))&&(N+=4,et=!0);break;case 102:{N+=2,91!==e.p[N]&&e9(e.L,tg("missing '[' after '%%f' in pattern"));let C=gt(e,N),ei=n===e.src_init?0:e.src[n-1];if(!wt(e,ei,N,C-1)&&wt(e,n===e.src_end?0:e.src[n],N,C-1)){N=C,et=!0;break}n=null;break}case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:null!==(n=j(e,n,e.p[N+1]))&&(N+=2,et=!0);break;default:C=!0}break;default:{C=!1;let ei=gt(e,N);if(Ct(e,n,N,ei))switch(e.p[ei]){case 63:{let C;null!==(C=Le(e,n+1,ei+1))?n=C:(N=ei+1,et=!0);break}case 43:n++;case 42:n=Zt(e,n,N,ei);break;case 45:n=Dt(e,n,N,ei);break;default:n++,N=ei,et=!0}else{if(42===e.p[ei]||63===e.p[ei]||45===e.p[ei]){N=ei+1,et=!0;break}n=null}}}return e.matchdepth++,n},Ye=function(e,n,N,C){if(n>=e.level)0===n?eI(e.L,e.src.subarray(N,C),C-N):e9(e.L,tg("invalid capture index %%%d"),n+1);else{let N=e.capture[n].len;-1===N&&e9(e.L,tg("unfinished capture")),-2===N?eE(e.L,e.capture[n].init-e.src_init+1):eI(e.L,e.src.subarray(e.capture[n].init),N)}},Je=function(e,n,N){let C=0===e.level&&e.src.subarray(n)?1:e.level;e4(e.L,C,"too many captures");for(let et=0;et<C;et++)Ye(e,et,n,N);return C},ot=function(e,n,N,C,et,ei){e.L=n,e.matchdepth=200,e.src=N,e.src_init=0,e.src_end=C,e.p=et,e.p_end=ei},$e=function(e){e.level=0,th.lua_assert(200===e.matchdepth)},qe=function(e,n){let N=e8(e,1),C=e8(e,2),et=N.length,ei=C.length,eo=vt(ta(e,3,1),et);if(eo<1)eo=1;else if(eo>et+1)return eR(e),1;if(n&&(eF(e,4)||function(e,n){for(let N=0;N<n;N++)if(-1!==td(ty,e[N]))return!1;return!0}(C,ei))){let n=function(e,n,N){var C=0,et=n.length;if(0===et)return C;for(;-1!==(C=e.indexOf(n[0],C));C++)if(tp(e.subarray(C,C+et),n))return C;return -1}(N.subarray(eo-1),C,0);if(n>-1)return eE(e,eo+n),eE(e,eo+n+ei-1),2}else{let eu=new Bt(e),ec=eo-1,ef=94===C[0];ef&&(C=C.subarray(1),ei--),ot(eu,e,N,et,C,ei);do{let N;if($e(eu),null!==(N=Le(eu,ec,0)))return n?(eE(e,ec+1),eE(e,N),Je(eu,null,0)+2):Je(eu,ec,N)}while(ec++<eu.src_end&&!ef)}return eR(e),1},Ge=function(e){let n=ez(e,e$(3));n.ms.L=e;for(let e=n.src;e<=n.ms.src_end;e++){let N;if($e(n.ms),null!==(N=Le(n.ms,e,n.p))&&N!==n.lastmatch)return n.src=n.lastmatch=N,Je(n.ms,e,N)}return 0},rt=function(e,n,N,C,et){let ei=e.L;switch(et){case ed:eM(ei,3),ey(ei,Je(e,N,C),1);break;case eb:Ye(e,0,N,C),eA(ei,3);break;default:return void function(e,n,N,C){let et=e.L,ei=ej(et,3),eo=ei.length;for(let eu=0;eu<eo;eu++)37!==ei[eu]?eq(n,ei[eu]):o(ei[++eu])?48===ei[eu]?eW(n,e.src.subarray(N,C),C-N):(Ye(e,ei[eu]-49,N,C),tc(et,-1),eP(et,-2),eJ(n)):(37!==ei[eu]&&e9(et,tg("invalid use of '%c' in replacement string"),37),eq(n,ei[eu]))}(e,n,N,C)}eF(ei,-1)?ew(ei,-1)||e9(ei,tg("invalid replacement value (a %s)"),tf(ei,-1)):(eT(ei,1),eI(ei,e.src.subarray(N,C),C-N)),eJ(n)},tv={byte:function(e){let n=e8(e,1),N=n.length,C=vt(ta(e,2,1),N),et=vt(ta(e,3,C),N);if(C<1&&(C=1),et>N&&(et=N),C>et)return 0;if(et-C>=Number.MAX_SAFE_INTEGER)return e9(e,"string slice too long");let ei=et-C+1;e4(e,ei,"string slice too long");for(let N=0;N<ei;N++)eE(e,n[C+N-1]);return ei},char:function(e){let n=eL(e),N=new eX,C=e2(e,N,n);for(let N=1;N<=n;N++){let n=e3(e,N);eQ(e,n>=0&&n<=255,"value out of range"),C[N-1]=n}return tu(N,n),1},dump:function(e){let n=new eX,N=eF(e,2);return e6(e,1,ed),eK(e,1),e1(e,n),0!==ek(e,yt,n,N)?e9(e,tg("unable to dump given function")):(tl(n),1)},find:function(e){return qe(e,1)},format:function(e){let n=eL(e),N=1,et=e8(e,1),eo=0,eu=new eX;for(e1(e,eu);eo<et.length;)if(37!==et[eo])eq(eu,et[eo++]);else if(37===et[++eo])eq(eu,et[eo++]);else{let ec=[];switch(++N>n&&e0(e,N,tg("no value")),eo=kt(e,et,eo,ec),String.fromCharCode(et[eo++])){case"c":eq(eu,e3(e,N));break;case"d":case"i":case"o":case"u":case"x":case"X":{let n=e3(e,N);J(ec,tg(ei,!0)),eY(eu,tg(C(String.fromCharCode(...ec),n)));break}case"a":case"A":J(ec,tg(ei,!0)),eY(eu,lt(e,ec,e5(e,N)));break;case"e":case"E":case"f":case"g":case"G":{let n=e5(e,N);J(ec,tg(ei,!0)),eY(eu,tg(C(String.fromCharCode(...ec),n)));break}case"q":Qe(e,eu,N);break;case"s":{let n=tc(e,N);ec.length<=2||0===ec[2]?eJ(eu):(eQ(e,n.length===bt(n),N,"string contains zeros"),0>td(ec,46)&&n.length>=100?eJ(eu):(eY(eu,tg(C(String.fromCharCode(...ec),t_(n)))),eT(e,1)));break}default:return e9(e,tg("invalid option '%%%c' to 'format'"),et[eo-1])}}return tl(eu),1},gmatch:function(e){let n=e8(e,1),N=e8(e,2),C=n.length,et=N.length;eK(e,2);let ei=new class{constructor(){this.src=NaN,this.p=NaN,this.lastmatch=NaN,this.ms=new Bt}};return eS(e,ei),ot(ei.ms,e,n,C,N,et),ei.src=0,ei.p=0,ei.lastmatch=null,eO(e,Ge,3),1},gsub:function(e){let n=e8(e,1),N=n.length,C=e8(e,2),et=C.length,ei=null,eo=eH(e,3),eu=ta(e,4,N+1),ec=94===C[0],ef=0,eh=new Bt(e),ep=new eX;for(eQ(e,eo===eg||eo===em||eo===ed||eo===eb,3,"string/function/table expected"),e1(e,ep),ec&&(C=C.subarray(1),et--),ot(eh,e,n,N,C,et),n=0,C=0;ef<eu;){let e;if($e(eh),null!==(e=Le(eh,n,C))&&e!==ei)ef++,rt(eh,ep,n,e,eo),n=ei=e;else{if(!(n<eh.src_end))break;eq(ep,eh.src[n++])}if(ec)break}return eW(ep,eh.src.subarray(n,eh.src_end),eh.src_end-n),tl(ep),eE(e,ef),2},len:function(e){return eE(e,e8(e,1).length),1},lower:function(e){let n=e8(e,1),N=n.length,C=new Uint8Array(N);for(let e=0;e<N;e++){let N=n[e];T(N)&&(N|=32),C[e]=N}return eC(e,C),1},match:function(e){return qe(e,0)},pack:function(e){let n=new eX,N=new Z(e),C={s:e8(e,1),off:0},et=1,ei=0;for(eR(e),e1(e,n);C.off<C.s.length;){let eo=Me(N,ei,C),eu=eo.opt,ec=eo.size,ef=eo.ntoalign;for(ei+=ef+ec;ef-- >0;)eq(n,0);switch(et++,eu){case 0:{let C=e3(e,et);if(ec<4){let n=1<<8*ec-1;eQ(e,-n<=C&&C<n,et,"integer overflow")}tt(n,C,N.islittle,ec,C<0);break}case 1:{let C=e3(e,et);ec<4&&eQ(e,C>>>0<1<<8*ec,et,"unsigned overflow"),tt(n,C>>>0,N.islittle,ec,!1);break}case 2:{let C=to(n,ec),ei=e5(e,et),eo=new DataView(C.buffer,C.byteOffset,C.byteLength);4===ec?eo.setFloat32(0,ei,N.islittle):eo.setFloat64(0,ei,N.islittle),eZ(n,ec);break}case 3:{let N=e8(e,et),C=N.length;for(eQ(e,C<=ec,et,"string longer than given size"),eW(n,N,C);C++<ec;)eq(n,0);break}case 4:{let C=e8(e,et),eo=C.length;eQ(e,ec>=4||eo<1<<8*ec,et,"string length does not fit in given size"),tt(n,eo,N.islittle,ec,0),eW(n,C,eo),ei+=eo;break}case 5:{let N=e8(e,et),C=N.length;eQ(e,0>td(N,0),et,"strings contains zeros"),eW(n,N,C),eq(n,0),ei+=C+1;break}case 6:eq(n,0);case 7:case 8:et--}}return tl(n),1},packsize:function(e){let n=new Z(e),N={s:e8(e,1),off:0},C=0;for(;N.off<N.s.length;){let et=Me(n,C,N),ei=et.opt,eo=et.size;switch(eQ(e,C<=2147483647-(eo+=et.ntoalign),1,"format result too large"),C+=eo,ei){case 4:case 5:e0(e,1,"variable-length format")}}return eE(e,C),1},rep:function(e){let n=e8(e,1),N=n.length,C=e3(e,2),et=ti(e,3,""),ei=et.length;if(C<=0)eN(e,"");else{if(N+ei<N||N+ei>2147483647/C)return e9(e,tg("resulting string too large"));{let eo=C*N+(C-1)*ei,eu=new eX,ec=e2(e,eu,eo),ef=0;for(;C-- >1;)ec.set(n,ef),ef+=N,ei>0&&(ec.set(et,ef),ef+=ei);ec.set(n,ef),tu(eu,eo)}}return 1},reverse:function(e){let n=e8(e,1),N=n.length,C=new Uint8Array(N);for(let e=0;e<N;e++)C[e]=n[N-1-e];return eC(e,C),1},sub:function(e){let n=e8(e,1),N=n.length,C=vt(e3(e,2),N),et=vt(ta(e,3,-1),N);return C<1&&(C=1),et>N&&(et=N),C<=et?eC(e,n.subarray(C-1,C-1+(et-C+1))):eN(e,""),1},unpack:function(e){let n=new Z(e),N={s:e8(e,1),off:0},C=e8(e,2),et=C.length,ei=vt(ta(e,3,1),et)-1,eo=0;for(eQ(e,ei<=et&&ei>=0,3,"initial position out of string");N.off<N.s.length;){let eu=Me(n,ei,N),ec=eu.opt,ef=eu.size,eh=eu.ntoalign;switch(ei+eh+ef>et&&e0(e,2,tg("data string too short")),ei+=eh,e4(e,2,"too many results"),eo++,ec){case 0:case 1:{let N=ct(e,C.subarray(ei),n.islittle,ef,0===ec);eE(e,N);break}case 2:eU(e,at(0,C.subarray(ei),n.islittle,ef));break;case 3:eC(e,C.subarray(ei,ei+ef));break;case 4:{let N=ct(e,C.subarray(ei),n.islittle,ef,0);eQ(e,ei+N+ef<=et,2,"data string too short"),eC(e,C.subarray(ei+ef,ei+ef+N)),ei+=N;break}case 5:{let n=td(C,0,ei);-1===n&&(n=C.length-ei),eC(e,C.subarray(ei,n)),ei=n+1;break}case 7:case 6:case 8:eo--}ei+=ef}return eE(e,ei+1),eo+1},upper:function(e){let n=e8(e,1),N=n.length,C=new Uint8Array(N);for(let e=0;e<N;e++){let N=n[e];p(N)&&(N&=223),C[e]=N}return eC(e,C),1}};e.exports.luaopen_string=function(e){return e7(e,tv),ev(e,0,1),eN(e,""),eM(e,-2),eB(e,-2),eT(e,1),eM(e,-2),eD(e,-2,tg("__index",!0)),eT(e,1),1}},function(e,n,N){let{lua_gettop:C,lua_pushcfunction:et,lua_pushfstring:ei,lua_pushinteger:eo,lua_pushnil:eu,lua_pushstring:ec,lua_pushvalue:ef,lua_setfield:eh,lua_tointeger:ep}=N(2),{luaL_Buffer:ed,luaL_addvalue:e_,luaL_argcheck:eg,luaL_buffinit:em,luaL_checkinteger:eb,luaL_checkstack:ey,luaL_checkstring:ev,luaL_error:ek,luaL_newlib:eA,luaL_optinteger:eL,luaL_pushresult:ex}=N(7),{luastring_of:ew,to_luastring:eT}=N(5),V=function(e){return(192&e)==128},Q=function(e,n){return e>=0?e:0-e>n?0:n+e+1},eO=[255,127,2047,65535],F=function(e,n){let N=e[n],C=0;if(N<128)C=N;else{let et=0;for(;64&N;){let ei=e[n+ ++et];if((192&ei)!=128)return null;C=C<<6|63&ei,N<<=1}if(C|=(127&N)<<5*et,et>3||C>1114111||C<=eO[et])return null;n+=et}return{code:C,pos:n+1}},eE=eT("%U"),y=function(e,n){let N=eb(e,n);eg(e,0<=N&&N<=1114111,n,"value out of range"),ei(e,eE,N)},Y=function(e){let n=ev(e,1),N=n.length,C=ep(e,2)-1;if(C<0)C=0;else if(C<N)for(C++;V(n[C]);)C++;if(C>=N)return 0;{let N=F(n,C);return null===N||V(n[N.pos])?ek(e,eT("invalid UTF-8 code")):(eo(e,C+1),eo(e,N.code),2)}},eS={char:function(e){let n=C(e);if(1===n)y(e,1);else{let N=new ed;em(e,N);for(let C=1;C<=n;C++)y(e,C),e_(N);ex(N)}return 1},codepoint:function(e){let n=ev(e,1),N=Q(eL(e,2,1),n.length),C=Q(eL(e,3,N),n.length);if(eg(e,N>=1,2,"out of range"),eg(e,C<=n.length,3,"out of range"),N>C)return 0;if(C-N>=Number.MAX_SAFE_INTEGER)return ek(e,"string slice too long");let et=C-N+1;for(ey(e,et,"string slice too long"),et=0,N-=1;N<C;){let C=F(n,N);if(null===C)return ek(e,"invalid UTF-8 code");eo(e,C.code),N=C.pos,et++}return et},codes:function(e){return ev(e,1),et(e,Y),ef(e,1),eo(e,0),3},len:function(e){let n=0,N=ev(e,1),C=N.length,et=Q(eL(e,2,1),C),ei=Q(eL(e,3,-1),C);for(eg(e,1<=et&&--et<=C,2,"initial position out of string"),eg(e,--ei<C,3,"final position out of string");et<=ei;){let C=F(N,et);if(null===C)return eu(e),eo(e,et+1),2;et=C.pos,n++}return eo(e,n),1},offset:function(e){let n=ev(e,1),N=eb(e,2),C=N>=0?1:n.length+1;if(C=Q(eL(e,3,C),n.length),eg(e,1<=C&&--C<=n.length,3,"position out of range"),0===N)for(;C>0&&V(n[C]);)C--;else if(V(n[C])&&ek(e,"initial position is a continuation byte"),N<0)for(;N<0&&C>0;){do C--;while(C>0&&V(n[C]));N++}else for(N--;N>0&&C<n.length;){do C++;while(V(n[C]));N--}return 0===N?eo(e,C+1):eu(e),1}},eN=ew(91,0,45,127,194,45,244,93,91,128,45,191,93,42);e.exports.luaopen_utf8=function(e){return eA(e,eS),ec(e,eN),eh(e,-2,eT("charpattern",!0)),1}},function(e,n,N){let C;let{LUA_OPLT:et,LUA_TNUMBER:ei,lua_compare:eo,lua_gettop:eu,lua_isinteger:ec,lua_isnoneornil:ef,lua_pushboolean:eh,lua_pushinteger:ep,lua_pushliteral:ed,lua_pushnil:e_,lua_pushnumber:eg,lua_pushvalue:em,lua_setfield:eb,lua_settop:ey,lua_tointeger:ev,lua_tointegerx:ek,lua_type:eA}=N(2),{luaL_argcheck:eL,luaL_argerror:ex,luaL_checkany:ew,luaL_checkinteger:eT,luaL_checknumber:eO,luaL_error:eE,luaL_newlib:eS,luaL_optnumber:eN}=N(7),{LUA_MAXINTEGER:eI,LUA_MININTEGER:eR,lua_numbertointeger:eU}=N(3),{to_luastring:eC}=N(5),_e=function(){return C=1103515245*C+12345&2147483647},me=function(e,n){let N=eU(n);!1!==N?ep(e,N):eg(e,n)},eM={abs:function(e){if(ec(e,1)){let n=ev(e,1);n<0&&(n=0|-n),ep(e,n)}else eg(e,Math.abs(eO(e,1)));return 1},acos:function(e){return eg(e,Math.acos(eO(e,1))),1},asin:function(e){return eg(e,Math.asin(eO(e,1))),1},atan:function(e){let n=eO(e,1),N=eN(e,2,1);return eg(e,Math.atan2(n,N)),1},ceil:function(e){return ec(e,1)?ey(e,1):me(e,Math.ceil(eO(e,1))),1},cos:function(e){return eg(e,Math.cos(eO(e,1))),1},deg:function(e){return eg(e,eO(e,1)*(180/Math.PI)),1},exp:function(e){return eg(e,Math.exp(eO(e,1))),1},floor:function(e){return ec(e,1)?ey(e,1):me(e,Math.floor(eO(e,1))),1},fmod:function(e){if(ec(e,1)&&ec(e,2)){let n=ev(e,2);0===n?ex(e,2,"zero"):ep(e,ev(e,1)%n|0)}else{let n=eO(e,1),N=eO(e,2);eg(e,n%N)}return 1},log:function(e){let n,N=eO(e,1);if(ef(e,2))n=Math.log(N);else{let C=eO(e,2);n=2===C?Math.log2(N):10===C?Math.log10(N):Math.log(N)/Math.log(C)}return eg(e,n),1},max:function(e){let n=eu(e),N=1;eL(e,n>=1,1,"value expected");for(let C=2;C<=n;C++)eo(e,N,C,et)&&(N=C);return em(e,N),1},min:function(e){let n=eu(e),N=1;eL(e,n>=1,1,"value expected");for(let C=2;C<=n;C++)eo(e,C,N,et)&&(N=C);return em(e,N),1},modf:function(e){if(ec(e,1))ey(e,1),eg(e,0);else{let n=eO(e,1),N=n<0?Math.ceil(n):Math.floor(n);me(e,N),eg(e,n===N?0:n-N)}return 2},rad:function(e){return eg(e,eO(e,1)*(Math.PI/180)),1},random:function(e){let n,N,et=void 0===C?Math.random():_e()/2147483648;switch(eu(e)){case 0:return eg(e,et),1;case 1:n=1,N=eT(e,1);break;case 2:n=eT(e,1),N=eT(e,2);break;default:return eE(e,"wrong number of arguments")}return eL(e,n<=N,1,"interval is empty"),eL(e,n>=0||N<=eI+n,1,"interval too large"),ep(e,Math.floor(et*=N-n+1)+n),1},randomseed:function(e){return 0==(C=0|eO(e,1))&&(C=1),_e(),0},sin:function(e){return eg(e,Math.sin(eO(e,1))),1},sqrt:function(e){return eg(e,Math.sqrt(eO(e,1))),1},tan:function(e){return eg(e,Math.tan(eO(e,1))),1},tointeger:function(e){let n=ek(e,1);return!1!==n?ep(e,n):(ew(e,1),e_(e)),1},type:function(e){return eA(e,1)===ei?ec(e,1)?ed(e,"integer"):ed(e,"float"):(ew(e,1),e_(e)),1},ult:function(e){let n=eT(e,1),N=eT(e,2);return eh(e,n>=0?N<0||n<N:N<0&&n<N),1}};e.exports.luaopen_math=function(e){return eS(e,eM),eg(e,Math.PI),eb(e,-2,eC("pi",!0)),eg(e,1/0),eb(e,-2,eC("huge",!0)),ep(e,eI),eb(e,-2,eC("maxinteger",!0)),ep(e,eR),eb(e,-2,eC("mininteger",!0)),1}},function(e,n,N){let C;let{LUA_MASKCALL:et,LUA_MASKCOUNT:ei,LUA_MASKLINE:eo,LUA_MASKRET:eu,LUA_REGISTRYINDEX:ec,LUA_TFUNCTION:ef,LUA_TNIL:eh,LUA_TTABLE:ep,LUA_TUSERDATA:ed,lua_Debug:e_,lua_call:eg,lua_checkstack:em,lua_gethook:eb,lua_gethookcount:ey,lua_gethookmask:ev,lua_getinfo:ek,lua_getlocal:eA,lua_getmetatable:eL,lua_getstack:ex,lua_getupvalue:ew,lua_getuservalue:eT,lua_insert:eO,lua_iscfunction:eE,lua_isfunction:eS,lua_isnoneornil:eN,lua_isthread:eI,lua_newtable:eR,lua_pcall:eU,lua_pop:eC,lua_pushboolean:eM,lua_pushfstring:eP,lua_pushinteger:eD,lua_pushlightuserdata:eB,lua_pushliteral:eK,lua_pushnil:eF,lua_pushstring:eV,lua_pushvalue:eG,lua_rawgetp:ej,lua_rawsetp:ez,lua_rotate:eH,lua_setfield:e$,lua_sethook:eX,lua_setlocal:eq,lua_setmetatable:eW,lua_settop:eZ,lua_setupvalue:eY,lua_setuservalue:eJ,lua_tojsstring:eQ,lua_toproxy:e0,lua_tostring:e1,lua_tothread:e2,lua_touserdata:e3,lua_type:e5,lua_upvalueid:e4,lua_upvaluejoin:e8,lua_xmove:e6}=N(2),{luaL_argcheck:e9,luaL_argerror:e7,luaL_checkany:ta,luaL_checkinteger:ti,luaL_checkstring:to,luaL_checktype:tl,luaL_error:tu,luaL_loadbuffer:tc,luaL_newlib:tf,luaL_optinteger:th,luaL_optstring:tp,luaL_traceback:td,lua_writestringerror:t_}=N(7),tg=N(17),{luastring_indexOf:tm,to_luastring:tb}=N(5),bt=function(e,n,N){e===n||em(n,N)||tu(e,tb("stack overflow",!0))},vt=function(e){return eI(e,1)?{arg:1,thread:e2(e,1)}:{arg:0,thread:e}},yt=function(e,n,N){eV(e,N),e$(e,-2,n)},Rt=function(e,n,N){eD(e,N),e$(e,-2,n)},lt=function(e,n,N){eM(e,N),e$(e,-2,n)},pt=function(e,n,N){e==n?eH(e,-2,1):e6(n,e,1),e$(e,-2,N)},At=function(e,n){let N=ti(e,2);tl(e,1,ef);let C=n?ew(e,1,N):eY(e,1,N);return null===C?0:(eV(e,C),eO(e,-(n+1)),n+1)},o=function(e,n,N){let C=ti(e,N);return tl(e,n,ef),e9(e,null!==ew(e,n,C),N,"invalid upvalue index"),C},ty=tb("__hooks__",!0),tv=["call","return","line","count","tail call"].map(e=>tb(e)),p=function(e,n){ej(e,ec,ty);let N=e3(e,-1).get(e);N&&(N(e),eV(e,tv[n.event]),n.currentline>=0?eD(e,n.currentline):eF(e),tg.lua_assert(ek(e,tb("lS"),n)),eg(e,2,0))},tk={gethook:function(e){let n,N=vt(e).thread,C=new Uint8Array(5),ei=ev(N),ef=eb(N);return null===ef?eF(e):ef!==p?eK(e,"external hook"):(ej(e,ec,ty),e3(e,-1).get(N)(e)),eV(e,(n=0,ei&et&&(C[n++]=99),ei&eu&&(C[n++]=114),ei&eo&&(C[n++]=108),C.subarray(0,n))),eD(e,ey(N)),3},getinfo:function(e){let n=new e_,N=vt(e),C=N.arg,et=N.thread,ei=tp(e,C+2,"flnStu");if(bt(e,et,3),eS(e,C+1))ei=eP(e,tb(">%s"),ei),eG(e,C+1),e6(e,et,1);else if(!ex(et,ti(e,C+1),n))return eF(e),1;return ek(et,ei,n)||e7(e,C+2,"invalid option"),eR(e),tm(ei,83)>-1&&(yt(e,tb("source",!0),n.source),yt(e,tb("short_src",!0),n.short_src),Rt(e,tb("linedefined",!0),n.linedefined),Rt(e,tb("lastlinedefined",!0),n.lastlinedefined),yt(e,tb("what",!0),n.what)),tm(ei,108)>-1&&Rt(e,tb("currentline",!0),n.currentline),tm(ei,117)>-1&&(Rt(e,tb("nups",!0),n.nups),Rt(e,tb("nparams",!0),n.nparams),lt(e,tb("isvararg",!0),n.isvararg)),tm(ei,110)>-1&&(yt(e,tb("name",!0),n.name),yt(e,tb("namewhat",!0),n.namewhat)),tm(ei,116)>-1&&lt(e,tb("istailcall",!0),n.istailcall),tm(ei,76)>-1&&pt(e,et,tb("activelines",!0)),tm(ei,102)>-1&&pt(e,et,tb("func",!0)),1},getlocal:function(e){let n=vt(e),N=n.thread,C=n.arg,et=new e_,ei=ti(e,C+2);if(eS(e,C+1))return eG(e,C+1),eV(e,eA(e,null,ei)),1;{if(!ex(N,ti(e,C+1),et))return e7(e,C+1,"level out of range");bt(e,N,1);let n=eA(N,et,ei);return n?(e6(N,e,1),eV(e,n),eH(e,-2,1),2):(eF(e),1)}},getmetatable:function(e){return ta(e,1),eL(e,1)||eF(e),1},getregistry:function(e){return eG(e,ec),1},getupvalue:function(e){return At(e,1)},getuservalue:function(e){return e5(e,1)!==ed?eF(e):eT(e,1),1},sethook:function(e){let n,N,C,ep,ed=vt(e),e_=ed.thread,eg=ed.arg;if(eN(e,eg+1))eZ(e,eg+1),C=null,n=0,N=0;else{var em;let ec;let eh=to(e,eg+2);tl(e,eg+1,ef),N=th(e,eg+3,0),C=p,em=N,ec=0,tm(eh,99)>-1&&(ec|=et),tm(eh,114)>-1&&(ec|=eu),tm(eh,108)>-1&&(ec|=eo),em>0&&(ec|=ei),n=ec}ej(e,ec,ty)===eh?(eB(e,ep=new WeakMap),ez(e,ec,ty)):ep=e3(e,-1);let eb=e0(e,eg+1);return ep.set(e_,eb),eX(e_,C,n,N),0},setlocal:function(e){let n=vt(e),N=n.thread,C=n.arg,et=new e_,ei=ti(e,C+1),eo=ti(e,C+2);if(!ex(N,ei,et))return e7(e,C+1,"level out of range");ta(e,C+3),eZ(e,C+3),bt(e,N,1),e6(e,N,1);let eu=eq(N,et,eo);return null===eu&&eC(N,1),eV(e,eu),1},setmetatable:function(e){let n=e5(e,2);return e9(e,n==eh||n==ep,2,"nil or table expected"),eZ(e,2),eW(e,1),1},setupvalue:function(e){return ta(e,3),At(e,0)},setuservalue:function(e){return tl(e,1,ed),ta(e,2),eZ(e,2),eJ(e,1),1},traceback:function(e){let n=vt(e),N=n.thread,C=n.arg,et=e1(e,C+1);if(null!==et||eN(e,C+1)){let n=th(e,C+2,e===N?1:0);td(e,N,et,n)}else eG(e,C+1);return 1},upvalueid:function(e){let n=o(e,1,2);return eB(e,e4(e,1,n)),1},upvaluejoin:function(e){let n=o(e,1,2),N=o(e,3,4);return e9(e,!eE(e,1),1,"Lua function expected"),e9(e,!eE(e,3),3,"Lua function expected"),e8(e,1,n,3,N),0}};"u">typeof window&&(C=function(){let e=prompt("lua_debug>","");return null!==e?e:""}),C&&(tk.debug=function(e){for(;;){let n=C();if("cont"===n)return 0;if(0===n.length)continue;let N=tb(n);(tc(e,N,N.length,tb("=(debug command)",!0))||eU(e,0,0,0))&&t_(eQ(e,-1),`
`),eZ(e,0)}}),e.exports.luaopen_debug=function(e){return tf(e,tk),1}},function(e,n,N){let C,et;let{LUA_DIRSEP:ei,LUA_EXEC_DIR:eo,LUA_JSPATH_DEFAULT:eu,LUA_PATH_DEFAULT:ec,LUA_PATH_MARK:ef,LUA_PATH_SEP:eh}=N(3),{LUA_OK:ep,LUA_REGISTRYINDEX:ed,LUA_TNIL:e_,LUA_TTABLE:eg,lua_callk:em,lua_createtable:eb,lua_getfield:ey,lua_insert:ev,lua_isfunction:ek,lua_isnil:eA,lua_isstring:eL,lua_newtable:ex,lua_pop:ew,lua_pushboolean:eT,lua_pushcclosure:eO,lua_pushcfunction:eE,lua_pushfstring:eS,lua_pushglobaltable:eN,lua_pushlightuserdata:eI,lua_pushliteral:eR,lua_pushlstring:eU,lua_pushnil:eC,lua_pushstring:eM,lua_pushvalue:eP,lua_rawgeti:eD,lua_rawgetp:eB,lua_rawseti:eK,lua_rawsetp:eF,lua_remove:eV,lua_setfield:eG,lua_setmetatable:ej,lua_settop:ez,lua_toboolean:eH,lua_tostring:e$,lua_touserdata:eX,lua_upvalueindex:eq}=N(2),{LUA_LOADED_TABLE:eW,LUA_PRELOAD_TABLE:eZ,luaL_Buffer:eY,luaL_addvalue:eJ,luaL_buffinit:eQ,luaL_checkstring:e0,luaL_error:e1,luaL_getsubtable:e2,luaL_gsub:e3,luaL_len:e5,luaL_loadfile:e4,luaL_newlib:e8,luaL_optstring:e6,luaL_pushresult:e9,luaL_setfuncs:e7}=N(7),ta=N(17),{luastring_indexOf:ti,to_jsstring:to,to_luastring:tl,to_uristring:tu}=N(5),tc=N(0),tf="u">typeof window?window:"u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this"),th=tl("__JSLIBS__"),tp=tl("luaopen_"),td=tl("_"),t_=tl("\x01");C=function(e,n,N){n=tu(n);let C=new XMLHttpRequest;if(C.open("GET",n,!1),C.send(),C.status<200||C.status>=300)return eM(e,tl(`${C.status}: ${C.statusText}`)),null;let et,ei=C.response;/\/\/[#@] sourceURL=/.test(ei)||(ei+=" //# sourceURL="+n);try{et=Function("fengari",ei)}catch(n){return eM(e,tl(`${n.name}: ${n.message}`)),null}let eo=et(tc);return"function"==typeof eo||"object"==typeof eo&&null!==eo?eo:void 0===eo?tf:(eM(e,tl(`library returned unexpected type (${typeof eo})`)),null)},et=function(e){e=tu(e);let n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(),n.status>=200&&n.status<=299};let bt=function(e,n,N){let et=Rt(e,n);if(null===et){if(null===(et=C(e,n,42===N[0])))return 1;lt(e,n,et)}if(42===N[0])return eT(e,1),0;{let n;let C=(n=et[to(N)])&&"function"==typeof n?n:(eS(e,tl("undefined symbol: %s"),N),null);return null===C?2:(eE(e,C),0)}},yt=function(e,n,N,C){let et,ei=`${N}${ta.LUA_VERSUFFIX}`;eM(e,tl(ei));let eo=tf[ei];void 0===eo&&(eo=tf[N]),void 0===eo||(ey(e,ed,tl("LUA_NOENV")),et=eH(e,-1),ew(e,1),et)?eM(e,C):(eo=e3(e,tl(eo),tl(eh+eh,!0),tl(eh+to(t_)+eh,!0)),e3(e,eo,t_,C),eV(e,-2)),eG(e,-3,n),ew(e,1)},Rt=function(e,n){eB(e,ed,th),ey(e,-1,n);let N=eX(e,-1);return ew(e,2),N},lt=function(e,n,N){eB(e,ed,th),eI(e,N),eP(e,-1),eG(e,-3,n),eK(e,-2,e5(e,-2)+1),ew(e,1)},pt=function(e,n){for(;n[0]===eh.charCodeAt(0);)n=n.subarray(1);if(0===n.length)return null;let N=ti(n,eh.charCodeAt(0));return N<0&&(N=n.length),eU(e,n,N),n.subarray(N)},At=function(e,n,N,C,ei){let eo=new eY;for(eQ(e,eo),0!==C[0]&&(n=e3(e,n,C,ei));null!==(N=pt(e,N));){let N=e3(e,e$(e,-1),tl(ef,!0),n);if(eV(e,-2),et(N))return N;eS(e,tl(`
	no file '%s'`),N),eV(e,-2),eJ(eo)}return e9(eo),null},o=function(e,n,N,C){ey(e,eq(1),N);let et=e$(e,-1);return null===et&&e1(e,tl("'package.%s' must be a string"),N),At(e,n,et,tl("."),C)},c=function(e,n,N){return n?(eM(e,N),2):e1(e,tl(`error loading module '%s' from file '%s':
	%s`),e$(e,1),N,e$(e,-1))},x=function(e){let n=e0(e,1),N=o(e,n,tl("path",!0),tl(ei,!0));return null===N?1:c(e,e4(e,N)===ep,N)},p=function(e,n,N){let C;let et=ti(N=e3(e,N,tl("."),td),45);if(et>=0){C=eU(e,N,et),C=eS(e,tl("%s%s"),tp,C);let ei=bt(e,n,C);if(2!==ei)return ei;N=et+1}return C=eS(e,tl("%s%s"),tp,N),bt(e,n,C)},T=function(e){let n=e0(e,1),N=o(e,n,tl("jspath",!0),tl(ei,!0));return null===N?1:c(e,0===p(e,N,n),N)},$=function(e){let n,N=e0(e,1),C=ti(N,46);if(C<0)return 0;eU(e,N,C);let et=o(e,e$(e,-1),tl("jspath",!0),tl(ei,!0));return null===et?1:0!==(n=p(e,et,N))?2!=n?c(e,0,et):(eM(e,tl(`
	no module '%s' in file '%s'`),N,et),1):(eM(e,et),2)},U=function(e){let n=e0(e,1);return ey(e,ed,eZ),ey(e,-1,n)===e_&&eS(e,tl(`
	no field package.preload['%s']`),n),1},pe=function(e,n,N){for(;n===ep?(eD(e,3,N.i)===e_&&(ew(e,1),e9(N.msg),e1(e,tl("module '%s' not found:%s"),N.name,e$(e,-1))),eM(e,N.name),em(e,1,2,N,pe)):n=ep,!ek(e,-2);N.i++)eL(e,-2)?(ew(e,1),eJ(N.msg)):ew(e,2);return N.k(e,ep,N.ctx)},He=function(e,n,N){return eM(e,N),ev(e,-2),em(e,2,1,N,Qe),Qe(e,ep,N)},Qe=function(e,n,N){return eA(e,-1)||eG(e,2,N),ey(e,2,N)==e_&&(eT(e,1),eP(e,-1),eG(e,2,N)),1},tg={loadlib:function(e){let n=e0(e,1),N=e0(e,2),C=bt(e,n,N);return 0===C?1:(eC(e),ev(e,-2),eR(e,1===C?"open":"init"),3)},searchpath:function(e){return null!==At(e,e0(e,1),e0(e,2),e6(e,3,"."),e6(e,4,ei))?1:(eC(e),ev(e,-2),2)}},tm={require:function(e){let n,N=e0(e,1);return ez(e,1),ey(e,ed,eW),ey(e,2,N),eH(e,-1)?1:(ew(e,1),eQ(e,n=new eY),ey(e,eq(1),tl("searchers",!0))!==eg&&e1(e,tl("'package.searchers' must be a table")),pe(e,ep,{name:N,i:1,msg:n,ctx:N,k:He}))}};e.exports.luaopen_package=function(e){return ex(e),eb(e,0,1),ej(e,-2),eF(e,ed,th),e8(e,tg),function(e){let n=[U,x,T,$,null];eb(e);for(let N=0;n[N];N++)eP(e,-2),eO(e,n[N],1),eK(e,-2,N+1);eG(e,-2,tl("searchers",!0))}(e),yt(e,tl("path",!0),"LUA_PATH",ec),yt(e,tl("jspath",!0),"LUA_JSPATH",eu),eR(e,ei+`
`+eh+`
`+ef+`
`+eo+`
-
`),eG(e,-2,tl("config",!0)),e2(e,ed,eW),eG(e,-2,tl("loaded",!0)),e2(e,ed,eZ),eG(e,-2,tl("preload",!0)),eN(e),eP(e,-2),e7(e,tm,1),ew(e,1),1}},function(e,n,N){let{lua_pushinteger:C,lua_pushliteral:et,lua_setfield:ei}=N(2),{luaL_newlib:eo}=N(7),{FENGARI_AUTHORS:eu,FENGARI_COPYRIGHT:ec,FENGARI_RELEASE:ef,FENGARI_VERSION:eh,FENGARI_VERSION_MAJOR:ep,FENGARI_VERSION_MINOR:ed,FENGARI_VERSION_NUM:e_,FENGARI_VERSION_RELEASE:eg,to_luastring:em}=N(5);e.exports.luaopen_fengari=function(e){return eo(e,{}),et(e,eu),ei(e,-2,em("AUTHORS")),et(e,ec),ei(e,-2,em("COPYRIGHT")),et(e,ef),ei(e,-2,em("RELEASE")),et(e,eh),ei(e,-2,em("VERSION")),et(e,ep),ei(e,-2,em("VERSION_MAJOR")),et(e,ed),ei(e,-2,em("VERSION_MINOR")),C(e,e_),ei(e,-2,em("VERSION_NUM")),et(e,eg),ei(e,-2,em("VERSION_RELEASE")),1}},function(e,n,N){N.r(n),N.d(n,"L",function(){return eI}),N.d(n,"load",function(){return y});var C=N(0);N.d(n,"FENGARI_AUTHORS",function(){return C.FENGARI_AUTHORS}),N.d(n,"FENGARI_COPYRIGHT",function(){return C.FENGARI_COPYRIGHT}),N.d(n,"FENGARI_RELEASE",function(){return C.FENGARI_RELEASE}),N.d(n,"FENGARI_VERSION",function(){return C.FENGARI_VERSION}),N.d(n,"FENGARI_VERSION_MAJOR",function(){return C.FENGARI_VERSION_MAJOR}),N.d(n,"FENGARI_VERSION_MINOR",function(){return C.FENGARI_VERSION_MINOR}),N.d(n,"FENGARI_VERSION_NUM",function(){return C.FENGARI_VERSION_NUM}),N.d(n,"FENGARI_VERSION_RELEASE",function(){return C.FENGARI_VERSION_RELEASE}),N.d(n,"luastring_eq",function(){return C.luastring_eq}),N.d(n,"luastring_indexOf",function(){return C.luastring_indexOf}),N.d(n,"luastring_of",function(){return C.luastring_of}),N.d(n,"to_jsstring",function(){return C.to_jsstring}),N.d(n,"to_luastring",function(){return C.to_luastring}),N.d(n,"to_uristring",function(){return C.to_uristring}),N.d(n,"lua",function(){return C.lua}),N.d(n,"lauxlib",function(){return C.lauxlib}),N.d(n,"lualib",function(){return C.lualib});var et=N(21);N.d(n,"interop",function(){return et});let{LUA_ERRRUN:ei,LUA_ERRSYNTAX:eo,LUA_OK:eu,LUA_VERSION_MAJOR:ec,LUA_VERSION_MINOR:ef,lua_Debug:eh,lua_getinfo:ep,lua_getstack:ed,lua_gettop:e_,lua_insert:eg,lua_pcall:em,lua_pop:eb,lua_pushcfunction:ey,lua_pushstring:ev,lua_remove:ek,lua_setglobal:eA,lua_tojsstring:eL}=C.lua,{luaL_loadbuffer:ex,luaL_newstate:ew,luaL_requiref:eT}=C.lauxlib,{checkjs:eO,luaopen_js:eE,push:eS,tojs:eN}=et,eI=ew();function y(e,n){if("string"==typeof e)e=Object(C.to_luastring)(e);else if(!(e instanceof Uint8Array))throw TypeError("expects an array of bytes or javascript string");let N,et=ex(eI,e,null,n=n?Object(C.to_luastring)(n):null);if(N=et===eo?SyntaxError(eL(eI,-1)):eN(eI,-1),eb(eI,1),et!==eu)throw N;return N}if(C.lualib.luaL_openlibs(eI),eT(eI,Object(C.to_luastring)("js"),eE,1),eb(eI,1),ev(eI,Object(C.to_luastring)(C.FENGARI_COPYRIGHT)),eA(eI,Object(C.to_luastring)("_COPYRIGHT")),"u">typeof document&&document instanceof HTMLDocument){let Y=function(e){switch(e){case"anonymous":return"omit";case"use-credentials":return"include";default:return"same-origin"}},de=function(e){let n=new eh;return ed(e,2,n)&&ep(e,Object(C.to_luastring)("Sl"),n),eS(e,new ErrorEvent("error",{bubbles:!0,cancelable:!0,message:eL(e,1),error:eN(e,1),filename:n.short_src?Object(C.to_jsstring)(n.short_src):void 0,lineno:n.currentline>0?n.currentline:void 0})),1},_e=function(e,n,N){let C,et=ex(eI,n,null,N);if(et===eo){let n=eL(eI,-1),N=e.src?e.src:document.location,et,ei=SyntaxError(n,N,et);C=new ErrorEvent("error",{message:n,error:ei,filename:N,lineno:et})}else if(et===eu){let n=e_(eI);ey(eI,de),eg(eI,n),Object.defineProperty(document,"currentScript",{value:e,configurable:!0}),et=em(eI,0,0,n),delete document.currentScript,ek(eI,n),et===ei&&(C=eO(eI,-1))}et!==eu&&(void 0===C&&(C=new ErrorEvent("error",{message:eL(eI,-1),error:eN(eI,-1)})),eb(eI,1),window.dispatchEvent(C)&&console.error("uncaught exception",C.error))},me=function(e,n,N){if(e.status>=200&&e.status<300){let et=e.response;_e(n,et="string"==typeof et?Object(C.to_luastring)(e.response):new Uint8Array(et),N)}else n.dispatchEvent(new Event("error"))},ve=function(e){if(e.src){let n=Object(C.to_luastring)("@"+e.src);if("complete"===document.readyState||e.async){if("function"==typeof fetch)fetch(e.src,{method:"GET",credentials:Y(e.crossorigin),redirect:"follow",integrity:e.integrity}).then(function(e){if(e.ok)return e.arrayBuffer();throw Error("unable to fetch")}).then(function(N){_e(e,new Uint8Array(N),n)}).catch(function(n){e.dispatchEvent(new Event("error"))});else{let N=new XMLHttpRequest;N.open("GET",e.src,!0),N.responseType="arraybuffer",N.onreadystatechange=function(){4===N.readyState&&me(N,e,n)},N.send()}}else{let N=new XMLHttpRequest;N.open("GET",e.src,!1),N.send(),me(N,e,n)}}else{let n=Object(C.to_luastring)(e.innerHTML),N=e.id?Object(C.to_luastring)("="+e.id):n;_e(e,n,N)}},e=/^(.*?\/.*?)([\t ]*;.*)?$/,n=/^(\d+)\.(\d+)$/,B=function(N){if("SCRIPT"!==N.tagName)return;let C=e.exec(N.type);if(!C)return;let et=C[1];if("application/lua"===et||"text/lua"===et){if(N.hasAttribute("lua-version")){let e=n.exec(N.getAttribute("lua-version"));if(!e||e[1]!==ec||e[2]!==ef)return}ve(N)}};"u">typeof MutationObserver?new MutationObserver(function(e,n){for(let n=0;n<e.length;n++){let N=e[n];for(let e=0;e<N.addedNodes.length;e++)B(N.addedNodes[e])}}).observe(document,{childList:!0,subtree:!0}):console.warn&&console.warn("fengari-web: MutationObserver not found; lua script tags will not be run when inserted"),Array.prototype.forEach.call(document.querySelectorAll('script[type^="application/lua"], script[type^="text/lua"]'),B)}},function(e,n,N){let{LUA_MULTRET:C,LUA_OPADD:et,LUA_OPBAND:ei,LUA_OPBNOT:eo,LUA_OPBOR:eu,LUA_OPBXOR:ec,LUA_OPDIV:ef,LUA_OPIDIV:eh,LUA_OPMOD:ep,LUA_OPSHL:ed,LUA_OPSHR:e_,LUA_OPUNM:eg,constant_types:{LUA_TBOOLEAN:em,LUA_TLIGHTUSERDATA:eb,LUA_TLNGSTR:ey,LUA_TNIL:ev,LUA_TNUMFLT:ek,LUA_TNUMINT:eA,LUA_TTABLE:eL},to_luastring:ex}=N(1),{lua_assert:ew}=N(4),eT=N(20),eO=N(6),eE=N(16),eS=N(23),eN=N(9),eI=N(15),eR=eE.OpCodesI,eU=eO.TValue,eC={OPR_ADD:0,OPR_SUB:1,OPR_MUL:2,OPR_MOD:3,OPR_POW:4,OPR_DIV:5,OPR_IDIV:6,OPR_BAND:7,OPR_BOR:8,OPR_BXOR:9,OPR_SHL:10,OPR_SHR:11,OPR_CONCAT:12,OPR_EQ:13,OPR_LT:14,OPR_LE:15,OPR_NE:16,OPR_GT:17,OPR_GE:18,OPR_AND:19,OPR_OR:20,OPR_NOBINOPR:21},eM={OPR_MINUS:0,OPR_BNOT:1,OPR_NOT:2,OPR_LEN:3,OPR_NOUNOPR:4},me=function(e){return e.t!==e.f},ve=function(e,n){let N=eS.expkind;if(me(e))return!1;switch(e.k){case N.VKINT:return!n||new eU(eA,e.u.ival);case N.VKFLT:return!n||new eU(ek,e.u.nval);default:return!1}},K=function(e,n,N){let C,et=n+N-1;if(e.pc>e.lasttarget&&(C=e.f.code[e.pc-1]).opcode===eR.OP_LOADNIL){let e=C.A,N=e+C.B;if(e<=n&&n<=N+1||n<=e&&e<=et+1)return e<n&&(n=e),N>et&&(et=N),eE.SETARG_A(C,n),void eE.SETARG_B(C,et-n)}te(e,eR.OP_LOADNIL,n,N-1,0)},I=function(e,n){return e.f.code[n.u.info]},B=function(e,n){let N=e.f.code[n].sBx;return -1===N?-1:n+1+N},ye=function(e,n,N){let C=e.f.code[n],et=N-(n+1);ew(-1!==N),Math.abs(et)>eE.MAXARG_sBx&&eT.luaX_syntaxerror(e.ls,ex("control structure too long",!0)),eE.SETARG_sBx(C,et)},be=function(e,n,N){if(-1===N)return n;if(-1===n)n=N;else{let C=n,et=B(e,C);for(;-1!==et;)et=B(e,C=et);ye(e,C,N)}return n},Ue=function(e){let n=e.jpc;e.jpc=-1;let N=S(e,eR.OP_JMP,0,-1);return be(e,N,n)},Xe=function(e,n,N,C,et){return te(e,n,N,C,et),Ue(e)},st=function(e){return e.lasttarget=e.pc,e.pc},Ze=function(e,n){return n>=1&&eE.testTMode(e.f.code[n-1].opcode)?n-1:n},ae=function(e,n){return e.f.code[Ze(e,n)]},le=function(e,n,N){let C=Ze(e,n),et=e.f.code[C];return et.opcode===eR.OP_TESTSET&&(N!==eE.NO_REG&&N!==et.B?eE.SETARG_A(et,N):e.f.code[C]=eE.CREATE_ABC(eR.OP_TEST,et.B,0,et.C),!0)},Pe=function(e,n){for(;-1!==n;n=B(e,n))le(e,n,eE.NO_REG)},xe=function(e,n,N,C,et){for(;-1!==n;){let ei=B(e,n);le(e,n,C)?ye(e,n,N):ye(e,n,et),n=ei}},ze=function(e,n){st(e),e.jpc=be(e,e.jpc,n)},g=function(e,n,N){N===e.pc?ze(e,n):(ew(N<e.pc),xe(e,n,N,eE.NO_REG,N))},ge=function(e,n){let N=e.f;return xe(e,e.jpc,e.pc,eE.NO_REG,e.pc),e.jpc=-1,N.code[e.pc]=n,N.lineinfo[e.pc]=e.ls.lastline,e.pc++},te=function(e,n,N,C,et){return ew(eE.getOpMode(n)===eE.iABC),ew(eE.getBMode(n)!==eE.OpArgN||0===C),ew(eE.getCMode(n)!==eE.OpArgN||0===et),ew(N<=eE.MAXARG_A&&C<=eE.MAXARG_B&&et<=eE.MAXARG_C),ge(e,eE.CREATE_ABC(n,N,C,et))},A=function(e,n,N,C){return ew(eE.getOpMode(n)===eE.iABx||eE.getOpMode(n)===eE.iAsBx),ew(eE.getCMode(n)===eE.OpArgN),ew(N<=eE.MAXARG_A&&C<=eE.MAXARG_Bx),ge(e,eE.CREATE_ABx(n,N,C))},S=function(e,n,N,C){return A(e,n,N,C+eE.MAXARG_sBx)},v=function(e,n){return ew(n<=eE.MAXARG_Ax),ge(e,eE.CREATE_Ax(eR.OP_EXTRAARG,n))},q=function(e,n,N){if(N<=eE.MAXARG_Bx)return A(e,eR.OP_LOADK,n,N);{let C=A(e,eR.OP_LOADKX,n,0);return v(e,N),C}},oe=function(e,n){let N=e.freereg+n;N>e.f.maxstacksize&&(N>=255&&eT.luaX_syntaxerror(e.ls,ex("function or expression needs too many registers",!0)),e.f.maxstacksize=N)},O=function(e,n){oe(e,n),e.freereg+=n},ee=function(e,n){!eE.ISK(n)&&n>=e.nactvar&&(e.freereg--,ew(n===e.freereg))},ce=function(e,n){n.k===eS.expkind.VNONRELOC&&ee(e,n.u.info)},Ne=function(e,n,N){let C=n.k===eS.expkind.VNONRELOC?n.u.info:-1,et=N.k===eS.expkind.VNONRELOC?N.u.info:-1;C>et?(ee(e,C),ee(e,et)):(ee(e,et),ee(e,C))},Ve=function(e,n,N){let C=e.f,et=eN.luaH_get(e.L,e.ls.h,n);if(et.ttisinteger()){let n=et.value;if(n<e.nk&&C.k[n].ttype()===N.ttype()&&C.k[n].value===N.value)return n}let ei=e.nk;return eN.luaH_setfrom(e.L,e.ls.h,n,new eO.TValue(eA,ei)),C.k[ei]=N,e.nk++,ei},nt=function(e,n){return Ve(e,new eU(eb,n),new eU(eA,n))},dt=function(e,n){let N=new eU(ek,n);return Ve(e,N,N)},xt=function(e,n){let N=new eU(em,n);return Ve(e,N,N)},Ot=function(e,n,N){let et=eS.expkind;if(n.k===et.VCALL)eE.SETARG_C(I(e,n),N+1);else if(n.k===et.VVARARG){let C=I(e,n);eE.SETARG_B(C,N+1),eE.SETARG_A(C,e.freereg),O(e,1)}else ew(N===C)},St=function(e,n){let N=eS.expkind;n.k===N.VCALL?(ew(2===I(e,n).C),n.k=N.VNONRELOC,n.u.info=I(e,n).A):n.k===N.VVARARG&&(eE.SETARG_B(I(e,n),2),n.k=N.VRELOCABLE)},D=function(e,n){let N=eS.expkind;switch(n.k){case N.VLOCAL:n.k=N.VNONRELOC;break;case N.VUPVAL:n.u.info=te(e,eR.OP_GETUPVAL,0,n.u.info,0),n.k=N.VRELOCABLE;break;case N.VINDEXED:{let C;ee(e,n.u.ind.idx),n.u.ind.vt===N.VLOCAL?(ee(e,n.u.ind.t),C=eR.OP_GETTABLE):(ew(n.u.ind.vt===N.VUPVAL),C=eR.OP_GETTABUP),n.u.info=te(e,C,0,n.u.ind.t,n.u.ind.idx),n.k=N.VRELOCABLE;break}case N.VVARARG:case N.VCALL:St(e,n)}},Ce=function(e,n,N,C){return st(e),te(e,eR.OP_LOADBOOL,n,N,C)},De=function(e,n,N){let C=eS.expkind;switch(D(e,n),n.k){case C.VNIL:K(e,N,1);break;case C.VFALSE:case C.VTRUE:te(e,eR.OP_LOADBOOL,N,n.k===C.VTRUE,0);break;case C.VK:q(e,N,n.u.info);break;case C.VKFLT:q(e,N,dt(e,n.u.nval));break;case C.VKINT:q(e,N,nt(e,n.u.ival));break;case C.VRELOCABLE:{let C=I(e,n);eE.SETARG_A(C,N);break}case C.VNONRELOC:N!==n.u.info&&te(e,eR.OP_MOVE,N,n.u.info,0);break;default:return void ew(n.k===C.VJMP)}n.u.info=N,n.k=C.VNONRELOC},Fe=function(e,n){n.k!==eS.expkind.VNONRELOC&&(O(e,1),De(e,n,e.freereg-1))},Se=function(e,n){for(;-1!==n;n=B(e,n))if(ae(e,n).opcode!==eR.OP_TESTSET)return!0;return!1},je=function(e,n,N){let C=eS.expkind;if(De(e,n,N),n.k===C.VJMP&&(n.t=be(e,n.t,n.u.info)),me(n)){let et,ei=-1,eo=-1;if(Se(e,n.t)||Se(e,n.f)){let et=n.k===C.VJMP?-1:Ue(e);ei=Ce(e,N,0,1),eo=Ce(e,N,1,0),ze(e,et)}et=st(e),xe(e,n.f,et,N,ei),xe(e,n.t,et,N,eo)}n.f=n.t=-1,n.u.info=N,n.k=C.VNONRELOC},We=function(e,n){D(e,n),ce(e,n),O(e,1),je(e,n,e.freereg-1)},bt=function(e,n){if(D(e,n),n.k===eS.expkind.VNONRELOC){if(!me(n))return n.u.info;if(n.u.info>=e.nactvar)return je(e,n,n.u.info),n.u.info}return We(e,n),n.u.info},vt=function(e,n){me(n)?bt(e,n):D(e,n)},yt=function(e,n){let N=eS.expkind,C=!1;switch(vt(e,n),n.k){case N.VTRUE:n.u.info=xt(e,!0),C=!0;break;case N.VFALSE:n.u.info=xt(e,!1),C=!0;break;case N.VNIL:let et,ei;n.u.info=(et=new eU(ev,null),ei=new eU(eL,e.ls.h),Ve(e,ei,et)),C=!0;break;case N.VKINT:n.u.info=nt(e,n.u.ival),C=!0;break;case N.VKFLT:n.u.info=dt(e,n.u.nval),C=!0;break;case N.VK:C=!0}return C&&(n.k=N.VK,n.u.info<=eE.MAXINDEXRK)?eE.RKASK(n.u.info):bt(e,n)},Rt=function(e,n){let N=ae(e,n.u.info);ew(eE.testTMode(N.opcode)&&N.opcode!==eR.OP_TESTSET&&N.opcode!==eR.OP_TEST),eE.SETARG_A(N,!N.A)},lt=function(e,n,N){if(n.k===eS.expkind.VRELOCABLE){let C=I(e,n);if(C.opcode===eR.OP_NOT)return e.pc--,Xe(e,eR.OP_TEST,C.B,0,!N)}return Fe(e,n),ce(e,n),Xe(e,eR.OP_TESTSET,eE.NO_REG,n.u.info,N)},pt=function(e,n){let N,C=eS.expkind;switch(D(e,n),n.k){case C.VJMP:Rt(e,n),N=n.u.info;break;case C.VK:case C.VKFLT:case C.VKINT:case C.VTRUE:N=-1;break;default:N=lt(e,n,0)}n.f=be(e,n.f,N),ze(e,n.t),n.t=-1},At=function(e,n){let N,C=eS.expkind;switch(D(e,n),n.k){case C.VJMP:N=n.u.info;break;case C.VNIL:case C.VFALSE:N=-1;break;default:N=lt(e,n,1)}n.t=be(e,n.t,N),ze(e,n.f),n.f=-1},o=function(e,n,N){let C,et,eg=eS.expkind;if(!(C=ve(n,!0))||!(et=ve(N,!0))||!function(e,n,N){switch(e){case ei:case eu:case ec:case ed:case e_:case eo:return!1!==eI.tointeger(n)&&!1!==eI.tointeger(N);case ef:case eh:case ep:return 0!==N.value;default:return 1}}(e,C,et))return 0;let em=new eU;if(eO.luaO_arith(null,e,C,et,em),em.ttisinteger())n.k=eg.VKINT,n.u.ival=em.value;else{let e=em.value;if(isNaN(e)||0===e)return!1;n.k=eg.VKFLT,n.u.nval=e}return!0},c=function(e,n,N,C,et){let ei=yt(e,C),eo=yt(e,N);Ne(e,N,C),N.u.info=te(e,n,0,eo,ei),N.k=eS.expkind.VRELOCABLE,x(e,et)},x=function(e,n){e.f.lineinfo[e.pc-1]=n};e.exports.BinOpr=eC,e.exports.NO_JUMP=-1,e.exports.UnOpr=eM,e.exports.getinstruction=I,e.exports.luaK_checkstack=oe,e.exports.luaK_code=ge,e.exports.luaK_codeABC=te,e.exports.luaK_codeABx=A,e.exports.luaK_codeAsBx=S,e.exports.luaK_codek=q,e.exports.luaK_concat=be,e.exports.luaK_dischargevars=D,e.exports.luaK_exp2RK=yt,e.exports.luaK_exp2anyreg=bt,e.exports.luaK_exp2anyregup=function(e,n){(n.k!==eS.expkind.VUPVAL||me(n))&&bt(e,n)},e.exports.luaK_exp2nextreg=We,e.exports.luaK_exp2val=vt,e.exports.luaK_fixline=x,e.exports.luaK_getlabel=st,e.exports.luaK_goiffalse=At,e.exports.luaK_goiftrue=pt,e.exports.luaK_indexed=function(e,n,N){let C=eS.expkind;ew(!me(n)&&(eS.vkisinreg(n.k)||n.k===C.VUPVAL)),n.u.ind.t=n.u.info,n.u.ind.idx=yt(e,N),n.u.ind.vt=n.k===C.VUPVAL?C.VUPVAL:C.VLOCAL,n.k=C.VINDEXED},e.exports.luaK_infix=function(e,n,N){switch(n){case eC.OPR_AND:pt(e,N);break;case eC.OPR_OR:At(e,N);break;case eC.OPR_CONCAT:We(e,N);break;case eC.OPR_ADD:case eC.OPR_SUB:case eC.OPR_MUL:case eC.OPR_DIV:case eC.OPR_IDIV:case eC.OPR_MOD:case eC.OPR_POW:case eC.OPR_BAND:case eC.OPR_BOR:case eC.OPR_BXOR:case eC.OPR_SHL:case eC.OPR_SHR:ve(N,!1)||yt(e,N);break;default:yt(e,N)}},e.exports.luaK_intK=nt,e.exports.luaK_jump=Ue,e.exports.luaK_jumpto=function(e,n){return g(e,Ue(e),n)},e.exports.luaK_nil=K,e.exports.luaK_numberK=dt,e.exports.luaK_patchclose=function(e,n,N){for(N++;-1!==n;n=B(e,n)){let C=e.f.code[n];ew(C.opcode===eR.OP_JMP&&(0===C.A||C.A>=N)),eE.SETARG_A(C,N)}},e.exports.luaK_patchlist=g,e.exports.luaK_patchtohere=ze,e.exports.luaK_posfix=function(e,n,N,C,ei){let eo=eS.expkind;switch(n){case eC.OPR_AND:ew(-1===N.t),D(e,C),C.f=be(e,C.f,N.f),N.to(C);break;case eC.OPR_OR:ew(-1===N.f),D(e,C),C.t=be(e,C.t,N.t),N.to(C);break;case eC.OPR_CONCAT:{vt(e,C);let n=I(e,C);C.k===eo.VRELOCABLE&&n.opcode===eR.OP_CONCAT?(ew(N.u.info===n.B-1),ce(e,N),eE.SETARG_B(n,N.u.info),N.k=eo.VRELOCABLE,N.u.info=C.u.info):(We(e,C),c(e,eR.OP_CONCAT,N,C,ei));break}case eC.OPR_ADD:case eC.OPR_SUB:case eC.OPR_MUL:case eC.OPR_DIV:case eC.OPR_IDIV:case eC.OPR_MOD:case eC.OPR_POW:case eC.OPR_BAND:case eC.OPR_BOR:case eC.OPR_BXOR:case eC.OPR_SHL:case eC.OPR_SHR:o(n+et,N,C)||c(e,n+eR.OP_ADD,N,C,ei);break;case eC.OPR_EQ:case eC.OPR_LT:case eC.OPR_LE:case eC.OPR_NE:case eC.OPR_GT:case eC.OPR_GE:(function(e,n,N,C){let et,ei=eS.expkind;N.k===ei.VK?et=eE.RKASK(N.u.info):(ew(N.k===ei.VNONRELOC),et=N.u.info);let eo=yt(e,C);switch(Ne(e,N,C),n){case eC.OPR_NE:N.u.info=Xe(e,eR.OP_EQ,0,et,eo);break;case eC.OPR_GT:case eC.OPR_GE:{let C=n-eC.OPR_NE+eR.OP_EQ;N.u.info=Xe(e,C,1,eo,et);break}default:{let C=n-eC.OPR_EQ+eR.OP_EQ;N.u.info=Xe(e,C,1,et,eo)}}N.k=ei.VJMP})(e,n,N,C)}return N},e.exports.luaK_prefix=function(e,n,N,C){let et=new eS.expdesc;switch(et.k=eS.expkind.VKINT,et.u.ival=et.u.nval=et.u.info=0,et.t=-1,et.f=-1,n){case eM.OPR_MINUS:case eM.OPR_BNOT:if(o(n+eg,N,et))break;case eM.OPR_LEN:var ei;let eo;ei=n+eR.OP_UNM,eo=bt(e,N),ce(e,N),N.u.info=te(e,ei,0,eo,0),N.k=eS.expkind.VRELOCABLE,x(e,C);break;case eM.OPR_NOT:(function(e,n){let N=eS.expkind;switch(D(e,n),n.k){case N.VNIL:case N.VFALSE:n.k=N.VTRUE;break;case N.VK:case N.VKFLT:case N.VKINT:case N.VTRUE:n.k=N.VFALSE;break;case N.VJMP:Rt(e,n);break;case N.VRELOCABLE:case N.VNONRELOC:Fe(e,n),ce(e,n),n.u.info=te(e,eR.OP_NOT,0,n.u.info,0),n.k=N.VRELOCABLE}{let e=n.f;n.f=n.t,n.t=e}Pe(e,n.f),Pe(e,n.t)})(e,N)}},e.exports.luaK_reserveregs=O,e.exports.luaK_ret=function(e,n,N){te(e,eR.OP_RETURN,n,N+1,0)},e.exports.luaK_self=function(e,n,N){bt(e,n);let C=n.u.info;ce(e,n),n.u.info=e.freereg,n.k=eS.expkind.VNONRELOC,O(e,2),te(e,eR.OP_SELF,n.u.info,C,yt(e,N)),ce(e,N)},e.exports.luaK_setlist=function(e,n,N,et){let ei=(N-1)/eE.LFIELDS_PER_FLUSH+1,eo=et===C?0:et;ew(0!==et&&et<=eE.LFIELDS_PER_FLUSH),ei<=eE.MAXARG_C?te(e,eR.OP_SETLIST,n,eo,ei):ei<=eE.MAXARG_Ax?(te(e,eR.OP_SETLIST,n,eo,0),v(e,ei)):eT.luaX_syntaxerror(e.ls,ex("constructor too long",!0)),e.freereg=n+1},e.exports.luaK_setmultret=function(e,n){Ot(e,n,C)},e.exports.luaK_setoneret=St,e.exports.luaK_setreturns=Ot,e.exports.luaK_storevar=function(e,n,N){let C=eS.expkind;switch(n.k){case C.VLOCAL:return ce(e,N),void je(e,N,n.u.info);case C.VUPVAL:{let C=bt(e,N);te(e,eR.OP_SETUPVAL,C,n.u.info,0);break}case C.VINDEXED:{let et=n.u.ind.vt===C.VLOCAL?eR.OP_SETTABLE:eR.OP_SETTABUP,ei=yt(e,N);te(e,et,n.u.ind.t,n.u.ind.idx,ei)}}ce(e,N)},e.exports.luaK_stringK=function(e,n){let N=new eU(ey,n);return Ve(e,N,N)}},function(e,n,N){let{LUA_SIGNATURE:C,constant_types:{LUA_TBOOLEAN:et,LUA_TLNGSTR:ei,LUA_TNIL:eo,LUA_TNUMFLT:eu,LUA_TNUMINT:ec,LUA_TSHRSTR:ef},thread_status:{LUA_ERRSYNTAX:eh},is_luastring:ep,luastring_eq:ed,to_luastring:e_}=N(1),eg=N(8),em=N(13),eb=N(6),{MAXARG_sBx:ey,POS_A:ev,POS_Ax:ek,POS_B:eA,POS_Bx:eL,POS_C:ex,POS_OP:ew,SIZE_A:eT,SIZE_Ax:eO,SIZE_B:eE,SIZE_Bx:eS,SIZE_C:eN,SIZE_OP:eI}=N(16),{lua_assert:eR}=N(4),{luaS_bless:eU}=N(10),{luaZ_read:eC,ZIO:eM}=N(19),eP=[25,147,13,10,26,10];let ve=class ve{constructor(e,n,N){this.intSize=4,this.size_tSize=4,this.instructionSize=4,this.integerSize=4,this.numberSize=8,eR(n instanceof eM,"BytecodeParser only operates on a ZIO"),eR(ep(N)),64===N[0]||61===N[0]?this.name=N.subarray(1):N[0]==C[0]?this.name=e_("binary string",!0):this.name=N,this.L=e,this.Z=n,this.arraybuffer=new ArrayBuffer(Math.max(this.intSize,this.size_tSize,this.instructionSize,this.integerSize,this.numberSize)),this.dv=new DataView(this.arraybuffer),this.u8=new Uint8Array(this.arraybuffer)}read(e){let n=new Uint8Array(e);return 0!==eC(this.Z,n,0,e)&&this.error("truncated"),n}LoadByte(){return 0!==eC(this.Z,this.u8,0,1)&&this.error("truncated"),this.u8[0]}LoadInt(){return 0!==eC(this.Z,this.u8,0,this.intSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadNumber(){return 0!==eC(this.Z,this.u8,0,this.numberSize)&&this.error("truncated"),this.dv.getFloat64(0,!0)}LoadInteger(){return 0!==eC(this.Z,this.u8,0,this.integerSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadSize_t(){return this.LoadInteger()}LoadString(){let e=this.LoadByte();return 255===e&&(e=this.LoadSize_t()),0===e?null:eU(this.L,this.read(e-1))}static MASK1(e,n){return~(-1<<e)<<n}LoadCode(e){let n=this.LoadInt();for(let N=0;N<n;N++){0!==eC(this.Z,this.u8,0,this.instructionSize)&&this.error("truncated");let n=this.dv.getUint32(0,!0);e.code[N]={code:n,opcode:n>>ew&ve.MASK1(eI,0),A:n>>ev&ve.MASK1(eT,0),B:n>>eA&ve.MASK1(eE,0),C:n>>ex&ve.MASK1(eN,0),Bx:n>>eL&ve.MASK1(eS,0),Ax:n>>ek&ve.MASK1(eO,0),sBx:(n>>eL&ve.MASK1(eS,0))-ey}}}LoadConstants(e){let n=this.LoadInt();for(let N=0;N<n;N++){let n=this.LoadByte();switch(n){case eo:e.k.push(new eb.TValue(eo,null));break;case et:e.k.push(new eb.TValue(et,0!==this.LoadByte()));break;case eu:e.k.push(new eb.TValue(eu,this.LoadNumber()));break;case ec:e.k.push(new eb.TValue(ec,this.LoadInteger()));break;case ef:case ei:e.k.push(new eb.TValue(ei,this.LoadString()));break;default:this.error(`unrecognized constant '${n}'`)}}}LoadProtos(e){let n=this.LoadInt();for(let N=0;N<n;N++)e.p[N]=new em.Proto(this.L),this.LoadFunction(e.p[N],e.source)}LoadUpvalues(e){let n=this.LoadInt();for(let N=0;N<n;N++)e.upvalues[N]={name:null,instack:this.LoadByte(),idx:this.LoadByte()}}LoadDebug(e){let n=this.LoadInt();for(let N=0;N<n;N++)e.lineinfo[N]=this.LoadInt();n=this.LoadInt();for(let N=0;N<n;N++)e.locvars[N]={varname:this.LoadString(),startpc:this.LoadInt(),endpc:this.LoadInt()};n=this.LoadInt();for(let N=0;N<n;N++)e.upvalues[N].name=this.LoadString()}LoadFunction(e,n){e.source=this.LoadString(),null===e.source&&(e.source=n),e.linedefined=this.LoadInt(),e.lastlinedefined=this.LoadInt(),e.numparams=this.LoadByte(),e.is_vararg=0!==this.LoadByte(),e.maxstacksize=this.LoadByte(),this.LoadCode(e),this.LoadConstants(e),this.LoadUpvalues(e),this.LoadProtos(e),this.LoadDebug(e)}checkliteral(e,n){ed(this.read(e.length),e)||this.error(n)}checkHeader(){this.checkliteral(C.subarray(1),"not a"),83!==this.LoadByte()&&this.error("version mismatch in"),0!==this.LoadByte()&&this.error("format mismatch in"),this.checkliteral(eP,"corrupted"),this.intSize=this.LoadByte(),this.size_tSize=this.LoadByte(),this.instructionSize=this.LoadByte(),this.integerSize=this.LoadByte(),this.numberSize=this.LoadByte(),this.checksize(this.intSize,4,"int"),this.checksize(this.size_tSize,4,"size_t"),this.checksize(this.instructionSize,4,"instruction"),this.checksize(this.integerSize,4,"integer"),this.checksize(this.numberSize,8,"number"),22136!==this.LoadInteger()&&this.error("endianness mismatch in"),370.5!==this.LoadNumber()&&this.error("float format mismatch in")}error(e){eb.luaO_pushfstring(this.L,e_("%s: %s precompiled chunk"),this.name,e_(e)),eg.luaD_throw(this.L,eh)}checksize(e,n,N){e!==n&&this.error(`${N} size mismatch in`)}};e.exports.luaU_undump=function(e,n,N){let C=new ve(e,n,N);C.checkHeader();let et=em.luaF_newLclosure(e,C.LoadByte());return eg.luaD_inctop(e),e.stack[e.top-1].setclLvalue(et),et.p=new em.Proto(e),C.LoadFunction(et.p,null),eR(et.nupvalues===et.p.upvalues.length),et}},function(e,n,N){let{LUA_SIGNATURE:C,LUA_VERSION_MAJOR:et,LUA_VERSION_MINOR:ei,constant_types:{LUA_TBOOLEAN:eo,LUA_TLNGSTR:eu,LUA_TNIL:ec,LUA_TNUMFLT:ef,LUA_TNUMINT:eh,LUA_TSHRSTR:ep},luastring_of:ed}=N(1),e_=ed(25,147,13,10,26,10),eg=16*Number(et)+Number(ei),f=function(e,n,N){0===N.status&&n>0&&(N.status=N.writer(N.L,e,n,N.data))},m=function(e,n){f(ed(e),1,n)},b=function(e,n){let N=new ArrayBuffer(4);new DataView(N).setInt32(0,e,!0),f(new Uint8Array(N),4,n)},R=function(e,n){let N=new ArrayBuffer(4);new DataView(N).setInt32(0,e,!0),f(new Uint8Array(N),4,n)},M=function(e,n){let N=new ArrayBuffer(8);new DataView(N).setFloat64(0,e,!0),f(new Uint8Array(N),8,n)},H=function(e,n){if(null===e)m(0,n);else{let N=e.tsslen()+1,C=e.getstr();N<255?m(N,n):(m(255,n),R(N,n)),f(C,N-1,n)}},z=function(e,n,N){N.strip||e.source===n?H(null,N):H(e.source,N),b(e.linedefined,N),b(e.lastlinedefined,N),m(e.numparams,N),m(e.is_vararg?1:0,N),m(e.maxstacksize,N),function(e,n){let N=e.code.map(e=>e.code);b(N.length,n);for(let e=0;e<N.length;e++)b(N[e],n)}(e,N),function(e,n){let N=e.k.length;b(N,n);for(let C=0;C<N;C++){let N=e.k[C];switch(m(N.ttype(),n),N.ttype()){case ec:break;case eo:m(N.value?1:0,n);break;case ef:M(N.value,n);break;case eh:R(N.value,n);break;case ep:case eu:H(N.tsvalue(),n)}}}(e,N),function(e,n){let N=e.upvalues.length;b(N,n);for(let C=0;C<N;C++)m(e.upvalues[C].instack?1:0,n),m(e.upvalues[C].idx,n)}(e,N),function(e,n){let N=e.p.length;b(N,n);for(let C=0;C<N;C++)z(e.p[C],e.source,n)}(e,N),function(e,n){let N=n.strip?0:e.lineinfo.length;b(N,n);for(let C=0;C<N;C++)b(e.lineinfo[C],n);b(N=n.strip?0:e.locvars.length,n);for(let C=0;C<N;C++)H(e.locvars[C].varname,n),b(e.locvars[C].startpc,n),b(e.locvars[C].endpc,n);b(N=n.strip?0:e.upvalues.length,n);for(let C=0;C<N;C++)H(e.upvalues[C].name,n)}(e,N)};e.exports.luaU_dump=function(e,n,N,et,ei){let eo=new class{constructor(){this.L=null,this.write=null,this.data=null,this.strip=NaN,this.status=NaN}};return eo.L=e,eo.writer=N,eo.data=et,eo.strip=ei,eo.status=0,f(C,C.length,eo),m(eg,eo),m(0,eo),f(e_,e_.length,eo),m(4,eo),m(4,eo),m(4,eo),m(4,eo),m(8,eo),R(22136,eo),M(370.5,eo),m(n.upvalues.length,eo),z(n,null,eo),eo.status}},function(e,n,N){var C;!function(){var et={not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function a(e){return function(e,n){var N,C,ei,eo,eu,ec,ef,eh,ep,ed=1,e_=e.length,eg="";for(C=0;C<e_;C++)if("string"==typeof e[C])eg+=e[C];else if(Array.isArray(e[C])){if((eo=e[C])[2])for(N=n[ed],ei=0;ei<eo[2].length;ei++){if(!N.hasOwnProperty(eo[2][ei]))throw Error(a('[sprintf] property "%s" does not exist',eo[2][ei]));N=N[eo[2][ei]]}else N=eo[1]?n[eo[1]]:n[ed++];if(et.not_type.test(eo[8])&&et.not_primitive.test(eo[8])&&N instanceof Function&&(N=N()),et.numeric_arg.test(eo[8])&&"number"!=typeof N&&isNaN(N))throw TypeError(a("[sprintf] expecting number but found %T",N));switch(et.number.test(eo[8])&&(eh=N>=0),eo[8]){case"b":N=parseInt(N,10).toString(2);break;case"c":N=String.fromCharCode(parseInt(N,10));break;case"d":case"i":N=parseInt(N,10);break;case"j":N=JSON.stringify(N,null,eo[6]?parseInt(eo[6]):0);break;case"e":N=eo[7]?parseFloat(N).toExponential(eo[7]):parseFloat(N).toExponential();break;case"f":N=eo[7]?parseFloat(N).toFixed(eo[7]):parseFloat(N);break;case"g":N=eo[7]?String(Number(N.toPrecision(eo[7]))):parseFloat(N);break;case"o":N=(parseInt(N,10)>>>0).toString(8);break;case"s":N=String(N),N=eo[7]?N.substring(0,eo[7]):N;break;case"t":N=String(!!N),N=eo[7]?N.substring(0,eo[7]):N;break;case"T":N=Object.prototype.toString.call(N).slice(8,-1).toLowerCase(),N=eo[7]?N.substring(0,eo[7]):N;break;case"u":N=parseInt(N,10)>>>0;break;case"v":N=N.valueOf(),N=eo[7]?N.substring(0,eo[7]):N;break;case"x":N=(parseInt(N,10)>>>0).toString(16);break;case"X":N=(parseInt(N,10)>>>0).toString(16).toUpperCase()}et.json.test(eo[8])?eg+=N:(et.number.test(eo[8])&&(!eh||eo[3])?(ep=eh?"+":"-",N=N.toString().replace(et.sign,"")):ep="",ec=eo[4]?"0"===eo[4]?"0":eo[4].charAt(1):" ",ef=eo[6]-(ep+N).length,eu=eo[6]&&ef>0?ec.repeat(ef):"",eg+=eo[5]?ep+N+eu:"0"===ec?ep+eu+N:eu+ep+N)}return eg}(function(e){if(ei[e])return ei[e];for(var n,N=e,C=[],eo=0;N;){if(null!==(n=et.text.exec(N)))C.push(n[0]);else if(null!==(n=et.modulo.exec(N)))C.push("%");else{if(null===(n=et.placeholder.exec(N)))throw SyntaxError("[sprintf] unexpected placeholder");if(n[2]){eo|=1;var eu=[],ec=n[2],ef=[];if(null===(ef=et.key.exec(ec)))throw SyntaxError("[sprintf] failed to parse named argument key");for(eu.push(ef[1]);""!==(ec=ec.substring(ef[0].length));)if(null!==(ef=et.key_access.exec(ec)))eu.push(ef[1]);else{if(null===(ef=et.index_access.exec(ec)))throw SyntaxError("[sprintf] failed to parse named argument key");eu.push(ef[1])}n[2]=eu}else eo|=2;if(3===eo)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");C.push(n)}N=N.substring(n[0].length)}return ei[e]=C}(e),arguments)}function i(e,n){return a.apply(null,[e].concat(n||[]))}var ei=Object.create(null);n.sprintf=a,n.vsprintf=i,"u">typeof window&&(window.sprintf=a,window.vsprintf=i,void 0===(C=(function(){return{sprintf:a,vsprintf:i}}).call(n,N,n,e))||(e.exports=C))}()},function(e,n,N){let{lua_pop:C}=N(2),{luaL_requiref:et}=N(7),{to_luastring:ei}=N(5),eo={};e.exports.luaL_openlibs=function(e){for(let n in eo)et(e,ei(n),eo[n],1),C(e,1)};let eu=N(17),{luaopen_base:ec}=N(24),{luaopen_coroutine:ef}=N(25),{luaopen_debug:eh}=N(31),{luaopen_math:ep}=N(30),{luaopen_package:ed}=N(32),{luaopen_os:e_}=N(27),{luaopen_string:eg}=N(28),{luaopen_table:em}=N(26),{luaopen_utf8:eb}=N(29);eo._G=ec,eo[eu.LUA_LOADLIBNAME]=ed,eo[eu.LUA_COLIBNAME]=ef,eo[eu.LUA_TABLIBNAME]=em,eo[eu.LUA_OSLIBNAME]=e_,eo[eu.LUA_STRLIBNAME]=eg,eo[eu.LUA_MATHLIBNAME]=ep,eo[eu.LUA_UTF8LIBNAME]=eb,eo[eu.LUA_DBLIBNAME]=eh;let{luaopen_fengari:ey}=N(33);eo[eu.LUA_FENGARILIBNAME]=ey}]);function gr(e,n){if("boolean"==typeof n)eg.lua.lua_pushboolean(e,n);else if("number"==typeof n)eg.lua.lua_pushnumber(e,n);else if("string"==typeof n)eg.lua.lua_pushstring(e,eg.to_luastring(n));else if(Array.isArray(n))eg.lua.lua_newtable(e),n.forEach((n,N)=>{gr(e,n),eg.lua.lua_rawseti(e,-2,N+1)});else if("object"==typeof n)eg.lua.lua_newtable(e),Object.entries(n).forEach(([n,N])=>{gr(e,N),eg.lua.lua_setfield(e,-2,n)});else throw`unknown type ${typeof n}`}function Qr(e,n){return eg.lua.lua_tojsstring(e,n)}function Os(e,n){eg.lua.lua_pushnil(e);let N={};for(;0!=eg.lua.lua_next(e,-2);)N[Qr(e,-2)]=es(e,-1),eg.lua.lua_pop(e,1);return N}function Ss(e){let n=es(e,-1);return eg.lua.lua_pop(e,1),n}function es(e,n){if(!eg.lua.lua_isnil(e,n)){if(eg.lua.lua_isboolean(e,n))return eg.lua.lua_toboolean(e,n);if(eg.lua.lua_isnumber(e,n))return eg.lua.lua_tonumber(e,n);if(eg.lua.lua_isstring(e,n))return Qr(e,n);if(eg.lua.lua_istable(e,n))return function(e,n){let N=eg.lua.lua_rawlen(e,n);if(0===N)return Os(e);let C=[];for(let n=0;n<N;++n){if(eg.lua.lua_rawgeti(e,-1,n+1),eg.lua.lua_isnil(e,-1))return eg.lua.lua_pop(e,1),Os(e);C.push(es(e,-1)),eg.lua.lua_pop(e,1)}return C}(e,n);throw`unknown type ${eg.lua.lua_typename(e,eg.lua.lua_type(e,n))}`}}function Cr(e,n,...N){if(eg.lua.lua_getglobal(e,eg.to_luastring(n,!0)),N.forEach(n=>{gr(e,n)}),eg.lua.lua_call(e,N.length,1)!==eg.lua.LUA_OK){let n=Qr(e,-1);if(n)throw Error(n)}}let ni=class ni{get luaState(){return this._luaState}constructor(e){this._luaState=e}};let si=class si{get luaState(){return this._instance.luaState}constructor(e){this._instance=e}saveState(){return Cr(this.luaState,"saveState"),Ss(this.luaState)}loadState(e){Cr(this.luaState,"loadState",e)}inputs(e){return Cr(this.luaState,"inputs",e),Ss(this.luaState)}};let oi=class oi{constructor(){this._exceptionLogged=!1}get id(){return 0}get label(){return"Agent"}get isBound(){return void 0!==this._vm}get isAgent(){return!0}get isPlayer(){return!1}loadAgent(e){return new Promise(n=>{let s=(e,N,C)=>{let et=function(e,n){switch(e){case"lua":return function(e){let n=function(e){let n=eg.lauxlib.luaL_newstate(),t=function(e,N){gr(n,N),eg.lua.lua_setglobal(n,eg.to_luastring(e))};if(void 0!==e.globals&&Object.entries(e.globals).forEach(([e,n])=>{console.log("register Lua global",e),t(e,n)}),void 0!==e.api&&Object.entries(e.api).forEach(([e,N])=>{console.log("register Lua api",e),eg.lua.lua_register(n,e,n=>{try{return N(n)}catch(n){throw Error(`error in ${e} implementation: ${n}`)}})}),void 0!==e.script&&eg.lauxlib.luaL_dostring(n,eg.to_luastring(e.script))!=eg.lua.LUA_OK){console.error(eg.to_jsstring(eg.lua.lua_tostring(n,-1)));return}return new ni(n)}({script:e});return void 0!==n?new si(n):void 0}(n);case"javascript":return function(e){let n={},N={exports:n},C=Object.keys(N),et=Function(...C,`${e}
; ${e_.map(e=>`if (typeof ${e} !== "undefined") exports.${e} = ${e}`).join(";")}`);return et(...C.map(e=>N[e])),new $a(et,n)}(n);default:return}}(e,C);this._agent={language:e,url:N,code:C},this.unloadAgent(),this._vm=et,this._exceptionLogged=!1,n()};void 0!==e.url?fetch(e.url).then(e=>e.text()).then(n=>s(void 0!==e.language?e.language:e.url.endsWith(".lua")?"lua":"javascript",e.url,n)):void 0!==e.code&&s(e.language??"javascript",void 0,e.code)})}unloadAgent(){this._vm=void 0}inputs(e){if(void 0!==this._vm)try{return this._vm.inputs(e)}catch(e){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling inputs",e))}return{}}saveState(){if(void 0!==this._vm)try{return this._vm.saveState()}catch(e){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling saveState",e))}return{}}loadState(e){if(void 0!==this._vm)try{this._vm.loadState(e)}catch(e){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling loadState",e))}}};let Rs=class Rs{get id(){return this._id}get label(){return this._agentController.isBound?this._agentController.label:void 0!==this._inputController?"human":"<>"}get isBound(){return void 0!==this._inputController}get isAgent(){return this._agentController.isBound}get isPlayer(){return this.isBound&&!this.isAgent}constructor(e,n){this._id=e,this._inputController=n,this._agentController=new oi}inputs(e){return this._agentController.isBound?this._agentController.inputs(e):void 0!==this._inputController?this._inputController.inputs:{}}loadAgent(e){return this._agentController.loadAgent(e)}unloadAgent(){this._agentController.unloadAgent()}saveState(){return this._agentController.saveState()}loadState(e){this._agentController.loadState(e)}};let li=class li{constructor(e){this._controllers=new Map,this._controllersArray=[new Rs(0,e.inputController()),new Rs(1)],this._controllers.set(0,this._controllersArray[0]),this._controllers.set(1,this._controllersArray[1])}get ids(){return[...this._controllers.keys()]}get controllers(){return this._controllers}get(e){return this._controllers.get(e)}inputs(e){return this._controllersArray.map(n=>({label:n.label,isBound:n.isBound,isPlayer:n.isPlayer,isAgent:n.isAgent,inputs:n.inputs(e)}))}saveState(){return[this._controllers.get(0).saveState(),this._controllers.get(1).saveState()]}loadState(e){this._controllers.get(0).loadState(e),this._controllers.get(1).loadState(e)}};let tr=class tr{constructor(e,n){this._el=document.createElement("div"),this._el.style.boxSizing="border-box",this._el.style.display="block",this._el.style.position="absolute",this._el.style.width="32px",this._el.style.height="32px",this._el.style.margin="4px",this._el.style.border="4px solid #fff",this._el.style.borderRadius="50%",this._el.style.animation="moroboxai-spinner-rotate 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite",this._el.style.borderColor="#fff transparent transparent transparent",void 0!==n&&(this._el.style.animationDelay=`-${n}s`),e.appendChild(this._el)}};let ui=class ui{constructor(e){this._el=document.createElement("div"),this._el.style.display="inline-block",this._el.style.position="relative",this._el.style.width="40px",this._el.style.height="40px",new tr(this._el,.45),new tr(this._el,.3),new tr(this._el,.15),new tr(this._el),e.appendChild(this._el);let n=document.getElementById("moroboxai-dynamic-style");n||((n=document.createElement("style")).id="moroboxai-dynamic-style",document.body.appendChild(n)),n.innerHTML=`@keyframes moroboxai-spinner-rotate {
   0% {
      transform: rotate(0deg);
   }
   100% {
      transform: rotate(360deg);
   }
}`}remove(){this._el.remove()}};let ts=class ts{get style(){return this.el.style}constructor(e){this.el=document.createElement("div"),this.el.style.width="100%",this.el.style.height="100%",this.el.style.position="absolute",this.el.style.left="0",this.el.style.top="0",this.el.style.display="flex",this.el.style.flexDirection="column",this.el.style.justifyContent="center",this.el.style.alignItems="center",e.appendChild(this.el)}show(){this.el.style.display="flex"}hide(){this.el.style.display="none"}remove(){this.el.remove()}};let ci=class ci{constructor(e){this._overlay=new ts(e),this._input=document.createElement("input"),this._input.type="button",this._input.value="Play",this._input.onclick=()=>{this.onPlay&&this.onPlay()},this._overlay.el.appendChild(this._input),e.appendChild(this._overlay.el)}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){}mouseMove(){}mouseLeave(){}remove(){this._overlay.remove()}};let fi=class fi{constructor(e){this._overlay=new ts(e),this._overlay.style.backgroundColor="black",new ui(this._overlay.el),e.appendChild(this._overlay.el)}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){}mouseMove(){}mouseLeave(){}remove(){this._overlay.remove()}};let hi=class hi{constructor(e){this._overlay=new ts(e),this._speed1=document.createElement("input"),this._speed1.type="button",this._speed1.value="x1",this._speed1.onclick=()=>{this.onSpeed&&this.onSpeed(1)},this._speed2=document.createElement("input"),this._speed2.type="button",this._speed2.value="x2",this._speed2.onclick=()=>{this.onSpeed&&this.onSpeed(2)},this._speed4=document.createElement("input"),this._speed4.type="button",this._speed4.value="x4",this._speed4.onclick=()=>{this.onSpeed&&this.onSpeed(4)},this._overlay.el.appendChild(this._speed1),this._overlay.el.appendChild(this._speed2),this._overlay.el.appendChild(this._speed4),this._overlay.hide(),e.appendChild(this._overlay.el)}playing(){}paused(){}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){this.show()}mouseMove(){}mouseLeave(){this.hide()}remove(){this._overlay.remove()}};let pi=class pi{constructor(e){this._root=e,this._playOverlay=new ci(e),this._selectedOverlay=this._playOverlay,this._playOverlay.onPlay=()=>{this.onPlay&&this.onPlay()},this._loadingOverlay=new fi(this._root),this._loadingOverlay.hide(),this._settingsOverlay=new hi(this._root),this._settingsOverlay.hide(),this._settingsOverlay.onSpeed=e=>{this.onSpeed&&this.onSpeed(e)}}stopped(){this._selectedOverlay.hide(),this._selectedOverlay=this._playOverlay,this._playOverlay.show()}loading(){this._playOverlay.hide(),this._selectedOverlay=this._loadingOverlay,this._loadingOverlay.show()}playing(){this._loadingOverlay.hide(),this._selectedOverlay=this._settingsOverlay,this._settingsOverlay.hide(),this._settingsOverlay.playing()}paused(){this._settingsOverlay.paused()}show(){}hide(){}mouseEnter(){this._selectedOverlay.mouseEnter()}mouseMove(){this._selectedOverlay.mouseMove()}mouseLeave(){this._selectedOverlay.mouseLeave()}remove(){this._playOverlay.remove(),this._loadingOverlay.remove(),this._settingsOverlay.remove()}};let mi=class mi{constructor(e,n,N){this.sortedPlugins=new Map,this.unfulfilledActions=new Set,this.plugins=[...N?N.plugins:[],...n],this.pluginContexts=new Map(this.plugins.map(n=>[n,e]))}hookFirst(e,n,N,C){return this.hookFirstAndGetPlugin(e,n,N,C).then(e=>e&&e[0])}async hookFirstAndGetPlugin(e,n,N,C){for(let et of this.getSortedPlugins(e)){if(null!=C&&C.has(et))continue;let ei=await this.runHook(e,n,et,N);if(null!=ei)return[ei,et]}return null}async hookParallel(e,n,N){let C=[];for(let et of this.getSortedPlugins(e))et[e].sequential?(await Promise.all(C),C.length=0,await this.runHook(e,n,et,N)):C.push(this.runHook(e,n,et,N));await Promise.all(C)}hookReduceArg0(e,[n,...N],C,et){let ei=Promise.resolve(n);for(let n of this.getSortedPlugins(e))ei=ei.then(ei=>this.runHook(e,[ei,...N],n,et).then(e=>C.call(this.pluginContexts.get(n),ei,e,n)));return ei}getSortedPlugins(e,n){return function(e,n,N){let C=e.get(n);if(void 0!==C)return C;let et=N();return e.set(n,et),et}(this.sortedPlugins,e,()=>(function(e,n,N=function(e,n,N){if("function"!=typeof e)throw`invalid plugin hook ${n} ${N}`}){let C=[],et=[],ei=[];for(let eo of n){let n=eo[e];if(n){if("object"==typeof n){if(N(n.handler,e,eo),"pre"===n.order){C.push(eo);continue}if("post"===n.order){ei.push(eo);continue}}else N(n,e,eo);et.push(eo)}}return[...C,...et,...ei]})(e,this.plugins,n))}runHook(e,n,N,C){let et=N[e],ei="object"==typeof et?et.handler:et,eo=this.pluginContexts.get(N);C&&(eo=C(eo,N));let eu=null;return Promise.resolve().then(()=>{if("function"!=typeof ei)return ei;let C=ei.apply(eo,n);return null!=C&&C.then?(eu=[N.name,e,n],this.unfulfilledActions.add(eu),Promise.resolve(C).then(e=>(this.unfulfilledActions.delete(eu),e))):C}).catch(e=>{throw null!==eu&&this.unfulfilledActions.delete(eu),e})}};let em=Symbol.for("yaml.alias"),eb=Symbol.for("yaml.document"),ey=Symbol.for("yaml.map"),ev=Symbol.for("yaml.pair"),ek=Symbol.for("yaml.scalar"),eA=Symbol.for("yaml.seq"),eL=Symbol.for("yaml.node.type"),An=e=>!!e&&"object"==typeof e&&e[eL]===em,Bn=e=>!!e&&"object"==typeof e&&e[eL]===eb,Cn=e=>!!e&&"object"==typeof e&&e[eL]===ey,Kt=e=>!!e&&"object"==typeof e&&e[eL]===ev,Gt=e=>!!e&&"object"==typeof e&&e[eL]===ek,Mn=e=>!!e&&"object"==typeof e&&e[eL]===eA;function Ht(e){if(e&&"object"==typeof e)switch(e[eL]){case ey:case eA:return!0}return!1}function Vt(e){if(e&&"object"==typeof e)switch(e[eL]){case em:case ey:case ek:case eA:return!0}return!1}let yi=e=>(Gt(e)||Ht(e))&&!!e.anchor,ex=Symbol("break visit"),ew=Symbol("skip children"),eT=Symbol("remove node");function gn(e,n){let N=Ys(n);Bn(e)?xn(null,e.contents,N,Object.freeze([e]))===eT&&(e.contents=null):xn(null,e,N,Object.freeze([]))}function xn(e,n,N,C){let et=Zs(e,n,N,C);if(Vt(et)||Kt(et))return qs(e,C,et),xn(e,et,N,C);if("symbol"!=typeof et){if(Ht(n)){C=Object.freeze(C.concat(n));for(let e=0;e<n.items.length;++e){let et=xn(e,n.items[e],N,C);if("number"==typeof et)e=et-1;else{if(et===ex)return ex;et===eT&&(n.items.splice(e,1),e-=1)}}}else if(Kt(n)){C=Object.freeze(C.concat(n));let e=xn("key",n.key,N,C);if(e===ex)return ex;e===eT&&(n.key=null);let et=xn("value",n.value,N,C);if(et===ex)return ex;et===eT&&(n.value=null)}}return et}async function mr(e,n){let N=Ys(n);Bn(e)?await En(null,e.contents,N,Object.freeze([e]))===eT&&(e.contents=null):await En(null,e,N,Object.freeze([]))}async function En(e,n,N,C){let et=await Zs(e,n,N,C);if(Vt(et)||Kt(et))return qs(e,C,et),En(e,et,N,C);if("symbol"!=typeof et){if(Ht(n)){C=Object.freeze(C.concat(n));for(let e=0;e<n.items.length;++e){let et=await En(e,n.items[e],N,C);if("number"==typeof et)e=et-1;else{if(et===ex)return ex;et===eT&&(n.items.splice(e,1),e-=1)}}}else if(Kt(n)){C=Object.freeze(C.concat(n));let e=await En("key",n.key,N,C);if(e===ex)return ex;e===eT&&(n.key=null);let et=await En("value",n.value,N,C);if(et===ex)return ex;et===eT&&(n.value=null)}}return et}function Ys(e){return"object"==typeof e&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function Zs(e,n,N,C){var et,ei,eo,eu,ec;return"function"==typeof N?N(e,n,C):Cn(n)?null==(et=N.Map)?void 0:et.call(N,e,n,C):Mn(n)?null==(ei=N.Seq)?void 0:ei.call(N,e,n,C):Kt(n)?null==(eo=N.Pair)?void 0:eo.call(N,e,n,C):Gt(n)?null==(eu=N.Scalar)?void 0:eu.call(N,e,n,C):An(n)?null==(ec=N.Alias)?void 0:ec.call(N,e,n,C):void 0}function qs(e,n,N){let C=n[n.length-1];if(Ht(C))C.items[e]=N;else if(Kt(C))"key"===e?C.key=N:C.value=N;else if(Bn(C))C.contents=N;else{let e=An(C)?"alias":"scalar";throw Error(`Cannot replace node with ${e} parent`)}}gn.BREAK=ex,gn.SKIP=ew,gn.REMOVE=eT,mr.BREAK=ex,mr.SKIP=ew,mr.REMOVE=eT;let eO={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},Li=e=>e.replace(/[!,[\]{}]/g,e=>eO[e]);let Wt=class Wt{constructor(e,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Wt.defaultYaml,e),this.tags=Object.assign({},Wt.defaultTags,n)}clone(){let e=new Wt(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){let e=new Wt(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Wt.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Wt.defaultTags)}return e}add(e,n){this.atNextDocument&&(this.yaml={explicit:Wt.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Wt.defaultTags),this.atNextDocument=!1);let N=e.trim().split(/[ \t]+/),C=N.shift();switch(C){case"%TAG":{if(2!==N.length&&(n(0,"%TAG directive should contain exactly two parts"),N.length<2))return!1;let[e,C]=N;return this.tags[e]=C,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==N.length)return n(0,"%YAML directive should contain exactly one part"),!1;let[e]=N;if("1.1"===e||"1.2"===e)return this.yaml.version=e,!0;{let N=/^\d+\.\d+$/.test(e);return n(6,`Unsupported YAML version ${e}`,N),!1}}default:return n(0,`Unknown directive ${C}`,!0),!1}}tagName(e,n){if("!"===e)return"!";if("!"!==e[0])return n(`Not a valid tag: ${e}`),null;if("<"===e[1]){let N=e.slice(2,-1);return"!"===N||"!!"===N?(n(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(">"!==e[e.length-1]&&n("Verbatim tags must end with a >"),N)}let[,N,C]=e.match(/^(.*!)([^!]*)$/);C||n(`The ${e} tag has no suffix`);let et=this.tags[N];return et?et+decodeURIComponent(C):"!"===N?e:(n(`Could not resolve tag: ${e}`),null)}tagString(e){for(let[n,N]of Object.entries(this.tags))if(e.startsWith(N))return n+Li(e.substring(N.length));return"!"===e[0]?e:`!<${e}>`}toString(e){let n;let N=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],C=Object.entries(this.tags);if(e&&C.length>0&&Vt(e.contents)){let N={};gn(e.contents,(e,n)=>{Vt(n)&&n.tag&&(N[n.tag]=!0)}),n=Object.keys(N)}else n=[];for(let[et,ei]of C)"!!"===et&&"tag:yaml.org,2002:"===ei||(!e||n.some(e=>e.startsWith(ei)))&&N.push(`%TAG ${et} ${ei}`);return N.join(`
`)}};function Ws(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){let n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(e)}`;throw Error(n)}return!0}function Js(e){let n=new Set;return gn(e,{Value(e,N){N.anchor&&n.add(N.anchor)}}),n}function Qs(e,n){for(let N=1;;++N){let C=`${e}${N}`;if(!n.has(C))return C}}function On(e,n,N,C){if(C&&"object"==typeof C){if(Array.isArray(C))for(let n=0,N=C.length;n<N;++n){let N=C[n],et=On(e,C,String(n),N);void 0===et?delete C[n]:et!==N&&(C[n]=et)}else if(C instanceof Map)for(let n of Array.from(C.keys())){let N=C.get(n),et=On(e,C,n,N);void 0===et?C.delete(n):et!==N&&C.set(n,et)}else if(C instanceof Set)for(let n of Array.from(C)){let N=On(e,C,n,n);void 0===N?C.delete(n):N!==n&&(C.delete(n),C.add(N))}else for(let[n,N]of Object.entries(C)){let et=On(e,C,n,N);void 0===et?delete C[n]:et!==N&&(C[n]=et)}}return e.call(n,N,C)}function nn(e,n,N){if(Array.isArray(e))return e.map((e,n)=>nn(e,String(n),N));if(e&&"function"==typeof e.toJSON){if(!N||!yi(e))return e.toJSON(n,N);let C={aliasCount:0,count:1,res:void 0};N.anchors.set(e,C),N.onCreate=e=>{C.res=e,delete N.onCreate};let et=e.toJSON(n,N);return N.onCreate&&N.onCreate(et),et}return"bigint"!=typeof e||null!=N&&N.keep?e:Number(e)}Wt.defaultYaml={explicit:!1,version:"1.2"},Wt.defaultTags={"!!":"tag:yaml.org,2002:"};let rs=class rs{constructor(e){Object.defineProperty(this,eL,{value:e})}clone(){let e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:n,maxAliasCount:N,onAnchor:C,reviver:et}={}){if(!Bn(e))throw TypeError("A document argument is required");let ei={anchors:new Map,doc:e,keep:!0,mapAsMap:!0===n,mapKeyWarned:!1,maxAliasCount:"number"==typeof N?N:100},eo=nn(this,"",ei);if("function"==typeof C)for(let{count:e,res:n}of ei.anchors.values())C(n,e);return"function"==typeof et?On(et,{"":eo},"",eo):eo}};let br=class br extends rs{constructor(e){super(em),this.source=e,Object.defineProperty(this,"tag",{set(){throw Error("Alias nodes cannot have tags")}})}resolve(e){let n;return gn(e,{Node:(e,N)=>{if(N===this)return gn.BREAK;N.anchor===this.source&&(n=N)}}),n}toJSON(e,n){if(!n)return{source:this.source};let{anchors:N,doc:C,maxAliasCount:et}=n,ei=this.resolve(C);if(!ei){let e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw ReferenceError(e)}let eo=N.get(ei);if(eo||(nn(ei,null,n),eo=N.get(ei)),!eo||void 0===eo.res)throw ReferenceError("This should not happen: Alias anchor was not resolved?");if(et>=0&&(eo.count+=1,0===eo.aliasCount&&(eo.aliasCount=function lr(e,n,N){if(An(n)){let C=n.resolve(e),et=N&&C&&N.get(C);return et?et.count*et.aliasCount:0}if(Ht(n)){let C=0;for(let et of n.items){let n=lr(e,et,N);n>C&&(C=n)}return C}if(Kt(n)){let C=lr(e,n.key,N),et=lr(e,n.value,N);return Math.max(C,et)}return 1}(C,ei,N)),eo.count*eo.aliasCount>et))throw ReferenceError("Excessive alias count indicates a resource exhaustion attack");return eo.res}toString(e,n,N){let C=`*${this.source}`;if(e){if(Ws(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){let e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw Error(e)}if(e.implicitKey)return`${C} `}return C}};let ea=e=>!e||"function"!=typeof e&&"object"!=typeof e;let It=class It extends rs{constructor(e){super(ek),this.value=e}toJSON(e,n){return null!=n&&n.keep?this.value:nn(this.value,e,n)}toString(){return String(this.value)}};function Yn(e,n,N){var C,et,ei;let eo;if(Bn(e)&&(e=e.contents),Vt(e))return e;if(Kt(e)){let n=null==(et=(C=N.schema[ey]).createNode)?void 0:et.call(C,N.schema,null,N);return n.items.push(e),n}(e instanceof String||e instanceof Number||e instanceof Boolean||"u">typeof BigInt&&e instanceof BigInt)&&(e=e.valueOf());let{aliasDuplicateObjects:eu,onAnchor:ec,onTagObj:ef,schema:eh,sourceObjects:ep}=N;if(eu&&e&&"object"==typeof e){if(eo=ep.get(e))return eo.anchor||(eo.anchor=ec(e)),new br(eo.anchor);eo={anchor:null,node:null},ep.set(e,eo)}null!=n&&n.startsWith("!!")&&(n="tag:yaml.org,2002:"+n.slice(2));let ed=function(e,n,N){if(n){let e=N.filter(e=>e.tag===n),C=e.find(e=>!e.format)??e[0];if(!C)throw Error(`Tag ${n} not found`);return C}return N.find(n=>{var N;return(null==(N=n.identify)?void 0:N.call(n,e))&&!n.format})}(e,n,eh.tags);if(!ed){if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),!e||"object"!=typeof e){let n=new It(e);return eo&&(eo.node=n),n}ed=e instanceof Map?eh[ey]:Symbol.iterator in Object(e)?eh[eA]:eh[ey]}ef&&(ef(ed),delete N.onTagObj);let e_=null!=ed&&ed.createNode?ed.createNode(N.schema,e,N):"function"==typeof(null==(ei=null==ed?void 0:ed.nodeClass)?void 0:ei.from)?ed.nodeClass.from(N.schema,e,N):new It(e);return n?e_.tag=n:ed.default||(e_.tag=ed.tag),eo&&(eo.node=e_),e_}function hr(e,n,N){let C=N;for(let e=n.length-1;e>=0;--e){let N=n[e];if("number"==typeof N&&Number.isInteger(N)&&N>=0){let e=[];e[N]=C,C=e}else C=new Map([[N,C]])}return Yn(C,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}It.BLOCK_FOLDED="BLOCK_FOLDED",It.BLOCK_LITERAL="BLOCK_LITERAL",It.PLAIN="PLAIN",It.QUOTE_DOUBLE="QUOTE_DOUBLE",It.QUOTE_SINGLE="QUOTE_SINGLE";let Vn=e=>null==e||"object"==typeof e&&!!e[Symbol.iterator]().next().done;let vr=class vr extends rs{constructor(e,n){super(e),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(e){let n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(n.schema=e),n.items=n.items.map(n=>Vt(n)||Kt(n)?n.clone(e):n),this.range&&(n.range=this.range.slice()),n}addIn(e,n){if(Vn(e))this.add(n);else{let[N,...C]=e,et=this.get(N,!0);if(Ht(et))et.addIn(C,n);else if(void 0===et&&this.schema)this.set(N,hr(this.schema,C,n));else throw Error(`Expected YAML collection at ${N}. Remaining path: ${C}`)}}deleteIn(e){let[n,...N]=e;if(0===N.length)return this.delete(n);let C=this.get(n,!0);if(Ht(C))return C.deleteIn(N);throw Error(`Expected YAML collection at ${n}. Remaining path: ${N}`)}getIn(e,n){let[N,...C]=e,et=this.get(N,!0);return 0===C.length?!n&&Gt(et)?et.value:et:Ht(et)?et.getIn(C,n):void 0}hasAllNullValues(e){return this.items.every(n=>{if(!Kt(n))return!1;let N=n.value;return null==N||e&&Gt(N)&&null==N.value&&!N.commentBefore&&!N.comment&&!N.tag})}hasIn(e){let[n,...N]=e;if(0===N.length)return this.has(n);let C=this.get(n,!0);return!!Ht(C)&&C.hasIn(N)}setIn(e,n){let[N,...C]=e;if(0===C.length)this.set(N,n);else{let e=this.get(N,!0);if(Ht(e))e.setIn(C,n);else if(void 0===e&&this.schema)this.set(N,hr(this.schema,C,n));else throw Error(`Expected YAML collection at ${N}. Remaining path: ${C}`)}}};vr.maxFlowStringSingleLineLength=60;let xi=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function fn(e,n){return/^\n+$/.test(e)?e.substring(1):n?e.replace(/^(?! *$)/gm,n):e}let dn=(e,n,N)=>e.endsWith(`
`)?fn(N,n):N.includes(`
`)?`
`+fn(N,n):(e.endsWith(" ")?"":" ")+N,eE="flow",eS="block",eN="quoted";function yr(e,n,N="flow",{indentAtStart:C,lineWidth:et=80,minContentWidth:ei=20,onFold:eo,onOverflow:eu}={}){if(!et||et<0)return e;let ec=Math.max(1+ei,1+et-n.length);if(e.length<=ec)return e;let ef=[],eh={},ep=et-n.length;"number"==typeof C&&(C>et-Math.max(2,ei)?ef.push(0):ep=et-C);let ed,e_,eg=!1,em=-1,eb=-1,ey=-1;N===eS&&-1!==(em=Ns(e,em))&&(ep=em+ec);for(let n;n=e[em+=1];){if(N===eN&&"\\"===n){switch(eb=em,e[em+1]){case"x":em+=3;break;case"u":em+=5;break;case"U":em+=9;break;default:em+=1}ey=em}if(n===`
`)N===eS&&(em=Ns(e,em)),ep=em+ec,ed=void 0;else{if(" "===n&&e_&&" "!==e_&&e_!==`
`&&"	"!==e_){let n=e[em+1];n&&" "!==n&&n!==`
`&&"	"!==n&&(ed=em)}if(em>=ep){if(ed)ef.push(ed),ep=ed+ec,ed=void 0;else if(N===eN){for(;" "===e_||"	"===e_;)e_=n,n=e[em+=1],eg=!0;let N=em>ey+1?em-2:eb-1;if(eh[N])return e;ef.push(N),eh[N]=!0,ep=N+ec,ed=void 0}else eg=!0}}e_=n}if(eg&&eu&&eu(),0===ef.length)return e;eo&&eo();let ev=e.slice(0,ef[0]);for(let C=0;C<ef.length;++C){let et=ef[C],ei=ef[C+1]||e.length;0===et?ev=`
${n}${e.slice(0,ei)}`:(N===eN&&eh[et]&&(ev+=`${e[et]}\\`),ev+=`
${n}${e.slice(et+1,ei)}`)}return ev}function Ns(e,n){let N=e[n+1];for(;" "===N||"	"===N;){do N=e[n+=1];while(N&&N!==`
`);N=e[n+1]}return n}let kr=(e,n)=>({indentAtStart:n?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),Lr=e=>/^(%|---|\.\.\.)/m.test(e);function $n(e,n){let N=JSON.stringify(e);if(n.options.doubleQuotedAsJSON)return N;let{implicitKey:C}=n,et=n.options.doubleQuotedMinMultiLineLength,ei=n.indent||(Lr(e)?"  ":""),eo="",eu=0;for(let e=0,n=N[e];n;n=N[++e])if(" "===n&&"\\"===N[e+1]&&"n"===N[e+2]&&(eo+=N.slice(eu,e)+"\\ ",e+=1,eu=e,n="\\"),"\\"===n)switch(N[e+1]){case"u":{eo+=N.slice(eu,e);let n=N.substr(e+2,4);switch(n){case"0000":eo+="\\0";break;case"0007":eo+="\\a";break;case"000b":eo+="\\v";break;case"001b":eo+="\\e";break;case"0085":eo+="\\N";break;case"00a0":eo+="\\_";break;case"2028":eo+="\\L";break;case"2029":eo+="\\P";break;default:"00"===n.substr(0,2)?eo+="\\x"+n.substr(2):eo+=N.substr(e,6)}e+=5,eu=e+1}break;case"n":if(C||'"'===N[e+2]||N.length<et)e+=1;else{for(eo+=N.slice(eu,e)+`

`;"\\"===N[e+2]&&"n"===N[e+3]&&'"'!==N[e+4];)eo+=`
`,e+=2;eo+=ei," "===N[e+2]&&(eo+="\\"),e+=1,eu=e+1}break;default:e+=1}return eo=eu?eo+N.slice(eu):N,C?eo:yr(eo,ei,eN,kr(n,!1))}function Yr(e,n){if(!1===n.options.singleQuote||n.implicitKey&&e.includes(`
`)||/[ \t]\n|\n[ \t]/.test(e))return $n(e,n);let N=n.indent||(Lr(e)?"  ":""),C="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&
${N}`)+"'";return n.implicitKey?C:yr(C,N,eE,kr(n,!1))}function Sn(e,n){let N;let{singleQuote:C}=n.options;if(!1===C)N=$n;else{let n=e.includes('"'),et=e.includes("'");N=n&&!et?Yr:et&&!n?$n:C?Yr:$n}return N(e,n)}try{C=RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{C=/\n+(?!\n|$)/g}function cr({comment:e,type:n,value:N},et,ei,eo){let eu,ec;let{blockQuote:ef,commentString:eh,lineWidth:ep}=et.options;if(!ef||/\n[\t ]+$/.test(N)||/^\s*$/.test(N))return Sn(N,et);let ed=et.indent||(et.forceBlockIndent||Lr(N)?"  ":""),e_="literal"===ef||"folded"!==ef&&n!==It.BLOCK_FOLDED&&(n===It.BLOCK_LITERAL||!function(e,n,N){if(!n||n<0)return!1;let C=n-N,et=e.length;if(et<=C)return!1;for(let n=0,N=0;n<et;++n)if(e[n]===`
`){if(n-N>C)return!0;if(et-(N=n+1)<=C)return!1}return!0}(N,ep,ed.length));if(!N)return e_?`|
`:`>
`;for(ec=N.length;ec>0;--ec){let e=N[ec-1];if(e!==`
`&&"	"!==e&&" "!==e)break}let eg=N.substring(ec),em=eg.indexOf(`
`);-1===em?eu="-":N===eg||em!==eg.length-1?(eu="+",eo&&eo()):eu="",eg&&(N=N.slice(0,-eg.length),eg[eg.length-1]===`
`&&(eg=eg.slice(0,-1)),eg=eg.replace(C,`$&${ed}`));let eb=!1,ey,ev=-1;for(ey=0;ey<N.length;++ey){let e=N[ey];if(" "===e)eb=!0;else if(e===`
`)ev=ey;else break}let ek=N.substring(0,ev<ey?ev+1:ey);ek&&(N=N.substring(ek.length),ek=ek.replace(/\n+/g,`$&${ed}`));let eA=(e_?"|":">")+(eb?ed?"2":"1":"")+eu;if(e&&(eA+=" "+eh(e.replace(/ ?[\r\n]+/g," ")),ei&&ei()),e_)return N=N.replace(/\n+/g,`$&${ed}`),`${eA}
${ed}${ek}${N}${eg}`;N=N.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${ed}`);let eL=yr(`${ek}${N}${eg}`,ed,eS,kr(et,!0));return`${eA}
${ed}${eL}`}function Wn(e,n,N,C){let{implicitKey:et,inFlow:ei}=n,eo="string"==typeof e.value?e:Object.assign({},e,{value:String(e.value)}),{type:eu}=e;eu!==It.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(eo.value)&&(eu=It.QUOTE_DOUBLE);let u=e=>{switch(e){case It.BLOCK_FOLDED:case It.BLOCK_LITERAL:return et||ei?Sn(eo.value,n):cr(eo,n,N,C);case It.QUOTE_DOUBLE:return $n(eo.value,n);case It.QUOTE_SINGLE:return Yr(eo.value,n);case It.PLAIN:return function(e,n,N,C){let{type:et,value:ei}=e,{actualString:eo,implicitKey:eu,indent:ec,indentStep:ef,inFlow:eh}=n;if(eu&&ei.includes(`
`)||eh&&/[[\]{},]/.test(ei))return Sn(ei,n);if(!ei||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(ei))return eu||eh||!ei.includes(`
`)?Sn(ei,n):cr(e,n,N,C);if(!eu&&!eh&&et!==It.PLAIN&&ei.includes(`
`))return cr(e,n,N,C);if(Lr(ei)){if(""===ec)return n.forceBlockIndent=!0,cr(e,n,N,C);if(eu&&ec===ef)return Sn(ei,n)}let ep=ei.replace(/\n+/g,`$&
${ec}`);if(eo){let L=e=>{var n;return e.default&&"tag:yaml.org,2002:str"!==e.tag&&(null==(n=e.test)?void 0:n.test(ep))},{compat:e,tags:N}=n.doc.schema;if(N.some(L)||null!=e&&e.some(L))return Sn(ei,n)}return eu?ep:yr(ep,ec,eE,kr(n,!1))}(eo,n,N,C);default:return null}},ec=u(eu);if(null===ec){let{defaultKeyType:e,defaultStringType:N}=n.options,C=et&&e||N;if(null===(ec=u(C)))throw Error(`Unsupported default string type ${C}`)}return ec}function na(e,n){let N;let C=Object.assign({blockQuote:!0,commentString:xi,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,n);switch(C.collectionStyle){case"block":N=!1;break;case"flow":N=!0;break;default:N=null}return{anchors:new Set,doc:e,flowCollectionPadding:C.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof C.indent?" ".repeat(C.indent):"  ",inFlow:N,options:C}}function Un(e,n,N,C){var et;let ei;if(Kt(e))return e.toString(n,N,C);if(An(e)){if(n.doc.directives)return e.toString(n);if(null!=(et=n.resolvedAliases)&&et.has(e))throw TypeError("Cannot stringify circular structure without alias nodes");n.resolvedAliases?n.resolvedAliases.add(e):n.resolvedAliases=new Set([e]),e=e.resolve(n.doc)}let eo=Vt(e)?e:n.doc.createNode(e,{onTagObj:e=>ei=e});ei||(ei=function(e,n){var N;let C,et;if(n.tag){let N=e.filter(e=>e.tag===n.tag);if(N.length>0)return N.find(e=>e.format===n.format)??N[0]}if(Gt(n)){et=n.value;let N=e.filter(e=>{var n;return null==(n=e.identify)?void 0:n.call(e,et)});C=N.find(e=>e.format===n.format)??N.find(e=>!e.format)}else et=n,C=e.find(e=>e.nodeClass&&et instanceof e.nodeClass);if(!C){let e=(null==(N=null==et?void 0:et.constructor)?void 0:N.name)??typeof et;throw Error(`Tag not resolved for ${e} value`)}return C}(n.doc.schema.tags,eo));let eu=function(e,n,{anchors:N,doc:C}){if(!C.directives)return"";let et=[],ei=(Gt(e)||Ht(e))&&e.anchor;ei&&Ws(ei)&&(N.add(ei),et.push(`&${ei}`));let eo=e.tag?e.tag:n.default?null:n.tag;return eo&&et.push(C.directives.tagString(eo)),et.join(" ")}(eo,ei,n);eu.length>0&&(n.indentAtStart=(n.indentAtStart??0)+eu.length+1);let ec="function"==typeof ei.stringify?ei.stringify(eo,n,N,C):Gt(eo)?Wn(eo,n,N,C):eo.toString(n,N,C);return eu?Gt(eo)||"{"===ec[0]||"["===ec[0]?`${eu} ${ec}`:`${eu}
${n.indent}${ec}`:ec}function ra(e,n){("debug"===e||"warn"===e)&&("u">typeof ec&&ec.emitWarning?ec.emitWarning(n):console.warn(n))}function sa(e,n,{key:N,value:C}){if(null!=e&&e.doc.schema.merge&&Ui(N)){if(Mn(C=An(C)?C.resolve(e.doc):C))for(let N of C.items)Mr(e,n,N);else if(Array.isArray(C))for(let N of C)Mr(e,n,N);else Mr(e,n,C)}else{let et=nn(N,"",e);if(n instanceof Map)n.set(et,nn(C,et,e));else if(n instanceof Set)n.add(et);else{let ei=function(e,n,N){if(null===n)return"";if("object"!=typeof n)return String(n);if(Vt(e)&&null!=N&&N.doc){let n=na(N.doc,{});for(let e of(n.anchors=new Set,N.anchors.keys()))n.anchors.add(e.anchor);n.inFlow=!0,n.inStringifyKey=!0;let C=e.toString(n);if(!N.mapKeyWarned){let e=JSON.stringify(C);e.length>40&&(e=e.substring(0,36)+'..."'),ra(N.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${e}. Set mapAsMap: true to use object keys.`),N.mapKeyWarned=!0}return C}return JSON.stringify(n)}(N,et,e),eo=nn(C,ei,e);ei in n?Object.defineProperty(n,ei,{value:eo,writable:!0,enumerable:!0,configurable:!0}):n[ei]=eo}}return n}let Ui=e=>"<<"===e||Gt(e)&&"<<"===e.value&&(!e.type||e.type===It.PLAIN);function Mr(e,n,N){let C=e&&An(N)?N.resolve(e.doc):N;if(!Cn(C))throw Error("Merge sources must be maps or map aliases");let et=C.toJSON(null,e,Map);for(let[e,N]of et)n instanceof Map?n.has(e)||n.set(e,N):n instanceof Set?n.add(e):Object.prototype.hasOwnProperty.call(n,e)||Object.defineProperty(n,e,{value:N,writable:!0,enumerable:!0,configurable:!0});return n}function ss(e,n,N){let C=Yn(e,void 0,N),et=Yn(n,void 0,N);return new Yt(C,et)}let Yt=class Yt{constructor(e,n=null){Object.defineProperty(this,eL,{value:ev}),this.key=e,this.value=n}clone(e){let{key:n,value:N}=this;return Vt(n)&&(n=n.clone(e)),Vt(N)&&(N=N.clone(e)),new Yt(n,N)}toJSON(e,n){let N=null!=n&&n.mapAsMap?new Map:{};return sa(n,N,this)}toString(e,n,N){return null!=e&&e.doc?function({key:e,value:n},N,C,et){let ei,eo,eu;let{allNullValues:ec,doc:ef,indent:eh,indentStep:ep,options:{commentString:ed,indentSeq:e_,simpleKeys:eg}}=N,em=Vt(e)&&e.comment||null;if(eg){if(em)throw Error("With simple keys, key nodes cannot have comments");if(Ht(e))throw Error("With simple keys, collection cannot be used as a key value")}let eb=!eg&&(!e||em&&null==n&&!N.inFlow||Ht(e)||(Gt(e)?e.type===It.BLOCK_FOLDED||e.type===It.BLOCK_LITERAL:"object"==typeof e));N=Object.assign({},N,{allNullValues:!1,implicitKey:!eb&&(eg||!ec),indent:eh+ep});let ey=!1,ev=!1,ek=Un(e,N,()=>ey=!0,()=>ev=!0);if(!eb&&!N.inFlow&&ek.length>1024){if(eg)throw Error("With simple keys, single line scalar must not span more than 1024 characters");eb=!0}if(N.inFlow){if(ec||null==n)return ey&&C&&C(),""===ek?"?":eb?`? ${ek}`:ek}else if(ec&&!eg||null==n&&eb)return ek=`? ${ek}`,em&&!ey?ek+=dn(ek,N.indent,ed(em)):ev&&et&&et(),ek;ey&&(em=null),eb?(em&&(ek+=dn(ek,N.indent,ed(em))),ek=`? ${ek}
${eh}:`):(ek=`${ek}:`,em&&(ek+=dn(ek,N.indent,ed(em)))),Vt(n)?(ei=!!n.spaceBefore,eo=n.commentBefore,eu=n.comment):(ei=!1,eo=null,eu=null,n&&"object"==typeof n&&(n=ef.createNode(n))),N.implicitKey=!1,!eb&&!em&&Gt(n)&&(N.indentAtStart=ek.length+1),ev=!1,!(!e_&&ep.length>=2&&!N.inFlow&&!eb&&Mn(n))||n.flow||n.tag||n.anchor||(N.indent=N.indent.substring(2));let eA=!1,eL=Un(n,N,()=>eA=!0,()=>ev=!0),ex=" ";if(em||ei||eo){if(ex=ei?`
`:"",eo){let e=ed(eo);ex+=`
${fn(e,N.indent)}`}""!==eL||N.inFlow?ex+=`
${N.indent}`:ex===`
`&&(ex=`

`)}else if(!eb&&Ht(n)){let e=eL[0],C=eL.indexOf(`
`),et=-1!==C,ei=N.inFlow??n.flow??0===n.items.length;if(et||!ei){let n=!1;if(et&&("&"===e||"!"===e)){let N=eL.indexOf(" ");"&"===e&&-1!==N&&N<C&&"!"===eL[N+1]&&(N=eL.indexOf(" ",N+1)),(-1===N||C<N)&&(n=!0)}n||(ex=`
${N.indent}`)}}else(""===eL||eL[0]===`
`)&&(ex="");return ek+=ex+eL,N.inFlow?eA&&C&&C():eu&&!eA?ek+=dn(ek,N.indent,ed(eu)):ev&&et&&et(),ek}(this,e,n,N):JSON.stringify(this)}};function aa(e,n,N){return(n.inFlow??e.flow?function({comment:e,items:n},N,{flowChars:C,itemIndent:et,onComment:ei}){let eo;let{indent:eu,indentStep:ec,flowCollectionPadding:ef,options:{commentString:eh}}=N;et+=ec;let ep=Object.assign({},N,{indent:et,inFlow:!0,type:null}),ed=!1,e_=0,eg=[];for(let e=0;e<n.length;++e){let C=n[e],ei=null;if(Vt(C))C.spaceBefore&&eg.push(""),pr(N,eg,C.commentBefore,!1),C.comment&&(ei=C.comment);else if(Kt(C)){let e=Vt(C.key)?C.key:null;e&&(e.spaceBefore&&eg.push(""),pr(N,eg,e.commentBefore,!1),e.comment&&(ed=!0));let n=Vt(C.value)?C.value:null;n?(n.comment&&(ei=n.comment),n.commentBefore&&(ed=!0)):null==C.value&&null!=e&&e.comment&&(ei=e.comment)}ei&&(ed=!0);let eo=Un(C,ep,()=>ei=null);e<n.length-1&&(eo+=","),ei&&(eo+=dn(eo,et,eh(ei))),!ed&&(eg.length>e_||eo.includes(`
`))&&(ed=!0),eg.push(eo),e_=eg.length}let{start:em,end:eb}=C;if(0===eg.length)eo=em+eb;else if(ed||(ed=eg.reduce((e,n)=>e+n.length+2,2)>vr.maxFlowStringSingleLineLength),ed){for(let e of(eo=em,eg))eo+=e?`
${ec}${eu}${e}`:`
`;eo+=`
${eu}${eb}`}else eo=`${em}${ef}${eg.join(" ")}${ef}${eb}`;return e&&(eo+=dn(eo,eu,eh(e)),ei&&ei()),eo}:function({comment:e,items:n},N,{blockItemPrefix:C,flowChars:et,itemIndent:ei,onChompKeep:eo,onComment:eu}){let ec;let{indent:ef,options:{commentString:eh}}=N,ep=Object.assign({},N,{indent:ei,type:null}),ed=!1,e_=[];for(let e=0;e<n.length;++e){let et=n[e],eo=null;if(Vt(et))!ed&&et.spaceBefore&&e_.push(""),pr(N,e_,et.commentBefore,ed),et.comment&&(eo=et.comment);else if(Kt(et)){let e=Vt(et.key)?et.key:null;e&&(!ed&&e.spaceBefore&&e_.push(""),pr(N,e_,e.commentBefore,ed))}ed=!1;let eu=Un(et,ep,()=>eo=null,()=>ed=!0);eo&&(eu+=dn(eu,ei,eh(eo))),ed&&eo&&(ed=!1),e_.push(C+eu)}if(0===e_.length)ec=et.start+et.end;else{ec=e_[0];for(let e=1;e<e_.length;++e){let n=e_[e];ec+=n?`
${ef}${n}`:`
`}}return e?(ec+=`
`+fn(eh(e),ef),eu&&eu()):ed&&eo&&eo(),ec})(e,n,N)}function pr({indent:e,options:{commentString:n}},N,C,et){if(C&&et&&(C=C.replace(/^\n+/,"")),C){let et=fn(n(C),e);N.push(et.trimStart())}}function yn(e,n){let N=Gt(n)?n.value:n;for(let C of e)if(Kt(C)&&(C.key===n||C.key===N||Gt(C.key)&&C.key.value===N))return C}let en=class en extends vr{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(ey,e),this.items=[]}static from(e,n,N){let{keepUndefined:C,replacer:et}=N,ei=new this(e),l=(e,eo)=>{if("function"==typeof et)eo=et.call(n,e,eo);else if(Array.isArray(et)&&!et.includes(e))return;(void 0!==eo||C)&&ei.items.push(ss(e,eo,N))};if(n instanceof Map)for(let[e,N]of n)l(e,N);else if(n&&"object"==typeof n)for(let e of Object.keys(n))l(e,n[e]);return"function"==typeof e.sortMapEntries&&ei.items.sort(e.sortMapEntries),ei}add(e,n){var N;let C;C=Kt(e)?e:e&&"object"==typeof e&&"key"in e?new Yt(e.key,e.value):new Yt(e,null==e?void 0:e.value);let et=yn(this.items,C.key),ei=null==(N=this.schema)?void 0:N.sortMapEntries;if(et){if(!n)throw Error(`Key ${C.key} already set`);Gt(et.value)&&ea(C.value)?et.value.value=C.value:et.value=C.value}else if(ei){let e=this.items.findIndex(e=>0>ei(C,e));-1===e?this.items.push(C):this.items.splice(e,0,C)}else this.items.push(C)}delete(e){let n=yn(this.items,e);return!!n&&this.items.splice(this.items.indexOf(n),1).length>0}get(e,n){let N=yn(this.items,e),C=null==N?void 0:N.value;return(!n&&Gt(C)?C.value:C)??void 0}has(e){return!!yn(this.items,e)}set(e,n){this.add(new Yt(e,n),!0)}toJSON(e,n,N){let C=N?new N:null!=n&&n.mapAsMap?new Map:{};for(let e of(null!=n&&n.onCreate&&n.onCreate(C),this.items))sa(n,C,e);return C}toString(e,n,N){if(!e)return JSON.stringify(this);for(let e of this.items)if(!Kt(e))throw Error(`Map items must all be pairs; found ${JSON.stringify(e)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),aa(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:N,onComment:n})}};let eI={collection:"map",default:!0,nodeClass:en,tag:"tag:yaml.org,2002:map",resolve:(e,n)=>(Cn(e)||n("Expected a mapping for this tag"),e),createNode:(e,n,N)=>en.from(e,n,N)};let mn=class mn extends vr{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(eA,e),this.items=[]}add(e){this.items.push(e)}delete(e){let n=nr(e);return"number"==typeof n&&this.items.splice(n,1).length>0}get(e,n){let N=nr(e);if("number"!=typeof N)return;let C=this.items[N];return!n&&Gt(C)?C.value:C}has(e){let n=nr(e);return"number"==typeof n&&n<this.items.length}set(e,n){let N=nr(e);if("number"!=typeof N)throw Error(`Expected a valid index, not ${e}.`);let C=this.items[N];Gt(C)&&ea(n)?C.value=n:this.items[N]=n}toJSON(e,n){let N=[];null!=n&&n.onCreate&&n.onCreate(N);let C=0;for(let e of this.items)N.push(nn(e,String(C++),n));return N}toString(e,n,N){return e?aa(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:N,onComment:n}):JSON.stringify(this)}static from(e,n,N){let{replacer:C}=N,et=new this(e);if(n&&Symbol.iterator in Object(n)){let e=0;for(let ei of n){if("function"==typeof C){let N=n instanceof Set?ei:String(e++);ei=C.call(n,N,ei)}et.items.push(Yn(ei,void 0,N))}}return et}};function nr(e){let n=Gt(e)?e.value:e;return n&&"string"==typeof n&&(n=Number(n)),"number"==typeof n&&Number.isInteger(n)&&n>=0?n:null}let eR={collection:"seq",default:!0,nodeClass:mn,tag:"tag:yaml.org,2002:seq",resolve:(e,n)=>(Mn(e)||n("Expected a sequence for this tag"),e),createNode:(e,n,N)=>mn.from(e,n,N)},eU={identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:(e,n,N,C)=>Wn(e,n=Object.assign({actualString:!0},n),N,C)},eC={identify:e=>null==e,createNode:()=>new It(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new It(null),stringify:({source:e},n)=>"string"==typeof e&&eC.test.test(e)?e:n.options.nullStr},eM={identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new It("t"===e[0]||"T"===e[0]),stringify({source:e,value:n},N){if(e&&eM.test.test(e)){let N="t"===e[0]||"T"===e[0];if(n===N)return e}return n?N.options.trueStr:N.options.falseStr}};function an({format:e,minFractionDigits:n,tag:N,value:C}){if("bigint"==typeof C)return String(C);let et="number"==typeof C?C:Number(C);if(!isFinite(et))return isNaN(et)?".nan":et<0?"-.inf":".inf";let ei=JSON.stringify(C);if(!e&&n&&(!N||"tag:yaml.org,2002:float"===N)&&/^\d/.test(ei)){let e=ei.indexOf(".");e<0&&(e=ei.length,ei+=".");let N=n-(ei.length-e-1);for(;N-- >0;)ei+="0"}return ei}let eP={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:an},eD={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){let n=Number(e.value);return isFinite(n)?n.toExponential():an(e)}},eB={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){let n=new It(parseFloat(e)),N=e.indexOf(".");return -1!==N&&"0"===e[e.length-1]&&(n.minFractionDigits=e.length-N-1),n},stringify:an},Tr=e=>"bigint"==typeof e||Number.isInteger(e),is=(e,n,N,{intAsBigInt:C})=>C?BigInt(e):parseInt(e.substring(n),N);function ua(e,n,N){let{value:C}=e;return Tr(C)&&C>=0?N+C.toString(n):an(e)}let eK={identify:e=>Tr(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,n,N)=>is(e,2,8,N),stringify:e=>ua(e,8,"0o")},eF={identify:Tr,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,n,N)=>is(e,0,10,N),stringify:an},eV={identify:e=>Tr(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,n,N)=>is(e,2,16,N),stringify:e=>ua(e,16,"0x")},eG=[eI,eR,eU,eC,eM,eK,eF,eV,eP,eD,eB];function Is(e){return"bigint"==typeof e||Number.isInteger(e)}let rr=({value:e})=>JSON.stringify(e),ej=[{identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:rr},{identify:e=>null==e,createNode:()=>new It(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:rr},{identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:e=>"true"===e,stringify:rr},{identify:Is,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,n,{intAsBigInt:N})=>N?BigInt(e):parseInt(e,10),stringify:({value:e})=>Is(e)?e.toString():JSON.stringify(e)},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:rr}],ez=[eI,eR].concat(ej,{default:!0,tag:"",test:/^/,resolve:(e,n)=>(n(`Unresolved plain scalar ${JSON.stringify(e)}`),e)}),eH={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,n){if("function"==typeof ef)return ef.from(e,"base64");if("function"!=typeof atob)return n("This environment does not support reading binary tags; either Buffer or atob is required"),e;{let n=atob(e.replace(/[\n\r]/g,"")),N=new Uint8Array(n.length);for(let e=0;e<n.length;++e)N[e]=n.charCodeAt(e);return N}},stringify({comment:e,type:n,value:N},C,et,ei){let eo;if("function"==typeof ef)eo=N instanceof ef?N.toString("base64"):ef.from(N.buffer).toString("base64");else if("function"==typeof btoa){let e="";for(let n=0;n<N.length;++n)e+=String.fromCharCode(N[n]);eo=btoa(e)}else throw Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(n||(n=It.BLOCK_LITERAL),n!==It.QUOTE_DOUBLE){let e=Math.max(C.options.lineWidth-C.indent.length,C.options.minContentWidth),N=Math.ceil(eo.length/e),et=Array(N);for(let n=0,C=0;n<N;++n,C+=e)et[n]=eo.substr(C,e);eo=et.join(n===It.BLOCK_LITERAL?`
`:" ")}return Wn({comment:e,type:n,value:eo},C,et,ei)}};function pa(e,n){if(Mn(e))for(let N=0;N<e.items.length;++N){let C=e.items[N];if(!Kt(C)){if(Cn(C)){C.items.length>1&&n("Each pair must have its own sequence indicator");let e=C.items[0]||new Yt(new It(null));if(C.commentBefore&&(e.key.commentBefore=e.key.commentBefore?`${C.commentBefore}
${e.key.commentBefore}`:C.commentBefore),C.comment){let n=e.value??e.key;n.comment=n.comment?`${C.comment}
${n.comment}`:C.comment}C=e}e.items[N]=Kt(C)?C:new Yt(C)}}else n("Expected a sequence for this tag");return e}function da(e,n,N){let{replacer:C}=N,et=new mn(e);et.tag="tag:yaml.org,2002:pairs";let ei=0;if(n&&Symbol.iterator in Object(n))for(let e of n){let eo,eu;if("function"==typeof C&&(e=C.call(n,String(ei++),e)),Array.isArray(e)){if(2===e.length)eo=e[0],eu=e[1];else throw TypeError(`Expected [key, value] tuple: ${e}`)}else if(e&&e instanceof Object){let n=Object.keys(e);if(1===n.length)eu=e[eo=n[0]];else throw TypeError(`Expected tuple with one key, not ${n.length} keys`)}else eo=e;et.items.push(ss(eo,eu,N))}return et}let e$={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:pa,createNode:da};let Rn=class Rn extends mn{constructor(){super(),this.add=en.prototype.add.bind(this),this.delete=en.prototype.delete.bind(this),this.get=en.prototype.get.bind(this),this.has=en.prototype.has.bind(this),this.set=en.prototype.set.bind(this),this.tag=Rn.tag}toJSON(e,n){if(!n)return super.toJSON(e);let N=new Map;for(let e of(null!=n&&n.onCreate&&n.onCreate(N),this.items)){let C,et;if(Kt(e)?(C=nn(e.key,"",n),et=nn(e.value,C,n)):C=nn(e,"",n),N.has(C))throw Error("Ordered maps must not include duplicate keys");N.set(C,et)}return N}static from(e,n,N){let C=da(e,n,N),et=new this;return et.items=C.items,et}};Rn.tag="tag:yaml.org,2002:omap";let eX={collection:"seq",identify:e=>e instanceof Map,nodeClass:Rn,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,n){let N=pa(e,n),C=[];for(let{key:e}of N.items)Gt(e)&&(C.includes(e.value)?n(`Ordered maps must not include duplicate keys: ${e.value}`):C.push(e.value));return Object.assign(new Rn,N)},createNode:(e,n,N)=>Rn.from(e,n,N)};function _a({value:e,source:n},N){return n&&(e?eq:eW).test.test(n)?n:e?N.options.trueStr:N.options.falseStr}let eq={identify:e=>!0===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new It(!0),stringify:_a},eW={identify:e=>!1===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>new It(!1),stringify:_a},Jn=e=>"bigint"==typeof e||Number.isInteger(e);function xr(e,n,N,{intAsBigInt:C}){let et=e[0];if(("-"===et||"+"===et)&&(n+=1),e=e.substring(n).replace(/_/g,""),C){switch(N){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`}let n=BigInt(e);return"-"===et?BigInt(-1)*n:n}let ei=parseInt(e,N);return"-"===et?-1*ei:ei}function cs(e,n,N){let{value:C}=e;if(Jn(C)){let e=C.toString(n);return C<0?"-"+N+e.substr(1):N+e}return an(e)}let Nn=class Nn extends en{constructor(e){super(e),this.tag=Nn.tag}add(e){let n;n=Kt(e)?e:e&&"object"==typeof e&&"key"in e&&"value"in e&&null===e.value?new Yt(e.key,null):new Yt(e,null),yn(this.items,n.key)||this.items.push(n)}get(e,n){let N=yn(this.items,e);return!n&&Kt(N)?Gt(N.key)?N.key.value:N.key:N}set(e,n){if("boolean"!=typeof n)throw Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);let N=yn(this.items,e);N&&!n?this.items.splice(this.items.indexOf(N),1):!N&&n&&this.items.push(new Yt(e))}toJSON(e,n){return super.toJSON(e,n,Set)}toString(e,n,N){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),n,N);throw Error("Set items must all have null values")}static from(e,n,N){let{replacer:C}=N,et=new this(e);if(n&&Symbol.iterator in Object(n))for(let e of n)"function"==typeof C&&(e=C.call(n,e,e)),et.items.push(ss(e,null,N));return et}};Nn.tag="tag:yaml.org,2002:set";let eZ={collection:"map",identify:e=>e instanceof Set,nodeClass:Nn,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,n,N)=>Nn.from(e,n,N),resolve(e,n){if(Cn(e)){if(e.hasAllNullValues(!0))return Object.assign(new Nn,e);n("Set items must all have null values")}else n("Expected a mapping for this tag");return e}};function hs(e,n){let N=e[0],C="-"===N||"+"===N?e.substring(1):e,s=e=>n?BigInt(e):Number(e),et=C.replace(/_/g,"").split(":").reduce((e,n)=>e*s(60)+s(n),s(0));return"-"===N?s(-1)*et:et}function ba(e){let{value:n}=e,t=e=>e;if("bigint"==typeof n)t=e=>BigInt(e);else if(isNaN(n)||!isFinite(n))return an(e);let N="";n<0&&(N="-",n*=t(-1));let C=t(60),et=[n%C];return n<60?et.unshift(0):(n=(n-et[0])/C,et.unshift(n%C),n>=60&&(n=(n-et[0])/C,et.unshift(n))),N+et.map(e=>String(e).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}let eY={identify:e=>"bigint"==typeof e||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,n,{intAsBigInt:N})=>hs(e,N),stringify:ba},eJ={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>hs(e,!1),stringify:ba},eQ={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){let n=e.match(eQ.test);if(!n)throw Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,N,C,et,ei,eo,eu]=n.map(Number),ec=n[7]?Number((n[7]+"00").substr(1,3)):0,ef=Date.UTC(N,C-1,et,ei||0,eo||0,eu||0,ec),eh=n[8];if(eh&&"Z"!==eh){let e=hs(eh,!1);30>Math.abs(e)&&(e*=60),ef-=6e4*e}return new Date(ef)},stringify:({value:e})=>e.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},e0=[eI,eR,eU,eC,eq,eW,{identify:Jn,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,n,N)=>xr(e,2,2,N),stringify:e=>cs(e,2,"0b")},{identify:Jn,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,n,N)=>xr(e,1,8,N),stringify:e=>cs(e,8,"0")},{identify:Jn,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,n,N)=>xr(e,0,10,N),stringify:an},{identify:Jn,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,n,N)=>xr(e,2,16,N),stringify:e=>cs(e,16,"0x")},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:an},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){let n=Number(e.value);return isFinite(n)?n.toExponential():an(e)}},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){let n=new It(parseFloat(e.replace(/_/g,""))),N=e.indexOf(".");if(-1!==N){let C=e.substring(N+1).replace(/_/g,"");"0"===C[C.length-1]&&(n.minFractionDigits=C.length)}return n},stringify:an},eH,eX,e$,eZ,eY,eJ,eQ],e1=new Map([["core",eG],["failsafe",[eI,eR,eU]],["json",ez],["yaml11",e0],["yaml-1.1",e0]]),e2={binary:eH,bool:eM,float:eB,floatExp:eD,floatNaN:eP,floatTime:eJ,int:eF,intHex:eV,intOct:eK,intTime:eY,map:eI,null:eC,omap:eX,pairs:e$,seq:eR,set:eZ,timestamp:eQ},e3={"tag:yaml.org,2002:binary":eH,"tag:yaml.org,2002:omap":eX,"tag:yaml.org,2002:pairs":e$,"tag:yaml.org,2002:set":eZ,"tag:yaml.org,2002:timestamp":eQ};function jr(e,n){let N=e1.get(n);if(!N){if(Array.isArray(e))N=[];else{let e=Array.from(e1.keys()).filter(e=>"yaml11"!==e).map(e=>JSON.stringify(e)).join(", ");throw Error(`Unknown schema "${n}"; use one of ${e} or define customTags array`)}}if(Array.isArray(e))for(let n of e)N=N.concat(n);else"function"==typeof e&&(N=e(N.slice()));return N.map(e=>{if("string"!=typeof e)return e;let n=e2[e];if(n)return n;let N=Object.keys(e2).map(e=>JSON.stringify(e)).join(", ");throw Error(`Unknown custom tag "${e}"; use one of ${N}`)})}let Yi=(e,n)=>e.key<n.key?-1:e.key>n.key?1:0;let Or=class Or{constructor({compat:e,customTags:n,merge:N,resolveKnownTags:C,schema:et,sortMapEntries:ei,toStringDefaults:eo}){this.compat=Array.isArray(e)?jr(e,"compat"):e?jr(null,e):null,this.merge=!!N,this.name="string"==typeof et&&et||"core",this.knownTags=C?e3:{},this.tags=jr(n,this.name),this.toStringOptions=eo??null,Object.defineProperty(this,ey,{value:eI}),Object.defineProperty(this,ek,{value:eU}),Object.defineProperty(this,eA,{value:eR}),this.sortMapEntries="function"==typeof ei?ei:!0===ei?Yi:null}clone(){let e=Object.create(Or.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}};let Dn=class Dn{constructor(e,n,N){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,eL,{value:eb});let C=null;"function"==typeof n||Array.isArray(n)?C=n:void 0===N&&n&&(N=n,n=void 0);let et=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},N);this.options=et;let{version:ei}=et;null!=N&&N._directives?(this.directives=N._directives.atDocument(),this.directives.yaml.explicit&&(ei=this.directives.yaml.version)):this.directives=new Wt({version:ei}),this.setSchema(ei,N),this.contents=void 0===e?null:this.createNode(e,C,N)}clone(){let e=Object.create(Dn.prototype,{[eL]:{value:eb}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=Vt(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){wn(this.contents)&&this.contents.add(e)}addIn(e,n){wn(this.contents)&&this.contents.addIn(e,n)}createAlias(e,n){if(!e.anchor){let N=Js(this);e.anchor=!n||N.has(n)?Qs(n||"a",N):n}return new br(e.anchor)}createNode(e,n,N){let C;if("function"==typeof n)e=n.call({"":e},"",e),C=n;else if(Array.isArray(n)){let e=n.filter(e=>"number"==typeof e||e instanceof String||e instanceof Number).map(String);e.length>0&&(n=n.concat(e)),C=n}else void 0===N&&n&&(N=n,n=void 0);let{aliasDuplicateObjects:et,anchorPrefix:ei,flow:eo,keepUndefined:eu,onTagObj:ec,tag:ef}=N??{},{onAnchor:eh,setAnchors:ep,sourceObjects:ed}=function(e,n){let N=[],C=new Map,et=null;return{onAnchor:C=>{N.push(C),et||(et=Js(e));let ei=Qs(n,et);return et.add(ei),ei},setAnchors:()=>{for(let e of N){let n=C.get(e);if("object"==typeof n&&n.anchor&&(Gt(n.node)||Ht(n.node)))n.node.anchor=n.anchor;else{let n=Error("Failed to resolve repeated object (this should not happen)");throw n.source=e,n}}},sourceObjects:C}}(this,ei||"a"),e_={aliasDuplicateObjects:et??!0,keepUndefined:eu??!1,onAnchor:eh,onTagObj:ec,replacer:C,schema:this.schema,sourceObjects:ed},eg=Yn(e,ef,e_);return eo&&Ht(eg)&&(eg.flow=!0),ep(),eg}createPair(e,n,N={}){let C=this.createNode(e,null,N),et=this.createNode(n,null,N);return new Yt(C,et)}delete(e){return!!wn(this.contents)&&this.contents.delete(e)}deleteIn(e){return Vn(e)?null!=this.contents&&(this.contents=null,!0):!!wn(this.contents)&&this.contents.deleteIn(e)}get(e,n){return Ht(this.contents)?this.contents.get(e,n):void 0}getIn(e,n){return Vn(e)?!n&&Gt(this.contents)?this.contents.value:this.contents:Ht(this.contents)?this.contents.getIn(e,n):void 0}has(e){return!!Ht(this.contents)&&this.contents.has(e)}hasIn(e){return Vn(e)?void 0!==this.contents:!!Ht(this.contents)&&this.contents.hasIn(e)}set(e,n){null==this.contents?this.contents=hr(this.schema,[e],n):wn(this.contents)&&this.contents.set(e,n)}setIn(e,n){Vn(e)?this.contents=n:null==this.contents?this.contents=hr(this.schema,Array.from(e),n):wn(this.contents)&&this.contents.setIn(e,n)}setSchema(e,n={}){let N;switch("number"==typeof e&&(e=String(e)),e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Wt({version:"1.1"}),N={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new Wt({version:e}),N={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,N=null;break;default:{let n=JSON.stringify(e);throw Error(`Expected '1.1', '1.2' or null as first argument, but found: ${n}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(N)this.schema=new Or(Object.assign(N,n));else throw Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:n,mapAsMap:N,maxAliasCount:C,onAnchor:et,reviver:ei}={}){let eo={anchors:new Map,doc:this,keep:!e,mapAsMap:!0===N,mapKeyWarned:!1,maxAliasCount:"number"==typeof C?C:100},eu=nn(this.contents,n??"",eo);if("function"==typeof et)for(let{count:e,res:n}of eo.anchors.values())et(n,e);return"function"==typeof ei?On(ei,{"":eu},"",eu):eu}toJSON(e,n){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:n})}toString(e={}){if(this.errors.length>0)throw Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||0>=Number(e.indent))){let n=JSON.stringify(e.indent);throw Error(`"indent" option must be a positive integer, not ${n}`)}return function(e,n){var N;let C=[],et=!0===n.directives;if(!1!==n.directives&&e.directives){let n=e.directives.toString(e);n?(C.push(n),et=!0):e.directives.docStart&&(et=!0)}et&&C.push("---");let ei=na(e,n),{commentString:eo}=ei.options;if(e.commentBefore){1!==C.length&&C.unshift("");let n=eo(e.commentBefore);C.unshift(fn(n,""))}let eu=!1,ec=null;if(e.contents){if(Vt(e.contents)){if(e.contents.spaceBefore&&et&&C.push(""),e.contents.commentBefore){let n=eo(e.contents.commentBefore);C.push(fn(n,""))}ei.forceBlockIndent=!!e.comment,ec=e.contents.comment}let n=ec?void 0:()=>eu=!0,N=Un(e.contents,ei,()=>ec=null,n);ec&&(N+=dn(N,"",eo(ec))),("|"===N[0]||">"===N[0])&&"---"===C[C.length-1]?C[C.length-1]=`--- ${N}`:C.push(N)}else C.push(Un(e.contents,ei));if(null!=(N=e.directives)&&N.docEnd){if(e.comment){let n=eo(e.comment);n.includes(`
`)?(C.push("..."),C.push(fn(n,""))):C.push(`... ${n}`)}else C.push("...")}else{let n=e.comment;n&&eu&&(n=n.replace(/^\n+/,"")),n&&((!eu||ec)&&""!==C[C.length-1]&&C.push(""),C.push(fn(eo(n),"")))}return C.join(`
`)+`
`}(this,e)}};function wn(e){if(Ht(e))return!0;throw Error("Expected a YAML collection as document contents")}let ps=class ps extends Error{constructor(e,n,N,C){super(),this.name=e,this.code=N,this.message=C,this.pos=n}};let kn=class kn extends ps{constructor(e,n,N){super("YAMLParseError",e,n,N)}};let ka=class ka extends ps{constructor(e,n,N){super("YAMLWarning",e,n,N)}};let dr=(e,n)=>N=>{if(-1===N.pos[0])return;N.linePos=N.pos.map(e=>n.linePos(e));let{line:C,col:et}=N.linePos[0];N.message+=` at line ${C}, column ${et}`;let ei=et-1,eo=e.substring(n.lineStarts[C-1],n.lineStarts[C]).replace(/[\n\r]+$/,"");if(ei>=60&&eo.length>80){let e=Math.min(ei-39,eo.length-79);eo="…"+eo.substring(e),ei-=e-1}if(eo.length>80&&(eo=eo.substring(0,79)+"…"),C>1&&/^ *$/.test(eo.substring(0,ei))){let N=e.substring(n.lineStarts[C-2],n.lineStarts[C-1]);N.length>80&&(N=N.substring(0,79)+`…
`),eo=N+eo}if(/[^ ]/.test(eo)){let e=1,n=N.linePos[1];n&&n.line===C&&n.col>et&&(e=Math.max(1,Math.min(n.col-et,80-ei)));let eu=" ".repeat(ei)+"^".repeat(e);N.message+=`:

${eo}
${eu}
`}};function In(e,{flow:n,indicator:N,next:C,offset:et,onError:ei,startOnNewline:eo}){let eu=!1,ec=eo,ef=eo,eh="",ep="",ed=!1,e_=!1,eg=!1,em=null,eb=null,ey=null,ev=null,ek=null;for(let C of e)switch(eg&&("space"!==C.type&&"newline"!==C.type&&"comma"!==C.type&&ei(C.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),eg=!1),C.type){case"space":!n&&ec&&"doc-start"!==N&&"	"===C.source[0]&&ei(C,"TAB_AS_INDENT","Tabs are not allowed as indentation"),ef=!0;break;case"comment":{ef||ei(C,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let e=C.source.substring(1)||" ";eh?eh+=ep+e:eh=e,ep="",ec=!1;break}case"newline":ec?eh?eh+=C.source:eu=!0:ep+=C.source,ec=!0,ed=!0,(em||eb)&&(e_=!0),ef=!0;break;case"anchor":em&&ei(C,"MULTIPLE_ANCHORS","A node can have at most one anchor"),C.source.endsWith(":")&&ei(C.offset+C.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),em=C,null===ek&&(ek=C.offset),ec=!1,ef=!1,eg=!0;break;case"tag":eb&&ei(C,"MULTIPLE_TAGS","A node can have at most one tag"),eb=C,null===ek&&(ek=C.offset),ec=!1,ef=!1,eg=!0;break;case N:(em||eb)&&ei(C,"BAD_PROP_ORDER",`Anchors and tags must be after the ${C.source} indicator`),ev&&ei(C,"UNEXPECTED_TOKEN",`Unexpected ${C.source} in ${n??"collection"}`),ev=C,ec=!1,ef=!1;break;case"comma":if(n){ey&&ei(C,"UNEXPECTED_TOKEN",`Unexpected , in ${n}`),ey=C,ec=!1,ef=!1;break}default:ei(C,"UNEXPECTED_TOKEN",`Unexpected ${C.type} token`),ec=!1,ef=!1}let eA=e[e.length-1],eL=eA?eA.offset+eA.source.length:et;return eg&&C&&"space"!==C.type&&"newline"!==C.type&&"comma"!==C.type&&("scalar"!==C.type||""!==C.source)&&ei(C.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:ey,found:ev,spaceBefore:eu,comment:eh,hasNewline:ed,hasNewlineAfterProp:e_,anchor:em,tag:eb,end:eL,start:ek??eL}}function Zn(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes(`
`))return!0;if(e.end){for(let n of e.end)if("newline"===n.type)return!0}return!1;case"flow-collection":for(let n of e.items){for(let e of n.start)if("newline"===e.type)return!0;if(n.sep){for(let e of n.sep)if("newline"===e.type)return!0}if(Zn(n.key)||Zn(n.value))return!0}return!1;default:return!0}}function qr(e,n,N){if((null==n?void 0:n.type)==="flow-collection"){let C=n.end[0];C.indent===e&&("]"===C.source||"}"===C.source)&&Zn(n)&&N(C,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function La(e,n,N){let{uniqueKeys:C}=e.options;if(!1===C)return!1;let et="function"==typeof C?C:(n,N)=>n===N||Gt(n)&&Gt(N)&&n.value===N.value&&!("<<"===n.value&&e.schema.merge);return n.some(e=>et(e.key,N))}let e5="All mapping items must start at the same column";function Qn(e,n,N,C){let et="";if(e){let ei=!1,eo="";for(let eu of e){let{source:e,type:ec}=eu;switch(ec){case"space":ei=!0;break;case"comment":{N&&!ei&&C(eu,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let n=e.substring(1)||" ";et?et+=eo+n:et=n,eo="";break}case"newline":et&&(eo+=e),ei=!0;break;default:C(eu,"UNEXPECTED_TOKEN",`Unexpected ${ec} at node end`)}n+=e.length}}return{comment:et,offset:n}}let e4="Block collections are not allowed within flow collections",Dr=e=>e&&("block-map"===e.type||"block-seq"===e.type);function Gr(e,n,N,C,et,ei){let eo="block-map"===N.type?function({composeNode:e,composeEmptyNode:n},N,C,et,ei){var eo;let eu=(null==ei?void 0:ei.nodeClass)??en,ec=new eu(N.schema);N.atRoot&&(N.atRoot=!1);let ef=C.offset,eh=null;for(let ei of C.items){let{start:eu,key:ep,sep:ed,value:e_}=ei,eg=In(eu,{indicator:"explicit-key-ind",next:ep??(null==ed?void 0:ed[0]),offset:ef,onError:et,startOnNewline:!0}),em=!eg.found;if(em){if(ep&&("block-seq"===ep.type?et(ef,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in ep&&ep.indent!==C.indent&&et(ef,"BAD_INDENT",e5)),!eg.anchor&&!eg.tag&&!ed){eh=eg.end,eg.comment&&(ec.comment?ec.comment+=`
`+eg.comment:ec.comment=eg.comment);continue}(eg.hasNewlineAfterProp||Zn(ep))&&et(ep??eu[eu.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else(null==(eo=eg.found)?void 0:eo.indent)!==C.indent&&et(ef,"BAD_INDENT",e5);let eb=eg.end,ey=ep?e(N,ep,eg,et):n(N,eb,eu,null,eg,et);N.schema.compat&&qr(C.indent,ep,et),La(N,ec.items,ey)&&et(eb,"DUPLICATE_KEY","Map keys must be unique");let ev=In(ed??[],{indicator:"map-value-ind",next:e_,offset:ey.range[2],onError:et,startOnNewline:!ep||"block-scalar"===ep.type});if(ef=ev.end,ev.found){em&&((null==e_?void 0:e_.type)!=="block-map"||ev.hasNewline||et(ef,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),N.options.strict&&eg.start<ev.found.offset-1024&&et(ey.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let eo=e_?e(N,e_,ev,et):n(N,ef,ed,null,ev,et);N.schema.compat&&qr(C.indent,e_,et),ef=eo.range[2];let eu=new Yt(ey,eo);N.options.keepSourceTokens&&(eu.srcToken=ei),ec.items.push(eu)}else{em&&et(ey.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),ev.comment&&(ey.comment?ey.comment+=`
`+ev.comment:ey.comment=ev.comment);let e=new Yt(ey);N.options.keepSourceTokens&&(e.srcToken=ei),ec.items.push(e)}}return eh&&eh<ef&&et(eh,"IMPOSSIBLE","Map comment with trailing content"),ec.range=[C.offset,ef,eh??ef],ec}(e,n,N,C,ei):"block-seq"===N.type?function({composeNode:e,composeEmptyNode:n},N,C,et,ei){let eo=(null==ei?void 0:ei.nodeClass)??mn,eu=new eo(N.schema);N.atRoot&&(N.atRoot=!1);let ec=C.offset,ef=null;for(let{start:ei,value:eo}of C.items){let eh=In(ei,{indicator:"seq-item-ind",next:eo,offset:ec,onError:et,startOnNewline:!0});if(!eh.found){if(eh.anchor||eh.tag||eo)eo&&"block-seq"===eo.type?et(eh.end,"BAD_INDENT","All sequence items must start at the same column"):et(ec,"MISSING_CHAR","Sequence item without - indicator");else{ef=eh.end,eh.comment&&(eu.comment=eh.comment);continue}}let ep=eo?e(N,eo,eh,et):n(N,eh.end,ei,null,eh,et);N.schema.compat&&qr(C.indent,eo,et),ec=ep.range[2],eu.items.push(ep)}return eu.range=[C.offset,ec,ef??ec],eu}(e,n,N,C,ei):function({composeNode:e,composeEmptyNode:n},N,C,et,ei){let eo="{"===C.start.source,eu=eo?"flow map":"flow sequence",ec=(null==ei?void 0:ei.nodeClass)??(eo?en:mn),ef=new ec(N.schema);ef.flow=!0;let eh=N.atRoot;eh&&(N.atRoot=!1);let ep=C.offset+C.start.source.length;for(let ei=0;ei<C.items.length;++ei){let ec=C.items[ei],{start:eh,key:ed,sep:e_,value:eg}=ec,em=In(eh,{flow:eu,indicator:"explicit-key-ind",next:ed??(null==e_?void 0:e_[0]),offset:ep,onError:et,startOnNewline:!1});if(!em.found){if(!em.anchor&&!em.tag&&!e_&&!eg){0===ei&&em.comma?et(em.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${eu}`):ei<C.items.length-1&&et(em.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${eu}`),em.comment&&(ef.comment?ef.comment+=`
`+em.comment:ef.comment=em.comment),ep=em.end;continue}!eo&&N.options.strict&&Zn(ed)&&et(ed,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(0===ei)em.comma&&et(em.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${eu}`);else if(em.comma||et(em.start,"MISSING_CHAR",`Missing , between ${eu} items`),em.comment){let e="";e:for(let n of eh)switch(n.type){case"comma":case"space":break;case"comment":e=n.source.substring(1);break e;default:break e}if(e){let n=ef.items[ef.items.length-1];Kt(n)&&(n=n.value??n.key),n.comment?n.comment+=`
`+e:n.comment=e,em.comment=em.comment.substring(e.length+1)}}if(eo||e_||em.found){let C=em.end,ei=ed?e(N,ed,em,et):n(N,C,eh,null,em,et);Dr(ed)&&et(ei.range,"BLOCK_IN_FLOW",e4);let eb=In(e_??[],{flow:eu,indicator:"map-value-ind",next:eg,offset:ei.range[2],onError:et,startOnNewline:!1});if(eb.found){if(!eo&&!em.found&&N.options.strict){if(e_)for(let e of e_){if(e===eb.found)break;if("newline"===e.type){et(e,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}em.start<eb.found.offset-1024&&et(eb.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else eg&&("source"in eg&&eg.source&&":"===eg.source[0]?et(eg,"MISSING_CHAR",`Missing space after : in ${eu}`):et(eb.start,"MISSING_CHAR",`Missing , or : between ${eu} items`));let ey=eg?e(N,eg,eb,et):eb.found?n(N,eb.end,e_,null,eb,et):null;ey?Dr(eg)&&et(ey.range,"BLOCK_IN_FLOW",e4):eb.comment&&(ei.comment?ei.comment+=`
`+eb.comment:ei.comment=eb.comment);let ev=new Yt(ei,ey);if(N.options.keepSourceTokens&&(ev.srcToken=ec),eo)La(N,ef.items,ei)&&et(C,"DUPLICATE_KEY","Map keys must be unique"),ef.items.push(ev);else{let e=new en(N.schema);e.flow=!0,e.items.push(ev),ef.items.push(e)}ep=ey?ey.range[2]:eb.end}else{let C=eg?e(N,eg,em,et):n(N,em.end,e_,null,em,et);ef.items.push(C),ep=C.range[2],Dr(eg)&&et(C.range,"BLOCK_IN_FLOW",e4)}}let ed=eo?"}":"]",[e_,...eg]=C.end,em=ep;if(e_&&e_.source===ed)em=e_.offset+e_.source.length;else{let e=eu[0].toUpperCase()+eu.substring(1),n=eh?`${e} must end with a ${ed}`:`${e} in block collection must be sufficiently indented and end with a ${ed}`;et(ep,eh?"MISSING_CHAR":"BAD_INDENT",n),e_&&1!==e_.source.length&&eg.unshift(e_)}if(eg.length>0){let e=Qn(eg,em,N.options.strict,et);e.comment&&(ef.comment?ef.comment+=`
`+e.comment:ef.comment=e.comment),ef.range=[C.offset,em,e.offset]}else ef.range=[C.offset,em,em];return ef}(e,n,N,C,ei),eu=eo.constructor;return"!"===et||et===eu.tagName?eo.tag=eu.tagName:et&&(eo.tag=et),eo}function Aa(e,n,N){let C=e.offset,et=function({offset:e,props:n},N,C){if("block-scalar-header"!==n[0].type)return C(n[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:et}=n[0],ei=et[0],eo=0,eu="",ec=-1;for(let n=1;n<et.length;++n){let N=et[n];if(eu||"-"!==N&&"+"!==N){let C=Number(N);!eo&&C?eo=C:-1===ec&&(ec=e+n)}else eu=N}-1!==ec&&C(ec,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${et}`);let ef=!1,eh="",ep=et.length;for(let e=1;e<n.length;++e){let et=n[e];switch(et.type){case"space":ef=!0;case"newline":ep+=et.source.length;break;case"comment":N&&!ef&&C(et,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),ep+=et.source.length,eh=et.source.substring(1);break;case"error":C(et,"UNEXPECTED_TOKEN",et.message),ep+=et.source.length;break;default:{let e=`Unexpected token in block scalar header: ${et.type}`;C(et,"UNEXPECTED_TOKEN",e);let n=et.source;n&&"string"==typeof n&&(ep+=n.length)}}}return{mode:ei,indent:eo,chomp:eu,comment:eh,length:ep}}(e,n,N);if(!et)return{value:"",type:null,comment:"",range:[C,C,C]};let ei=">"===et.mode?It.BLOCK_FOLDED:It.BLOCK_LITERAL,eo=e.source?function(e){let n=e.split(/\n( *)/),N=n[0],C=N.match(/^( *)/),et=[null!=C&&C[1]?[C[1],N.slice(C[1].length)]:["",N]];for(let e=1;e<n.length;e+=2)et.push([n[e],n[e+1]]);return et}(e.source):[],eu=eo.length;for(let e=eo.length-1;e>=0;--e){let n=eo[e][1];if(""===n||"\r"===n)eu=e;else break}if(0===eu){let n="+"===et.chomp&&eo.length>0?`
`.repeat(Math.max(1,eo.length-1)):"",N=C+et.length;return e.source&&(N+=e.source.length),{value:n,type:ei,comment:et.comment,range:[C,N,N]}}let ec=e.indent+et.indent,ef=e.offset+et.length,eh=0;for(let e=0;e<eu;++e){let[n,C]=eo[e];if(""===C||"\r"===C)0===et.indent&&n.length>ec&&(ec=n.length);else{n.length<ec&&N(ef+n.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),0===et.indent&&(ec=n.length),eh=e;break}ef+=n.length+C.length+1}for(let e=eo.length-1;e>=eu;--e)eo[e][0].length>ec&&(eu=e+1);let ep="",ed="",e_=!1;for(let e=0;e<eh;++e)ep+=eo[e][0].slice(ec)+`
`;for(let e=eh;e<eu;++e){let[n,C]=eo[e];ef+=n.length+C.length+1;let eu="\r"===C[C.length-1];if(eu&&(C=C.slice(0,-1)),C&&n.length<ec){let e=`Block scalar lines must not be less indented than their ${et.indent?"explicit indentation indicator":"first line"}`;N(ef-C.length-(eu?2:1),"BAD_INDENT",e),n=""}ei===It.BLOCK_LITERAL?(ep+=ed+n.slice(ec)+C,ed=`
`):n.length>ec||"	"===C[0]?(" "===ed?ed=`
`:e_||ed!==`
`||(ed=`

`),ep+=ed+n.slice(ec)+C,ed=`
`,e_=!0):""===C?ed===`
`?ep+=`
`:ed=`
`:(ep+=ed+C,ed=" ",e_=!1)}switch(et.chomp){case"-":break;case"+":for(let e=eu;e<eo.length;++e)ep+=`
`+eo[e][0].slice(ec);ep[ep.length-1]!==`
`&&(ep+=`
`);break;default:ep+=`
`}let eg=C+et.length+e.source.length;return{value:ep,type:ei,comment:et.comment,range:[C,eg,eg]}}function wa(e,n,N){let C,et;let{offset:ei,type:eo,source:eu,end:ec}=e,h=(e,n,C)=>N(ei+e,n,C);switch(eo){case"scalar":C=It.PLAIN,et=function(e,n){let N="";switch(e[0]){case"	":N="a tab character";break;case",":N="flow indicator character ,";break;case"%":N="directive indicator character %";break;case"|":case">":N=`block scalar indicator ${e[0]}`;break;case"@":case"`":N=`reserved character ${e[0]}`}return N&&n(0,"BAD_SCALAR_START",`Plain value cannot start with ${N}`),Ta(e)}(eu,h);break;case"single-quoted-scalar":C=It.QUOTE_SINGLE,("'"!==eu[eu.length-1]||1===eu.length)&&h(eu.length,"MISSING_CHAR","Missing closing 'quote"),et=Ta(eu.slice(1,-1)).replace(/''/g,"'");break;case"double-quoted-scalar":C=It.QUOTE_DOUBLE,et=function(e,n){let N="";for(let C=1;C<e.length-1;++C){let et=e[C];if(!("\r"===et&&e[C+1]===`
`)){if(et===`
`){let{fold:n,offset:et}=function(e,n){let N="",C=e[n+1];for(;(" "===C||"	"===C||C===`
`||"\r"===C)&&!("\r"===C&&e[n+2]!==`
`);)C===`
`&&(N+=`
`),n+=1,C=e[n+1];return N||(N=" "),{fold:N,offset:n}}(e,C);N+=n,C=et}else if("\\"===et){let et=e[++C],ei=e8[et];if(ei)N+=ei;else if(et===`
`)for(et=e[C+1];" "===et||"	"===et;)et=e[++C+1];else if("\r"===et&&e[C+1]===`
`)for(et=e[++C+1];" "===et||"	"===et;)et=e[++C+1];else if("x"===et||"u"===et||"U"===et){let ei={x:2,u:4,U:8}[et];N+=function(e,n,N,C){let et=e.substr(n,N),ei=et.length===N&&/^[0-9a-fA-F]+$/.test(et)?parseInt(et,16):NaN;if(isNaN(ei)){let et=e.substr(n-2,N+2);return C(n-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${et}`),et}return String.fromCodePoint(ei)}(e,C+1,ei,n),C+=ei}else{let et=e.substr(C-1,2);n(C-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${et}`),N+=et}}else if(" "===et||"	"===et){let n=C,ei=e[C+1];for(;" "===ei||"	"===ei;)ei=e[++C+1];ei===`
`||"\r"===ei&&e[C+2]===`
`||(N+=C>n?e.slice(n,C+1):et)}else N+=et}}return('"'!==e[e.length-1]||1===e.length)&&n(e.length,"MISSING_CHAR",'Missing closing "quote'),N}(eu,h);break;default:return N(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${eo}`),{value:"",type:null,comment:"",range:[ei,ei+eu.length,ei+eu.length]}}let ef=ei+eu.length,eh=Qn(ec,ef,n,N);return{value:et,type:C,comment:eh.comment,range:[ei,ef,eh.offset]}}function Ta(e){let n,N;try{n=RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),N=RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{n=/(.*?)[ \t]*\r?\n/sy,N=/[ \t]*(.*?)[ \t]*\r?\n/sy}let C=n.exec(e);if(!C)return e;let et=C[1],ei=" ",eo=n.lastIndex;for(N.lastIndex=eo;C=N.exec(e);)""===C[1]?ei===`
`?et+=ei:ei=`
`:(et+=ei+C[1],ei=" "),eo=N.lastIndex;let eu=/[ \t]*(.*)/sy;return eu.lastIndex=eo,et+ei+((null==(C=eu.exec(e))?void 0:C[1])??"")}let e8={0:"\x00",a:"\x07",b:"\b",e:"\x1b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xa0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function xa(e,n,N,C){let et;let{value:ei,type:eo,comment:eu,range:ec}="block-scalar"===n.type?Aa(n,e.options.strict,C):wa(n,e.options.strict,C),ef=N?e.directives.tagName(N.source,e=>C(N,"TAG_RESOLVE_FAILED",e)):null,eh=N&&ef?function(e,n,N,C,et){var ei;if("!"===N)return e[ek];let eo=[];for(let n of e.tags)if(!n.collection&&n.tag===N){if(!n.default||!n.test)return n;eo.push(n)}for(let e of eo)if(null!=(ei=e.test)&&ei.test(n))return e;let eu=e.knownTags[N];return eu&&!eu.collection?(e.tags.push(Object.assign({},eu,{default:!1,test:void 0})),eu):(et(C,"TAG_RESOLVE_FAILED",`Unresolved tag: ${N}`,"tag:yaml.org,2002:str"!==N),e[ek])}(e.schema,ei,ef,N,C):"scalar"===n.type?function({directives:e,schema:n},N,C,et){let ei=n.tags.find(e=>{var n;return e.default&&(null==(n=e.test)?void 0:n.test(N))})||n[ek];if(n.compat){let eo=n.compat.find(e=>{var n;return e.default&&(null==(n=e.test)?void 0:n.test(N))})??n[ek];if(ei.tag!==eo.tag){let n=e.tagString(ei.tag),N=e.tagString(eo.tag),eu=`Value may be parsed as either ${n} or ${N}`;et(C,"TAG_RESOLVE_FAILED",eu,!0)}}return ei}(e,ei,n,C):e.schema[ek];try{let eo=eh.resolve(ei,e=>C(N??n,"TAG_RESOLVE_FAILED",e),e.options);et=Gt(eo)?eo:new It(eo)}catch(eo){let e=eo instanceof Error?eo.message:String(eo);C(N??n,"TAG_RESOLVE_FAILED",e),et=new It(ei)}return et.range=ec,et.source=ei,eo&&(et.type=eo),ef&&(et.tag=ef),eh.format&&(et.format=eh.format),eu&&(et.comment=eu),et}let e6={composeNode:Ea,composeEmptyNode:ds};function Ea(e,n,N,C){let{spaceBefore:et,comment:ei,anchor:eo,tag:eu}=N,ec,ef=!0;switch(n.type){case"alias":ec=function({options:e},{offset:n,source:N,end:C},et){let ei=new br(N.substring(1));""===ei.source&&et(n,"BAD_ALIAS","Alias cannot be an empty string"),ei.source.endsWith(":")&&et(n+N.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let eo=n+N.length,eu=Qn(C,eo,e.strict,et);return ei.range=[n,eo,eu.offset],eu.comment&&(ei.comment=eu.comment),ei}(e,n,C),(eo||eu)&&C(n,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":ec=xa(e,n,eu,C),eo&&(ec.anchor=eo.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":ec=function(e,n,N,C,et){var ei;let eo=C?n.directives.tagName(C.source,e=>et(C,"TAG_RESOLVE_FAILED",e)):null,eu="block-map"===N.type?"map":"block-seq"===N.type?"seq":"{"===N.start.source?"map":"seq";if(!C||!eo||"!"===eo||eo===en.tagName&&"map"===eu||eo===mn.tagName&&"seq"===eu||!eu)return Gr(e,n,N,et,eo);let ec=n.schema.tags.find(e=>e.tag===eo&&e.collection===eu);if(!ec){let ei=n.schema.knownTags[eo];if(!ei||ei.collection!==eu)return null!=ei&&ei.collection?et(C,"BAD_COLLECTION_TYPE",`${ei.tag} used for ${eu} collection, but expects ${ei.collection}`,!0):et(C,"TAG_RESOLVE_FAILED",`Unresolved tag: ${eo}`,!0),Gr(e,n,N,et,eo);n.schema.tags.push(Object.assign({},ei,{default:!1})),ec=ei}let ef=Gr(e,n,N,et,eo,ec),eh=(null==(ei=ec.resolve)?void 0:ei.call(ec,ef,e=>et(C,"TAG_RESOLVE_FAILED",e),n.options))??ef,ep=Vt(eh)?eh:new It(eh);return ep.range=ef.range,ep.tag=eo,null!=ec&&ec.format&&(ep.format=ec.format),ep}(e6,e,n,eu,C),eo&&(ec.anchor=eo.source.substring(1));break;default:{let et="error"===n.type?n.message:`Unsupported token (type: ${n.type})`;C(n,"UNEXPECTED_TOKEN",et),ec=ds(e,n.offset,void 0,null,N,C),ef=!1}}return eo&&""===ec.anchor&&C(eo,"BAD_ALIAS","Anchor cannot be an empty string"),et&&(ec.spaceBefore=!0),ei&&("scalar"===n.type&&""===n.source?ec.comment=ei:ec.commentBefore=ei),e.options.keepSourceTokens&&ef&&(ec.srcToken=n),ec}function ds(e,n,N,C,{spaceBefore:et,comment:ei,anchor:eo,tag:eu,end:ec},ef){let eh={type:"scalar",offset:function(e,n,N){if(n){null===N&&(N=n.length);for(let C=N-1;C>=0;--C){let N=n[C];switch(N.type){case"space":case"comment":case"newline":e-=N.source.length;continue}for(N=n[++C];(null==N?void 0:N.type)==="space";)e+=N.source.length,N=n[++C];break}}return e}(n,N,C),indent:-1,source:""},ep=xa(e,eh,eu,ef);return eo&&(ep.anchor=eo.source.substring(1),""===ep.anchor&&ef(eo,"BAD_ALIAS","Anchor cannot be an empty string")),et&&(ep.spaceBefore=!0),ei&&(ep.comment=ei,ep.range[2]=ec),ep}function Hn(e){if("number"==typeof e)return[e,e+1];if(Array.isArray(e))return 2===e.length?e:[e[0],e[1]];let{offset:n,source:N}=e;return[n,n+("string"==typeof N?N.length:1)]}function js(e){var n;let N="",C=!1,et=!1;for(let ei=0;ei<e.length;++ei){let eo=e[ei];switch(eo[0]){case"#":N+=(""===N?"":et?`

`:`
`)+(eo.substring(1)||" "),C=!0,et=!1;break;case"%":(null==(n=e[ei+1])?void 0:n[0])!=="#"&&(ei+=1),C=!1;break;default:C||(et=!0),C=!1}}return{comment:N,afterEmptyLine:et}}let _s=class _s{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(e,n,N,C)=>{let et=Hn(e);C?this.warnings.push(new ka(et,n,N)):this.errors.push(new kn(et,n,N))},this.directives=new Wt({version:e.version||"1.2"}),this.options=e}decorate(e,n){let{comment:N,afterEmptyLine:C}=js(this.prelude);if(N){let et=e.contents;if(n)e.comment=e.comment?`${e.comment}
${N}`:N;else if(C||e.directives.docStart||!et)e.commentBefore=N;else if(Ht(et)&&!et.flow&&et.items.length>0){let e=et.items[0];Kt(e)&&(e=e.key);let n=e.commentBefore;e.commentBefore=n?`${N}
${n}`:N}else{let e=et.commentBefore;et.commentBefore=e?`${N}
${e}`:N}}n?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:js(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,n=!1,N=-1){for(let n of e)yield*this.next(n);yield*this.end(n,N)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(n,N,C)=>{let et=Hn(e);et[0]+=n,this.onError(et,"BAD_DIRECTIVE",N,C)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{let n=function(e,n,{offset:N,start:C,value:et,end:ei},eo){let eu=Object.assign({_directives:n},e),ec=new Dn(void 0,eu),ef={atRoot:!0,directives:ec.directives,options:ec.options,schema:ec.schema},eh=In(C,{indicator:"doc-start",next:et??(null==ei?void 0:ei[0]),offset:N,onError:eo,startOnNewline:!0});eh.found&&(ec.directives.docStart=!0,et&&("block-map"===et.type||"block-seq"===et.type)&&!eh.hasNewline&&eo(eh.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),ec.contents=et?Ea(ef,et,eh,eo):ds(ef,eh.end,C,null,eh,eo);let ep=ec.contents.range[2],ed=Qn(ei,ep,!1,eo);return ed.comment&&(ec.comment=ed.comment),ec.range=[N,ep,ed.offset],ec}(this.options,this.directives,e,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{let n=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,N=new kn(Hn(e),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(N):this.doc.errors.push(N);break}case"doc-end":{if(!this.doc){this.errors.push(new kn(Hn(e),"UNEXPECTED_TOKEN","Unexpected doc-end without preceding document"));break}this.doc.directives.docEnd=!0;let n=Qn(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){let e=this.doc.comment;this.doc.comment=e?`${e}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new kn(Hn(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){let e=Object.assign({_directives:this.directives},this.options),N=new Dn(void 0,e);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),N.range=[0,n,n],this.decorate(N,!1),yield N}}};function Oa(e,n){if(n)for(let N of n)switch(N.type){case"space":case"comment":e.push(N);break;case"newline":return e.push(N),!0}return!1}function Kr(e,n,N){switch(e.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":e.type=N,e.source=n;break;case"block-scalar":{let C=e.props.slice(1),et=n.length;for(let n of("block-scalar-header"===e.props[0].type&&(et-=e.props[0].source.length),C))n.offset+=et;delete e.props,Object.assign(e,{type:N,source:n,end:C});break}case"block-map":case"block-seq":{let C={type:"newline",offset:e.offset+n.length,indent:e.indent,source:`
`};delete e.items,Object.assign(e,{type:N,source:n,end:[C]});break}default:{let C="indent"in e?e.indent:-1,et="end"in e&&Array.isArray(e.end)?e.end.filter(e=>"space"===e.type||"comment"===e.type||"newline"===e.type):[];for(let n of Object.keys(e))"type"!==n&&"offset"!==n&&delete e[n];Object.assign(e,{type:N,indent:C,source:n,end:et})}}}function _r(e){switch(e.type){case"block-scalar":{let n="";for(let N of e.props)n+=_r(N);return n+e.source}case"block-map":case"block-seq":{let n="";for(let N of e.items)n+=fr(N);return n}case"flow-collection":{let n=e.start.source;for(let N of e.items)n+=fr(N);for(let N of e.end)n+=N.source;return n}case"document":{let n=fr(e);if(e.end)for(let N of e.end)n+=N.source;return n}default:{let n=e.source;if("end"in e&&e.end)for(let N of e.end)n+=N.source;return n}}}function fr({start:e,key:n,sep:N,value:C}){let et="";for(let n of e)et+=n.source;if(n&&(et+=_r(n)),N)for(let e of N)et+=e.source;return C&&(et+=_r(C)),et}let e9=Symbol("break visit"),e7=Symbol("skip children"),ta=Symbol("remove item");function Ln(e,n){"type"in e&&"document"===e.type&&(e={start:e.start,value:e.value}),function Ra(e,n,N){let C=N(n,e);if("symbol"==typeof C)return C;for(let et of["key","value"]){let ei=n[et];if(ei&&"items"in ei){for(let n=0;n<ei.items.length;++n){let C=Ra(Object.freeze(e.concat([[et,n]])),ei.items[n],N);if("number"==typeof C)n=C-1;else{if(C===e9)return e9;C===ta&&(ei.items.splice(n,1),n-=1)}}"function"==typeof C&&"key"===et&&(C=C(n,e))}}return"function"==typeof C?C(n,e):C}(Object.freeze([]),e,n)}function Na(e){switch(e){case"\uFEFF":return"byte-order-mark";case"\x02":return"doc-mode";case"\x18":return"flow-error-end";case"\x1f":return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}Ln.BREAK=e9,Ln.SKIP=e7,Ln.REMOVE=ta,Ln.itemAtPath=(e,n)=>{let N=e;for(let[e,C]of n){let n=null==N?void 0:N[e];if(!n||!("items"in n))return;N=n.items[C]}return N},Ln.parentCollection=(e,n)=>{let N=Ln.itemAtPath(e,n.slice(0,-1)),C=n[n.length-1][0],et=null==N?void 0:N[C];if(et&&"items"in et)return et;throw Error("Parent collection not found")};let ti=Object.freeze(Object.defineProperty({__proto__:null,BOM:"\uFEFF",DOCUMENT:"\x02",FLOW_END:"\x18",SCALAR:"\x1f",createScalarToken:function(e,n){let{implicitKey:N=!1,indent:C,inFlow:et=!1,offset:ei=-1,type:eo="PLAIN"}=n,eu=Wn({type:eo,value:e},{implicitKey:N,indent:C>0?" ".repeat(C):"",inFlow:et,options:{blockQuote:!0,lineWidth:-1}}),ec=n.end??[{type:"newline",offset:-1,indent:C,source:`
`}];switch(eu[0]){case"|":case">":{let e=eu.indexOf(`
`),n=eu.substring(0,e),N=eu.substring(e+1)+`
`,et=[{type:"block-scalar-header",offset:ei,indent:C,source:n}];return Oa(et,ec)||et.push({type:"newline",offset:-1,indent:C,source:`
`}),{type:"block-scalar",offset:ei,indent:C,props:et,source:N}}case'"':return{type:"double-quoted-scalar",offset:ei,indent:C,source:eu,end:ec};case"'":return{type:"single-quoted-scalar",offset:ei,indent:C,source:eu,end:ec};default:return{type:"scalar",offset:ei,indent:C,source:eu,end:ec}}},isCollection:e=>!!e&&"items"in e,isScalar:e=>!!e&&("scalar"===e.type||"single-quoted-scalar"===e.type||"double-quoted-scalar"===e.type||"block-scalar"===e.type),prettyToken:function(e){switch(e){case"\uFEFF":return"<BOM>";case"\x02":return"<DOC>";case"\x18":return"<FLOW_END>";case"\x1f":return"<SCALAR>";default:return JSON.stringify(e)}},resolveAsScalar:function(e,n=!0,N){if(e){let r=(e,n,C)=>{let et="number"==typeof e?e:Array.isArray(e)?e[0]:e.offset;if(N)N(et,n,C);else throw new kn([et,et+1],n,C)};switch(e.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return wa(e,n,r);case"block-scalar":return Aa(e,n,r)}}return null},setScalarValue:function(e,n,N={}){let{afterKey:C=!1,implicitKey:et=!1,inFlow:ei=!1,type:eo}=N,eu="indent"in e?e.indent:null;if(C&&"number"==typeof eu&&(eu+=2),!eo)switch(e.type){case"single-quoted-scalar":eo="QUOTE_SINGLE";break;case"double-quoted-scalar":eo="QUOTE_DOUBLE";break;case"block-scalar":{let n=e.props[0];if("block-scalar-header"!==n.type)throw Error("Invalid block scalar header");eo=">"===n.source[0]?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:eo="PLAIN"}let ec=Wn({type:eo,value:n},{implicitKey:et||null===eu,indent:null!==eu&&eu>0?" ".repeat(eu):"",inFlow:ei,options:{blockQuote:!0,lineWidth:-1}});switch(ec[0]){case"|":case">":!function(e,n){let N=n.indexOf(`
`),C=n.substring(0,N),et=n.substring(N+1)+`
`;if("block-scalar"===e.type){let n=e.props[0];if("block-scalar-header"!==n.type)throw Error("Invalid block scalar header");n.source=C,e.source=et}else{let{offset:n}=e,N="indent"in e?e.indent:-1,ei=[{type:"block-scalar-header",offset:n,indent:N,source:C}];for(let n of(Oa(ei,"end"in e?e.end:void 0)||ei.push({type:"newline",offset:-1,indent:N,source:`
`}),Object.keys(e)))"type"!==n&&"offset"!==n&&delete e[n];Object.assign(e,{type:"block-scalar",indent:N,props:ei,source:et})}}(e,ec);break;case'"':Kr(e,ec,"double-quoted-scalar");break;case"'":Kr(e,ec,"single-quoted-scalar");break;default:Kr(e,ec,"scalar")}},stringify:e=>"type"in e?_r(e):fr(e),tokenType:Na,visit:Ln},Symbol.toStringTag,{value:"Module"}));function tn(e){switch(e){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}let to="0123456789ABCDEFabcdef".split(""),tl="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),tu=",[]{}".split(""),tc=` ,[]{}
\r	`.split(""),Hr=e=>!e||tc.includes(e);let Ua=class Ua{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,n=!1){e&&(this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null),this.atEnd=!n;let N=this.next??"stream";for(;N&&(n||this.hasChars(1));)N=yield*this.parseNext(N)}atLineEnd(){let e=this.pos,n=this.buffer[e];for(;" "===n||"	"===n;)n=this.buffer[++e];return!n||"#"===n||n===`
`||"\r"===n&&this.buffer[e+1]===`
`}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let n=this.buffer[e];if(this.indentNext>0){let N=0;for(;" "===n;)n=this.buffer[++N+e];if("\r"===n){let n=this.buffer[N+e+1];if(n===`
`||!n&&!this.atEnd)return e+N+1}return n!==`
`&&!(N>=this.indentNext)&&(n||this.atEnd)?-1:e+N}if("-"===n||"."===n){let n=this.buffer.substr(e,3);if(("---"===n||"..."===n)&&tn(this.buffer[e+3]))return -1}return e}getLine(){let e=this.lineEndPos;return("number"!=typeof e||-1!==e&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),-1===e?this.atEnd?this.buffer.substring(this.pos):null:("\r"===this.buffer[e-1]&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(null===e)return this.setNext("stream");if("\uFEFF"===e[0]&&(yield*this.pushCount(1),e=e.substring(1)),"%"===e[0]){let n=e.length,N=e.indexOf("#");if(-1!==N){let C=e[N-1];(" "===C||"	"===C)&&(n=N-1)}for(;;){let N=e[n-1];if(" "===N||"	"===N)n-=1;else break}let C=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-C),this.pushNewline(),"stream"}if(this.atLineEnd()){let n=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-n),yield*this.pushNewline(),"stream"}return yield"\x02",yield*this.parseLineStart()}*parseLineStart(){let e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if("-"===e||"."===e){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let e=this.peek(3);if("---"===e&&tn(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if("..."===e&&tn(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!tn(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){let[e,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if(("-"===e||"?"===e||":"===e)&&tn(n)){let e=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=e,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let e=this.getLine();if(null===e)return this.setNext("doc");let n=yield*this.pushIndicators();switch(e[n]){case"#":yield*this.pushCount(e.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Hr),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=(yield*this.parseBlockScalarHeader())+(yield*this.pushSpaces(!0)),yield*this.pushCount(e.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,n,N=-1;do(e=yield*this.pushNewline())>0?(n=yield*this.pushSpaces(!1),this.indentValue=N=n):n=0,n+=yield*this.pushSpaces(!0);while(e+n>0);let C=this.getLine();if(null===C)return this.setNext("flow");if((-1!==N&&N<this.indentNext&&"#"!==C[0]||0===N&&(C.startsWith("---")||C.startsWith("..."))&&tn(C[3]))&&!(N===this.indentNext-1&&1===this.flowLevel&&("]"===C[0]||"}"===C[0])))return this.flowLevel=0,yield"\x18",yield*this.parseLineStart();let et=0;for(;","===C[et];)et+=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0)),this.flowKey=!1;switch(C[et+=yield*this.pushIndicators()]){case void 0:return"flow";case"#":return yield*this.pushCount(C.length-et),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Hr),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let e=this.charAt(1);if(this.flowKey||tn(e)||","===e)return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let e=this.charAt(0),n=this.buffer.indexOf(e,this.pos+1);if("'"===e)for(;-1!==n&&"'"===this.buffer[n+1];)n=this.buffer.indexOf("'",n+2);else for(;-1!==n;){let e=0;for(;"\\"===this.buffer[n-1-e];)e+=1;if(e%2==0)break;n=this.buffer.indexOf('"',n+1)}let N=this.buffer.substring(0,n),C=N.indexOf(`
`,this.pos);if(-1!==C){for(;-1!==C;){let e=this.continueScalar(C+1);if(-1===e)break;C=N.indexOf(`
`,e)}-1!==C&&(n=C-("\r"===N[C-1]?2:1))}if(-1===n){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){let n=this.buffer[++e];if("+"===n)this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if("-"!==n)break}return yield*this.pushUntil(e=>tn(e)||"#"===e)}*parseBlockScalar(){let e=this.pos-1,n=0,N;e:for(let C=this.pos;N=this.buffer[C];++C)switch(N){case" ":n+=1;break;case`
`:e=C,n=0;break;case"\r":{let e=this.buffer[C+1];if(!e&&!this.atEnd)return this.setNext("block-scalar");if(e===`
`)break}default:break e}if(!N&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){-1===this.blockScalarIndent?this.indentNext=n:this.indentNext+=this.blockScalarIndent;do{let n=this.continueScalar(e+1);if(-1===n)break;e=this.buffer.indexOf(`
`,n)}while(-1!==e);if(-1===e){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}if(!this.blockScalarKeep)for(;;){let N=e-1,C=this.buffer[N];"\r"===C&&(C=this.buffer[--N]);let et=N;for(;" "===C||"	"===C;)C=this.buffer[--N];if(C===`
`&&N>=this.pos&&N+1+n>et)e=N;else break}return yield"\x1f",yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let e=this.flowLevel>0,n=this.pos-1,N=this.pos-1,C;for(;C=this.buffer[++N];)if(":"===C){let C=this.buffer[N+1];if(tn(C)||e&&","===C)break;n=N}else if(tn(C)){let et=this.buffer[N+1];if("\r"===C&&(et===`
`?(N+=1,C=`
`,et=this.buffer[N+1]):n=N),"#"===et||e&&tu.includes(et))break;if(C===`
`){let e=this.continueScalar(N+1);if(-1===e)break;N=Math.max(N,e-2)}}else{if(e&&tu.includes(C))break;n=N}return C||this.atEnd?(yield"\x1f",yield*this.pushToIndex(n+1,!0),e?"flow":"doc"):this.setNext("plain-scalar")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,n){let N=this.buffer.slice(this.pos,e);return N?(yield N,this.pos+=N.length,N.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Hr))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let e=this.flowLevel>0,n=this.charAt(1);if(tn(n)||e&&tu.includes(n))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if("<"===this.charAt(1)){let e=this.pos+2,n=this.buffer[e];for(;!tn(n)&&">"!==n;)n=this.buffer[++e];return yield*this.pushToIndex(">"===n?e+1:e,!1)}{let e=this.pos+1,n=this.buffer[e];for(;n;)if(tl.includes(n))n=this.buffer[++e];else if("%"===n&&to.includes(this.buffer[e+1])&&to.includes(this.buffer[e+2]))n=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){let e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):"\r"===e&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let n=this.pos-1,N;do N=this.buffer[++n];while(" "===N||e&&"	"===N);let C=n-this.pos;return C>0&&(yield this.buffer.substr(this.pos,C),this.pos=n),C}*pushUntil(e){let n=this.pos,N=this.buffer[n];for(;!e(N);)N=this.buffer[++n];return yield*this.pushToIndex(n,!1)}};let Ia=class Ia{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let n=0,N=this.lineStarts.length;for(;n<N;){let C=n+N>>1;this.lineStarts[C]<e?n=C+1:N=C}if(this.lineStarts[n]===e)return{line:n+1,col:1};if(0===n)return{line:0,col:e};let C=this.lineStarts[n-1];return{line:n,col:e-C+1}}}};function sn(e,n){for(let N=0;N<e.length;++N)if(e[N].type===n)return!0;return!1}function Ds(e){for(let n=0;n<e.length;++n)switch(e[n].type){case"space":case"comment":case"newline":break;default:return n}return -1}function Pa(e){switch(null==e?void 0:e.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function sr(e){switch(e.type){case"document":return e.start;case"block-map":{let n=e.items[e.items.length-1];return n.sep??n.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function Tn(e){var n;if(0===e.length)return[];let N=e.length;e:for(;--N>=0;)switch(e[N].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;(null==(n=e[++N])?void 0:n.type)==="space";);return e.splice(N,e.length)}function Gs(e){if("flow-seq-start"===e.start.type)for(let n of e.items)!n.sep||n.value||sn(n.start,"explicit-key-ind")||sn(n.sep,"map-value-ind")||(n.key&&(n.value=n.key),delete n.key,Pa(n.value)?n.value.end?Array.prototype.push.apply(n.value.end,n.sep):n.value.end=n.sep:Array.prototype.push.apply(n.start,n.sep),delete n.sep)}let gs=class gs{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Ua,this.onNewLine=e}*parse(e,n=!1){for(let N of(this.onNewLine&&0===this.offset&&this.onNewLine(0),this.lexer.lex(e,n)))yield*this.next(N);n||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}let n=Na(e);if(n){if("scalar"===n)this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&" "===e[0]&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}}else{let n=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let e=this.peek(1);if("doc-end"===this.type&&(!e||"doc-end"!==e.type)){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){let n=e??this.stack.pop();if(n){if(0===this.stack.length)yield n;else{let e=this.peek(1);switch("block-scalar"===n.type?n.indent="indent"in e?e.indent:0:"flow-collection"===n.type&&"document"===e.type&&(n.indent=0),"flow-collection"===n.type&&Gs(n),e.type){case"document":e.value=n;break;case"block-scalar":e.props.push(n);break;case"block-map":{let N=e.items[e.items.length-1];if(N.value){e.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}if(N.sep)N.value=n;else{Object.assign(N,{key:n,sep:[]}),this.onKeyLine=!sn(N.start,"explicit-key-ind");return}break}case"block-seq":{let N=e.items[e.items.length-1];N.value?e.items.push({start:[],value:n}):N.value=n;break}case"flow-collection":{let N=e.items[e.items.length-1];!N||N.value?e.items.push({start:[],key:n,sep:[]}):N.sep?N.value=n:Object.assign(N,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if(("document"===e.type||"block-map"===e.type||"block-seq"===e.type)&&("block-map"===n.type||"block-seq"===n.type)){let N=n.items[n.items.length-1];N&&!N.sep&&!N.value&&N.start.length>0&&-1===Ds(N.start)&&(0===n.indent||N.start.every(e=>"comment"!==e.type||e.indent<n.indent))&&("document"===e.type?e.end=N.start:e.items.push({start:N.start}),n.items.splice(-1,1))}}}else yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let e={type:"document",offset:this.offset,start:[]};"doc-start"===this.type&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":-1!==Ds(e.start)?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return;case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}let n=this.startBlockValue(e);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if("map-value-ind"===this.type){let n;let N=sr(this.peek(2)),C=Tn(N);e.end?((n=e.end).push(this.sourceToken),delete e.end):n=[this.sourceToken];let et={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:C,key:e,sep:n}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=et}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){var n;let N=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,N.value){let n="end"in N.value?N.value.end:void 0,C=Array.isArray(n)?n[n.length-1]:void 0;(null==C?void 0:C.type)==="comment"?null==n||n.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else N.sep?N.sep.push(this.sourceToken):N.start.push(this.sourceToken);return;case"space":case"comment":if(N.value)e.items.push({start:[this.sourceToken]});else if(N.sep)N.sep.push(this.sourceToken);else{if(this.atIndentedComment(N.start,e.indent)){let C=e.items[e.items.length-2],et=null==(n=null==C?void 0:C.value)?void 0:n.end;if(Array.isArray(et)){Array.prototype.push.apply(et,N.start),et.push(this.sourceToken),e.items.pop();return}}N.start.push(this.sourceToken)}return}if(this.indent>=e.indent){let n=!this.onKeyLine&&this.indent===e.indent&&N.sep,C=[];if(n&&N.sep&&!N.value){let n=[];for(let C=0;C<N.sep.length;++C){let et=N.sep[C];switch(et.type){case"newline":n.push(C);break;case"space":break;case"comment":et.indent>e.indent&&(n.length=0);break;default:n.length=0}}n.length>=2&&(C=N.sep.splice(n[1]))}switch(this.type){case"anchor":case"tag":n||N.value?(C.push(this.sourceToken),e.items.push({start:C}),this.onKeyLine=!0):N.sep?N.sep.push(this.sourceToken):N.start.push(this.sourceToken);return;case"explicit-key-ind":N.sep||sn(N.start,"explicit-key-ind")?n||N.value?(C.push(this.sourceToken),e.items.push({start:C})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}):N.start.push(this.sourceToken),this.onKeyLine=!0;return;case"map-value-ind":if(sn(N.start,"explicit-key-ind")){if(N.sep){if(N.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(sn(N.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:C,key:null,sep:[this.sourceToken]}]});else if(Pa(N.key)&&!sn(N.sep,"newline")){let e=Tn(N.start),n=N.key,C=N.sep;C.push(this.sourceToken),delete N.key,delete N.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:n,sep:C}]})}else C.length>0?N.sep=N.sep.concat(C,this.sourceToken):N.sep.push(this.sourceToken)}else if(sn(N.start,"newline"))Object.assign(N,{key:null,sep:[this.sourceToken]});else{let e=Tn(N.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:null,sep:[this.sourceToken]}]})}}else N.sep?N.value||n?e.items.push({start:C,key:null,sep:[this.sourceToken]}):sn(N.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):N.sep.push(this.sourceToken):Object.assign(N,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let et=this.flowScalar(this.type);n||N.value?(e.items.push({start:C,key:et,sep:[]}),this.onKeyLine=!0):N.sep?this.stack.push(et):(Object.assign(N,{key:et,sep:[]}),this.onKeyLine=!0);return}default:{let et=this.startBlockValue(e);if(et){n&&"block-seq"!==et.type&&sn(N.start,"explicit-key-ind")&&e.items.push({start:C}),this.stack.push(et);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){var n;let N=e.items[e.items.length-1];switch(this.type){case"newline":if(N.value){let n="end"in N.value?N.value.end:void 0,C=Array.isArray(n)?n[n.length-1]:void 0;(null==C?void 0:C.type)==="comment"?null==n||n.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else N.start.push(this.sourceToken);return;case"space":case"comment":if(N.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(N.start,e.indent)){let C=e.items[e.items.length-2],et=null==(n=null==C?void 0:C.value)?void 0:n.end;if(Array.isArray(et)){Array.prototype.push.apply(et,N.start),et.push(this.sourceToken),e.items.pop();return}}N.start.push(this.sourceToken)}return;case"anchor":case"tag":if(N.value||this.indent<=e.indent)break;N.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;N.value||sn(N.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):N.start.push(this.sourceToken);return}if(this.indent>e.indent){let n=this.startBlockValue(e);if(n){this.stack.push(n);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){let n=e.items[e.items.length-1];if("flow-error-end"===this.type){let e;do yield*this.pop(),e=this.peek(1);while(e&&"flow-collection"===e.type)}else if(0===e.end.length){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?e.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?e.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let N=this.flowScalar(this.type);!n||n.value?e.items.push({start:[],key:N,sep:[]}):n.sep?this.stack.push(N):Object.assign(n,{key:N,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}let N=this.startBlockValue(e);N?this.stack.push(N):(yield*this.pop(),yield*this.step())}else{let n=this.peek(2);if("block-map"!==n.type||("map-value-ind"!==this.type||n.indent!==e.indent)&&("newline"!==this.type||n.items[n.items.length-1].sep)){if("map-value-ind"===this.type&&"flow-collection"!==n.type){let N=sr(n),C=Tn(N);Gs(e);let et=e.end.splice(1,e.end.length);et.push(this.sourceToken);let ei={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:C,key:e,sep:et}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=ei}else yield*this.lineEnd(e)}else yield*this.pop(),yield*this.step()}}flowScalar(e){if(this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let n=sr(e),N=Tn(n);return N.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:N}]}}case"map-value-ind":{this.onKeyLine=!0;let n=sr(e),N=Tn(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:N,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,n){return"comment"===this.type&&!(this.indent<=n)&&e.every(e=>"newline"===e.type||"space"===e.type)}*documentEnd(e){"doc-mode"!==this.type&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop())}}};function Ba(e){let n=!1!==e.prettyErrors;return{lineCounter:e.lineCounter||n&&new Ia||null,prettyErrors:n}}function Ca(e,n={}){let{lineCounter:N,prettyErrors:C}=Ba(n),et=new gs(null==N?void 0:N.addNewLine),ei=new _s(n),eo=null;for(let n of ei.compose(et.parse(e),!0,e.length))if(eo){if("silent"!==eo.options.logLevel){eo.errors.push(new kn(n.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}}else eo=n;return C&&N&&(eo.errors.forEach(dr(e,N)),eo.warnings.forEach(dr(e,N))),eo}let tf=Object.freeze(Object.defineProperty({__proto__:null,Alias:br,CST:ti,Composer:_s,Document:Dn,Lexer:Ua,LineCounter:Ia,Pair:Yt,Parser:gs,Scalar:It,Schema:Or,YAMLError:ps,YAMLMap:en,YAMLParseError:kn,YAMLSeq:mn,YAMLWarning:ka,isAlias:An,isCollection:Ht,isDocument:Bn,isMap:Cn,isNode:Vt,isPair:Kt,isScalar:Gt,isSeq:Mn,parse:function(e,n,N){let C;"function"==typeof n?C=n:void 0===N&&n&&"object"==typeof n&&(N=n);let et=Ca(e,N);if(!et)return null;if(et.warnings.forEach(e=>ra(et.options.logLevel,e)),et.errors.length>0){if("silent"!==et.options.logLevel)throw et.errors[0];et.errors=[]}return et.toJS(Object.assign({reviver:C},N))},parseAllDocuments:function(e,n={}){let{lineCounter:N,prettyErrors:C}=Ba(n),et=new gs(null==N?void 0:N.addNewLine),ei=new _s(n),eo=Array.from(ei.compose(et.parse(e)));if(C&&N)for(let n of eo)n.errors.forEach(dr(e,N)),n.warnings.forEach(dr(e,N));return eo.length>0?eo:Object.assign([],{empty:!0},ei.streamInfo())},parseDocument:Ca,stringify:function(e,n,N){let C=null;if("function"==typeof n||Array.isArray(n)?C=n:void 0===N&&n&&(N=n),"string"==typeof N&&(N=N.length),"number"==typeof N){let e=Math.round(N);N=e<1?void 0:e>8?{indent:8}:{indent:e}}if(void 0===e){let{keepUndefined:e}=N??n??{};if(!e)return}return new Dn(e,C,N).toString(N)},visit:gn,visitAsync:mr},Symbol.toStringTag,{value:"Module"}));function Ks(e){let n={},N={exports:{boot:void 0}},C={context:Function("exports","module","define",e)(n,N,void 0)};return void 0!==n.boot?C.boot=n.boot:void 0!==N.exports.boot?C.boot=N.exports.boot:"object"===C.context&&void 0!==C.context.boot&&(C.boot=C.context.boot),C}function No(e){return new Promise(async(n,N)=>{if(void 0!==e.header)return n(e.header);if(void 0===e.url)return N("failed to get header");let C=e.url.split("/").slice(-1)[0];C.endsWith(".yml")||C.endsWith(".yaml")||(C="header.yml"),console.log(`load header ${C}...`);let et=await e.gameServer.get(C);return e.header=tf.parse(et),n(e.header)})}function Uo(e){return new Promise(async n=>{if(void 0===e.boot)throw"no boot specified";if("function"==typeof e.boot)return n(e.boot);if("object"==typeof e.boot)return n(e.boot.boot);if(!e.boot.endsWith(".js")&&!e.boot.endsWith(".ts")){let N=window[e.boot];if(void 0===N)throw`boot module ${e.boot} not found`;if(void 0===N.boot)throw`no boot function found in module ${e.boot}`;return n(N.boot)}if(e.boot.startsWith("http")){let N=await fetch(e.boot);if(!N.ok)throw N.statusText;let C=await N.text(),et=Ks(C);if(void 0===et.boot)throw`no boot function found in ${e.boot}`;return e.context=et.context,n(et.boot)}let N=await e.gameServer.get(e.boot),C=Ks(N);if(void 0===C.boot)throw`no boot function found in ${e.boot}`;return e.context=C.context,n(C.boot)})}(et=eo||(eo={})).defaultPlugin=e=>({name:"default",loadHeader:No,loadBoot:Uo}),et.injectHeader=e=>({name:"injectHeader",loadHeader:n=>new Promise((N,C)=>(n.header={...n.header??{},...e??{}},N(n.header)))});let Io=class Io{constructor(e){this._server=e}href(e){return this._server.href(e)}get(e){return this._server.get(e)}ready(e){this._server.ready(e)}close(e){this._server.close(e)}};let Co=class Co{constructor(e){this._isDone=!1,this._cancelRequested=!1,this.options=e}loadGame(){return new Promise(async e=>{var n,N;console.log("start game server..."),this.gameServer=await (n=this.options.sdkConfig,N=this.options.url,new Promise(e=>{let C=function(e,n){if(n.endsWith(".zip"))return e.zipServer(n);if(n.endsWith(".yaml")||n.endsWith(".yml")){let e=n.lastIndexOf("/");n=e<0?"":n.substring(0,e)}return e.fileServer(n)}(n,N),et=new Io(C);et.ready(()=>e(et))})),console.log("game server started"),console.log("load game header...");let C={url:this.options.url,gameServer:this.gameServer},et=await this.options.pluginDriver.hookReduceArg0("loadHeader",[C],(e,n,N)=>(null!==n&&(e.header=n),e));if(this.header=et.header,void 0===this.header)throw"could not load game header";console.log("game header loaded",this.header);let ei=this.options.boot??this.header.boot;if(void 0===ei)throw"missing boot parameter in game header";console.log("load game boot...");let eo={boot:ei,gameServer:this.gameServer},eu=await this.options.pluginDriver.hookReduceArg0("loadBoot",[eo],(e,n,N)=>(null!==n&&(e.boot=n),e));if(!eu||void 0===eu.boot||"function"!=typeof eu.boot)throw"could not load game boot";return console.log("game boot loaded",eu.boot),this.context=eu.context,this.boot=eu.boot,console.log("boot the game..."),this.game=await eu.boot({vm:this.options.vm}),console.log("game booted"),e()}).then(()=>{if(this._isDone=!0,this._cancelRequested){this.cancel();return}this.options.callback(this)}).catch(e=>{this._isDone=!0,this.error=e,this.cancel(),this.options.callback(this)})}cancel(){if(!this._isDone){this._cancelRequested=!0;return}void 0!==this.gameServer&&(this.gameServer.close(),this.gameServer=void 0)}};let jo=class jo{constructor(e,n,N){this._state=0,this._ui={},this._speed=1,this._physicsAccumulator=0,this._frame=0,this._time=0,this._sdkConfig=e,this._options=N,this._pluginDriver=new mi({player:this,vm:this},[eo.defaultPlugin(),...void 0!==this._options.plugins?this._options.plugins:[]]),this._controllerBus=new li({inputController:e.inputController}),void 0!==N.agents&&N.agents.map((e,n)=>{let N=this._controllerBus.get(n);void 0!==N&&N.loadAgent(e)}),this._tickFromGame=this._tickFromGame.bind(this),void 0!==this._options.onReady&&(this._readyCallback=this._options.onReady),"dataset"in n&&(this._ui.element=n,this._options={...N},void 0===this._options.url&&void 0!==n.dataset.url&&(this._options.url=n.dataset.url),this._attach(),this.autoPlay&&this.play())}get isLoading(){return 1==this._state}get isPlaying(){return 3==this._state}get isPaused(){return 4==this._state}_attach(){if(void 0!==this._ui.element){{let e=document.createElement("div");this._ui.wrapper=e,e.addEventListener("mouseenter",()=>this._onMouseEnter()),e.addEventListener("mousemove",()=>this._onMouseMove()),e.addEventListener("mouseleave",()=>this._onMouseLeave()),e.style.position="relative",e.style.backgroundSize="cover",void 0!==this._options.splashart&&(e.style.backgroundImage=`url('${this._options.splashart}')`),this._ui.element.appendChild(e)}{let e=document.createElement("div");this._ui.base=e,e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.left="0",e.style.top="0",this._ui.wrapper.appendChild(e)}void 0===this._options.width&&void 0===this._options.height&&(this._options.width=256,this._options.height=256),this.resize({width:this._options.width,height:this._options.height}),this._ui.overlay=new pi(this._ui.wrapper),this._ui.overlay.onPlay=()=>this.play(),this._ui.overlay.onSpeed=e=>this.speed=e,this._resizeListener=()=>this._onResize(),window.addEventListener("resize",this._resizeListener)}}_notifyReady(){void 0!==this._readyCallback&&this._readyCallback()}_play(e,n){if(void 0!==e){this.stop(),this._options.url=e??this._options.url,(!0===n||this.autoPlay)&&this._play();return}if(4===this._state){this._state=3,this._ui.overlay&&this._ui.overlay.playing(),void 0!==this._game&&this._game.play();return}if(0!==this._state){console.error("a game is already playing, call stop before");return}if(this._state=1,this._startLoadingDate=new Date,this._ui.overlay&&this._ui.overlay.loading(),void 0===this._ui.element)throw"no root HTML element";this._loadGameTask=new Co({sdkConfig:this._sdkConfig,url:this._options.url,boot:this._options.boot,pluginDriver:this._pluginDriver,vm:this,callback:e=>{void 0!==e.error&&console.log(e.error),this._game=e.game,this._game.ticker=this._tickFromGame,this._gameServer=e.gameServer,this._ready()}}),this._loadGameTask.loadGame()}_onMouseEnter(){this._ui.overlay&&this._ui.overlay.mouseEnter()}_onMouseMove(){this._ui.overlay&&this._ui.overlay.mouseMove()}_onMouseLeave(){this._ui.overlay&&this._ui.overlay.mouseLeave()}get player(){return this}get vm(){return this}get root(){return this._ui.base}get gameServer(){var e;return null==(e=this._loadGameTask)?void 0:e.gameServer}resize(e,n){void 0!==this._ui.wrapper&&("number"!=typeof e&&(n=e.height,e=e.width),void 0!==e?this._ui.wrapper.style.width=`${Math.round(e)}px`:this._ui.wrapper.style.width="100%",void 0!==n?this._ui.wrapper.style.height=`${Math.round(n)}px`:this._ui.wrapper.style.height="100%",this._onResize())}_onResize(){void 0!==this._game&&this._game.resize()}get onReady(){return this._readyCallback}set onReady(e){this._readyCallback=e,this.isPlaying&&this._notifyReady()}_ready(){if(1!=this._state)return;this._state=2;let e=1e3-(+new Date-+this._startLoadingDate);if(e>0){setTimeout(()=>this._ready_after_loading(),e);return}this._ready_after_loading()}_ready_after_loading(){2===this._state&&(this._state=3,void 0!==this._game&&(this.scale=this._options.scale??1),this._ui.overlay&&this._ui.overlay.playing(),this._game&&this._game.play(),this._notifyReady())}getController(e){return this._controllerBus.get(e)}get width(){return this._ui.wrapper?this._ui.wrapper.clientWidth:0}set width(e){this.resize({width:e})}get height(){return this._ui.wrapper?this._ui.wrapper.clientHeight:0}set height(e){this.resize({height:e})}get scale(){return void 0===this._game?1:Math.min(this.width/this._game.width,this.height/this._game.height)}set scale(e){void 0!==this._game&&(e/=this._game.scale??1,this.resize({width:this._game.width*e,height:this._game.height*e}))}get resizable(){return!0===this._options.resizable}set resizable(e){this._options.resizable=e}get speed(){return this._speed}set speed(e){this._speed=e}get url(){return this._options.url}set url(e){this.play({url:e})}get boot(){return this._options.boot}set boot(e){this._options.boot=e}get header(){var e;return null==(e=this._loadGameTask)?void 0:e.header}get autoPlay(){return!0===this._options.autoPlay}set autoPlay(e){this._options.autoPlay=e}get simulated(){return!0===this._options.simulated}set simulated(e){this._options.simulated=e}get frame(){return this._frame}get time(){return this._time}play(e){if("object"==typeof e){this._play(e.url,e.autoPlay);return}if(void 0!==e){this._play(e);return}this._play()}pause(){this.isPlaying&&(void 0!==this._game&&this._game.pause(),this._ui.overlay&&this._ui.overlay.paused(),this._state=4)}stop(){void 0!==this._game&&(this._game.stop(),this._game=void 0),this._ui.overlay&&this._ui.overlay.stopped(),void 0!==this._gameServer&&(this._gameServer.close(),this._gameServer=void 0),this._speed=1,this._state=0}reload(){this.stop(),this.play()}remove(){this.stop(),void 0!==this._resizeListener&&window.removeEventListener("resize",this._resizeListener),this._ui.overlay&&(this._ui.overlay.remove(),this._ui.overlay=void 0),this._ui.wrapper&&(this._ui.wrapper.remove(),this._ui.wrapper=void 0)}saveState(){return{physicsAccumulator:this._physicsAccumulator,game:void 0!==this._game?this._game.saveState():{},controllers:this._controllerBus.saveState()}}loadState(e){this._physicsAccumulator=void 0!==e.physicsAccumulator?e.physicsAccumulator:0,void 0!==this._game&&this._game.loadState(void 0!==e.game?e.game:{}),this._controllerBus.loadState(void 0!==e.controllers?e.controllers:[{},{}])}_tickFromGame(e){if(void 0!==this.ticker){this.ticker(e);return}this.simulated||this.tick(e)}tick(e){if(void 0!==this._game){for(this._physicsAccumulator+=e*this.speed;this._physicsAccumulator>.01;)this._tickOneFrame(.01,!1),this._physicsAccumulator-=.01;this._tickOneFrame(.01,!0)}}_tickOneFrame(e,n){this._time+=e,this._frame++;let N=this._game.getStateForAgent();this._game.tick(this._controllerBus.inputs(N),e,n)}};function Ma(e){return"length"in e}let zo=class zo{constructor(){this._inputs={left:!1,right:!1,up:!1,down:!1},this._keyDownListener=e=>this._onKey(e,!0),this._keyUpListener=e=>this._onKey(e,!1),document.addEventListener("keydown",this._keyDownListener,!1),document.addEventListener("keyup",this._keyUpListener,!1)}_onKey(e,n){"ArrowDown"===e.code||"KeyS"===e.code?("ArrowDown"===e.code&&e.preventDefault(),this._inputs.down=n):"ArrowUp"===e.code||"KeyW"===e.code?("ArrowUp"===e.code&&e.preventDefault(),this._inputs.up=n):"ArrowLeft"===e.code||"KeyA"===e.code?("ArrowLeft"===e.code&&e.preventDefault(),this._inputs.left=n):("ArrowRight"===e.code||"KeyD"===e.code)&&("ArrowRight"===e.code&&e.preventDefault(),this._inputs.right=n)}remove(){document.removeEventListener("keydown",this._keyDownListener),document.removeEventListener("keyup",this._keyUpListener)}get inputs(){return this._inputs}};var th="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof N.g?N.g:"u">typeof self?self:{};function or(e){throw Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var tp={exports:{}};tp.exports=(function t(e,n,N){function i(et,ei){if(!n[et]){if(!e[et]){if(!ei&&or)return or(et,!0);if(C)return C(et,!0);var eo=Error("Cannot find module '"+et+"'");throw eo.code="MODULE_NOT_FOUND",eo}var eu=n[et]={exports:{}};e[et][0].call(eu.exports,function(n){return i(e[et][1][n]||n)},eu,eu.exports,t,e,n,N)}return n[et].exports}for(var C=or,et=0;et<N.length;et++)i(N[et]);return i})({1:[function(e,n,N){var C=e("./utils"),et=e("./support"),ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";N.encode=function(e){for(var n,N,et,eo,eu,ec,ef,eh=[],ep=0,ed=e.length,e_=ed,eg="string"!==C.getTypeOf(e);ep<e.length;)e_=ed-ep,et=eg?(n=e[ep++],N=ep<ed?e[ep++]:0,ep<ed?e[ep++]:0):(n=e.charCodeAt(ep++),N=ep<ed?e.charCodeAt(ep++):0,ep<ed?e.charCodeAt(ep++):0),eo=n>>2,eu=(3&n)<<4|N>>4,ec=1<e_?(15&N)<<2|et>>6:64,ef=2<e_?63&et:64,eh.push(ei.charAt(eo)+ei.charAt(eu)+ei.charAt(ec)+ei.charAt(ef));return eh.join("")},N.decode=function(e){var n,N,C,eo,eu,ec,ef=0,eh=0,ep="data:";if(e.substr(0,ep.length)===ep)throw Error("Invalid base64 input, it looks like a data url.");var ed,e_=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===ei.charAt(64)&&e_--,e.charAt(e.length-2)===ei.charAt(64)&&e_--,e_%1!=0)throw Error("Invalid base64 input, bad content length.");for(ed=et.uint8array?new Uint8Array(0|e_):Array(0|e_);ef<e.length;)n=ei.indexOf(e.charAt(ef++))<<2|(eo=ei.indexOf(e.charAt(ef++)))>>4,N=(15&eo)<<4|(eu=ei.indexOf(e.charAt(ef++)))>>2,C=(3&eu)<<6|(ec=ei.indexOf(e.charAt(ef++))),ed[eh++]=n,64!==eu&&(ed[eh++]=N),64!==ec&&(ed[eh++]=C);return ed}},{"./support":30,"./utils":32}],2:[function(e,n,N){var C=e("./external"),et=e("./stream/DataWorker"),ei=e("./stream/Crc32Probe"),eo=e("./stream/DataLengthProbe");function h(e,n,N,C,et){this.compressedSize=e,this.uncompressedSize=n,this.crc32=N,this.compression=C,this.compressedContent=et}h.prototype={getContentWorker:function(){var e=new et(C.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new eo("data_length")),n=this;return e.on("end",function(){if(this.streamInfo.data_length!==n.uncompressedSize)throw Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new et(C.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(e,n,N){return e.pipe(new ei).pipe(new eo("uncompressedSize")).pipe(n.compressWorker(N)).pipe(new eo("compressedSize")).withStreamInfo("compression",n)},n.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,N){var C=e("./stream/GenericWorker");N.STORE={magic:"\x00\x00",compressWorker:function(){return new C("STORE compression")},uncompressWorker:function(){return new C("STORE decompression")}},N.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,N){var C=e("./utils"),et=function(){for(var e,n=[],N=0;N<256;N++){e=N;for(var C=0;C<8;C++)e=1&e?3988292384^e>>>1:e>>>1;n[N]=e}return n}();n.exports=function(e,n){return void 0!==e&&e.length?"string"!==C.getTypeOf(e)?function(e,n,N,C){var ei=C+N;e^=-1;for(var eo=C;eo<ei;eo++)e=e>>>8^et[255&(e^n[eo])];return -1^e}(0|n,e,e.length,0):function(e,n,N,C){var ei=C+N;e^=-1;for(var eo=C;eo<ei;eo++)e=e>>>8^et[255&(e^n.charCodeAt(eo))];return -1^e}(0|n,e,e.length,0):0}},{"./utils":32}],5:[function(e,n,N){N.base64=!1,N.binary=!1,N.dir=!1,N.createFolders=!0,N.date=null,N.compression=null,N.compressionOptions=null,N.comment=null,N.unixPermissions=null,N.dosPermissions=null},{}],6:[function(e,n,N){var C=null;C="u">typeof Promise?Promise:e("lie"),n.exports={Promise:C}},{lie:37}],7:[function(e,n,N){var C="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Uint32Array,et=e("pako"),ei=e("./utils"),eo=e("./stream/GenericWorker"),eu=C?"uint8array":"array";function w(e,n){eo.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=n,this.meta={}}N.magic="\b\x00",ei.inherits(w,eo),w.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(ei.transformTo(eu,e.data),!1)},w.prototype.flush=function(){eo.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},w.prototype.cleanUp=function(){eo.prototype.cleanUp.call(this),this._pako=null},w.prototype._createPako=function(){this._pako=new et[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(n){e.push({data:n,meta:e.meta})}},N.compressWorker=function(e){return new w("Deflate",e)},N.uncompressWorker=function(){return new w("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,N){function a(e,n){var N,C="";for(N=0;N<n;N++)C+=String.fromCharCode(255&e),e>>>=8;return C}function i(e,n,N,et,ec,ef){var eh,ep,ed,e_,eg=e.file,em=e.compression,eb=ef!==ei.utf8encode,ey=C.transformTo("string",ef(eg.name)),ev=C.transformTo("string",ei.utf8encode(eg.name)),ek=eg.comment,eA=C.transformTo("string",ef(ek)),eL=C.transformTo("string",ei.utf8encode(ek)),ex=ev.length!==eg.name.length,ew=eL.length!==ek.length,eT="",eO="",eE="",eS=eg.dir,eN=eg.date,eI={crc32:0,compressedSize:0,uncompressedSize:0};n&&!N||(eI.crc32=e.crc32,eI.compressedSize=e.compressedSize,eI.uncompressedSize=e.uncompressedSize);var eR=0;n&&(eR|=8),!eb&&(ex||ew)&&(eR|=2048);var eU=0,eC=0;eS&&(eU|=16),"UNIX"===ec?(eC=798,eU|=(ep=eh=eg.unixPermissions,eh||(ep=eS?16893:33204),(65535&ep)<<16)):(eC=20,eU|=63&(eg.dosPermissions||0)),ed=(eN.getUTCHours()<<6|eN.getUTCMinutes())<<5|eN.getUTCSeconds()/2,e_=(eN.getUTCFullYear()-1980<<4|eN.getUTCMonth()+1)<<5|eN.getUTCDate(),ex&&(eO=a(1,1)+a(eo(ey),4)+ev,eT+="up"+a(eO.length,2)+eO),ew&&(eE=a(1,1)+a(eo(eA),4)+eL,eT+="uc"+a(eE.length,2)+eE);var eM="";return eM+=`
\0`+a(eR,2)+em.magic+a(ed,2)+a(e_,2)+a(eI.crc32,4)+a(eI.compressedSize,4)+a(eI.uncompressedSize,4)+a(ey.length,2)+a(eT.length,2),{fileRecord:eu.LOCAL_FILE_HEADER+eM+ey+eT,dirRecord:eu.CENTRAL_FILE_HEADER+a(eC,2)+eM+a(eA.length,2)+"\x00\x00\x00\x00"+a(eU,4)+a(et,4)+ey+eT+eA}}var C=e("../utils"),et=e("../stream/GenericWorker"),ei=e("../utf8"),eo=e("../crc32"),eu=e("../signature");function L(e,n,N,C){et.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=n,this.zipPlatform=N,this.encodeFileName=C,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}C.inherits(L,et),L.prototype.push=function(e){var n=e.meta.percent||0,N=this.entriesCount,C=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,et.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:N?(n+100*(N-C-1))/N:100}}))},L.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var n=this.streamFiles&&!e.file.dir;if(n){var N=i(e,n,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:N.fileRecord,meta:{percent:0}})}else this.accumulate=!0},L.prototype.closedSource=function(e){this.accumulate=!1;var n=this.streamFiles&&!e.file.dir,N=i(e,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(N.dirRecord),n)this.push({data:eu.DATA_DESCRIPTOR+a(e.crc32,4)+a(e.compressedSize,4)+a(e.uncompressedSize,4),meta:{percent:100}});else for(this.push({data:N.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},L.prototype.flush=function(){for(var e,n,N,et,ei=this.bytesWritten,eo=0;eo<this.dirRecords.length;eo++)this.push({data:this.dirRecords[eo],meta:{percent:100}});var ec=this.bytesWritten-ei,ef=(e=this.dirRecords.length,n=this.zipComment,N=this.encodeFileName,et=C.transformTo("string",N(n)),eu.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+a(e,2)+a(e,2)+a(ec,4)+a(ei,4)+a(et.length,2)+et);this.push({data:ef,meta:{percent:100}})},L.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},L.prototype.registerPrevious=function(e){this._sources.push(e);var n=this;return e.on("data",function(e){n.processChunk(e)}),e.on("end",function(){n.closedSource(n.previous.streamInfo),n._sources.length?n.prepareNextSource():n.end()}),e.on("error",function(e){n.error(e)}),this},L.prototype.resume=function(){return!!et.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},L.prototype.error=function(e){var n=this._sources;if(!et.prototype.error.call(this,e))return!1;for(var N=0;N<n.length;N++)try{n[N].error(e)}catch{}return!0},L.prototype.lock=function(){et.prototype.lock.call(this);for(var e=this._sources,n=0;n<e.length;n++)e[n].lock()},n.exports=L},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,N){var C=e("../compressions"),et=e("./ZipFileWorker");N.generateWorker=function(e,n,N){var ei=new et(n.streamFiles,N,n.platform,n.encodeFileName),eo=0;try{e.forEach(function(e,N){eo++;var et=function(e,n){var N=e||n,et=C[N];if(!et)throw Error(N+" is not a valid compression method !");return et}(N.options.compression,n.compression),eu=N.options.compressionOptions||n.compressionOptions||{},ec=N.dir,ef=N.date;N._compressWorker(et,eu).withStreamInfo("file",{name:e,dir:ec,date:ef,comment:N.comment||"",unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions}).pipe(ei)}),ei.entriesCount=eo}catch(e){ei.error(e)}return ei}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,N){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new a;for(var n in this)"function"!=typeof this[n]&&(e[n]=this[n]);return e}}(a.prototype=e("./object")).loadAsync=e("./load"),a.support=e("./support"),a.defaults=e("./defaults"),a.version="3.10.1",a.loadAsync=function(e,n){return new a().loadAsync(e,n)},a.external=e("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,N){var C=e("./utils"),et=e("./external"),ei=e("./utf8"),eo=e("./zipEntries"),eu=e("./stream/Crc32Probe"),ec=e("./nodejsUtils");n.exports=function(e,n){var N=this;return n=C.extend(n||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:ei.utf8decode}),ec.isNode&&ec.isStream(e)?et.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):C.prepareContent("the loaded zip file",e,!0,n.optimizedBinaryString,n.base64).then(function(e){var N=new eo(n);return N.load(e),N}).then(function(e){var N=[et.Promise.resolve(e)],C=e.files;if(n.checkCRC32)for(var ei=0;ei<C.length;ei++)N.push(function(e){return new et.Promise(function(n,N){var C=e.decompressed.getContentWorker().pipe(new eu);C.on("error",function(e){N(e)}).on("end",function(){C.streamInfo.crc32!==e.decompressed.crc32?N(Error("Corrupted zip : CRC32 mismatch")):n()}).resume()})}(C[ei]));return et.Promise.all(N)}).then(function(e){for(var et=e.shift(),ei=et.files,eo=0;eo<ei.length;eo++){var eu=ei[eo],ec=eu.fileNameStr,ef=C.resolve(eu.fileNameStr);N.file(ef,eu.decompressed,{binary:!0,optimizedBinaryString:!0,date:eu.date,dir:eu.dir,comment:eu.fileCommentStr.length?eu.fileCommentStr:null,unixPermissions:eu.unixPermissions,dosPermissions:eu.dosPermissions,createFolders:n.createFolders}),eu.dir||(N.file(ef).unsafeOriginalName=ec)}return et.zipComment.length&&(N.comment=et.zipComment),N})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,N){var C=e("../utils"),et=e("../stream/GenericWorker");function l(e,n){et.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(n)}C.inherits(l,et),l.prototype._bindStream=function(e){var n=this;(this._stream=e).pause(),e.on("data",function(e){n.push({data:e,meta:{percent:0}})}).on("error",function(e){n.isPaused?this.generatedError=e:n.error(e)}).on("end",function(){n.isPaused?n._upstreamEnded=!0:n.end()})},l.prototype.pause=function(){return!!et.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!et.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,N){var C=e("readable-stream").Readable;function i(e,n,N){C.call(this,n),this._helper=e;var et=this;e.on("data",function(e,n){et.push(e)||et._helper.pause(),N&&N(n)}).on("error",function(e){et.emit("error",e)}).on("end",function(){et.push(null)})}e("../utils").inherits(i,C),i.prototype._read=function(){this._helper.resume()},n.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,n,N){n.exports={isNode:"u">typeof ef,newBufferFrom:function(e,n){if(ef.from&&ef.from!==Uint8Array.from)return ef.from(e,n);if("number"==typeof e)throw Error('The "data" argument must not be a number');return new ef(e,n)},allocBuffer:function(e){if(ef.alloc)return ef.alloc(e);var n=new ef(e);return n.fill(0),n},isBuffer:function(e){return ef.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,n,N){function a(e,n,N){var C,eo=et.getTypeOf(n),eh=et.extend(N||{},eu);eh.date=eh.date||new Date,null!==eh.compression&&(eh.compression=eh.compression.toUpperCase()),"string"==typeof eh.unixPermissions&&(eh.unixPermissions=parseInt(eh.unixPermissions,8)),eh.unixPermissions&&16384&eh.unixPermissions&&(eh.dir=!0),eh.dosPermissions&&16&eh.dosPermissions&&(eh.dir=!0),eh.dir&&(e=b(e)),eh.createFolders&&(C=m(e))&&R.call(this,C,!0);var e_="string"===eo&&!1===eh.binary&&!1===eh.base64;N&&void 0!==N.binary||(eh.binary=!e_),(n instanceof ec&&0===n.uncompressedSize||eh.dir||!n||0===n.length)&&(eh.base64=!1,eh.binary=!0,n="",eh.compression="STORE",eo="string");var eg=null;eg=n instanceof ec||n instanceof ei?n:ep.isNode&&ep.isStream(n)?new ed(e,n):et.prepareContent(e,n,eh.binary,eh.optimizedBinaryString,eh.base64);var em=new ef(e,eg,eh);this.files[e]=em}var C=e("./utf8"),et=e("./utils"),ei=e("./stream/GenericWorker"),eo=e("./stream/StreamHelper"),eu=e("./defaults"),ec=e("./compressedObject"),ef=e("./zipObject"),eh=e("./generate"),ep=e("./nodejsUtils"),ed=e("./nodejs/NodejsStreamInputAdapter"),m=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var n=e.lastIndexOf("/");return 0<n?e.substring(0,n):""},b=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},R=function(e,n){return n=void 0!==n?n:eu.createFolders,e=b(e),this.files[e]||a.call(this,e,null,{dir:!0,createFolders:n}),this.files[e]};function M(e){return"[object RegExp]"===Object.prototype.toString.call(e)}n.exports={load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var n,N,C;for(n in this.files)C=this.files[n],(N=n.slice(this.root.length,n.length))&&n.slice(0,this.root.length)===this.root&&e(N,C)},filter:function(e){var n=[];return this.forEach(function(N,C){e(N,C)&&n.push(C)}),n},file:function(e,n,N){if(1!=arguments.length)return e=this.root+e,a.call(this,e,n,N),this;if(M(e)){var C=e;return this.filter(function(e,n){return!n.dir&&C.test(e)})}var et=this.files[this.root+e];return et&&!et.dir?et:null},folder:function(e){if(!e)return this;if(M(e))return this.filter(function(n,N){return N.dir&&e.test(n)});var n=this.root+e,N=R.call(this,n),C=this.clone();return C.root=N.name,C},remove:function(e){e=this.root+e;var n=this.files[e];if(n||("/"!==e.slice(-1)&&(e+="/"),n=this.files[e]),n&&!n.dir)delete this.files[e];else for(var N=this.filter(function(n,N){return N.name.slice(0,e.length)===e}),C=0;C<N.length;C++)delete this.files[N[C].name];return this},generate:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var n,N={};try{if((N=et.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:C.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),"binarystring"===N.type&&(N.type="string"),!N.type)throw Error("No output type specified.");et.checkSupport(N.type),"darwin"!==N.platform&&"freebsd"!==N.platform&&"linux"!==N.platform&&"sunos"!==N.platform||(N.platform="UNIX"),"win32"===N.platform&&(N.platform="DOS");var eu=N.comment||this.comment||"";n=eh.generateWorker(this,N,eu)}catch(e){(n=new ei("error")).error(e)}return new eo(n,N.type||"string",N.mimeType)},generateAsync:function(e,n){return this.generateInternalStream(e).accumulate(n)},generateNodeStream:function(e,n){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(n)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,N){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,N){var C=e("./DataReader");function i(e){C.call(this,e);for(var n=0;n<this.data.length;n++)e[n]=255&e[n]}e("../utils").inherits(i,C),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var n=e.charCodeAt(0),N=e.charCodeAt(1),C=e.charCodeAt(2),et=e.charCodeAt(3),ei=this.length-4;0<=ei;--ei)if(this.data[ei]===n&&this.data[ei+1]===N&&this.data[ei+2]===C&&this.data[ei+3]===et)return ei-this.zero;return -1},i.prototype.readAndCheckSignature=function(e){var n=e.charCodeAt(0),N=e.charCodeAt(1),C=e.charCodeAt(2),et=e.charCodeAt(3),ei=this.readData(4);return n===ei[0]&&N===ei[1]&&C===ei[2]&&et===ei[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var n=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,n},n.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,n,N){var C=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var n,N=0;for(this.checkOffset(e),n=this.index+e-1;n>=this.index;n--)N=(N<<8)+this.byteAt(n);return this.index+=e,N},readString:function(e){return C.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},n.exports=i},{"../utils":32}],19:[function(e,n,N){var C=e("./Uint8ArrayReader");function i(e){C.call(this,e)}e("../utils").inherits(i,C),i.prototype.readData=function(e){this.checkOffset(e);var n=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,n},n.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,N){var C=e("./DataReader");function i(e){C.call(this,e)}e("../utils").inherits(i,C),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var n=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,n},n.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,n,N){var C=e("./ArrayReader");function i(e){C.call(this,e)}e("../utils").inherits(i,C),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var n=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,n},n.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,N){var C=e("../utils"),et=e("../support"),ei=e("./ArrayReader"),eo=e("./StringReader"),eu=e("./NodeBufferReader"),ec=e("./Uint8ArrayReader");n.exports=function(e){var n=C.getTypeOf(e);return C.checkSupport(n),"string"!==n||et.uint8array?"nodebuffer"===n?new eu(e):et.uint8array?new ec(C.transformTo("uint8array",e)):new ei(C.transformTo("array",e)):new eo(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,N){N.LOCAL_FILE_HEADER="PK\x03\x04",N.CENTRAL_FILE_HEADER="PK\x01\x02",N.CENTRAL_DIRECTORY_END="PK\x05\x06",N.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",N.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",N.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,N){var C=e("./GenericWorker"),et=e("../utils");function l(e){C.call(this,"ConvertWorker to "+e),this.destType=e}et.inherits(l,C),l.prototype.processChunk=function(e){this.push({data:et.transformTo(this.destType,e.data),meta:e.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,N){var C=e("./GenericWorker"),et=e("../crc32");function l(){C.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,C),l.prototype.processChunk=function(e){this.streamInfo.crc32=et(e.data,this.streamInfo.crc32||0),this.push(e)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,N){var C=e("../utils"),et=e("./GenericWorker");function l(e){et.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}C.inherits(l,et),l.prototype.processChunk=function(e){if(e){var n=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=n+e.data.length}et.prototype.processChunk.call(this,e)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,N){var C=e("../utils"),et=e("./GenericWorker");function l(e){et.call(this,"DataWorker");var n=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){n.dataIsReady=!0,n.data=e,n.max=e&&e.length||0,n.type=C.getTypeOf(e),n.isPaused||n._tickAndRepeat()},function(e){n.error(e)})}C.inherits(l,et),l.prototype.cleanUp=function(){et.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!et.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,C.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(C.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,n=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,n);break;case"uint8array":e=this.data.subarray(this.index,n);break;case"array":case"nodebuffer":e=this.data.slice(this.index,n)}return this.index=n,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,N){function a(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,n){return this._listeners[e].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,n){if(this._listeners[e])for(var N=0;N<this._listeners[e].length;N++)this._listeners[e][N].call(this,n)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var n=this;return e.on("data",function(e){n.processChunk(e)}),e.on("end",function(){n.end()}),e.on("error",function(e){n.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,n){return this.extraStreamInfo[e]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},n.exports=a},{}],29:[function(e,n,N){var C=e("../utils"),et=e("./ConvertWorker"),ei=e("./GenericWorker"),eo=e("../base64"),eu=e("../support"),ec=e("../external"),eh=null;if(eu.nodestream)try{eh=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(e,n,N){var eo=n;switch(n){case"blob":case"arraybuffer":eo="uint8array";break;case"base64":eo="string"}try{this._internalType=eo,this._outputType=n,this._mimeType=N,C.checkSupport(eo),this._worker=e.pipe(new et(eo)),e.lock()}catch(e){this._worker=new ei("error"),this._worker.error(e)}}_.prototype={accumulate:function(e){var n;return n=this,new ec.Promise(function(N,et){var ei=[],eu=n._internalType,ec=n._outputType,eh=n._mimeType;n.on("data",function(n,N){ei.push(n),e&&e(N)}).on("error",function(e){ei=[],et(e)}).on("end",function(){try{var e=function(e,n,N){switch(e){case"blob":return C.newBlob(C.transformTo("arraybuffer",n),N);case"base64":return eo.encode(n);default:return C.transformTo(e,n)}}(ec,function(e,n){var N,C=0,et=null,ei=0;for(N=0;N<n.length;N++)ei+=n[N].length;switch(e){case"string":return n.join("");case"array":return Array.prototype.concat.apply([],n);case"uint8array":for(et=new Uint8Array(ei),N=0;N<n.length;N++)et.set(n[N],C),C+=n[N].length;return et;case"nodebuffer":return ef.concat(n);default:throw Error("concat : unsupported type '"+e+"'")}}(eu,ei),eh);N(e)}catch(e){et(e)}ei=[]}).resume()})},on:function(e,n){var N=this;return"data"===e?this._worker.on(e,function(e){n.call(N,e.data,e.meta)}):this._worker.on(e,function(){C.delay(n,arguments,N)}),this},resume:function(){return C.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(C.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+" is not supported by this method");return new eh(this,{objectMode:"nodebuffer"!==this._outputType},e)}},n.exports=_},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,N){if(N.base64=!0,N.array=!0,N.string=!0,N.arraybuffer="u">typeof ArrayBuffer&&"u">typeof Uint8Array,N.nodebuffer="u">typeof ef,N.uint8array="u">typeof Uint8Array,typeof ArrayBuffer>"u")N.blob=!1;else{var C=new ArrayBuffer(0);try{N.blob=0===new Blob([C],{type:"application/zip"}).size}catch{try{var et=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);et.append(C),N.blob=0===et.getBlob("application/zip").size}catch{N.blob=!1}}}try{N.nodestream=!!e("readable-stream").Readable}catch{N.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,N){for(var C=e("./utils"),et=e("./support"),ei=e("./nodejsUtils"),eo=e("./stream/GenericWorker"),eu=Array(256),ec=0;ec<256;ec++)eu[ec]=252<=ec?6:248<=ec?5:240<=ec?4:224<=ec?3:192<=ec?2:1;function d(){eo.call(this,"utf-8 decode"),this.leftOver=null}function L(){eo.call(this,"utf-8 encode")}eu[254]=eu[254]=1,N.utf8encode=function(e){return et.nodebuffer?ei.newBufferFrom(e,"utf-8"):function(e){var n,N,C,ei,eo,eu=e.length,ec=0;for(ei=0;ei<eu;ei++)(64512&(N=e.charCodeAt(ei)))==55296&&ei+1<eu&&(64512&(C=e.charCodeAt(ei+1)))==56320&&(N=65536+(N-55296<<10)+(C-56320),ei++),ec+=N<128?1:N<2048?2:N<65536?3:4;for(n=et.uint8array?new Uint8Array(ec):Array(ec),ei=eo=0;eo<ec;ei++)(64512&(N=e.charCodeAt(ei)))==55296&&ei+1<eu&&(64512&(C=e.charCodeAt(ei+1)))==56320&&(N=65536+(N-55296<<10)+(C-56320),ei++),N<128?n[eo++]=N:(N<2048?n[eo++]=192|N>>>6:(N<65536?n[eo++]=224|N>>>12:(n[eo++]=240|N>>>18,n[eo++]=128|N>>>12&63),n[eo++]=128|N>>>6&63),n[eo++]=128|63&N);return n}(e)},N.utf8decode=function(e){return et.nodebuffer?C.transformTo("nodebuffer",e).toString("utf-8"):function(e){var n,N,et,ei,eo=e.length,ec=Array(2*eo);for(n=N=0;n<eo;)if((et=e[n++])<128)ec[N++]=et;else if(4<(ei=eu[et]))ec[N++]=65533,n+=ei-1;else{for(et&=2===ei?31:3===ei?15:7;1<ei&&n<eo;)et=et<<6|63&e[n++],ei--;1<ei?ec[N++]=65533:et<65536?ec[N++]=et:(et-=65536,ec[N++]=55296|et>>10&1023,ec[N++]=56320|1023&et)}return ec.length!==N&&(ec.subarray?ec=ec.subarray(0,N):ec.length=N),C.applyFromCharCode(ec)}(e=C.transformTo(et.uint8array?"uint8array":"array",e))},C.inherits(d,eo),d.prototype.processChunk=function(e){var n=C.transformTo(et.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(et.uint8array){var ei=n;(n=new Uint8Array(ei.length+this.leftOver.length)).set(this.leftOver,0),n.set(ei,this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}var eo=function(e,n){var N;for((n=n||e.length)>e.length&&(n=e.length),N=n-1;0<=N&&(192&e[N])==128;)N--;return N<0||0===N?n:N+eu[e[N]]>n?N:n}(n),ec=n;eo!==n.length&&(et.uint8array?(ec=n.subarray(0,eo),this.leftOver=n.subarray(eo,n.length)):(ec=n.slice(0,eo),this.leftOver=n.slice(eo,n.length))),this.push({data:N.utf8decode(ec),meta:e.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:N.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},N.Utf8DecodeWorker=d,C.inherits(L,eo),L.prototype.processChunk=function(e){this.push({data:N.utf8encode(e.data),meta:e.meta})},N.Utf8EncodeWorker=L},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,N){var C=e("./support"),et=e("./base64"),ei=e("./nodejsUtils"),eo=e("./external");function h(e){return e}function w(e,n){for(var N=0;N<e.length;++N)n[N]=255&e.charCodeAt(N);return n}e("setimmediate"),N.newBlob=function(e,n){N.checkSupport("blob");try{return new Blob([e],{type:n})}catch{try{var C=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return C.append(e),C.getBlob(n)}catch{throw Error("Bug : can't construct the Blob.")}}};var eu={stringifyByChunk:function(e,n,N){var C=[],et=0,ei=e.length;if(ei<=N)return String.fromCharCode.apply(null,e);for(;et<ei;)"array"===n||"nodebuffer"===n?C.push(String.fromCharCode.apply(null,e.slice(et,Math.min(et+N,ei)))):C.push(String.fromCharCode.apply(null,e.subarray(et,Math.min(et+N,ei)))),et+=N;return C.join("")},stringifyByChar:function(e){for(var n="",N=0;N<e.length;N++)n+=String.fromCharCode(e[N]);return n},applyCanBeUsed:{uint8array:function(){try{return C.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return C.nodebuffer&&1===String.fromCharCode.apply(null,ei.allocBuffer(1)).length}catch{return!1}}()}};function L(e){var n=65536,C=N.getTypeOf(e),et=!0;if("uint8array"===C?et=eu.applyCanBeUsed.uint8array:"nodebuffer"===C&&(et=eu.applyCanBeUsed.nodebuffer),et)for(;1<n;)try{return eu.stringifyByChunk(e,C,n)}catch{n=Math.floor(n/2)}return eu.stringifyByChar(e)}function _(e,n){for(var N=0;N<e.length;N++)n[N]=e[N];return n}N.applyFromCharCode=L;var ec={};ec.string={string:h,array:function(e){return w(e,Array(e.length))},arraybuffer:function(e){return ec.string.uint8array(e).buffer},uint8array:function(e){return w(e,new Uint8Array(e.length))},nodebuffer:function(e){return w(e,ei.allocBuffer(e.length))}},ec.array={string:L,array:h,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return ei.newBufferFrom(e)}},ec.arraybuffer={string:function(e){return L(new Uint8Array(e))},array:function(e){return _(new Uint8Array(e),Array(e.byteLength))},arraybuffer:h,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return ei.newBufferFrom(new Uint8Array(e))}},ec.uint8array={string:L,array:function(e){return _(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:h,nodebuffer:function(e){return ei.newBufferFrom(e)}},ec.nodebuffer={string:L,array:function(e){return _(e,Array(e.length))},arraybuffer:function(e){return ec.nodebuffer.uint8array(e).buffer},uint8array:function(e){return _(e,new Uint8Array(e.length))},nodebuffer:h},N.transformTo=function(e,n){return(n=n||"",e)?(N.checkSupport(e),ec[N.getTypeOf(n)][e](n)):n},N.resolve=function(e){for(var n=e.split("/"),N=[],C=0;C<n.length;C++){var et=n[C];"."===et||""===et&&0!==C&&C!==n.length-1||(".."===et?N.pop():N.push(et))}return N.join("/")},N.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":C.nodebuffer&&ei.isBuffer(e)?"nodebuffer":C.uint8array&&e instanceof Uint8Array?"uint8array":C.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},N.checkSupport=function(e){if(!C[e.toLowerCase()])throw Error(e+" is not supported by this platform")},N.MAX_VALUE_16BITS=65535,N.MAX_VALUE_32BITS=-1,N.pretty=function(e){var n,N,C="";for(N=0;N<(e||"").length;N++)C+="\\x"+((n=e.charCodeAt(N))<16?"0":"")+n.toString(16).toUpperCase();return C},N.delay=function(e,n,N){setImmediate(function(){e.apply(N||null,n||[])})},N.inherits=function(e,n){function b(){}b.prototype=n.prototype,e.prototype=new b},N.extend=function(){var e,n,N={};for(e=0;e<arguments.length;e++)for(n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&void 0===N[n]&&(N[n]=arguments[e][n]);return N},N.prepareContent=function(e,n,ei,eu,ec){return eo.Promise.resolve(n).then(function(e){return C.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"u">typeof FileReader?new eo.Promise(function(n,N){var C=new FileReader;C.onload=function(e){n(e.target.result)},C.onerror=function(e){N(e.target.error)},C.readAsArrayBuffer(e)}):e}).then(function(n){var ef,eh=N.getTypeOf(n);return eh?("arraybuffer"===eh?n=N.transformTo("uint8array",n):"string"===eh&&(ec?n=et.decode(n):ei&&!0!==eu&&(n=w(ef=n,C.uint8array?new Uint8Array(ef.length):Array(ef.length)))),n):eo.Promise.reject(Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,N){var C=e("./reader/readerFor"),et=e("./utils"),ei=e("./signature"),eo=e("./zipEntry"),eu=e("./support");function w(e){this.files=[],this.loadOptions=e}w.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var n=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+et.pretty(n)+", expected "+et.pretty(e)+")")}},isSignature:function(e,n){var N=this.reader.index;this.reader.setIndex(e);var C=this.reader.readString(4)===n;return this.reader.setIndex(N),C},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),n=eu.uint8array?"uint8array":"array",N=et.transformTo(n,e);this.zipComment=this.loadOptions.decodeFileName(N)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,n,N,C=this.zip64EndOfCentralSize-44;0<C;)e=this.reader.readInt(2),n=this.reader.readInt(4),N=this.reader.readData(n),this.zip64ExtensibleData[e]={id:e,length:n,value:N}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,n;for(e=0;e<this.files.length;e++)n=this.files[e],this.reader.setIndex(n.localHeaderOffset),this.checkSignature(ei.LOCAL_FILE_HEADER),n.readLocalPart(this.reader),n.handleUTF8(),n.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(ei.CENTRAL_FILE_HEADER);)(e=new eo({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(ei.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,ei.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var n=e;if(this.checkSignature(ei.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===et.MAX_VALUE_16BITS||this.diskWithCentralDirStart===et.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===et.MAX_VALUE_16BITS||this.centralDirRecords===et.MAX_VALUE_16BITS||this.centralDirSize===et.MAX_VALUE_32BITS||this.centralDirOffset===et.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(ei.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(ei.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,ei.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(ei.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(ei.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var N=this.centralDirOffset+this.centralDirSize;this.zip64&&(N+=20+(12+this.zip64EndOfCentralSize));var C=n-N;if(0<C)this.isSignature(n,ei.CENTRAL_FILE_HEADER)||(this.reader.zero=C);else if(C<0)throw Error("Corrupted zip: missing "+Math.abs(C)+" bytes.")},prepareReader:function(e){this.reader=C(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=w},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,N){var C=e("./reader/readerFor"),et=e("./utils"),ei=e("./compressedObject"),eo=e("./crc32"),eu=e("./utf8"),ec=e("./compressions"),ef=e("./support");function L(e,n){this.options=e,this.loadOptions=n}L.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(e){var n,N;if(e.skip(22),this.fileNameLength=e.readInt(2),N=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(N),-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(n=function(e){for(var n in ec)if(Object.prototype.hasOwnProperty.call(ec,n)&&ec[n].magic===e)return ec[n];return null}(this.compressionMethod)))throw Error("Corrupted zip : compression "+et.pretty(this.compressionMethod)+" unknown (inner file : "+et.transformTo("string",this.fileName)+")");this.decompressed=new ei(this.compressedSize,this.uncompressedSize,this.crc32,n,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var n=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");e.skip(n),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=C(this.extraFields[1].value);this.uncompressedSize===et.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===et.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===et.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===et.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var n,N,C,et=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<et;)n=e.readInt(2),N=e.readInt(2),C=e.readData(N),this.extraFields[n]={id:n,length:N,value:C};e.setIndex(et)},handleUTF8:function(){var e=ef.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=eu.utf8decode(this.fileName),this.fileCommentStr=eu.utf8decode(this.fileComment);else{var n=this.findExtraFieldUnicodePath();if(null!==n)this.fileNameStr=n;else{var N=et.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(N)}var C=this.findExtraFieldUnicodeComment();if(null!==C)this.fileCommentStr=C;else{var ei=et.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(ei)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var n=C(e.value);return 1!==n.readInt(1)||eo(this.fileName)!==n.readInt(4)?null:eu.utf8decode(n.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var n=C(e.value);return 1!==n.readInt(1)||eo(this.fileComment)!==n.readInt(4)?null:eu.utf8decode(n.readData(e.length-5))}return null}},n.exports=L},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,N){function a(e,n,N){this.name=e,this.dir=N.dir,this.date=N.date,this.comment=N.comment,this.unixPermissions=N.unixPermissions,this.dosPermissions=N.dosPermissions,this._data=n,this._dataBinary=N.binary,this.options={compression:N.compression,compressionOptions:N.compressionOptions}}var C=e("./stream/StreamHelper"),et=e("./stream/DataWorker"),ei=e("./utf8"),eo=e("./compressedObject"),eu=e("./stream/GenericWorker");a.prototype={internalStream:function(e){var n=null,N="string";try{if(!e)throw Error("No output type specified.");var et="string"===(N=e.toLowerCase())||"text"===N;"binarystring"!==N&&"text"!==N||(N="string"),n=this._decompressWorker();var eo=!this._dataBinary;eo&&!et&&(n=n.pipe(new ei.Utf8EncodeWorker)),!eo&&et&&(n=n.pipe(new ei.Utf8DecodeWorker))}catch(e){(n=new eu("error")).error(e)}return new C(n,N,"")},async:function(e,n){return this.internalStream(e).accumulate(n)},nodeStream:function(e,n){return this.internalStream(e||"nodebuffer").toNodejsStream(n)},_compressWorker:function(e,n){if(this._data instanceof eo&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var N=this._decompressWorker();return this._dataBinary||(N=N.pipe(new ei.Utf8EncodeWorker)),eo.createWorkerFrom(N,e,n)},_decompressWorker:function(){return this._data instanceof eo?this._data.getContentWorker():this._data instanceof eu?this._data:new et(this._data)}};for(var ec=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],L=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},ef=0;ef<ec.length;ef++)a.prototype[ec[ef]]=L;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,N){(function(e){var N,C,et=e.MutationObserver||e.WebKitMutationObserver;if(et){var ei=0,eo=new et(E),eu=e.document.createTextNode("");eo.observe(eu,{characterData:!0}),N=function(){eu.data=ei=++ei%2}}else if(e.setImmediate||void 0===e.MessageChannel)N="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var n=e.document.createElement("script");n.onreadystatechange=function(){E(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},e.document.documentElement.appendChild(n)}:function(){setTimeout(E,0)};else{var ec=new e.MessageChannel;ec.port1.onmessage=E,N=function(){ec.port2.postMessage(0)}}var ef=[];function E(){var e,n;C=!0;for(var N=ef.length;N;){for(n=ef,ef=[],e=-1;++e<N;)n[e]();N=ef.length}C=!1}n.exports=function(e){1!==ef.push(e)||C||N()}}).call(this,"u">typeof th?th:"u">typeof self?self:"u">typeof window?window:{})},{}],37:[function(e,n,N){var C=e("immediate");function i(){}var et={},ei=["REJECTED"],eo=["FULFILLED"],eu=["PENDING"];function d(e){if("function"!=typeof e)throw TypeError("resolver must be a function");this.state=eu,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function L(e,n,N){this.promise=e,"function"==typeof n&&(this.onFulfilled=n,this.callFulfilled=this.otherCallFulfilled),"function"==typeof N&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function _(e,n,N){C(function(){var C;try{C=n(N)}catch(n){return et.reject(e,n)}C===e?et.reject(e,TypeError("Cannot resolve promise with itself")):et.resolve(e,C)})}function E(e){var n=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof n)return function(){n.apply(e,arguments)}}function f(e,n){var N=!1;function H(n){N||(N=!0,et.reject(e,n))}function z(n){N||(N=!0,et.resolve(e,n))}var C=m(function(){n(z,H)});"error"===C.status&&H(C.value)}function m(e,n){var N={};try{N.value=e(n),N.status="success"}catch(e){N.status="error",N.value=e}return N}(n.exports=d).prototype.finally=function(e){if("function"!=typeof e)return this;var n=this.constructor;return this.then(function(N){return n.resolve(e()).then(function(){return N})},function(N){return n.resolve(e()).then(function(){throw N})})},d.prototype.catch=function(e){return this.then(null,e)},d.prototype.then=function(e,n){if("function"!=typeof e&&this.state===eo||"function"!=typeof n&&this.state===ei)return this;var N=new this.constructor(i);return this.state!==eu?_(N,this.state===eo?e:n,this.outcome):this.queue.push(new L(N,e,n)),N},L.prototype.callFulfilled=function(e){et.resolve(this.promise,e)},L.prototype.otherCallFulfilled=function(e){_(this.promise,this.onFulfilled,e)},L.prototype.callRejected=function(e){et.reject(this.promise,e)},L.prototype.otherCallRejected=function(e){_(this.promise,this.onRejected,e)},et.resolve=function(e,n){var N=m(E,n);if("error"===N.status)return et.reject(e,N.value);var C=N.value;if(C)f(e,C);else{e.state=eo,e.outcome=n;for(var ei=-1,eu=e.queue.length;++ei<eu;)e.queue[ei].callFulfilled(n)}return e},et.reject=function(e,n){e.state=ei,e.outcome=n;for(var N=-1,C=e.queue.length;++N<C;)e.queue[N].callRejected(n);return e},d.resolve=function(e){return e instanceof this?e:et.resolve(new this(i),e)},d.reject=function(e){var n=new this(i);return et.reject(n,e)},d.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var N=e.length,C=!1;if(!N)return this.resolve([]);for(var ei=Array(N),eo=0,eu=-1,ec=new this(i);++eu<N;)(function(e,eu){n.resolve(e).then(function(e){ei[eu]=e,++eo!==N||C||(C=!0,et.resolve(ec,ei))},function(e){C||(C=!0,et.reject(ec,e))})})(e[eu],eu);return ec},d.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(TypeError("must be an array"));var n,N=e.length,C=!1;if(!N)return this.resolve([]);for(var ei=-1,eo=new this(i);++ei<N;)n=e[ei],this.resolve(n).then(function(e){C||(C=!0,et.resolve(eo,e))},function(e){C||(C=!0,et.reject(eo,e))});return eo}},{immediate:36}],38:[function(e,n,N){var C={};(0,e("./lib/utils/common").assign)(C,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=C},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,N){var C=e("./zlib/deflate"),et=e("./utils/common"),ei=e("./utils/strings"),eo=e("./zlib/messages"),eu=e("./zlib/zstream"),ec=Object.prototype.toString;function f(e){if(!(this instanceof f))return new f(e);this.options=et.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var n,N=this.options;N.raw&&0<N.windowBits?N.windowBits=-N.windowBits:N.gzip&&0<N.windowBits&&N.windowBits<16&&(N.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eu,this.strm.avail_out=0;var ef=C.deflateInit2(this.strm,N.level,N.method,N.windowBits,N.memLevel,N.strategy);if(0!==ef)throw Error(eo[ef]);if(N.header&&C.deflateSetHeader(this.strm,N.header),N.dictionary){if(n="string"==typeof N.dictionary?ei.string2buf(N.dictionary):"[object ArrayBuffer]"===ec.call(N.dictionary)?new Uint8Array(N.dictionary):N.dictionary,0!==(ef=C.deflateSetDictionary(this.strm,n)))throw Error(eo[ef]);this._dict_set=!0}}function m(e,n){var N=new f(n);if(N.push(e,!0),N.err)throw N.msg||eo[N.err];return N.result}f.prototype.push=function(e,n){var N,eo,eu=this.strm,ef=this.options.chunkSize;if(this.ended)return!1;eo=n===~~n?n:!0===n?4:0,"string"==typeof e?eu.input=ei.string2buf(e):"[object ArrayBuffer]"===ec.call(e)?eu.input=new Uint8Array(e):eu.input=e,eu.next_in=0,eu.avail_in=eu.input.length;do{if(0===eu.avail_out&&(eu.output=new et.Buf8(ef),eu.next_out=0,eu.avail_out=ef),1!==(N=C.deflate(eu,eo))&&0!==N)return this.onEnd(N),this.ended=!0,!1;0!==eu.avail_out&&(0!==eu.avail_in||4!==eo&&2!==eo)||("string"===this.options.to?this.onData(ei.buf2binstring(et.shrinkBuf(eu.output,eu.next_out))):this.onData(et.shrinkBuf(eu.output,eu.next_out)))}while((0<eu.avail_in||0===eu.avail_out)&&1!==N);return 4===eo?(N=C.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,0===N):2!==eo||(this.onEnd(0),eu.avail_out=0,!0)},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},N.Deflate=f,N.deflate=m,N.deflateRaw=function(e,n){return(n=n||{}).raw=!0,m(e,n)},N.gzip=function(e,n){return(n=n||{}).gzip=!0,m(e,n)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,N){var C=e("./zlib/inflate"),et=e("./utils/common"),ei=e("./utils/strings"),eo=e("./zlib/constants"),eu=e("./zlib/messages"),ec=e("./zlib/zstream"),ef=e("./zlib/gzheader"),eh=Object.prototype.toString;function _(e){if(!(this instanceof _))return new _(e);this.options=et.assign({chunkSize:16384,windowBits:0,to:""},e||{});var n=this.options;n.raw&&0<=n.windowBits&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),!(0<=n.windowBits&&n.windowBits<16)||e&&e.windowBits||(n.windowBits+=32),15<n.windowBits&&n.windowBits<48&&!(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ec,this.strm.avail_out=0;var N=C.inflateInit2(this.strm,n.windowBits);if(N!==eo.Z_OK)throw Error(eu[N]);this.header=new ef,C.inflateGetHeader(this.strm,this.header)}function E(e,n){var N=new _(n);if(N.push(e,!0),N.err)throw N.msg||eu[N.err];return N.result}_.prototype.push=function(e,n){var N,eu,ec,ef,ep,ed,e_=this.strm,eg=this.options.chunkSize,em=this.options.dictionary,eb=!1;if(this.ended)return!1;eu=n===~~n?n:!0===n?eo.Z_FINISH:eo.Z_NO_FLUSH,"string"==typeof e?e_.input=ei.binstring2buf(e):"[object ArrayBuffer]"===eh.call(e)?e_.input=new Uint8Array(e):e_.input=e,e_.next_in=0,e_.avail_in=e_.input.length;do{if(0===e_.avail_out&&(e_.output=new et.Buf8(eg),e_.next_out=0,e_.avail_out=eg),(N=C.inflate(e_,eo.Z_NO_FLUSH))===eo.Z_NEED_DICT&&em&&(ed="string"==typeof em?ei.string2buf(em):"[object ArrayBuffer]"===eh.call(em)?new Uint8Array(em):em,N=C.inflateSetDictionary(this.strm,ed)),N===eo.Z_BUF_ERROR&&!0===eb&&(N=eo.Z_OK,eb=!1),N!==eo.Z_STREAM_END&&N!==eo.Z_OK)return this.onEnd(N),this.ended=!0,!1;e_.next_out&&(0!==e_.avail_out&&N!==eo.Z_STREAM_END&&(0!==e_.avail_in||eu!==eo.Z_FINISH&&eu!==eo.Z_SYNC_FLUSH)||("string"===this.options.to?(ec=ei.utf8border(e_.output,e_.next_out),ef=e_.next_out-ec,ep=ei.buf2string(e_.output,ec),e_.next_out=ef,e_.avail_out=eg-ef,ef&&et.arraySet(e_.output,e_.output,ec,ef,0),this.onData(ep)):this.onData(et.shrinkBuf(e_.output,e_.next_out)))),0===e_.avail_in&&0===e_.avail_out&&(eb=!0)}while((0<e_.avail_in||0===e_.avail_out)&&N!==eo.Z_STREAM_END);return N===eo.Z_STREAM_END&&(eu=eo.Z_FINISH),eu===eo.Z_FINISH?(N=C.inflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===eo.Z_OK):eu!==eo.Z_SYNC_FLUSH||(this.onEnd(eo.Z_OK),e_.avail_out=0,!0)},_.prototype.onData=function(e){this.chunks.push(e)},_.prototype.onEnd=function(e){e===eo.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=et.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},N.Inflate=_,N.inflate=E,N.inflateRaw=function(e,n){return(n=n||{}).raw=!0,E(e,n)},N.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,N){var C="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Int32Array;N.assign=function(e){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var N=n.shift();if(N){if("object"!=typeof N)throw TypeError(N+"must be non-object");for(var C in N)N.hasOwnProperty(C)&&(e[C]=N[C])}}return e},N.shrinkBuf=function(e,n){return e.length===n?e:e.subarray?e.subarray(0,n):(e.length=n,e)};var et={arraySet:function(e,n,N,C,et){if(n.subarray&&e.subarray)e.set(n.subarray(N,N+C),et);else for(var ei=0;ei<C;ei++)e[et+ei]=n[N+ei]},flattenChunks:function(e){var n,N,C,et,ei,eo;for(n=C=0,N=e.length;n<N;n++)C+=e[n].length;for(eo=new Uint8Array(C),n=et=0,N=e.length;n<N;n++)ei=e[n],eo.set(ei,et),et+=ei.length;return eo}},ei={arraySet:function(e,n,N,C,et){for(var ei=0;ei<C;ei++)e[et+ei]=n[N+ei]},flattenChunks:function(e){return[].concat.apply([],e)}};N.setTyped=function(e){e?(N.Buf8=Uint8Array,N.Buf16=Uint16Array,N.Buf32=Int32Array,N.assign(N,et)):(N.Buf8=Array,N.Buf16=Array,N.Buf32=Array,N.assign(N,ei))},N.setTyped(C)},{}],42:[function(e,n,N){var C=e("./common"),et=!0,ei=!0;try{String.fromCharCode.apply(null,[0])}catch{et=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ei=!1}for(var eo=new C.Buf8(256),eu=0;eu<256;eu++)eo[eu]=252<=eu?6:248<=eu?5:240<=eu?4:224<=eu?3:192<=eu?2:1;function w(e,n){if(n<65537&&(e.subarray&&ei||!e.subarray&&et))return String.fromCharCode.apply(null,C.shrinkBuf(e,n));for(var N="",eo=0;eo<n;eo++)N+=String.fromCharCode(e[eo]);return N}eo[254]=eo[254]=1,N.string2buf=function(e){var n,N,et,ei,eo,eu=e.length,ec=0;for(ei=0;ei<eu;ei++)(64512&(N=e.charCodeAt(ei)))==55296&&ei+1<eu&&(64512&(et=e.charCodeAt(ei+1)))==56320&&(N=65536+(N-55296<<10)+(et-56320),ei++),ec+=N<128?1:N<2048?2:N<65536?3:4;for(n=new C.Buf8(ec),ei=eo=0;eo<ec;ei++)(64512&(N=e.charCodeAt(ei)))==55296&&ei+1<eu&&(64512&(et=e.charCodeAt(ei+1)))==56320&&(N=65536+(N-55296<<10)+(et-56320),ei++),N<128?n[eo++]=N:(N<2048?n[eo++]=192|N>>>6:(N<65536?n[eo++]=224|N>>>12:(n[eo++]=240|N>>>18,n[eo++]=128|N>>>12&63),n[eo++]=128|N>>>6&63),n[eo++]=128|63&N);return n},N.buf2binstring=function(e){return w(e,e.length)},N.binstring2buf=function(e){for(var n=new C.Buf8(e.length),N=0,et=n.length;N<et;N++)n[N]=e.charCodeAt(N);return n},N.buf2string=function(e,n){var N,C,et,ei,eu=n||e.length,ec=Array(2*eu);for(N=C=0;N<eu;)if((et=e[N++])<128)ec[C++]=et;else if(4<(ei=eo[et]))ec[C++]=65533,N+=ei-1;else{for(et&=2===ei?31:3===ei?15:7;1<ei&&N<eu;)et=et<<6|63&e[N++],ei--;1<ei?ec[C++]=65533:et<65536?ec[C++]=et:(et-=65536,ec[C++]=55296|et>>10&1023,ec[C++]=56320|1023&et)}return w(ec,C)},N.utf8border=function(e,n){var N;for((n=n||e.length)>e.length&&(n=e.length),N=n-1;0<=N&&(192&e[N])==128;)N--;return N<0||0===N?n:N+eo[e[N]]>n?N:n}},{"./common":41}],43:[function(e,n,N){n.exports=function(e,n,N,C){for(var et=65535&e|0,ei=e>>>16&65535|0,eo=0;0!==N;){for(N-=eo=2e3<N?2e3:N;ei=ei+(et=et+n[C++]|0)|0,--eo;);et%=65521,ei%=65521}return et|ei<<16|0}},{}],44:[function(e,n,N){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,N){var C=function(){for(var e,n=[],N=0;N<256;N++){e=N;for(var C=0;C<8;C++)e=1&e?3988292384^e>>>1:e>>>1;n[N]=e}return n}();n.exports=function(e,n,N,et){var ei=et+N;e^=-1;for(var eo=et;eo<ei;eo++)e=e>>>8^C[255&(e^n[eo])];return -1^e}},{}],46:[function(e,n,N){var C,et=e("../utils/common"),ei=e("./trees"),eo=e("./adler32"),eu=e("./crc32"),ec=e("./messages");function me(e,n){return e.msg=ec[n],n}function ve(e){return(e<<1)-(4<e?9:0)}function K(e){for(var n=e.length;0<=--n;)e[n]=0}function I(e){var n=e.state,N=n.pending;N>e.avail_out&&(N=e.avail_out),0!==N&&(et.arraySet(e.output,n.pending_buf,n.pending_out,N,e.next_out),e.next_out+=N,n.pending_out+=N,e.total_out+=N,e.avail_out-=N,n.pending-=N,0===n.pending&&(n.pending_out=0))}function B(e,n){ei._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,I(e.strm)}function ye(e,n){e.pending_buf[e.pending++]=n}function be(e,n){e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=255&n}function Ue(e,n){var N,C,et=e.max_chain_length,ei=e.strstart,eo=e.prev_length,eu=e.nice_match,ec=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,ef=e.window,eh=e.w_mask,ep=e.prev,ed=e.strstart+258,e_=ef[ei+eo-1],eg=ef[ei+eo];e.prev_length>=e.good_match&&(et>>=2),eu>e.lookahead&&(eu=e.lookahead);do if(ef[(N=n)+eo]===eg&&ef[N+eo-1]===e_&&ef[N]===ef[ei]&&ef[++N]===ef[ei+1]){ei+=2,N++;do;while(ef[++ei]===ef[++N]&&ef[++ei]===ef[++N]&&ef[++ei]===ef[++N]&&ef[++ei]===ef[++N]&&ef[++ei]===ef[++N]&&ef[++ei]===ef[++N]&&ef[++ei]===ef[++N]&&ef[++ei]===ef[++N]&&ei<ed);if(C=258-(ed-ei),ei=ed-258,eo<C){if(e.match_start=n,eu<=(eo=C))break;e_=ef[ei+eo-1],eg=ef[ei+eo]}}while((n=ep[n&eh])>ec&&0!=--et);return eo<=e.lookahead?eo:e.lookahead}function Xe(e){var n,N,C,ei,ec,ef,eh,ep,ed,e_,eg=e.w_size;do{if(ei=e.window_size-e.lookahead-e.strstart,e.strstart>=eg+(eg-262)){for(et.arraySet(e.window,e.window,eg,eg,0),e.match_start-=eg,e.strstart-=eg,e.block_start-=eg,n=N=e.hash_size;C=e.head[--n],e.head[n]=eg<=C?C-eg:0,--N;);for(n=N=eg;C=e.prev[--n],e.prev[n]=eg<=C?C-eg:0,--N;);ei+=eg}if(0===e.strm.avail_in)break;if(ef=e.strm,eh=e.window,ep=e.strstart+e.lookahead,e_=void 0,(ed=ei)<(e_=ef.avail_in)&&(e_=ed),N=0===e_?0:(ef.avail_in-=e_,et.arraySet(eh,ef.input,ef.next_in,e_,ep),1===ef.state.wrap?ef.adler=eo(ef.adler,eh,e_,ep):2===ef.state.wrap&&(ef.adler=eu(ef.adler,eh,e_,ep)),ef.next_in+=e_,ef.total_in+=e_,e_),e.lookahead+=N,e.lookahead+e.insert>=3)for(ec=e.strstart-e.insert,e.ins_h=e.window[ec],e.ins_h=(e.ins_h<<e.hash_shift^e.window[ec+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[ec+3-1])&e.hash_mask,e.prev[ec&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=ec,ec++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function st(e,n){for(var N,C;;){if(e.lookahead<262){if(Xe(e),e.lookahead<262&&0===n)return 1;if(0===e.lookahead)break}if(N=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==N&&e.strstart-N<=e.w_size-262&&(e.match_length=Ue(e,N)),e.match_length>=3){if(C=ei._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask}else C=ei._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(C&&(B(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===n?(B(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?1:2}function Ze(e,n){for(var N,C,et;;){if(e.lookahead<262){if(Xe(e),e.lookahead<262&&0===n)return 1;if(0===e.lookahead)break}if(N=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==N&&e.prev_length<e.max_lazy_match&&e.strstart-N<=e.w_size-262&&(e.match_length=Ue(e,N),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(et=e.strstart+e.lookahead-3,C=ei._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=et&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,C&&(B(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((C=ei._tr_tally(e,0,e.window[e.strstart-1]))&&B(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(C=ei._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===n?(B(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?1:2}function ae(e,n,N,C,et){this.good_length=e,this.max_lazy=n,this.nice_length=N,this.max_chain=C,this.func=et}function le(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new et.Buf16(1146),this.dyn_dtree=new et.Buf16(122),this.bl_tree=new et.Buf16(78),K(this.dyn_ltree),K(this.dyn_dtree),K(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new et.Buf16(16),this.heap=new et.Buf16(573),K(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new et.Buf16(573),K(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Pe(e){var n;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(n=e.state).pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?42:113,e.adler=2===n.wrap?0:1,n.last_flush=0,ei._tr_init(n),0):me(e,-2)}function xe(e){var n,N=Pe(e);return 0===N&&((n=e.state).window_size=2*n.w_size,K(n.head),n.max_lazy_match=C[n.level].max_lazy,n.good_match=C[n.level].good_length,n.nice_match=C[n.level].nice_length,n.max_chain_length=C[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),N}function ze(e,n,N,C,ei,eo){if(!e)return -2;var eu=1;if(-1===n&&(n=6),C<0?(eu=0,C=-C):15<C&&(eu=2,C-=16),ei<1||9<ei||8!==N||C<8||15<C||n<0||9<n||eo<0||4<eo)return me(e,-2);8===C&&(C=9);var ec=new le;return(e.state=ec).strm=e,ec.wrap=eu,ec.gzhead=null,ec.w_bits=C,ec.w_size=1<<ec.w_bits,ec.w_mask=ec.w_size-1,ec.hash_bits=ei+7,ec.hash_size=1<<ec.hash_bits,ec.hash_mask=ec.hash_size-1,ec.hash_shift=~~((ec.hash_bits+3-1)/3),ec.window=new et.Buf8(2*ec.w_size),ec.head=new et.Buf16(ec.hash_size),ec.prev=new et.Buf16(ec.w_size),ec.lit_bufsize=1<<ei+6,ec.pending_buf_size=4*ec.lit_bufsize,ec.pending_buf=new et.Buf8(ec.pending_buf_size),ec.d_buf=1*ec.lit_bufsize,ec.l_buf=3*ec.lit_bufsize,ec.level=n,ec.strategy=eo,ec.method=N,xe(e)}C=[new ae(0,0,0,0,function(e,n){var N=65535;for(65535>e.pending_buf_size-5&&(N=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Xe(e),0===e.lookahead&&0===n)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var C=e.block_start+N;if((0===e.strstart||e.strstart>=C)&&(e.lookahead=e.strstart-C,e.strstart=C,B(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-262&&(B(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===n?(B(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(B(e,!1),e.strm.avail_out),1)}),new ae(4,4,8,4,st),new ae(4,5,16,8,st),new ae(4,6,32,32,st),new ae(4,4,16,16,Ze),new ae(8,16,32,32,Ze),new ae(8,16,128,128,Ze),new ae(8,32,128,256,Ze),new ae(32,128,258,1024,Ze),new ae(32,258,258,4096,Ze)],N.deflateInit=function(e,n){return ze(e,n,8,15,8,0)},N.deflateInit2=ze,N.deflateReset=xe,N.deflateResetKeep=Pe,N.deflateSetHeader=function(e,n){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=n,0):-2},N.deflate=function(e,n){var N,et,eo,ec;if(!e||!e.state||5<n||n<0)return e?me(e,-2):-2;if(et=e.state,!e.output||!e.input&&0!==e.avail_in||666===et.status&&4!==n)return me(e,0===e.avail_out?-5:-2);if(et.strm=e,N=et.last_flush,et.last_flush=n,42===et.status){if(2===et.wrap)e.adler=0,ye(et,31),ye(et,139),ye(et,8),et.gzhead?(ye(et,(et.gzhead.text?1:0)+(et.gzhead.hcrc?2:0)+(et.gzhead.extra?4:0)+(et.gzhead.name?8:0)+(et.gzhead.comment?16:0)),ye(et,255&et.gzhead.time),ye(et,et.gzhead.time>>8&255),ye(et,et.gzhead.time>>16&255),ye(et,et.gzhead.time>>24&255),ye(et,9===et.level?2:2<=et.strategy||et.level<2?4:0),ye(et,255&et.gzhead.os),et.gzhead.extra&&et.gzhead.extra.length&&(ye(et,255&et.gzhead.extra.length),ye(et,et.gzhead.extra.length>>8&255)),et.gzhead.hcrc&&(e.adler=eu(e.adler,et.pending_buf,et.pending,0)),et.gzindex=0,et.status=69):(ye(et,0),ye(et,0),ye(et,0),ye(et,0),ye(et,0),ye(et,9===et.level?2:2<=et.strategy||et.level<2?4:0),ye(et,3),et.status=113);else{var ef=8+(et.w_bits-8<<4)<<8;ef|=(2<=et.strategy||et.level<2?0:et.level<6?1:6===et.level?2:3)<<6,0!==et.strstart&&(ef|=32),ef+=31-ef%31,et.status=113,be(et,ef),0!==et.strstart&&(be(et,e.adler>>>16),be(et,65535&e.adler)),e.adler=1}}if(69===et.status){if(et.gzhead.extra){for(eo=et.pending;et.gzindex<(65535&et.gzhead.extra.length)&&(et.pending!==et.pending_buf_size||(et.gzhead.hcrc&&et.pending>eo&&(e.adler=eu(e.adler,et.pending_buf,et.pending-eo,eo)),I(e),eo=et.pending,et.pending!==et.pending_buf_size));)ye(et,255&et.gzhead.extra[et.gzindex]),et.gzindex++;et.gzhead.hcrc&&et.pending>eo&&(e.adler=eu(e.adler,et.pending_buf,et.pending-eo,eo)),et.gzindex===et.gzhead.extra.length&&(et.gzindex=0,et.status=73)}else et.status=73}if(73===et.status){if(et.gzhead.name){eo=et.pending;do{if(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>eo&&(e.adler=eu(e.adler,et.pending_buf,et.pending-eo,eo)),I(e),eo=et.pending,et.pending===et.pending_buf_size)){ec=1;break}ec=et.gzindex<et.gzhead.name.length?255&et.gzhead.name.charCodeAt(et.gzindex++):0,ye(et,ec)}while(0!==ec);et.gzhead.hcrc&&et.pending>eo&&(e.adler=eu(e.adler,et.pending_buf,et.pending-eo,eo)),0===ec&&(et.gzindex=0,et.status=91)}else et.status=91}if(91===et.status){if(et.gzhead.comment){eo=et.pending;do{if(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>eo&&(e.adler=eu(e.adler,et.pending_buf,et.pending-eo,eo)),I(e),eo=et.pending,et.pending===et.pending_buf_size)){ec=1;break}ec=et.gzindex<et.gzhead.comment.length?255&et.gzhead.comment.charCodeAt(et.gzindex++):0,ye(et,ec)}while(0!==ec);et.gzhead.hcrc&&et.pending>eo&&(e.adler=eu(e.adler,et.pending_buf,et.pending-eo,eo)),0===ec&&(et.status=103)}else et.status=103}if(103===et.status&&(et.gzhead.hcrc?(et.pending+2>et.pending_buf_size&&I(e),et.pending+2<=et.pending_buf_size&&(ye(et,255&e.adler),ye(et,e.adler>>8&255),e.adler=0,et.status=113)):et.status=113),0!==et.pending){if(I(e),0===e.avail_out)return et.last_flush=-1,0}else if(0===e.avail_in&&ve(n)<=ve(N)&&4!==n)return me(e,-5);if(666===et.status&&0!==e.avail_in)return me(e,-5);if(0!==e.avail_in||0!==et.lookahead||0!==n&&666!==et.status){var eh=2===et.strategy?function(e,n){for(var N;;){if(0===e.lookahead&&(Xe(e),0===e.lookahead)){if(0===n)return 1;break}if(e.match_length=0,N=ei._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,N&&(B(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===n?(B(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?1:2}(et,n):3===et.strategy?function(e,n){for(var N,C,et,eo,eu=e.window;;){if(e.lookahead<=258){if(Xe(e),e.lookahead<=258&&0===n)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(C=eu[et=e.strstart-1])===eu[++et]&&C===eu[++et]&&C===eu[++et]){eo=e.strstart+258;do;while(C===eu[++et]&&C===eu[++et]&&C===eu[++et]&&C===eu[++et]&&C===eu[++et]&&C===eu[++et]&&C===eu[++et]&&C===eu[++et]&&et<eo);e.match_length=258-(eo-et),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(N=ei._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(N=ei._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),N&&(B(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===n?(B(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?1:2}(et,n):C[et.level].func(et,n);if(3!==eh&&4!==eh||(et.status=666),1===eh||3===eh)return 0===e.avail_out&&(et.last_flush=-1),0;if(2===eh&&(1===n?ei._tr_align(et):5!==n&&(ei._tr_stored_block(et,0,0,!1),3===n&&(K(et.head),0===et.lookahead&&(et.strstart=0,et.block_start=0,et.insert=0))),I(e),0===e.avail_out))return et.last_flush=-1,0}return 4!==n?0:et.wrap<=0?1:(2===et.wrap?(ye(et,255&e.adler),ye(et,e.adler>>8&255),ye(et,e.adler>>16&255),ye(et,e.adler>>24&255),ye(et,255&e.total_in),ye(et,e.total_in>>8&255),ye(et,e.total_in>>16&255),ye(et,e.total_in>>24&255)):(be(et,e.adler>>>16),be(et,65535&e.adler)),I(e),0<et.wrap&&(et.wrap=-et.wrap),0!==et.pending?0:1)},N.deflateEnd=function(e){var n;return e&&e.state?42!==(n=e.state.status)&&69!==n&&73!==n&&91!==n&&103!==n&&113!==n&&666!==n?me(e,-2):(e.state=null,113===n?me(e,-3):0):-2},N.deflateSetDictionary=function(e,n){var N,C,ei,eu,ec,ef,eh,ep,ed=n.length;if(!e||!e.state||2===(eu=(N=e.state).wrap)||1===eu&&42!==N.status||N.lookahead)return -2;for(1===eu&&(e.adler=eo(e.adler,n,ed,0)),N.wrap=0,ed>=N.w_size&&(0===eu&&(K(N.head),N.strstart=0,N.block_start=0,N.insert=0),ep=new et.Buf8(N.w_size),et.arraySet(ep,n,ed-N.w_size,N.w_size,0),n=ep,ed=N.w_size),ec=e.avail_in,ef=e.next_in,eh=e.input,e.avail_in=ed,e.next_in=0,e.input=n,Xe(N);N.lookahead>=3;){for(C=N.strstart,ei=N.lookahead-2;N.ins_h=(N.ins_h<<N.hash_shift^N.window[C+3-1])&N.hash_mask,N.prev[C&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=C,C++,--ei;);N.strstart=C,N.lookahead=2,Xe(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=2,N.match_available=0,e.next_in=ef,e.input=eh,e.avail_in=ec,N.wrap=eu,0},N.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,N){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,N){n.exports=function(e,n){var N,C,et,ei,eo,eu,ec,ef,eh,ep,ed,e_,eg,em,eb,ey,ev,ek,eA,eL,ex,ew,eT,eO,eE;N=e.state,C=e.next_in,eO=e.input,et=C+(e.avail_in-5),ei=e.next_out,eE=e.output,eo=ei-(n-e.avail_out),eu=ei+(e.avail_out-257),ec=N.dmax,ef=N.wsize,eh=N.whave,ep=N.wnext,ed=N.window,e_=N.hold,eg=N.bits,em=N.lencode,eb=N.distcode,ey=(1<<N.lenbits)-1,ev=(1<<N.distbits)-1;e:do for(eg<15&&(e_+=eO[C++]<<eg,eg+=8,e_+=eO[C++]<<eg,eg+=8),ek=em[e_&ey];;){if(e_>>>=eA=ek>>>24,eg-=eA,0==(eA=ek>>>16&255))eE[ei++]=65535&ek;else{if(!(16&eA)){if(!(64&eA)){ek=em[(65535&ek)+(e_&(1<<eA)-1)];continue}if(32&eA){N.mode=12;break e}e.msg="invalid literal/length code",N.mode=30;break e}for(eL=65535&ek,(eA&=15)&&(eg<eA&&(e_+=eO[C++]<<eg,eg+=8),eL+=e_&(1<<eA)-1,e_>>>=eA,eg-=eA),eg<15&&(e_+=eO[C++]<<eg,eg+=8,e_+=eO[C++]<<eg,eg+=8),ek=eb[e_&ev];;){if(e_>>>=eA=ek>>>24,eg-=eA,!(16&(eA=ek>>>16&255))){if(!(64&eA)){ek=eb[(65535&ek)+(e_&(1<<eA)-1)];continue}e.msg="invalid distance code",N.mode=30;break e}if(ex=65535&ek,eg<(eA&=15)&&(e_+=eO[C++]<<eg,(eg+=8)<eA&&(e_+=eO[C++]<<eg,eg+=8)),ec<(ex+=e_&(1<<eA)-1)){e.msg="invalid distance too far back",N.mode=30;break e}if(e_>>>=eA,eg-=eA,(eA=ei-eo)<ex){if(eh<(eA=ex-eA)&&N.sane){e.msg="invalid distance too far back",N.mode=30;break e}if(eT=ed,(ew=0)===ep){if(ew+=ef-eA,eA<eL){for(eL-=eA;eE[ei++]=ed[ew++],--eA;);ew=ei-ex,eT=eE}}else if(ep<eA){if(ew+=ef+ep-eA,(eA-=ep)<eL){for(eL-=eA;eE[ei++]=ed[ew++],--eA;);if(ew=0,ep<eL){for(eL-=eA=ep;eE[ei++]=ed[ew++],--eA;);ew=ei-ex,eT=eE}}}else if(ew+=ep-eA,eA<eL){for(eL-=eA;eE[ei++]=ed[ew++],--eA;);ew=ei-ex,eT=eE}for(;2<eL;)eE[ei++]=eT[ew++],eE[ei++]=eT[ew++],eE[ei++]=eT[ew++],eL-=3;eL&&(eE[ei++]=eT[ew++],1<eL&&(eE[ei++]=eT[ew++]))}else{for(ew=ei-ex;eE[ei++]=eE[ew++],eE[ei++]=eE[ew++],eE[ei++]=eE[ew++],2<(eL-=3););eL&&(eE[ei++]=eE[ew++],1<eL&&(eE[ei++]=eE[ew++]))}break}}break}while(C<et&&ei<eu);C-=eL=eg>>3,e_&=(1<<(eg-=eL<<3))-1,e.next_in=C,e.next_out=ei,e.avail_in=C<et?et-C+5:5-(C-et),e.avail_out=ei<eu?eu-ei+257:257-(ei-eu),N.hold=e_,N.bits=eg}},{}],49:[function(e,n,N){var C=e("../utils/common"),et=e("./adler32"),ei=e("./crc32"),eo=e("./inffast"),eu=e("./inftrees");function b(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new C.Buf16(320),this.work=new C.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function M(e){var n;return e&&e.state?(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new C.Buf32(852),n.distcode=n.distdyn=new C.Buf32(592),n.sane=1,n.back=-1,0):-2}function H(e){var n;return e&&e.state?((n=e.state).wsize=0,n.whave=0,n.wnext=0,M(e)):-2}function z(e,n){var N,C;return e&&e.state?(C=e.state,n<0?(N=0,n=-n):(N=1+(n>>4),n<48&&(n&=15)),n&&(n<8||15<n)?-2:(null!==C.window&&C.wbits!==n&&(C.window=null),C.wrap=N,C.wbits=n,H(e))):-2}function W(e,n){var N,C;return e?(C=new R,(e.state=C).window=null,0!==(N=z(e,n))&&(e.state=null),N):-2}var ec,ef,eh=!0;function he(e,n,N,et){var ei,eo=e.state;return null===eo.window&&(eo.wsize=1<<eo.wbits,eo.wnext=0,eo.whave=0,eo.window=new C.Buf8(eo.wsize)),et>=eo.wsize?(C.arraySet(eo.window,n,N-eo.wsize,eo.wsize,0),eo.wnext=0,eo.whave=eo.wsize):(et<(ei=eo.wsize-eo.wnext)&&(ei=et),C.arraySet(eo.window,n,N-et,ei,eo.wnext),(et-=ei)?(C.arraySet(eo.window,n,N-et,et,0),eo.wnext=et,eo.whave=eo.wsize):(eo.wnext+=ei,eo.wnext===eo.wsize&&(eo.wnext=0),eo.whave<eo.wsize&&(eo.whave+=ei))),0}N.inflateReset=H,N.inflateReset2=z,N.inflateResetKeep=M,N.inflateInit=function(e){return W(e,15)},N.inflateInit2=W,N.inflate=function(e,n){var N,ep,ed,e_,eg,em,eb,ey,ev,ek,eA,eL,ex,ew,eT,eO,eE,eS,eN,eI,eR,eU,eC,eM,eP=0,eD=new C.Buf8(4),eB=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return -2;12===(N=e.state).mode&&(N.mode=13),eg=e.next_out,ed=e.output,eb=e.avail_out,e_=e.next_in,ep=e.input,em=e.avail_in,ey=N.hold,ev=N.bits,ek=em,eA=eb,eU=0;e:for(;;)switch(N.mode){case 1:if(0===N.wrap){N.mode=13;break}for(;ev<16;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(2&N.wrap&&35615===ey){eD[N.check=0]=255&ey,eD[1]=ey>>>8&255,N.check=ei(N.check,eD,2,0),ev=ey=0,N.mode=2;break}if(N.flags=0,N.head&&(N.head.done=!1),!(1&N.wrap)||(((255&ey)<<8)+(ey>>8))%31){e.msg="incorrect header check",N.mode=30;break}if((15&ey)!=8){e.msg="unknown compression method",N.mode=30;break}if(ev-=4,eR=8+(15&(ey>>>=4)),0===N.wbits)N.wbits=eR;else if(eR>N.wbits){e.msg="invalid window size",N.mode=30;break}N.dmax=1<<eR,e.adler=N.check=1,N.mode=512&ey?10:12,ev=ey=0;break;case 2:for(;ev<16;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(N.flags=ey,(255&N.flags)!=8){e.msg="unknown compression method",N.mode=30;break}if(57344&N.flags){e.msg="unknown header flags set",N.mode=30;break}N.head&&(N.head.text=ey>>8&1),512&N.flags&&(eD[0]=255&ey,eD[1]=ey>>>8&255,N.check=ei(N.check,eD,2,0)),ev=ey=0,N.mode=3;case 3:for(;ev<32;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}N.head&&(N.head.time=ey),512&N.flags&&(eD[0]=255&ey,eD[1]=ey>>>8&255,eD[2]=ey>>>16&255,eD[3]=ey>>>24&255,N.check=ei(N.check,eD,4,0)),ev=ey=0,N.mode=4;case 4:for(;ev<16;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}N.head&&(N.head.xflags=255&ey,N.head.os=ey>>8),512&N.flags&&(eD[0]=255&ey,eD[1]=ey>>>8&255,N.check=ei(N.check,eD,2,0)),ev=ey=0,N.mode=5;case 5:if(1024&N.flags){for(;ev<16;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}N.length=ey,N.head&&(N.head.extra_len=ey),512&N.flags&&(eD[0]=255&ey,eD[1]=ey>>>8&255,N.check=ei(N.check,eD,2,0)),ev=ey=0}else N.head&&(N.head.extra=null);N.mode=6;case 6:if(1024&N.flags&&(em<(eL=N.length)&&(eL=em),eL&&(N.head&&(eR=N.head.extra_len-N.length,N.head.extra||(N.head.extra=Array(N.head.extra_len)),C.arraySet(N.head.extra,ep,e_,eL,eR)),512&N.flags&&(N.check=ei(N.check,ep,eL,e_)),em-=eL,e_+=eL,N.length-=eL),N.length))break e;N.length=0,N.mode=7;case 7:if(2048&N.flags){if(0===em)break e;for(eL=0;eR=ep[e_+eL++],N.head&&eR&&N.length<65536&&(N.head.name+=String.fromCharCode(eR)),eR&&eL<em;);if(512&N.flags&&(N.check=ei(N.check,ep,eL,e_)),em-=eL,e_+=eL,eR)break e}else N.head&&(N.head.name=null);N.length=0,N.mode=8;case 8:if(4096&N.flags){if(0===em)break e;for(eL=0;eR=ep[e_+eL++],N.head&&eR&&N.length<65536&&(N.head.comment+=String.fromCharCode(eR)),eR&&eL<em;);if(512&N.flags&&(N.check=ei(N.check,ep,eL,e_)),em-=eL,e_+=eL,eR)break e}else N.head&&(N.head.comment=null);N.mode=9;case 9:if(512&N.flags){for(;ev<16;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(ey!==(65535&N.check)){e.msg="header crc mismatch",N.mode=30;break}ev=ey=0}N.head&&(N.head.hcrc=N.flags>>9&1,N.head.done=!0),e.adler=N.check=0,N.mode=12;break;case 10:for(;ev<32;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}e.adler=N.check=b(ey),ev=ey=0,N.mode=11;case 11:if(0===N.havedict)return e.next_out=eg,e.avail_out=eb,e.next_in=e_,e.avail_in=em,N.hold=ey,N.bits=ev,2;e.adler=N.check=1,N.mode=12;case 12:if(5===n||6===n)break e;case 13:if(N.last){ey>>>=7&ev,ev-=7&ev,N.mode=27;break}for(;ev<3;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}switch(N.last=1&ey,ev-=1,3&(ey>>>=1)){case 0:N.mode=14;break;case 1:if(function(e){if(eh){var n;for(ec=new C.Buf32(512),ef=new C.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(eu(1,e.lens,0,288,ec,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;eu(2,e.lens,0,32,ef,0,e.work,{bits:5}),eh=!1}e.lencode=ec,e.lenbits=9,e.distcode=ef,e.distbits=5}(N),N.mode=20,6!==n)break;ey>>>=2,ev-=2;break e;case 2:N.mode=17;break;case 3:e.msg="invalid block type",N.mode=30}ey>>>=2,ev-=2;break;case 14:for(ey>>>=7&ev,ev-=7&ev;ev<32;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if((65535&ey)!=(ey>>>16^65535)){e.msg="invalid stored block lengths",N.mode=30;break}if(N.length=65535&ey,ev=ey=0,N.mode=15,6===n)break e;case 15:N.mode=16;case 16:if(eL=N.length){if(em<eL&&(eL=em),eb<eL&&(eL=eb),0===eL)break e;C.arraySet(ed,ep,e_,eL,eg),em-=eL,e_+=eL,eb-=eL,eg+=eL,N.length-=eL;break}N.mode=12;break;case 17:for(;ev<14;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(N.nlen=257+(31&ey),ey>>>=5,ev-=5,N.ndist=1+(31&ey),ey>>>=5,ev-=5,N.ncode=4+(15&ey),ey>>>=4,ev-=4,286<N.nlen||30<N.ndist){e.msg="too many length or distance symbols",N.mode=30;break}N.have=0,N.mode=18;case 18:for(;N.have<N.ncode;){for(;ev<3;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}N.lens[eB[N.have++]]=7&ey,ey>>>=3,ev-=3}for(;N.have<19;)N.lens[eB[N.have++]]=0;if(N.lencode=N.lendyn,N.lenbits=7,eC={bits:N.lenbits},eU=eu(0,N.lens,0,19,N.lencode,0,N.work,eC),N.lenbits=eC.bits,eU){e.msg="invalid code lengths set",N.mode=30;break}N.have=0,N.mode=19;case 19:for(;N.have<N.nlen+N.ndist;){for(;eO=(eP=N.lencode[ey&(1<<N.lenbits)-1])>>>16&255,eE=65535&eP,!((eT=eP>>>24)<=ev);){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(eE<16)ey>>>=eT,ev-=eT,N.lens[N.have++]=eE;else{if(16===eE){for(eM=eT+2;ev<eM;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(ey>>>=eT,ev-=eT,0===N.have){e.msg="invalid bit length repeat",N.mode=30;break}eR=N.lens[N.have-1],eL=3+(3&ey),ey>>>=2,ev-=2}else if(17===eE){for(eM=eT+3;ev<eM;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}ev-=eT,eR=0,eL=3+(7&(ey>>>=eT)),ey>>>=3,ev-=3}else{for(eM=eT+7;ev<eM;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}ev-=eT,eR=0,eL=11+(127&(ey>>>=eT)),ey>>>=7,ev-=7}if(N.have+eL>N.nlen+N.ndist){e.msg="invalid bit length repeat",N.mode=30;break}for(;eL--;)N.lens[N.have++]=eR}}if(30===N.mode)break;if(0===N.lens[256]){e.msg="invalid code -- missing end-of-block",N.mode=30;break}if(N.lenbits=9,eC={bits:N.lenbits},eU=eu(1,N.lens,0,N.nlen,N.lencode,0,N.work,eC),N.lenbits=eC.bits,eU){e.msg="invalid literal/lengths set",N.mode=30;break}if(N.distbits=6,N.distcode=N.distdyn,eC={bits:N.distbits},eU=eu(2,N.lens,N.nlen,N.ndist,N.distcode,0,N.work,eC),N.distbits=eC.bits,eU){e.msg="invalid distances set",N.mode=30;break}if(N.mode=20,6===n)break e;case 20:N.mode=21;case 21:if(6<=em&&258<=eb){e.next_out=eg,e.avail_out=eb,e.next_in=e_,e.avail_in=em,N.hold=ey,N.bits=ev,eo(e,eA),eg=e.next_out,ed=e.output,eb=e.avail_out,e_=e.next_in,ep=e.input,em=e.avail_in,ey=N.hold,ev=N.bits,12===N.mode&&(N.back=-1);break}for(N.back=0;eO=(eP=N.lencode[ey&(1<<N.lenbits)-1])>>>16&255,eE=65535&eP,!((eT=eP>>>24)<=ev);){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(eO&&!(240&eO)){for(eS=eT,eN=eO,eI=eE;eO=(eP=N.lencode[eI+((ey&(1<<eS+eN)-1)>>eS)])>>>16&255,eE=65535&eP,!(eS+(eT=eP>>>24)<=ev);){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}ey>>>=eS,ev-=eS,N.back+=eS}if(ey>>>=eT,ev-=eT,N.back+=eT,N.length=eE,0===eO){N.mode=26;break}if(32&eO){N.back=-1,N.mode=12;break}if(64&eO){e.msg="invalid literal/length code",N.mode=30;break}N.extra=15&eO,N.mode=22;case 22:if(N.extra){for(eM=N.extra;ev<eM;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}N.length+=ey&(1<<N.extra)-1,ey>>>=N.extra,ev-=N.extra,N.back+=N.extra}N.was=N.length,N.mode=23;case 23:for(;eO=(eP=N.distcode[ey&(1<<N.distbits)-1])>>>16&255,eE=65535&eP,!((eT=eP>>>24)<=ev);){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(!(240&eO)){for(eS=eT,eN=eO,eI=eE;eO=(eP=N.distcode[eI+((ey&(1<<eS+eN)-1)>>eS)])>>>16&255,eE=65535&eP,!(eS+(eT=eP>>>24)<=ev);){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}ey>>>=eS,ev-=eS,N.back+=eS}if(ey>>>=eT,ev-=eT,N.back+=eT,64&eO){e.msg="invalid distance code",N.mode=30;break}N.offset=eE,N.extra=15&eO,N.mode=24;case 24:if(N.extra){for(eM=N.extra;ev<eM;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}N.offset+=ey&(1<<N.extra)-1,ey>>>=N.extra,ev-=N.extra,N.back+=N.extra}if(N.offset>N.dmax){e.msg="invalid distance too far back",N.mode=30;break}N.mode=25;case 25:if(0===eb)break e;if(eL=eA-eb,N.offset>eL){if((eL=N.offset-eL)>N.whave&&N.sane){e.msg="invalid distance too far back",N.mode=30;break}ex=eL>N.wnext?(eL-=N.wnext,N.wsize-eL):N.wnext-eL,eL>N.length&&(eL=N.length),ew=N.window}else ew=ed,ex=eg-N.offset,eL=N.length;for(eb<eL&&(eL=eb),eb-=eL,N.length-=eL;ed[eg++]=ew[ex++],--eL;);0===N.length&&(N.mode=21);break;case 26:if(0===eb)break e;ed[eg++]=N.length,eb--,N.mode=21;break;case 27:if(N.wrap){for(;ev<32;){if(0===em)break e;em--,ey|=ep[e_++]<<ev,ev+=8}if(eA-=eb,e.total_out+=eA,N.total+=eA,eA&&(e.adler=N.check=N.flags?ei(N.check,ed,eA,eg-eA):et(N.check,ed,eA,eg-eA)),eA=eb,(N.flags?ey:b(ey))!==N.check){e.msg="incorrect data check",N.mode=30;break}ev=ey=0}N.mode=28;case 28:if(N.wrap&&N.flags){for(;ev<32;){if(0===em)break e;em--,ey+=ep[e_++]<<ev,ev+=8}if(ey!==(4294967295&N.total)){e.msg="incorrect length check",N.mode=30;break}ev=ey=0}N.mode=29;case 29:eU=1;break e;case 30:eU=-3;break e;case 31:return -4;default:return -2}return e.next_out=eg,e.avail_out=eb,e.next_in=e_,e.avail_in=em,N.hold=ey,N.bits=ev,(N.wsize||eA!==e.avail_out&&N.mode<30&&(N.mode<27||4!==n))&&he(e,e.output,e.next_out,eA-e.avail_out)?(N.mode=31,-4):(ek-=e.avail_in,eA-=e.avail_out,e.total_in+=ek,e.total_out+=eA,N.total+=eA,N.wrap&&eA&&(e.adler=N.check=N.flags?ei(N.check,ed,eA,e.next_out-eA):et(N.check,ed,eA,e.next_out-eA)),e.data_type=N.bits+(N.last?64:0)+(12===N.mode?128:0)+(20===N.mode||15===N.mode?256:0),(0==ek&&0===eA||4===n)&&0===eU&&(eU=-5),eU)},N.inflateEnd=function(e){if(!e||!e.state)return -2;var n=e.state;return n.window&&(n.window=null),e.state=null,0},N.inflateGetHeader=function(e,n){var N;return e&&e.state&&2&(N=e.state).wrap?((N.head=n).done=!1,0):-2},N.inflateSetDictionary=function(e,n){var N,C=n.length;return e&&e.state?0!==(N=e.state).wrap&&11!==N.mode?-2:11===N.mode&&et(1,n,C,0)!==N.check?-3:he(e,n,C,C)?(N.mode=31,-4):(N.havedict=1,0):-2},N.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,N){var C=e("../utils/common"),et=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ei=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],eo=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],eu=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(e,n,N,ec,ef,eh,ep,ed){var e_,eg,em,eb,ey,ev,ek,eA,eL,ex=ed.bits,ew=0,eT=0,eO=0,eE=0,eS=0,eN=0,eI=0,eR=0,eU=0,eC=0,eM=null,eP=0,eD=new C.Buf16(16),eB=new C.Buf16(16),eK=null,eF=0;for(ew=0;ew<=15;ew++)eD[ew]=0;for(eT=0;eT<ec;eT++)eD[n[N+eT]]++;for(eS=ex,eE=15;1<=eE&&0===eD[eE];eE--);if(eE<eS&&(eS=eE),0===eE)return ef[eh++]=20971520,ef[eh++]=20971520,ed.bits=1,0;for(eO=1;eO<eE&&0===eD[eO];eO++);for(eS<eO&&(eS=eO),ew=eR=1;ew<=15;ew++)if(eR<<=1,(eR-=eD[ew])<0)return -1;if(0<eR&&(0===e||1!==eE))return -1;for(eB[1]=0,ew=1;ew<15;ew++)eB[ew+1]=eB[ew]+eD[ew];for(eT=0;eT<ec;eT++)0!==n[N+eT]&&(ep[eB[n[N+eT]]++]=eT);if(ev=0===e?(eM=eK=ep,19):1===e?(eM=et,eP-=257,eK=ei,eF-=257,256):(eM=eo,eK=eu,-1),ew=eO,ey=eh,eI=eT=eC=0,em=-1,eb=(eU=1<<(eN=eS))-1,1===e&&852<eU||2===e&&592<eU)return 1;for(;;){for(ek=ew-eI,eL=ep[eT]<ev?(eA=0,ep[eT]):ep[eT]>ev?(eA=eK[eF+ep[eT]],eM[eP+ep[eT]]):(eA=96,0),e_=1<<ew-eI,eO=eg=1<<eN;ef[ey+(eC>>eI)+(eg-=e_)]=ek<<24|eA<<16|eL|0,0!==eg;);for(e_=1<<ew-1;eC&e_;)e_>>=1;if(0!==e_?(eC&=e_-1,eC+=e_):eC=0,eT++,0==--eD[ew]){if(ew===eE)break;ew=n[N+ep[eT]]}if(eS<ew&&(eC&eb)!==em){for(0===eI&&(eI=eS),ey+=eO,eR=1<<(eN=ew-eI);eN+eI<eE&&!((eR-=eD[eN+eI])<=0);)eN++,eR<<=1;if(eU+=1<<eN,1===e&&852<eU||2===e&&592<eU)return 1;ef[em=eC&eb]=eS<<24|eN<<16|ey-eh|0}}return 0!==eC&&(ef[ey+eC]=ew-eI<<24|4194304),ed.bits=eS,0}},{"../utils/common":41}],51:[function(e,n,N){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,N){var C=e("../utils/common");function u(e){for(var n=e.length;0<=--n;)e[n]=0}var et=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ei=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],eo=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],eu=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ec=Array(576);u(ec);var ef=Array(60);u(ef);var eh=Array(512);u(eh);var ep=Array(256);u(ep);var ed=Array(29);u(ed);var e_,eg,em,eb=Array(30);function K(e,n,N,C,et){this.static_tree=e,this.extra_bits=n,this.extra_base=N,this.elems=C,this.max_length=et,this.has_stree=e&&e.length}function I(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}function B(e){return e<256?eh[e]:eh[256+(e>>>7)]}function ye(e,n){e.pending_buf[e.pending++]=255&n,e.pending_buf[e.pending++]=n>>>8&255}function be(e,n,N){e.bi_valid>16-N?(e.bi_buf|=n<<e.bi_valid&65535,ye(e,e.bi_buf),e.bi_buf=n>>16-e.bi_valid,e.bi_valid+=N-16):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=N)}function Ue(e,n,N){be(e,N[2*n],N[2*n+1])}function Xe(e,n){for(var N=0;N|=1&e,e>>>=1,N<<=1,0<--n;);return N>>>1}function st(e,n,N){var C,et,ei=Array(16),eo=0;for(C=1;C<=15;C++)ei[C]=eo=eo+N[C-1]<<1;for(et=0;et<=n;et++){var eu=e[2*et+1];0!==eu&&(e[2*et]=Xe(ei[eu]++,eu))}}function Ze(e){var n;for(n=0;n<286;n++)e.dyn_ltree[2*n]=0;for(n=0;n<30;n++)e.dyn_dtree[2*n]=0;for(n=0;n<19;n++)e.bl_tree[2*n]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function ae(e){8<e.bi_valid?ye(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function le(e,n,N,C){var et=2*n,ei=2*N;return e[et]<e[ei]||e[et]===e[ei]&&C[n]<=C[N]}function Pe(e,n,N){for(var C=e.heap[N],et=N<<1;et<=e.heap_len&&(et<e.heap_len&&le(n,e.heap[et+1],e.heap[et],e.depth)&&et++,!le(n,C,e.heap[et],e.depth));)e.heap[N]=e.heap[et],N=et,et<<=1;e.heap[N]=C}function xe(e,n,N){var C,eo,eu,ec,ef=0;if(0!==e.last_lit)for(;C=e.pending_buf[e.d_buf+2*ef]<<8|e.pending_buf[e.d_buf+2*ef+1],eo=e.pending_buf[e.l_buf+ef],ef++,0===C?Ue(e,eo,n):(Ue(e,(eu=ep[eo])+256+1,n),0!==(ec=et[eu])&&be(e,eo-=ed[eu],ec),Ue(e,eu=B(--C),N),0!==(ec=ei[eu])&&be(e,C-=eb[eu],ec)),ef<e.last_lit;);Ue(e,256,n)}function ze(e,n){var N,C,et,ei=n.dyn_tree,eo=n.stat_desc.static_tree,eu=n.stat_desc.has_stree,ec=n.stat_desc.elems,ef=-1;for(e.heap_len=0,e.heap_max=573,N=0;N<ec;N++)0!==ei[2*N]?(e.heap[++e.heap_len]=ef=N,e.depth[N]=0):ei[2*N+1]=0;for(;e.heap_len<2;)ei[2*(et=e.heap[++e.heap_len]=ef<2?++ef:0)]=1,e.depth[et]=0,e.opt_len--,eu&&(e.static_len-=eo[2*et+1]);for(n.max_code=ef,N=e.heap_len>>1;1<=N;N--)Pe(e,ei,N);for(et=ec;N=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Pe(e,ei,1),C=e.heap[1],e.heap[--e.heap_max]=N,e.heap[--e.heap_max]=C,ei[2*et]=ei[2*N]+ei[2*C],e.depth[et]=(e.depth[N]>=e.depth[C]?e.depth[N]:e.depth[C])+1,ei[2*N+1]=ei[2*C+1]=et,e.heap[1]=et++,Pe(e,ei,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,n){var N,C,et,ei,eo,eu,ec=n.dyn_tree,ef=n.max_code,eh=n.stat_desc.static_tree,ep=n.stat_desc.has_stree,ed=n.stat_desc.extra_bits,e_=n.stat_desc.extra_base,eg=n.stat_desc.max_length,em=0;for(ei=0;ei<=15;ei++)e.bl_count[ei]=0;for(ec[2*e.heap[e.heap_max]+1]=0,N=e.heap_max+1;N<573;N++)eg<(ei=ec[2*ec[2*(C=e.heap[N])+1]+1]+1)&&(ei=eg,em++),ec[2*C+1]=ei,ef<C||(e.bl_count[ei]++,eo=0,e_<=C&&(eo=ed[C-e_]),eu=ec[2*C],e.opt_len+=eu*(ei+eo),ep&&(e.static_len+=eu*(eh[2*C+1]+eo)));if(0!==em){do{for(ei=eg-1;0===e.bl_count[ei];)ei--;e.bl_count[ei]--,e.bl_count[ei+1]+=2,e.bl_count[eg]--,em-=2}while(0<em);for(ei=eg;0!==ei;ei--)for(C=e.bl_count[ei];0!==C;)ef<(et=e.heap[--N])||(ec[2*et+1]!==ei&&(e.opt_len+=(ei-ec[2*et+1])*ec[2*et],ec[2*et+1]=ei),C--)}}(e,n),st(ei,ef,e.bl_count)}function g(e,n,N){var C,et,ei=-1,eo=n[1],eu=0,ec=7,ef=4;for(0===eo&&(ec=138,ef=3),n[2*(N+1)+1]=65535,C=0;C<=N;C++)et=eo,eo=n[2*(C+1)+1],++eu<ec&&et===eo||(eu<ef?e.bl_tree[2*et]+=eu:0!==et?(et!==ei&&e.bl_tree[2*et]++,e.bl_tree[32]++):eu<=10?e.bl_tree[34]++:e.bl_tree[36]++,ei=et,ef=(eu=0)===eo?(ec=138,3):et===eo?(ec=6,3):(ec=7,4))}function ge(e,n,N){var C,et,ei=-1,eo=n[1],eu=0,ec=7,ef=4;for(0===eo&&(ec=138,ef=3),C=0;C<=N;C++)if(et=eo,eo=n[2*(C+1)+1],!(++eu<ec&&et===eo)){if(eu<ef)for(;Ue(e,et,e.bl_tree),0!=--eu;);else 0!==et?(et!==ei&&(Ue(e,et,e.bl_tree),eu--),Ue(e,16,e.bl_tree),be(e,eu-3,2)):eu<=10?(Ue(e,17,e.bl_tree),be(e,eu-3,3)):(Ue(e,18,e.bl_tree),be(e,eu-11,7));ei=et,ef=(eu=0)===eo?(ec=138,3):et===eo?(ec=6,3):(ec=7,4)}}u(eb);var ey=!1;function A(e,n,N,et){be(e,0+(et?1:0),3),ae(e),ye(e,N),ye(e,~N),C.arraySet(e.pending_buf,e.window,n,N,e.pending),e.pending+=N}N._tr_init=function(e){ey||(function(){var e,n,N,C,eu,ey=Array(16);for(C=N=0;C<28;C++)for(ed[C]=N,e=0;e<1<<et[C];e++)ep[N++]=C;for(ep[N-1]=C,C=eu=0;C<16;C++)for(eb[C]=eu,e=0;e<1<<ei[C];e++)eh[eu++]=C;for(eu>>=7;C<30;C++)for(eb[C]=eu<<7,e=0;e<1<<ei[C]-7;e++)eh[256+eu++]=C;for(n=0;n<=15;n++)ey[n]=0;for(e=0;e<=143;)ec[2*e+1]=8,e++,ey[8]++;for(;e<=255;)ec[2*e+1]=9,e++,ey[9]++;for(;e<=279;)ec[2*e+1]=7,e++,ey[7]++;for(;e<=287;)ec[2*e+1]=8,e++,ey[8]++;for(st(ec,287,ey),e=0;e<30;e++)ef[2*e+1]=5,ef[2*e]=Xe(e,5);e_=new K(ec,et,257,286,15),eg=new K(ef,ei,0,30,15),em=new K([],eo,0,19,7)}(),ey=!0),e.l_desc=new I(e.dyn_ltree,e_),e.d_desc=new I(e.dyn_dtree,eg),e.bl_desc=new I(e.bl_tree,em),e.bi_buf=0,e.bi_valid=0,Ze(e)},N._tr_stored_block=A,N._tr_flush_block=function(e,n,N,C){var et,ei,eo=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var n,N=4093624447;for(n=0;n<=31;n++,N>>>=1)if(1&N&&0!==e.dyn_ltree[2*n])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==e.dyn_ltree[2*n])return 1;return 0}(e)),ze(e,e.l_desc),ze(e,e.d_desc),eo=function(e){var n;for(g(e,e.dyn_ltree,e.l_desc.max_code),g(e,e.dyn_dtree,e.d_desc.max_code),ze(e,e.bl_desc),n=18;3<=n&&0===e.bl_tree[2*eu[n]+1];n--);return e.opt_len+=3*(n+1)+5+5+4,n}(e),et=e.opt_len+3+7>>>3,(ei=e.static_len+3+7>>>3)<=et&&(et=ei)):et=ei=N+5,N+4<=et&&-1!==n?A(e,n,N,C):4===e.strategy||ei===et?(be(e,2+(C?1:0),3),xe(e,ec,ef)):(be(e,4+(C?1:0),3),function(e,n,N,C){var et;for(be(e,n-257,5),be(e,N-1,5),be(e,C-4,4),et=0;et<C;et++)be(e,e.bl_tree[2*eu[et]+1],3);ge(e,e.dyn_ltree,n-1),ge(e,e.dyn_dtree,N-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,eo+1),xe(e,e.dyn_ltree,e.dyn_dtree)),Ze(e),C&&ae(e)},N._tr_tally=function(e,n,N){return e.pending_buf[e.d_buf+2*e.last_lit]=n>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&n,e.pending_buf[e.l_buf+e.last_lit]=255&N,e.last_lit++,0===n?e.dyn_ltree[2*N]++:(e.matches++,n--,e.dyn_ltree[2*(ep[N]+256+1)]++,e.dyn_dtree[2*B(n)]++),e.last_lit===e.lit_bufsize-1},N._tr_align=function(e){be(e,2,3),Ue(e,256,ec),16===e.bi_valid?(ye(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,n,N){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,N){(function(e){!function(e,n){if(!e.setImmediate){var N,C,et,ei,eo=1,eu={},ef=!1,eh=e.document,ep=Object.getPrototypeOf&&Object.getPrototypeOf(e);ep=ep&&ep.setTimeout?ep:e,N="[object process]"===({}).toString.call(e.process)?function(e){ec.nextTick(function(){R(e)})}:!function(){if(e.postMessage&&!e.importScripts){var n=!0,N=e.onmessage;return e.onmessage=function(){n=!1},e.postMessage("","*"),e.onmessage=N,n}}()?e.MessageChannel?((et=new MessageChannel).port1.onmessage=function(e){R(e.data)},function(e){et.port2.postMessage(e)}):eh&&"onreadystatechange"in eh.createElement("script")?(C=eh.documentElement,function(e){var n=eh.createElement("script");n.onreadystatechange=function(){R(e),n.onreadystatechange=null,C.removeChild(n),n=null},C.appendChild(n)}):function(e){setTimeout(R,0,e)}:(ei="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",M,!1):e.attachEvent("onmessage",M),function(n){e.postMessage(ei+n,"*")}),ep.setImmediate=function(e){"function"!=typeof e&&(e=Function(""+e));for(var n=Array(arguments.length-1),C=0;C<n.length;C++)n[C]=arguments[C+1];var et={callback:e,args:n};return eu[eo]=et,N(eo),eo++},ep.clearImmediate=b}function b(e){delete eu[e]}function R(e){if(ef)setTimeout(R,0,e);else{var n=eu[e];if(n){ef=!0;try{!function(e){var n=e.callback,N=e.args;switch(N.length){case 0:n();break;case 1:n(N[0]);break;case 2:n(N[0],N[1]);break;case 3:n(N[0],N[1],N[2]);break;default:n.apply(void 0,N)}}(n)}finally{b(e),ef=!1}}}}function M(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(ei)&&R(+n.data.slice(ei.length))}}(typeof self>"u"?void 0===e?this:e:self)}).call(this,"u">typeof th?th:"u">typeof self?self:"u">typeof window?window:{})},{}]},{},[10])(10);var td=tp.exports;let t_=td&&td.__esModule&&Object.prototype.hasOwnProperty.call(td,"default")?td.default:td;function Fa(e){return fetch(e).then(e=>e.ok?e.blob():Promise.reject(e.status)).then(e=>e.text())}let Xo=class Xo{constructor(e){this.baseUrl=e}href(e){return`${this.baseUrl}/${e}`}get(e){return Fa(this.href(e))}ready(e){e&&e()}close(e){e&&e(null)}};let Yo=class Yo{ready(e){throw Error("Method not implemented.")}close(e){throw Error("Method not implemented.")}};let Zo=class Zo extends Yo{constructor(e){super(),this._zip=void 0,this._isClosed=!1,this._task=Fa(e).then(t_.loadAsync).then(e=>{this._isClosed||(this._zip=e,this._task=void 0,this._notifyReady())})}href(e){return e}get(e){return new Promise((n,N)=>{if(void 0===this._zip){N(void 0);return}let C=this._zip.file(e);if(!C){N(void 0);return}C.async("string").then(e=>{n(e)}).catch(N)})}ready(e){this._readyCallback=e,void 0===this._task&&this._notifyReady()}_notifyReady(){void 0!==this._readyCallback&&this._readyCallback()}close(e){this._isClosed=!0,this._task=void 0,this._zip=void 0,void 0!==e&&e(null)}};let tg={inputController:()=>new zo,fileServer:e=>new Xo(e),zipServer:e=>new Zo(e)},tm=class extends eu.Component{componentDidMount(){var e,n,N,C;let et,ei;void 0===this._player&&(console.log("mount player from",this),this._player=(e={element:this.props._ref.current,url:this.props.url,boot:this.props.boot,splashart:this.props.splashart,width:this.props.width,height:this.props.height,scale:this.props.scale,resizable:this.props.resizable,autoPlay:this.props.autoPlay,speed:this.props.speed,onReady:this.props.onReady},n=void 0,ei={url:"",resizable:!0,speed:1},void 0===e||Ma(e)||"className"in e?et=e:n=e,void 0!==n&&(ei={...ei,...n}),null==et&&(et=void 0!==ei.element?ei.element:document.getElementsByClassName("moroboxai-player")),Ma(et)?Array.prototype.map.call(et,e=>{var n;return n=ei,new jo(tg,e,n)}):(N=et,C=ei,new jo(tg,N,C))),void 0!==this.props.onMount&&this.props.onMount(this._player))}componentDidUpdate(e){void 0!==this._player&&(void 0!==this.props.width&&this.props.width!=e.width&&this._player.resize({width:this.props.width,height:this._player.height}),void 0!==this.props.height&&this.props.height!=e.height&&this._player.resize({width:this._player.width,height:this.props.height}),void 0!==this.props.scale&&this.props.scale!=e.scale&&(this._player.scale=this.props.scale),void 0!==this.props.speed&&this.props.speed!=e.speed&&(this._player.speed=this.props.speed),void 0!==this.props.resizable&&this.props.resizable!=e.resizable&&(this._player.resizable=this.props.resizable),void 0!==this.props.boot&&this.props.boot!=e.boot&&(this._player.boot=this.props.boot),void 0!==this.props.autoPlay&&this.props.autoPlay!=e.autoPlay&&(this._player.autoPlay=this.props.autoPlay),void 0!==this.props.url&&this.props.url!=e.url&&this._player.play({url:this.props.url}))}componentWillUnmount(){if(void 0!==this._player){console.log("unmount player from",this);let e=this._player;this._player.remove(),this._player=void 0,void 0!==this.props.onUnmount&&this.props.onUnmount(e)}}getModel(){return this._player}render(){let e={style:{backgroundSize:"cover"}};return void 0!==this.props.url&&(e["data-url"]=this.props.url),void 0!==this.props.splashart&&(e.style.backgroundImage=`url('${this.props.splashart}')`),ed.jsx("div",{className:"mai-player "+(this.props.className||""),ref:this.props._ref,...e})}},tb=(0,eu.memo)(tm);let el=class el extends eu.Component{constructor(e){super(e),this._refContainer=eu.createRef()}render(){return ed.jsx(tb,{_ref:this._refContainer,...this.props})}};let ty=(0,eu.memo)(el)}}]);