"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736],{3253:function(t,n,N){let M;N.d(n,{S1:function(){return $o}});var es,ea,eo=N(3454),el=N(1876).Buffer;let eu=["saveState","loadState","inputs"];let Da=class Da{constructor(t,n){this._fun=t,this._context=n}saveState(){return void 0!==this._context.saveState?this._context.saveState():{}}loadState(t){void 0!==this._context.loadState&&this._context.loadState(t)}inputs(t){return void 0!==this._context.inputs?this._context.inputs(t):{}}};var ec=function(t){var n={};function e(N){if(n[N])return n[N].exports;var M=n[N]={i:N,l:!1,exports:{}};return t[N].call(M.exports,M,M.exports,e),M.l=!0,M.exports}return e.m=t,e.c=n,e.d=function(t,n,N){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:N})},e.r=function(t){"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n||4&n&&"object"==typeof t&&t&&t.__esModule)return t;var N=Object.create(null);if(e.r(N),Object.defineProperty(N,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var M in t)e.d(N,M,(function(n){return t[n]}).bind(null,M));return N},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=34)}([function(t,n,N){/**
  @license MIT
  
  Copyright © 2017-2018 Benoit Giannangeli
  Copyright © 2017-2018 Daurnimator
  Copyright © 1994–2017 Lua.org, PUC-Rio.
  */let M=N(5);t.exports.FENGARI_AUTHORS=M.FENGARI_AUTHORS,t.exports.FENGARI_COPYRIGHT=M.FENGARI_COPYRIGHT,t.exports.FENGARI_RELEASE=M.FENGARI_RELEASE,t.exports.FENGARI_VERSION=M.FENGARI_VERSION,t.exports.FENGARI_VERSION_MAJOR=M.FENGARI_VERSION_MAJOR,t.exports.FENGARI_VERSION_MINOR=M.FENGARI_VERSION_MINOR,t.exports.FENGARI_VERSION_NUM=M.FENGARI_VERSION_NUM,t.exports.FENGARI_VERSION_RELEASE=M.FENGARI_VERSION_RELEASE,t.exports.luastring_eq=M.luastring_eq,t.exports.luastring_indexOf=M.luastring_indexOf,t.exports.luastring_of=M.luastring_of,t.exports.to_jsstring=M.to_jsstring,t.exports.to_luastring=M.to_luastring,t.exports.to_uristring=M.to_uristring;let es=N(3),ea=N(2),eo=N(7),el=N(17);t.exports.luaconf=es,t.exports.lua=ea,t.exports.lauxlib=eo,t.exports.lualib=el},function(t,n,N){let M,es,ea;if(M="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(t){let n=0,N=t.length,M=new Uint8Array(N);for(;N>n;)M[n]=t[n++];return M},"function"==typeof new Uint8Array().indexOf)es=function(t,n,N){return t.indexOf(n,N)};else{let t=[].indexOf;if(0!==t.call(new Uint8Array(1),0))throw Error("missing .indexOf");es=function(n,N,M){return t.call(n,N,M)}}ea="function"==typeof Uint8Array.of?Uint8Array.of.bind(Uint8Array):function(){return M(arguments)};let i=function(t){return t instanceof Uint8Array},eo="cannot convert invalid utf8 to javascript string",el=";,/?:@&=+$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,-_.!~*'()#".split("").reduce(function(t,n){return t[n.charCodeAt(0)]=!0,t},{}),eu={},T=function(t,n){if("string"!=typeof t)throw TypeError("to_luastring expects a javascript string");if(n){let n=eu[t];if(i(n))return n}let N=t.length,es=Array(N),ea=0;for(let n=0;n<N;++n){let M=t.charCodeAt(n);if(M<=127)es[ea++]=M;else if(M<=2047)es[ea++]=192|M>>6,es[ea++]=128|63&M;else{if(M>=55296&&M<=56319&&n+1<N){let N=t.charCodeAt(n+1);N>=56320&&N<=57343&&(n++,M=1024*(M-55296)+N+9216)}M<=65535?es[ea++]=224|M>>12:(es[ea++]=240|M>>18,es[ea++]=128|M>>12&63),es[ea++]=128|M>>6&63,es[ea++]=128|63&M}}return es=M(es),n&&(eu[t]=es),es};t.exports.luastring_from=M,t.exports.luastring_indexOf=es,t.exports.luastring_of=ea,t.exports.is_luastring=i,t.exports.luastring_eq=function(t,n){if(t!==n){let N=t.length;if(N!==n.length)return!1;for(let M=0;M<N;M++)if(t[M]!==n[M])return!1}return!0},t.exports.to_jsstring=function(t,n,N,M){if(!i(t))throw TypeError("to_jsstring expects a Uint8Array");N=void 0===N?t.length:Math.min(t.length,N);let es="";for(let ea=void 0!==n?n:0;ea<N;){let n=t[ea++];if(n<128)es+=String.fromCharCode(n);else if(n<194||n>244){if(!M)throw RangeError(eo);es+="�"}else if(n<=223){if(ea>=N){if(!M)throw RangeError(eo);es+="�";continue}let el=t[ea++];if((192&el)!=128){if(!M)throw RangeError(eo);es+="�";continue}es+=String.fromCharCode(((31&n)<<6)+(63&el))}else if(n<=239){if(ea+1>=N){if(!M)throw RangeError(eo);es+="�";continue}let el=t[ea++];if((192&el)!=128){if(!M)throw RangeError(eo);es+="�";continue}let eu=t[ea++];if((192&eu)!=128){if(!M)throw RangeError(eo);es+="�";continue}let ec=((15&n)<<12)+((63&el)<<6)+(63&eu);ec<=65535?es+=String.fromCharCode(ec):es+=String.fromCharCode(55296+((ec-=65536)>>10),ec%1024+56320)}else{if(ea+2>=N){if(!M)throw RangeError(eo);es+="�";continue}let el=t[ea++];if((192&el)!=128){if(!M)throw RangeError(eo);es+="�";continue}let eu=t[ea++];if((192&eu)!=128){if(!M)throw RangeError(eo);es+="�";continue}let ec=t[ea++];if((192&ec)!=128){if(!M)throw RangeError(eo);es+="�";continue}let ef=((7&n)<<18)+((63&el)<<12)+((63&eu)<<6)+(63&ec);es+=String.fromCharCode(55296+((ef-=65536)>>10),ef%1024+56320)}}return es},t.exports.to_uristring=function(t){if(!i(t))throw TypeError("to_uristring expects a Uint8Array");let n="";for(let N=0;N<t.length;N++){let M=t[N];el[M]?n+=String.fromCharCode(M):n+="%"+(M<16?"0":"")+M.toString(16)}return n},t.exports.to_luastring=T,t.exports.from_userstring=function(t){if(!i(t)){if("string"!=typeof t)throw TypeError("expects an array of bytes or javascript string");t=T(t)}return t};let ec=T("\x1bLua");t.exports.LUA_SIGNATURE=ec,t.exports.LUA_VERSION_MAJOR="5",t.exports.LUA_VERSION_MINOR="3",t.exports.LUA_VERSION_NUM=503,t.exports.LUA_VERSION_RELEASE="4",t.exports.LUA_VERSION="Lua 5.3",t.exports.LUA_RELEASE="Lua 5.3.4",t.exports.LUA_COPYRIGHT="Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio",t.exports.LUA_AUTHORS="R. Ierusalimschy, L. H. de Figueiredo, W. Celes";let ef={LUA_TNONE:-1,LUA_TNIL:0,LUA_TBOOLEAN:1,LUA_TLIGHTUSERDATA:2,LUA_TNUMBER:3,LUA_TSTRING:4,LUA_TTABLE:5,LUA_TFUNCTION:6,LUA_TUSERDATA:7,LUA_TTHREAD:8,LUA_NUMTAGS:9};ef.LUA_TSHRSTR=0|ef.LUA_TSTRING,ef.LUA_TLNGSTR=16|ef.LUA_TSTRING,ef.LUA_TNUMFLT=0|ef.LUA_TNUMBER,ef.LUA_TNUMINT=16|ef.LUA_TNUMBER,ef.LUA_TLCL=0|ef.LUA_TFUNCTION,ef.LUA_TLCF=16|ef.LUA_TFUNCTION,ef.LUA_TCCL=32|ef.LUA_TFUNCTION;let{LUAI_MAXSTACK:eh}=N(3),ep=-eh-1e3;t.exports.LUA_HOOKCALL=0,t.exports.LUA_HOOKCOUNT=3,t.exports.LUA_HOOKLINE=2,t.exports.LUA_HOOKRET=1,t.exports.LUA_HOOKTAILCALL=4,t.exports.LUA_MASKCALL=1,t.exports.LUA_MASKCOUNT=8,t.exports.LUA_MASKLINE=4,t.exports.LUA_MASKRET=2,t.exports.LUA_MINSTACK=20,t.exports.LUA_MULTRET=-1,t.exports.LUA_OPADD=0,t.exports.LUA_OPBAND=7,t.exports.LUA_OPBNOT=13,t.exports.LUA_OPBOR=8,t.exports.LUA_OPBXOR=9,t.exports.LUA_OPDIV=5,t.exports.LUA_OPEQ=0,t.exports.LUA_OPIDIV=6,t.exports.LUA_OPLE=2,t.exports.LUA_OPLT=1,t.exports.LUA_OPMOD=3,t.exports.LUA_OPMUL=2,t.exports.LUA_OPPOW=4,t.exports.LUA_OPSHL=10,t.exports.LUA_OPSHR=11,t.exports.LUA_OPSUB=1,t.exports.LUA_OPUNM=12,t.exports.LUA_REGISTRYINDEX=ep,t.exports.LUA_RIDX_GLOBALS=2,t.exports.LUA_RIDX_LAST=2,t.exports.LUA_RIDX_MAINTHREAD=1,t.exports.constant_types=ef,t.exports.lua_Debug=class{constructor(){this.event=NaN,this.name=null,this.namewhat=null,this.what=null,this.source=null,this.currentline=NaN,this.linedefined=NaN,this.lastlinedefined=NaN,this.nups=NaN,this.nparams=NaN,this.isvararg=NaN,this.istailcall=NaN,this.short_src=null,this.i_ci=null}},t.exports.lua_upvalueindex=function(t){return ep-t},t.exports.thread_status={LUA_OK:0,LUA_YIELD:1,LUA_ERRRUN:2,LUA_ERRSYNTAX:3,LUA_ERRMEM:4,LUA_ERRGCMM:5,LUA_ERRERR:6}},function(t,n,N){let M=N(1),es=N(18),ea=N(11),eo=N(8),el=N(12);t.exports.LUA_AUTHORS=M.LUA_AUTHORS,t.exports.LUA_COPYRIGHT=M.LUA_COPYRIGHT,t.exports.LUA_ERRERR=M.thread_status.LUA_ERRERR,t.exports.LUA_ERRGCMM=M.thread_status.LUA_ERRGCMM,t.exports.LUA_ERRMEM=M.thread_status.LUA_ERRMEM,t.exports.LUA_ERRRUN=M.thread_status.LUA_ERRRUN,t.exports.LUA_ERRSYNTAX=M.thread_status.LUA_ERRSYNTAX,t.exports.LUA_HOOKCALL=M.LUA_HOOKCALL,t.exports.LUA_HOOKCOUNT=M.LUA_HOOKCOUNT,t.exports.LUA_HOOKLINE=M.LUA_HOOKLINE,t.exports.LUA_HOOKRET=M.LUA_HOOKRET,t.exports.LUA_HOOKTAILCALL=M.LUA_HOOKTAILCALL,t.exports.LUA_MASKCALL=M.LUA_MASKCALL,t.exports.LUA_MASKCOUNT=M.LUA_MASKCOUNT,t.exports.LUA_MASKLINE=M.LUA_MASKLINE,t.exports.LUA_MASKRET=M.LUA_MASKRET,t.exports.LUA_MINSTACK=M.LUA_MINSTACK,t.exports.LUA_MULTRET=M.LUA_MULTRET,t.exports.LUA_NUMTAGS=M.constant_types.LUA_NUMTAGS,t.exports.LUA_OK=M.thread_status.LUA_OK,t.exports.LUA_OPADD=M.LUA_OPADD,t.exports.LUA_OPBAND=M.LUA_OPBAND,t.exports.LUA_OPBNOT=M.LUA_OPBNOT,t.exports.LUA_OPBOR=M.LUA_OPBOR,t.exports.LUA_OPBXOR=M.LUA_OPBXOR,t.exports.LUA_OPDIV=M.LUA_OPDIV,t.exports.LUA_OPEQ=M.LUA_OPEQ,t.exports.LUA_OPIDIV=M.LUA_OPIDIV,t.exports.LUA_OPLE=M.LUA_OPLE,t.exports.LUA_OPLT=M.LUA_OPLT,t.exports.LUA_OPMOD=M.LUA_OPMOD,t.exports.LUA_OPMUL=M.LUA_OPMUL,t.exports.LUA_OPPOW=M.LUA_OPPOW,t.exports.LUA_OPSHL=M.LUA_OPSHL,t.exports.LUA_OPSHR=M.LUA_OPSHR,t.exports.LUA_OPSUB=M.LUA_OPSUB,t.exports.LUA_OPUNM=M.LUA_OPUNM,t.exports.LUA_REGISTRYINDEX=M.LUA_REGISTRYINDEX,t.exports.LUA_RELEASE=M.LUA_RELEASE,t.exports.LUA_RIDX_GLOBALS=M.LUA_RIDX_GLOBALS,t.exports.LUA_RIDX_LAST=M.LUA_RIDX_LAST,t.exports.LUA_RIDX_MAINTHREAD=M.LUA_RIDX_MAINTHREAD,t.exports.LUA_SIGNATURE=M.LUA_SIGNATURE,t.exports.LUA_TNONE=M.constant_types.LUA_TNONE,t.exports.LUA_TNIL=M.constant_types.LUA_TNIL,t.exports.LUA_TBOOLEAN=M.constant_types.LUA_TBOOLEAN,t.exports.LUA_TLIGHTUSERDATA=M.constant_types.LUA_TLIGHTUSERDATA,t.exports.LUA_TNUMBER=M.constant_types.LUA_TNUMBER,t.exports.LUA_TSTRING=M.constant_types.LUA_TSTRING,t.exports.LUA_TTABLE=M.constant_types.LUA_TTABLE,t.exports.LUA_TFUNCTION=M.constant_types.LUA_TFUNCTION,t.exports.LUA_TUSERDATA=M.constant_types.LUA_TUSERDATA,t.exports.LUA_TTHREAD=M.constant_types.LUA_TTHREAD,t.exports.LUA_VERSION=M.LUA_VERSION,t.exports.LUA_VERSION_MAJOR=M.LUA_VERSION_MAJOR,t.exports.LUA_VERSION_MINOR=M.LUA_VERSION_MINOR,t.exports.LUA_VERSION_NUM=M.LUA_VERSION_NUM,t.exports.LUA_VERSION_RELEASE=M.LUA_VERSION_RELEASE,t.exports.LUA_YIELD=M.thread_status.LUA_YIELD,t.exports.lua_Debug=M.lua_Debug,t.exports.lua_upvalueindex=M.lua_upvalueindex,t.exports.lua_absindex=es.lua_absindex,t.exports.lua_arith=es.lua_arith,t.exports.lua_atpanic=es.lua_atpanic,t.exports.lua_atnativeerror=es.lua_atnativeerror,t.exports.lua_call=es.lua_call,t.exports.lua_callk=es.lua_callk,t.exports.lua_checkstack=es.lua_checkstack,t.exports.lua_close=el.lua_close,t.exports.lua_compare=es.lua_compare,t.exports.lua_concat=es.lua_concat,t.exports.lua_copy=es.lua_copy,t.exports.lua_createtable=es.lua_createtable,t.exports.lua_dump=es.lua_dump,t.exports.lua_error=es.lua_error,t.exports.lua_gc=es.lua_gc,t.exports.lua_getallocf=es.lua_getallocf,t.exports.lua_getextraspace=es.lua_getextraspace,t.exports.lua_getfield=es.lua_getfield,t.exports.lua_getglobal=es.lua_getglobal,t.exports.lua_gethook=ea.lua_gethook,t.exports.lua_gethookcount=ea.lua_gethookcount,t.exports.lua_gethookmask=ea.lua_gethookmask,t.exports.lua_geti=es.lua_geti,t.exports.lua_getinfo=ea.lua_getinfo,t.exports.lua_getlocal=ea.lua_getlocal,t.exports.lua_getmetatable=es.lua_getmetatable,t.exports.lua_getstack=ea.lua_getstack,t.exports.lua_gettable=es.lua_gettable,t.exports.lua_gettop=es.lua_gettop,t.exports.lua_getupvalue=es.lua_getupvalue,t.exports.lua_getuservalue=es.lua_getuservalue,t.exports.lua_insert=es.lua_insert,t.exports.lua_isboolean=es.lua_isboolean,t.exports.lua_iscfunction=es.lua_iscfunction,t.exports.lua_isfunction=es.lua_isfunction,t.exports.lua_isinteger=es.lua_isinteger,t.exports.lua_islightuserdata=es.lua_islightuserdata,t.exports.lua_isnil=es.lua_isnil,t.exports.lua_isnone=es.lua_isnone,t.exports.lua_isnoneornil=es.lua_isnoneornil,t.exports.lua_isnumber=es.lua_isnumber,t.exports.lua_isproxy=es.lua_isproxy,t.exports.lua_isstring=es.lua_isstring,t.exports.lua_istable=es.lua_istable,t.exports.lua_isthread=es.lua_isthread,t.exports.lua_isuserdata=es.lua_isuserdata,t.exports.lua_isyieldable=eo.lua_isyieldable,t.exports.lua_len=es.lua_len,t.exports.lua_load=es.lua_load,t.exports.lua_newstate=el.lua_newstate,t.exports.lua_newtable=es.lua_newtable,t.exports.lua_newthread=el.lua_newthread,t.exports.lua_newuserdata=es.lua_newuserdata,t.exports.lua_next=es.lua_next,t.exports.lua_pcall=es.lua_pcall,t.exports.lua_pcallk=es.lua_pcallk,t.exports.lua_pop=es.lua_pop,t.exports.lua_pushboolean=es.lua_pushboolean,t.exports.lua_pushcclosure=es.lua_pushcclosure,t.exports.lua_pushcfunction=es.lua_pushcfunction,t.exports.lua_pushfstring=es.lua_pushfstring,t.exports.lua_pushglobaltable=es.lua_pushglobaltable,t.exports.lua_pushinteger=es.lua_pushinteger,t.exports.lua_pushjsclosure=es.lua_pushjsclosure,t.exports.lua_pushjsfunction=es.lua_pushjsfunction,t.exports.lua_pushlightuserdata=es.lua_pushlightuserdata,t.exports.lua_pushliteral=es.lua_pushliteral,t.exports.lua_pushlstring=es.lua_pushlstring,t.exports.lua_pushnil=es.lua_pushnil,t.exports.lua_pushnumber=es.lua_pushnumber,t.exports.lua_pushstring=es.lua_pushstring,t.exports.lua_pushthread=es.lua_pushthread,t.exports.lua_pushvalue=es.lua_pushvalue,t.exports.lua_pushvfstring=es.lua_pushvfstring,t.exports.lua_rawequal=es.lua_rawequal,t.exports.lua_rawget=es.lua_rawget,t.exports.lua_rawgeti=es.lua_rawgeti,t.exports.lua_rawgetp=es.lua_rawgetp,t.exports.lua_rawlen=es.lua_rawlen,t.exports.lua_rawset=es.lua_rawset,t.exports.lua_rawseti=es.lua_rawseti,t.exports.lua_rawsetp=es.lua_rawsetp,t.exports.lua_register=es.lua_register,t.exports.lua_remove=es.lua_remove,t.exports.lua_replace=es.lua_replace,t.exports.lua_resume=eo.lua_resume,t.exports.lua_rotate=es.lua_rotate,t.exports.lua_setallof=eo.lua_setallof,t.exports.lua_setfield=es.lua_setfield,t.exports.lua_setglobal=es.lua_setglobal,t.exports.lua_sethook=ea.lua_sethook,t.exports.lua_seti=es.lua_seti,t.exports.lua_setlocal=ea.lua_setlocal,t.exports.lua_setmetatable=es.lua_setmetatable,t.exports.lua_settable=es.lua_settable,t.exports.lua_settop=es.lua_settop,t.exports.lua_setupvalue=es.lua_setupvalue,t.exports.lua_setuservalue=es.lua_setuservalue,t.exports.lua_status=es.lua_status,t.exports.lua_stringtonumber=es.lua_stringtonumber,t.exports.lua_toboolean=es.lua_toboolean,t.exports.lua_todataview=es.lua_todataview,t.exports.lua_tointeger=es.lua_tointeger,t.exports.lua_tointegerx=es.lua_tointegerx,t.exports.lua_tojsstring=es.lua_tojsstring,t.exports.lua_tolstring=es.lua_tolstring,t.exports.lua_tonumber=es.lua_tonumber,t.exports.lua_tonumberx=es.lua_tonumberx,t.exports.lua_topointer=es.lua_topointer,t.exports.lua_toproxy=es.lua_toproxy,t.exports.lua_tostring=es.lua_tostring,t.exports.lua_tothread=es.lua_tothread,t.exports.lua_touserdata=es.lua_touserdata,t.exports.lua_type=es.lua_type,t.exports.lua_typename=es.lua_typename,t.exports.lua_upvalueid=es.lua_upvalueid,t.exports.lua_upvaluejoin=es.lua_upvaluejoin,t.exports.lua_version=es.lua_version,t.exports.lua_xmove=es.lua_xmove,t.exports.lua_yield=eo.lua_yield,t.exports.lua_yieldk=eo.lua_yieldk,t.exports.lua_tocfunction=es.lua_tocfunction},function(t,n,N){let M={},{LUA_VERSION_MAJOR:es,LUA_VERSION_MINOR:ea,to_luastring:eo}=N(1);t.exports.LUA_PATH_SEP=";",t.exports.LUA_PATH_MARK="?",t.exports.LUA_EXEC_DIR="!";let el=es+"."+ea;t.exports.LUA_VDIR=el;{t.exports.LUA_DIRSEP="/";let n="./lua/"+el+"/";t.exports.LUA_LDIR=n,t.exports.LUA_JSDIR=n;let N=eo(n+"?.lua;"+n+"?/init.lua;./?.lua;./?/init.lua");t.exports.LUA_PATH_DEFAULT=N;let M=eo(n+"?.js;"+n+"loadall.js;./?.js");t.exports.LUA_JSPATH_DEFAULT=M}let eu=M.LUA_COMPAT_FLOATSTRING||!1,ec=M.LUAI_MAXSTACK||1e6,ef=M.LUA_IDSIZE||59,eh=M.LUAL_BUFFERSIZE||8192,L=function(t,n){for(var N=Math.min(3,Math.ceil(Math.abs(n)/1023)),M=t,es=0;es<N;es++)M*=Math.pow(2,Math.floor((n+es)/N));return M};t.exports.LUAI_MAXSTACK=ec,t.exports.LUA_COMPAT_FLOATSTRING=eu,t.exports.LUA_IDSIZE=ef,t.exports.LUA_INTEGER_FMT="%d",t.exports.LUA_INTEGER_FRMLEN="",t.exports.LUA_MAXINTEGER=2147483647,t.exports.LUA_MININTEGER=-2147483648,t.exports.LUA_NUMBER_FMT="%.14g",t.exports.LUA_NUMBER_FRMLEN="",t.exports.LUAL_BUFFERSIZE=eh,t.exports.frexp=function(t){if(0===t)return[t,0];var n=new DataView(new ArrayBuffer(8));n.setFloat64(0,t);var N=n.getUint32(0)>>>20&2047;0===N&&(n.setFloat64(0,18446744073709552e3*t),N=(n.getUint32(0)>>>20&2047)-64);var M=N-1022;return[L(t,-M),M]},t.exports.ldexp=L,t.exports.lua_getlocaledecpoint=function(){return 46},t.exports.lua_integer2str=function(t){return String(t)},t.exports.lua_number2str=function(t){return String(Number(t.toPrecision(14)))},t.exports.lua_numbertointeger=function(t){return t>=-2147483648&&t<2147483648&&t},t.exports.luai_apicheck=function(t,n){if(!n)throw Error(n)}},function(t,n,N){let{luai_apicheck:M}=N(3),s=function(t){if(!t)throw Error("assertion failed")};t.exports.lua_assert=s,t.exports.luai_apicheck=M||function(t,n){return s(n)},t.exports.api_check=function(t,n,N){return M(t,n&&N)},t.exports.LUAI_MAXCCALLS=200,t.exports.LUA_MINBUFFER=32,t.exports.luai_nummod=function(t,n,N){let M=n%N;return M*N<0&&(M+=N),M},t.exports.MAX_INT=2147483647,t.exports.MIN_INT=-2147483648},function(t,n,N){let M=N(1),es=`Fengari 0.1.4  Copyright (C) 2017-2018 B. Giannangeli, Daurnimator
Based on: `+M.LUA_COPYRIGHT;t.exports.FENGARI_AUTHORS="B. Giannangeli, Daurnimator",t.exports.FENGARI_COPYRIGHT=es,t.exports.FENGARI_RELEASE="Fengari 0.1.4",t.exports.FENGARI_VERSION="Fengari 0.1",t.exports.FENGARI_VERSION_MAJOR="0",t.exports.FENGARI_VERSION_MINOR="1",t.exports.FENGARI_VERSION_NUM=1,t.exports.FENGARI_VERSION_RELEASE="4",t.exports.is_luastring=M.is_luastring,t.exports.luastring_eq=M.luastring_eq,t.exports.luastring_from=M.luastring_from,t.exports.luastring_indexOf=M.luastring_indexOf,t.exports.luastring_of=M.luastring_of,t.exports.to_jsstring=M.to_jsstring,t.exports.to_luastring=M.to_luastring,t.exports.to_uristring=M.to_uristring,t.exports.from_userstring=M.from_userstring},function(t,n,N){let{LUA_OPADD:M,LUA_OPBAND:es,LUA_OPBNOT:ea,LUA_OPBOR:eo,LUA_OPBXOR:el,LUA_OPDIV:eu,LUA_OPIDIV:ec,LUA_OPMOD:ef,LUA_OPMUL:eh,LUA_OPPOW:ep,LUA_OPSHL:ed,LUA_OPSHR:e_,LUA_OPSUB:eg,LUA_OPUNM:em,constant_types:{LUA_NUMTAGS:eb,LUA_TBOOLEAN:ey,LUA_TCCL:ev,LUA_TFUNCTION:ek,LUA_TLCF:eL,LUA_TLCL:eA,LUA_TLIGHTUSERDATA:ex,LUA_TLNGSTR:ew,LUA_TNIL:eT,LUA_TNUMBER:eO,LUA_TNUMFLT:eE,LUA_TNUMINT:eS,LUA_TSHRSTR:eN,LUA_TSTRING:eU,LUA_TTABLE:eI,LUA_TTHREAD:eR,LUA_TUSERDATA:eC},from_userstring:eP,luastring_indexOf:eM,luastring_of:eB,to_jsstring:eD,to_luastring:eK}=N(1),{lisdigit:eF,lisprint:eV,lisspace:ej,lisxdigit:eG}=N(22),ez=N(11),eH=N(8),eX=N(12),{luaS_bless:e$,luaS_new:eW}=N(10),eq=N(9),{LUA_COMPAT_FLOATSTRING:eZ,ldexp:eY,lua_integer2str:eJ,lua_number2str:eQ}=N(3),e1=N(15),{MAX_INT:e0,luai_nummod:e2,lua_assert:e3}=N(4),e5=N(14),e4=eb+1;let lt=class lt{constructor(t,n){this.type=t,this.value=n}ttype(){return 63&this.type}ttnov(){return 15&this.type}checktag(t){return this.type===t}checktype(t){return this.ttnov()===t}ttisnumber(){return this.checktype(eO)}ttisfloat(){return this.checktag(eE)}ttisinteger(){return this.checktag(eS)}ttisnil(){return this.checktag(eT)}ttisboolean(){return this.checktag(ey)}ttislightuserdata(){return this.checktag(ex)}ttisstring(){return this.checktype(eU)}ttisshrstring(){return this.checktag(eN)}ttislngstring(){return this.checktag(ew)}ttistable(){return this.checktag(eI)}ttisfunction(){return this.checktype(ek)}ttisclosure(){return(31&this.type)===ek}ttisCclosure(){return this.checktag(ev)}ttisLclosure(){return this.checktag(eA)}ttislcf(){return this.checktag(eL)}ttisfulluserdata(){return this.checktag(eC)}ttisthread(){return this.checktag(eR)}ttisdeadkey(){return this.checktag(e4)}l_isfalse(){return this.ttisnil()||this.ttisboolean()&&!1===this.value}setfltvalue(t){this.type=eE,this.value=t}chgfltvalue(t){e3(this.type==eE),this.value=t}setivalue(t){this.type=eS,this.value=t}chgivalue(t){e3(this.type==eS),this.value=t}setnilvalue(){this.type=eT,this.value=null}setfvalue(t){this.type=eL,this.value=t}setpvalue(t){this.type=ex,this.value=t}setbvalue(t){this.type=ey,this.value=t}setsvalue(t){this.type=ew,this.value=t}setuvalue(t){this.type=eC,this.value=t}setthvalue(t){this.type=eR,this.value=t}setclLvalue(t){this.type=eA,this.value=t}setclCvalue(t){this.type=ev,this.value=t}sethvalue(t){this.type=eI,this.value=t}setdeadvalue(){this.type=e4,this.value=null}setfrom(t){this.type=t.type,this.value=t.value}tsvalue(){return e3(this.ttisstring()),this.value}svalue(){return this.tsvalue().getstr()}vslen(){return this.tsvalue().tsslen()}jsstring(t,n){return eD(this.svalue(),t,n,!0)}};let Nt=function(t,n,N){t.stack[n].setsvalue(N)},e8=new lt(eT,null);Object.freeze(e8),t.exports.luaO_nilobject=e8;let ne=class ne{constructor(t,n){this.id=t.l_G.id_counter++,this.p=null,this.nupvalues=n,this.upvals=Array(n)}};let fe=class fe{constructor(t,n,N){for(this.id=t.l_G.id_counter++,this.f=n,this.nupvalues=N,this.upvalue=Array(N);N--;)this.upvalue[N]=new lt(eT,null)}};let Te=class Te{constructor(t,n){this.id=t.l_G.id_counter++,this.metatable=null,this.uservalue=new lt(eT,null),this.len=n,this.data=Object.create(null)}};let e6=eK("..."),e9=eK('[string "'),e7=eK('"]'),Ct=function(t){return eF(t)?t-48:(223&t)-55},Gt=function(t,n){let N=1;if(e3(n<=1114111),n<128)t[7]=n;else{let M=63;do t[8-N++]=128|63&n,n>>=6,M>>=1;while(n>M);t[8-N]=~M<<1|n}return N},Mt=function(t,n){let N="x"===n?function(t){let n,N=0,M=0,es=0,ea=0,eo=0,el=!1;for(;ej(t[N]);)N++;if(((n=45===t[N])||43===t[N])&&N++,48!==t[N]||120!==t[N+1]&&88!==t[N+1])return null;for(N+=2;;N++)if(46===t[N]){if(el)break;el=!0}else{if(!eG(t[N]))break;0===es&&48===t[N]?ea++:++es<=30?M=16*M+Ct(t[N]):eo++,el&&eo--}if(ea+es===0)return null;if(eo*=4,112===t[N]||80===t[N]){let n,M=0;if(((n=45===t[++N])||43===t[N])&&N++,!eF(t[N]))return null;for(;eF(t[N]);)M=10*M+t[N++]-48;n&&(M=-M),eo+=M}return n&&(M=-M),{n:eY(M,eo),i:N}}(t):function(t){try{t=eD(t)}catch{return null}let n=/^[\t\v\f \n\r]*[+-]?(?:[0-9]+\.?[0-9]*|\.[0-9]*)(?:[eE][+-]?[0-9]+)?/.exec(t);if(!n)return null;let N=parseFloat(n[0]);return isNaN(N)?null:{n:N,i:n[0].length}}(t);if(null===N)return null;for(;ej(t[N.i]);)N.i++;return N.i===t.length||0===t[N.i]?N:null},ta=[46,120,88,110,78],to={46:".",120:"x",88:"x",110:"n",78:"n"},tl=Math.floor(e0/10),tu=e0%10,ge=function(t,n){let N;if(n.ttisinteger())N=eK(eJ(n.value));else{let t=eQ(n.value);!eZ&&/^[-0123456789]+$/.test(t)&&(t+=".0"),N=eK(t)}n.setsvalue(e$(t,N))},ye=function(t,n){eH.luaD_inctop(t),Nt(t,t.top-1,eW(t,n))},Ie=function(t,n,N){let M,es=0,ea=0,eo=0;for(;-1!=(M=eM(n,37,ea));){switch(ye(t,n.subarray(ea,M)),n[M+1]){case 115:{let n=N[eo++];if(null===n)n=eK("(null)",!0);else{let t=eM(n=eP(n),0);-1!==t&&(n=n.subarray(0,t))}ye(t,n);break}case 99:{let n=N[eo++];eV(n)?ye(t,eB(n)):ae(t,eK("<\\%d>",!0),n);break}case 100:case 73:eH.luaD_inctop(t),t.stack[t.top-1].setivalue(N[eo++]),ge(t,t.stack[t.top-1]);break;case 102:eH.luaD_inctop(t),t.stack[t.top-1].setfltvalue(N[eo++]),ge(t,t.stack[t.top-1]);break;case 112:{let n=N[eo++];if(n instanceof eX.lua_State||n instanceof eq.Table||n instanceof Te||n instanceof ne||n instanceof fe)ye(t,eK("0x"+n.id.toString(16)));else switch(typeof n){case"undefined":ye(t,eK("undefined"));break;case"number":ye(t,eK("Number("+n+")"));break;case"string":ye(t,eK("String("+JSON.stringify(n)+")"));break;case"boolean":ye(t,eK(n?"Boolean(true)":"Boolean(false)"));break;case"object":if(null===n){ye(t,eK("null"));break}case"function":{let N=t.l_G.ids.get(n);N||(N=t.l_G.id_counter++,t.l_G.ids.set(n,N)),ye(t,eK("0x"+N.toString(16)));break}default:ye(t,eK("<id NYI>"))}break}case 85:{let n=new Uint8Array(8),M=Gt(n,N[eo++]);ye(t,n.subarray(8-M));break}case 37:ye(t,eK("%",!0));break;default:ez.luaG_runerror(t,eK("invalid option '%%%c' to 'lua_pushfstring'"),n[M+1])}es+=2,ea=M+2}return eH.luaD_checkstack(t,1),ye(t,n.subarray(ea)),es>0&&e1.luaV_concat(t,es+1),t.stack[t.top-1].svalue()},ae=function(t,n,...N){return Ie(t,n,N)},ce=function(t,n,N,eu){switch(n){case M:return N+eu|0;case eg:return N-eu|0;case eh:return e1.luaV_imul(N,eu);case ef:return e1.luaV_mod(t,N,eu);case ec:return e1.luaV_div(t,N,eu);case es:return N&eu;case eo:return N|eu;case el:return N^eu;case ed:return e1.luaV_shiftl(N,eu);case e_:return e1.luaV_shiftl(N,-eu);case em:return 0-N|0;case ea:return -1^N;default:e3(0)}},Le=function(t,n,N,es){switch(n){case M:return N+es;case eg:return N-es;case eh:return N*es;case eu:return N/es;case ep:return Math.pow(N,es);case ec:return Math.floor(N/es);case em:return-N;case ef:return e2(t,N,es);default:e3(0)}};t.exports.CClosure=fe,t.exports.LClosure=ne,t.exports.LUA_TDEADKEY=e4,t.exports.LUA_TPROTO=eb,t.exports.LocVar=class{constructor(){this.varname=null,this.startpc=NaN,this.endpc=NaN}},t.exports.TValue=lt,t.exports.Udata=Te,t.exports.UTF8BUFFSZ=8,t.exports.luaO_arith=function(t,n,N,ec,ef){let eh="number"==typeof ef?t.stack[ef]:ef;switch(n){case es:case eo:case el:case ed:case e_:case ea:{let M,es;if(!1!==(M=e1.tointeger(N))&&!1!==(es=e1.tointeger(ec)))return void eh.setivalue(ce(t,n,M,es));break}case eu:case ep:{let M,es;if(!1!==(M=e1.tonumber(N))&&!1!==(es=e1.tonumber(ec)))return void eh.setfltvalue(Le(t,n,M,es));break}default:{let M,es;if(N.ttisinteger()&&ec.ttisinteger())return void eh.setivalue(ce(t,n,N.value,ec.value));if(!1!==(M=e1.tonumber(N))&&!1!==(es=e1.tonumber(ec)))return void eh.setfltvalue(Le(t,n,M,es))}}e3(null!==t),e5.luaT_trybinTM(t,N,ec,ef,n-M+e5.TMS.TM_ADD)},t.exports.luaO_chunkid=function(t,n){let N,M=t.length;if(61===t[0])M<n?(N=new Uint8Array(M-1)).set(t.subarray(1)):(N=new Uint8Array(n)).set(t.subarray(1,n+1));else if(64===t[0])M<=n?(N=new Uint8Array(M-1)).set(t.subarray(1)):((N=new Uint8Array(n)).set(e6),n-=e6.length,N.set(t.subarray(M-n),e6.length));else{N=new Uint8Array(n);let es=eM(t,10);N.set(e9);let ea=e9.length;M<(n-=e9.length+e6.length+e7.length)&&-1===es?(N.set(t,ea),ea+=t.length):(-1!==es&&(M=es),M>n&&(M=n),N.set(t.subarray(0,M),ea),ea+=M,N.set(e6,ea),ea+=e6.length),N.set(e7,ea),ea+=e7.length,N=N.subarray(0,ea)}return N},t.exports.luaO_hexavalue=Ct,t.exports.luaO_int2fb=function(t){let n=0;if(t<8)return t;for(;t>=128;)t=t+15>>4,n+=4;for(;t>=16;)t=t+1>>1,n++;return n+1<<3|t-8},t.exports.luaO_pushfstring=ae,t.exports.luaO_pushvfstring=Ie,t.exports.luaO_str2num=function(t,n){let N=function(t){let n,N=0,M=0,es=!0;for(;ej(t[N]);)N++;if(((n=45===t[N])||43===t[N])&&N++,48!==t[N]||120!==t[N+1]&&88!==t[N+1])for(;N<t.length&&eF(t[N]);N++){let ea=t[N]-48;if(M>=tl&&(M>tl||ea>tu+n))return null;M=10*M+ea|0,es=!1}else for(N+=2;N<t.length&&eG(t[N]);N++)M=16*M+Ct(t[N])|0,es=!1;for(;N<t.length&&ej(t[N]);)N++;return es||N!==t.length&&0!==t[N]?null:{n:0|(n?-M:M),i:N}}(t);return null!==N?(n.setivalue(N.n),N.i+1):null!==(N=function(t){let n=t.length,N=0;for(let M=0;M<n;M++){let n=t[M];if(-1!==ta.indexOf(n)){N=n;break}}let M=to[N];return"n"===M?null:Mt(t,M)}(t))?(n.setfltvalue(N.n),N.i+1):0},t.exports.luaO_tostring=ge,t.exports.luaO_utf8esc=Gt,t.exports.numarith=Le,t.exports.pushobj2s=function(t,n){t.stack[t.top++]=new lt(n.type,n.value)},t.exports.pushsvalue2s=function(t,n){t.stack[t.top++]=new lt(ew,n)},t.exports.setobjs2s=function(t,n,N){t.stack[n].setfrom(t.stack[N])},t.exports.setobj2s=function(t,n,N){t.stack[n].setfrom(N)},t.exports.setsvalue2s=Nt},function(t,n,N){let M,es;let{LUAL_BUFFERSIZE:ea}=N(3),{LUA_ERRERR:eo,LUA_MULTRET:el,LUA_REGISTRYINDEX:eu,LUA_SIGNATURE:ec,LUA_TBOOLEAN:ef,LUA_TLIGHTUSERDATA:eh,LUA_TNIL:ep,LUA_TNONE:ed,LUA_TNUMBER:e_,LUA_TSTRING:eg,LUA_TTABLE:em,LUA_VERSION_NUM:eb,lua_Debug:ey,lua_absindex:ev,lua_atpanic:ek,lua_call:eL,lua_checkstack:eA,lua_concat:ex,lua_copy:ew,lua_createtable:eT,lua_error:eO,lua_getfield:eE,lua_getinfo:eS,lua_getmetatable:eN,lua_getstack:eU,lua_gettop:eI,lua_insert:eR,lua_isinteger:eC,lua_isnil:eP,lua_isnumber:eM,lua_isstring:eB,lua_istable:eD,lua_len:eK,lua_load:eF,lua_newstate:eV,lua_newtable:ej,lua_next:eG,lua_pcall:ez,lua_pop:eH,lua_pushboolean:eX,lua_pushcclosure:e$,lua_pushcfunction:eW,lua_pushfstring:eq,lua_pushinteger:eZ,lua_pushliteral:eY,lua_pushlstring:eJ,lua_pushnil:eQ,lua_pushstring:e1,lua_pushvalue:e0,lua_pushvfstring:e2,lua_rawequal:e3,lua_rawget:e5,lua_rawgeti:e4,lua_rawlen:e8,lua_rawseti:e6,lua_remove:e9,lua_setfield:e7,lua_setglobal:ta,lua_setmetatable:to,lua_settop:tl,lua_toboolean:tu,lua_tointeger:tc,lua_tointegerx:tf,lua_tojsstring:th,lua_tolstring:tp,lua_tonumber:td,lua_tonumberx:t_,lua_topointer:tg,lua_tostring:tm,lua_touserdata:tb,lua_type:ty,lua_typename:tv,lua_version:tk}=N(2),{from_userstring:tL,luastring_eq:tA,to_luastring:tx,to_uristring:tw}=N(5),tT=eo+1,tO=tx("_LOADED"),tE=tx("_PRELOAD"),tS=tx("FILE*"),tN=tx("__name"),tU=tx("__tostring"),tI=new Uint8Array(0);let I=class I{constructor(){this.L=null,this.b=tI,this.n=0}};let ct=function(t,n,N){if(0===N||!eD(t,-1))return 0;for(eQ(t);eG(t,-2);){if(ty(t,-2)===eg){if(e3(t,n,-1))return eH(t,1),1;if(ct(t,n,N-1))return e9(t,-2),eY(t,"."),eR(t,-2),ex(t,3),1}eH(t,1)}return 0},Vt=function(t,n){let N=eI(t);if(eS(t,tx("f"),n),eE(t,eu,tO),ct(t,N+1,2)){let n=tm(t,-1);return 95===n[0]&&71===n[1]&&46===n[2]&&(e1(t,n.subarray(3)),e9(t,-2)),ew(t,-1,N+1),eH(t,2),1}return tl(t,N),0},Jt=function(t,n){Vt(t,n)?(eq(t,tx("function '%s'"),tm(t,-1)),e9(t,-2)):0!==n.namewhat.length?eq(t,tx("%s '%s'"),n.namewhat,n.name):n.what&&109===n.what[0]?eY(t,"main chunk"):n.what&&76===n.what[0]?eq(t,tx("function <%s:%d>"),n.short_src,n.linedefined):eY(t,"?")},ve=function(t){throw Error("PANIC: unprotected error in call to Lua API ("+th(t,-1)+")")},ke=function(t,n,N){let M=new ey;return eU(t,0,M)?(eS(t,tx("n"),M),tA(M.namewhat,tx("method"))&&0==--n?W(t,tx("calling '%s' on bad self (%s)"),M.name,N):(null===M.name&&(M.name=Vt(t,M)?tm(t,-1):tx("?")),W(t,tx("bad argument #%d to '%s' (%s)"),n,M.name,N))):W(t,tx("bad argument #%d (%s)"),n,N)},vt=function(t,n,N){let M;M=jt(t,n,tN)===eg?tm(t,-1):ty(t,n)===eh?tx("light userdata",!0):pe(t,n);let es=eq(t,tx("%s expected, got %s"),N,M);return ke(t,n,es)},zt=function(t,n){let N=new ey;eU(t,n,N)&&(eS(t,tx("Sl",!0),N),N.currentline>0)?eq(t,tx("%s:%d: "),N.short_src,N.currentline):e1(t,tx(""))},W=function(t,n,...N){return zt(t,1),e2(t,n,N),ex(t,2),eO(t)},Rt=function(t,n,N,M){if(n)return eX(t,1),1;{let n,es;return eQ(t),M?(n=M.message,es=-M.errno):(n="Success",es=0),N?eq(t,tx("%s: %s"),N,tx(n)):e1(t,tx(n)),eZ(t,es),3}},bt=function(t,n){return eE(t,eu,n)},Zt=function(t,n,N){let M=tb(t,n);return null!==M&&eN(t,n)?(bt(t,N),e3(t,-1,-2)||(M=null),eH(t,2),M):null},he=function(t,n,N){vt(t,n,tv(t,N))},pe=function(t,n){return tv(t,ty(t,n))},ue=function(t,n){let N=tp(t,n);return null!=N||he(t,n,eg),N},Ke=function(t,n,N){return 0>=ty(t,n)?null===N?null:tL(N):ue(t,n)},Ee=function(t,n){let N=t_(t,n);return!1===N&&he(t,n,e_),N},Ae=function(t,n){let N=tf(t,n);return!1===N&&(eM(t,n)?ke(t,n,tx("number has no integer representation",!0)):he(t,n,e_)),N},Pe=function(t,n){let N=t.n+n;if(t.b.length<N){let n=Math.max(2*t.b.length,N),M=new Uint8Array(n);M.set(t.b),t.b=M}return t.b.subarray(t.n,N)},Me=function(t,n){n.L=t,n.b=tI},We=function(t,n,N){N>0&&(n=tL(n),Pe(t,N).set(n.subarray(0,N)),Xe(t,N))},Ge=function(t,n){We(t,n=tL(n),n.length)},Ze=function(t){eJ(t.L,t.b,t.n),t.n=0,t.b=tI},Xe=function(t,n){t.n+=n},D=function(t,n,N,M){return 0>=ty(t,N)?M:n(t,N)},kt=function(t,n){let N=n.string;return n.string=null,N},Ht=function(t,n,N,M,es){return eF(t,kt,{string:n},M,es)},qt=function(t,n,N,M){return Ht(t,n,0,M,null)},se=function(t,n){return qt(t,n,n.length,n)},jt=function(t,n,N){if(eN(t,n)){e1(t,N);let n=e5(t,-2);return n===ep?eH(t,2):e9(t,-2),n}return ep},$t=function(t,n,N){return n=ev(t,n),jt(t,n,N)!==ep&&(e0(t,n),eL(t,1,1),!0)},tR=tx("%I"),tC=tx("%f"),le=function(t,n,N){var M=N>>>0,es=n.length,ea=t.length+1-es;e:for(;M<ea;M++){for(let N=0;N<es;N++)if(t[M+N]!==n[N])continue e;return M}return -1},y=function(t,n,N){return eE(t,n,N)===em||(eH(t,1),n=ev(t,n),ej(t),e0(t,-1),e7(t,n,N),!1)},nt=function(t,n,N){for(let M in et(t,N,tx("too many upvalues",!0)),n){for(let n=0;n<N;n++)e0(t,-N);e$(t,n[M],N),e7(t,-(N+2),tx(M))}eH(t,N)},et=function(t,n,N){eA(t,n)||(N?W(t,tx("stack overflow (%s)"),N):W(t,tx("stack overflow",!0)))},wt=function(t,n,N,M){let es=M.message,ea=tm(t,N).subarray(1);return eq(t,tx("cannot %s %s: %s"),tx(n),ea,tx(es)),e9(t,N),tT},tP=[239,187,191],oe=function(t){let n=function(t){let n;t.n=0;let N=0;do{if(null===(n=M(t))||n!==tP[N])return n;N++,t.buff[t.n++]=n}while(N<tP.length);return t.n=0,M(t)}(t);if(35===n){do n=M(t);while(n&&10!==n);return{skipped:!0,c:M(t)}}return{skipped:!1,c:n}};{let C=class C{constructor(){this.n=NaN,this.f=null,this.buff=new Uint8Array(1024),this.pos=0,this.err=void 0}};let J=function(t,n){if(null!==n.f&&n.n>0){let t=n.n;return n.n=0,n.f=n.f.subarray(n.pos),n.buff.subarray(0,t)}let N=n.f;return n.f=null,N};M=function(t){return t.pos<t.f.length?t.f[t.pos++]:null},es=function(t,n,N){let M=new C,es=eI(t)+1;if(null===n)throw Error("Can't read stdin in the browser");{eq(t,tx("@%s"),n);let N=tw(n),ea=new XMLHttpRequest;if(ea.open("GET",N,!1),typeof window>"u"&&(ea.responseType="arraybuffer"),ea.send(),!(ea.status>=200&&ea.status<=299))return M.err=ea.status,wt(t,"open",es,{message:`${ea.status}: ${ea.statusText}`});"string"==typeof ea.response?M.f=tx(ea.response):M.f=new Uint8Array(ea.response)}let ea=oe(M);ea.c===ec[0]&&n||ea.skipped&&(M.buff[M.n++]=10),null!==ea.c&&(M.buff[M.n++]=ea.c);let eo=eF(t,J,M,tm(t,-1),N),el=M.err;return el?(tl(t,es),wt(t,"read",es,el)):(e9(t,es),eo)}}let be=function(t,n){return es(t,n,null)},Ne=function(t,n,N){let M=tk(t);72!=N&&W(t,tx("core and library have incompatible numeric types")),M!=tk(null)?W(t,tx("multiple Lua VMs detected")):M!==n&&W(t,tx("version mismatch: app. needs %f, Lua core provides %f"),n,M)};t.exports.LUA_ERRFILE=tT,t.exports.LUA_FILEHANDLE=tS,t.exports.LUA_LOADED_TABLE=tO,t.exports.LUA_NOREF=-2,t.exports.LUA_PRELOAD_TABLE=tE,t.exports.LUA_REFNIL=-1,t.exports.luaL_Buffer=I,t.exports.luaL_addchar=function(t,n){Pe(t,1),t.b[t.n++]=n},t.exports.luaL_addlstring=We,t.exports.luaL_addsize=Xe,t.exports.luaL_addstring=Ge,t.exports.luaL_addvalue=function(t){let n=t.L,N=tm(n,-1);We(t,N,N.length),eH(n,1)},t.exports.luaL_argcheck=function(t,n,N,M){n||ke(t,N,M)},t.exports.luaL_argerror=ke,t.exports.luaL_buffinit=Me,t.exports.luaL_buffinitsize=function(t,n,N){return Me(t,n),Pe(n,N)},t.exports.luaL_callmeta=$t,t.exports.luaL_checkany=function(t,n){ty(t,n)===ed&&ke(t,n,tx("value expected",!0))},t.exports.luaL_checkinteger=Ae,t.exports.luaL_checklstring=ue,t.exports.luaL_checknumber=Ee,t.exports.luaL_checkoption=function(t,n,N,M){let es=null!==N?Ke(t,n,N):ue(t,n);for(let t=0;M[t];t++)if(tA(M[t],es))return t;return ke(t,n,eq(t,tx("invalid option '%s'"),es))},t.exports.luaL_checkstack=et,t.exports.luaL_checkstring=ue,t.exports.luaL_checktype=function(t,n,N){ty(t,n)!==N&&he(t,n,N)},t.exports.luaL_checkudata=function(t,n,N){let M=Zt(t,n,N);return null===M&&vt(t,n,N),M},t.exports.luaL_checkversion=function(t){Ne(t,eb,72)},t.exports.luaL_checkversion_=Ne,t.exports.luaL_dofile=function(t,n){return be(t,n)||ez(t,0,el,0)},t.exports.luaL_dostring=function(t,n){return se(t,n)||ez(t,0,el,0)},t.exports.luaL_error=W,t.exports.luaL_execresult=function(t,n){let N,M;if(null===n)return eX(t,1),eY(t,"exit"),eZ(t,0),3;if(n.status)N="exit",M=n.status;else{if(!n.signal)return Rt(t,0,null,n);N="signal",M=n.signal}return eQ(t),eY(t,N),eZ(t,M),3},t.exports.luaL_fileresult=Rt,t.exports.luaL_getmetafield=jt,t.exports.luaL_getmetatable=bt,t.exports.luaL_getsubtable=y,t.exports.luaL_gsub=function(t,n,N,M){let es,ea=new I;for(Me(t,ea);(es=le(n,N))>=0;)We(ea,n,es),Ge(ea,M),n=n.subarray(es+N.length);return Ge(ea,n),Ze(ea),tm(t,-1)},t.exports.luaL_len=function(t,n){eK(t,n);let N=tf(t,-1);return!1===N&&W(t,tx("object length is not an integer",!0)),eH(t,1),N},t.exports.luaL_loadbuffer=qt,t.exports.luaL_loadbufferx=Ht,t.exports.luaL_loadfile=be,t.exports.luaL_loadfilex=es,t.exports.luaL_loadstring=se,t.exports.luaL_newlib=function(t,n){eT(t),nt(t,n,0)},t.exports.luaL_newlibtable=function(t){eT(t)},t.exports.luaL_newmetatable=function(t,n){return bt(t,n)!==ep?0:(eH(t,1),eT(t,0,2),e1(t,n),e7(t,-2,tN),e0(t,-1),e7(t,eu,n),1)},t.exports.luaL_newstate=function(){let t=eV();return t&&ek(t,ve),t},t.exports.luaL_opt=D,t.exports.luaL_optinteger=function(t,n,N){return D(t,Ae,n,N)},t.exports.luaL_optlstring=Ke,t.exports.luaL_optnumber=function(t,n,N){return D(t,Ee,n,N)},t.exports.luaL_optstring=Ke,t.exports.luaL_prepbuffer=function(t){return Pe(t,ea)},t.exports.luaL_prepbuffsize=Pe,t.exports.luaL_pushresult=Ze,t.exports.luaL_pushresultsize=function(t,n){Xe(t,n),Ze(t)},t.exports.luaL_ref=function(t,n){let N;return eP(t,-1)?(eH(t,1),-1):(n=ev(t,n),e4(t,n,0),N=tc(t,-1),eH(t,1),0!==N?(e4(t,n,N),e6(t,n,0)):N=e8(t,n)+1,e6(t,n,N),N)},t.exports.luaL_requiref=function(t,n,N,M){y(t,eu,tO),eE(t,-1,n),tu(t,-1)||(eH(t,1),eW(t,N),e1(t,n),eL(t,1,1),e0(t,-1),e7(t,-3,n)),e9(t,-2),M&&(e0(t,-1),ta(t,n))},t.exports.luaL_setfuncs=nt,t.exports.luaL_setmetatable=function(t,n){bt(t,n),to(t,-2)},t.exports.luaL_testudata=Zt,t.exports.luaL_tolstring=function(t,n){if($t(t,n,tU))eB(t,-1)||W(t,tx("'__tostring' must return a string"));else switch(ty(t,n)){case e_:eC(t,n)?eq(t,tR,tc(t,n)):eq(t,tC,td(t,n));break;case eg:e0(t,n);break;case ef:eY(t,tu(t,n)?"true":"false");break;case ep:eY(t,"nil");break;default:{let N=jt(t,n,tN),M=N===eg?tm(t,-1):pe(t,n);eq(t,tx("%s: %p"),M,tg(t,n)),N!==ep&&e9(t,-2)}}return tp(t,-1)},t.exports.luaL_traceback=function(t,n,N,M){let es=new ey,ea=eI(t),eo=function(t){let n=new ey,N=1,M=1;for(;eU(t,M,n);)N=M,M*=2;for(;N<M;){let es=Math.floor((N+M)/2);eU(t,es,n)?N=es+1:M=es}return M-1}(n),el=eo-M>21?10:-1;for(N&&eq(t,tx(`%s
`),N),et(t,10,null),eY(t,"stack traceback:");eU(n,M++,es);)0==el--?(eY(t,`
	...`),M=eo-11+1):(eS(n,tx("Slnt",!0),es),eq(t,tx(`
	%s:`),es.short_src),es.currentline>0&&eY(t,`${es.currentline}:`),eY(t," in "),Jt(t,es),es.istailcall&&eY(t,`
	(...tail calls..)`),ex(t,eI(t)-ea));ex(t,eI(t)-ea)},t.exports.luaL_typename=pe,t.exports.luaL_unref=function(t,n,N){N>=0&&(n=ev(t,n),e4(t,n,0),e6(t,n,N),eZ(t,N),e6(t,n,0))},t.exports.luaL_where=zt,t.exports.lua_writestringerror=function(){for(let t=0;t<arguments.length;t++){let n=arguments[t];do{let t=/([^\n]*)\n?([\d\D]*)/.exec(n);console.error(t[1]),n=t[2]}while(""!==n)}}},function(t,n,N){let{LUA_HOOKCALL:M,LUA_HOOKRET:es,LUA_HOOKTAILCALL:ea,LUA_MASKCALL:eo,LUA_MASKLINE:el,LUA_MASKRET:eu,LUA_MINSTACK:ec,LUA_MULTRET:ef,LUA_SIGNATURE:eh,constant_types:{LUA_TCCL:ep,LUA_TLCF:ed,LUA_TLCL:e_,LUA_TNIL:eg},thread_status:{LUA_ERRMEM:em,LUA_ERRERR:eb,LUA_ERRRUN:ey,LUA_ERRSYNTAX:ev,LUA_OK:ek,LUA_YIELD:eL},lua_Debug:eA,luastring_indexOf:ex,to_luastring:ew}=N(1),eT=N(18),eO=N(11),eE=N(13),{api_check:eS,lua_assert:eN,LUAI_MAXCCALLS:eU}=N(4),eI=N(6),eR=N(16),eC=N(23),eP=N(12),{luaS_newliteral:eM}=N(10),eB=N(14),{LUAI_MAXSTACK:eD}=N(3),eK=N(36),eF=N(15),{MBuffer:eV}=N(19),St=function(t,n){if(t.top<n)for(;t.top<n;)t.stack[t.top++]=new eI.TValue(eg,null);else for(;t.top>n;)delete t.stack[--t.top]},Xt=function(t,n,N){let M=t.top;for(;t.top<N+1;)t.stack[t.top++]=new eI.TValue(eg,null);switch(n){case em:eI.setsvalue2s(t,N,eM(t,"not enough memory"));break;case eb:eI.setsvalue2s(t,N,eM(t,"error in error handling"));break;default:eI.setobjs2s(t,N,M-1)}for(;t.top>N+1;)delete t.stack[--t.top]},ej=eD+200,Yt=function(t,n){eN(n<=eD||n==ej),eN(t.stack_last==t.stack.length-eP.EXTRA_STACK),t.stack.length=n,t.stack_last=n-eP.EXTRA_STACK},rt=function(t,n){let N=t.stack.length;if(N>eD)q(t,eb);else{let M=t.top+n+eP.EXTRA_STACK,es=2*N;es>eD&&(es=eD),es<M&&(es=M),es>eD?(Yt(t,ej),eO.luaG_runerror(t,ew("stack overflow",!0))):Yt(t,es)}},ot=function(t,n){t.stack_last-t.top<=n&&rt(t,n)},It=function(t){let n=function(t){let n=t.top;for(let N=t.ci;null!==N;N=N.previous)n<N.top&&(n=N.top);return eN(n<=t.stack_last),n+1}(t),N=n+Math.floor(n/8)+2*eP.EXTRA_STACK;N>eD&&(N=eD),t.stack.length>eD&&eP.luaE_freeCI(t),n<=eD-eP.EXTRA_STACK&&N<t.stack.length&&Yt(t,N)},xt=function(t,n,N){let es=t.stack[n];switch(es.type){case ep:case ed:{let ea=es.type===ep?es.value.f:es.value;ot(t,ec);let el=eP.luaE_extendCI(t);el.funcOff=n,el.nresults=N,el.func=es,el.top=t.top+ec,eN(el.top<=t.stack_last),el.callstatus=0,t.hookmask&eo&&pt(t,M,-1);let eu=ea(t);if("number"!=typeof eu||eu<0||(0|eu)!==eu)throw Error("invalid return value from JS function (expected integer)");return eT.api_checknelems(t,eu),Kt(t,el,t.top-eu,eu),!0}case e_:{let M,ea=es.value.p,el=t.top-n-1,eu=ea.maxstacksize;if(ot(t,eu),ea.is_vararg)M=w(t,ea,el);else{for(;el<ea.numparams;el++)t.stack[t.top++]=new eI.TValue(eg,null);M=n+1}let ec=eP.luaE_extendCI(t);return ec.funcOff=n,ec.nresults=N,ec.func=es,ec.l_base=M,ec.top=M+eu,St(t,ec.top),ec.l_code=ea.code,ec.l_savedpc=0,ec.callstatus=eP.CIST_LUA,t.hookmask&eo&&tt(t,ec),!1}default:return ot(t,1),S(t,n,es),xt(t,n,N)}},Kt=function(t,n,N,M){let ea=n.nresults;t.hookmask&(eu|el)&&(t.hookmask&eu&&pt(t,es,-1),t.oldpc=n.previous.l_savedpc);let eo=n.funcOff;return t.ci=n.previous,t.ci.next=null,m(t,N,eo,M,ea)},m=function(t,n,N,M,es){switch(es){case 0:break;case 1:0===M?t.stack[N].setnilvalue():eI.setobjs2s(t,N,n);break;case ef:for(let es=0;es<M;es++)eI.setobjs2s(t,N+es,n+es);for(let n=t.top;n>=N+M;n--)delete t.stack[n];return t.top=N+M,!1;default:{let ea;if(es<=M)for(ea=0;ea<es;ea++)eI.setobjs2s(t,N+ea,n+ea);else{for(ea=0;ea<M;ea++)eI.setobjs2s(t,N+ea,n+ea);for(;ea<es;ea++)N+ea>=t.top?t.stack[N+ea]=new eI.TValue(eg,null):t.stack[N+ea].setnilvalue()}}}let ea=N+es;for(let n=t.top;n>=ea;n--)delete t.stack[n];return t.top=ea,!0},pt=function(t,n,N){let M=t.hook;if(M&&t.allowhook){let es=t.ci,ea=t.top,eo=es.top,el=new eA;el.event=n,el.currentline=N,el.i_ci=es,ot(t,ec),es.top=t.top+ec,eN(es.top<=t.stack_last),t.allowhook=0,es.callstatus|=eP.CIST_HOOKED,M(t,el),eN(!t.allowhook),t.allowhook=1,es.top=eo,St(t,ea),es.callstatus&=~eP.CIST_HOOKED}},tt=function(t,n){let N=M;n.l_savedpc++,n.previous.callstatus&eP.CIST_LUA&&n.previous.l_code[n.previous.l_savedpc-1].opcode==eR.OpCodesI.OP_TAILCALL&&(n.callstatus|=eP.CIST_TAIL,N=ea),pt(t,N,-1),n.l_savedpc--},w=function(t,n,N){let M,es=n.numparams,ea=t.top-N,eo=t.top;for(M=0;M<es&&M<N;M++)eI.pushobj2s(t,t.stack[ea+M]),t.stack[ea+M].setnilvalue();for(;M<es;M++)t.stack[t.top++]=new eI.TValue(eg,null);return eo},S=function(t,n,N){let M=eB.luaT_gettmbyobj(t,N,eB.TMS.TM_CALL);M.ttisfunction(M)||eO.luaG_typeerror(t,N,ew("call",!0)),eI.pushobj2s(t,t.stack[t.top-1]);for(let N=t.top-2;N>n;N--)eI.setobjs2s(t,N,N-1);eI.setobj2s(t,n,M)},b=function(t,n,N){++t.nCcalls>=eU&&(t.nCcalls===eU?eO.luaG_runerror(t,ew("JS stack overflow",!0)):t.nCcalls>=eU+(eU>>3)&&q(t,eb)),xt(t,n,N)||eF.luaV_execute(t),t.nCcalls--},q=function(t,n){if(t.errorJmp)throw t.errorJmp.status=n,t.errorJmp;{let N=t.l_G;if(t.status=n,!N.mainthread.errorJmp){let M=N.panic;throw M&&(Xt(t,n,t.top),t.ci.top<t.top&&(t.ci.top=t.top),M(t)),Error(`Aborted ${n}`)}N.mainthread.stack[N.mainthread.top++]=t.stack[t.top-1],q(N.mainthread,n)}},st=function(t,n,N){let M=t.nCcalls,es={status:ek,previous:t.errorJmp};t.errorJmp=es;try{n(t,N)}catch(n){if(es.status===ek){let N=t.l_G.atnativeerror;if(N)try{if(es.status=ek,eT.lua_pushcfunction(t,N),eT.lua_pushlightuserdata(t,n),Te(t,t.top-2,1),0!==t.errfunc){let n=t.errfunc;eI.pushobj2s(t,t.stack[t.top-1]),eI.setobjs2s(t,t.top-2,n),Te(t,t.top-2,1)}es.status=ey}catch{es.status===ek&&(es.status=-1)}else es.status=-1}}return t.errorJmp=es.previous,t.nCcalls=M,es.status},O=function(t,n){let N=t.ci;eN(null!==N.c_k&&0===t.nny),eN(N.callstatus&eP.CIST_YPCALL||n===eL),N.callstatus&eP.CIST_YPCALL&&(N.callstatus&=~eP.CIST_YPCALL,t.errfunc=N.c_old_errfunc),N.nresults===ef&&t.ci.top<t.top&&(t.ci.top=t.top);let M=(0,N.c_k)(t,n,N.c_ctx);eT.api_checknelems(t,M),Kt(t,N,t.top-M,M)},Q=function(t,n){for(null!==n&&O(t,n);t.ci!==t.base_ci;)t.ci.callstatus&eP.CIST_LUA?(eF.luaV_finishOp(t),eF.luaV_execute(t)):O(t,eL)},lt=function(t,n){let N=function(t){for(let n=t.ci;null!==n;n=n.previous)if(n.callstatus&eP.CIST_YPCALL)return n;return null}(t);if(null===N)return 0;let M=N.extra;return eE.luaF_close(t,M),Xt(t,n,M),t.ci=N,t.allowhook=N.callstatus&eP.CIST_OAH,t.nny=0,It(t),t.errfunc=N.c_old_errfunc,1},Nt=function(t,n,N){let M=eM(t,n);if(0===N)eI.pushsvalue2s(t,M),eS(t,t.top<=t.ci.top,"stack overflow");else{for(let n=1;n<N;n++)delete t.stack[--t.top];eI.setsvalue2s(t,t.top-1,M)}return ey},Ft=function(t,n){let N=t.top-n,M=t.ci;t.status===ek?xt(t,N-1,ef)||eF.luaV_execute(t):(eN(t.status===eL),t.status=ek,M.funcOff=M.extra,M.func=t.stack[M.funcOff],M.callstatus&eP.CIST_LUA?eF.luaV_execute(t):(null!==M.c_k&&(n=M.c_k(t,eL,M.c_ctx),eT.api_checknelems(t,n),N=t.top-n),Kt(t,M,N,n)),Q(t,null))},ne=function(t,n,N,M){let es=t.ci;return eT.api_checknelems(t,n),t.nny>0&&(t!==t.l_G.mainthread?eO.luaG_runerror(t,ew("attempt to yield across a JS-call boundary",!0)):eO.luaG_runerror(t,ew("attempt to yield from outside a coroutine",!0))),t.status=eL,es.extra=es.funcOff,es.callstatus&eP.CIST_LUA?eS(t,null===M,"hooks cannot continue after yielding"):(es.c_k=M,null!==M&&(es.c_ctx=N),es.funcOff=t.top-n-1,es.func=t.stack[es.funcOff],q(t,eL)),eN(es.callstatus&eP.CIST_HOOKED),0},fe=function(t,n,N,M,es){let ea=t.ci,eo=t.allowhook,el=t.nny,eu=t.errfunc;t.errfunc=es;let ec=st(t,n,N);return ec!==ek&&(eE.luaF_close(t,M),Xt(t,ec,M),t.ci=ea,t.allowhook=eo,t.nny=el,It(t)),t.errfunc=eu,ec},Te=function(t,n,N){t.nny++,b(t,n,N),t.nny--},Oe=function(t,n,N){n&&-1===ex(n,N[0])&&(eI.luaO_pushfstring(t,ew("attempt to load a %s chunk (mode is '%s')"),N,n),q(t,ev))},Re=function(t,n){let N,M=n.z.zgetc();M===eh[0]?(Oe(t,n.mode,ew("binary",!0)),N=eK.luaU_undump(t,n.z,n.name)):(Oe(t,n.mode,ew("text",!0)),N=eC.luaY_parser(t,n.z,n.buff,n.dyd,n.name,M)),eN(N.nupvalues===N.p.upvalues.length),eE.luaF_initupvals(t,N)};t.exports.adjust_top=St,t.exports.luaD_call=b,t.exports.luaD_callnoyield=Te,t.exports.luaD_checkstack=ot,t.exports.luaD_growstack=rt,t.exports.luaD_hook=pt,t.exports.luaD_inctop=function(t){ot(t,1),t.stack[t.top++]=new eI.TValue(eg,null)},t.exports.luaD_pcall=fe,t.exports.luaD_poscall=Kt,t.exports.luaD_precall=xt,t.exports.luaD_protectedparser=function(t,n,N,M){let es=new class{constructor(t,n,N){this.z=t,this.buff=new eV,this.dyd=new eC.Dyndata,this.mode=N,this.name=n}}(n,N,M);t.nny++;let ea=fe(t,Re,es,t.top,t.errfunc);return t.nny--,ea},t.exports.luaD_rawrunprotected=st,t.exports.luaD_reallocstack=Yt,t.exports.luaD_throw=q,t.exports.lua_isyieldable=function(t){return 0===t.nny},t.exports.lua_resume=function(t,n,N){let M=t.nny;if(t.status===ek){if(t.ci!==t.base_ci)return Nt(t,"cannot resume non-suspended coroutine",N)}else if(t.status!==eL)return Nt(t,"cannot resume dead coroutine",N);if(t.nCcalls=n?n.nCcalls+1:1,t.nCcalls>=eU)return Nt(t,"JS stack overflow",N);t.nny=0,eT.api_checknelems(t,t.status===ek?N+1:N);let es=st(t,Ft,N);if(-1===es)es=ey;else{for(;es>eL&&lt(t,es);)es=st(t,Q,es);es>eL?(t.status=es,Xt(t,es,t.top),t.ci.top=t.top):eN(es===t.status)}return t.nny=M,t.nCcalls--,eN(t.nCcalls===(n?n.nCcalls:0)),es},t.exports.lua_yield=function(t,n){ne(t,n,0,null)},t.exports.lua_yieldk=ne},function(t,n,N){let{constant_types:{LUA_TBOOLEAN:M,LUA_TCCL:es,LUA_TLCF:ea,LUA_TLCL:eo,LUA_TLIGHTUSERDATA:el,LUA_TLNGSTR:eu,LUA_TNIL:ec,LUA_TNUMFLT:ef,LUA_TNUMINT:eh,LUA_TSHRSTR:ep,LUA_TTABLE:ed,LUA_TTHREAD:e_,LUA_TUSERDATA:eg},to_luastring:em}=N(1),{lua_assert:eb}=N(4),ey=N(11),ev=N(6),{luaS_hashlongstr:ek,TString:eL}=N(10),eA=N(12),ex=new WeakMap,X=function(t){let n=ex.get(t);return n||(n={},ex.set(t,n)),n},z=function(t,n){switch(n.type){case ec:return ey.luaG_runerror(t,em("table index is nil",!0));case ef:if(isNaN(n.value))return ey.luaG_runerror(t,em("table index is NaN",!0));case eh:case M:case ed:case eo:case ea:case es:case eg:case e_:return n.value;case ep:case eu:return ek(n.tsvalue());case el:{let N=n.value;switch(typeof N){case"string":return"*"+N;case"number":return"#"+N;case"boolean":return N?"?true":"?false";case"function":return X(N);case"object":if(N instanceof eA.lua_State&&N.l_G===t.l_G||N instanceof Y||N instanceof ev.Udata||N instanceof ev.LClosure||N instanceof ev.CClosure)return X(N);default:return N}}default:throw Error("unknown key type: "+n.type)}};let Y=class Y{constructor(t){this.id=t.l_G.id_counter++,this.strong=new Map,this.dead_strong=new Map,this.dead_weak=void 0,this.f=void 0,this.l=void 0,this.metatable=null,this.flags=-1}};let ut=function(t,n,N,M){t.dead_strong.clear(),t.dead_weak=void 0;let es=null,ea={key:N,value:M,p:es=t.l,n:void 0};t.f||(t.f=ea),es&&(es.n=ea),t.strong.set(n,ea),t.l=ea},G=function(t,n){let N=t.strong.get(n);if(N){N.key.setdeadvalue(),N.value=void 0;let M=N.n,es=N.p;N.p=void 0,es&&(es.n=M),M&&(M.p=es),t.f===N&&(t.f=M),t.l===N&&(t.l=es),t.strong.delete(n),("object"==typeof n?null!==n:"function"==typeof n)?(t.dead_weak||(t.dead_weak=new WeakMap),t.dead_weak.set(n,N)):t.dead_strong.set(n,N)}},it=function(t,n){let N=t.strong.get(n);return N?N.value:ev.luaO_nilobject},k=function(t,n){return eb("number"==typeof n&&(0|n)===n),it(t,n)};t.exports.invalidateTMcache=function(t){t.flags=0},t.exports.luaH_get=function(t,n,N){return eb(N instanceof ev.TValue),N.ttisnil()||N.ttisfloat()&&isNaN(N.value)?ev.luaO_nilobject:it(n,z(t,N))},t.exports.luaH_getint=k,t.exports.luaH_getn=function(t){let n=0,N=t.strong.size+1;for(;N-n>1;){let M=Math.floor((n+N)/2);k(t,M).ttisnil()?N=M:n=M}return n},t.exports.luaH_getstr=function(t,n){return eb(n instanceof eL),it(t,ek(n))},t.exports.luaH_setfrom=function(t,n,N,M){eb(N instanceof ev.TValue);let es=z(t,N);if(M.ttisnil())return void G(n,es);let ea=n.strong.get(es);if(ea)ea.value.setfrom(M);else{let t=N.value;ut(n,es,N.ttisfloat()&&(0|t)===t?new ev.TValue(eh,t):new ev.TValue(N.type,t),new ev.TValue(M.type,M.value))}},t.exports.luaH_setint=function(t,n,N){if(eb("number"==typeof n&&(0|n)===n&&N instanceof ev.TValue),N.ttisnil())return void G(t,n);let M=t.strong.get(n);if(M)M.value.setfrom(N);else{let M=new ev.TValue(eh,n);ut(t,n,M,new ev.TValue(N.type,N.value))}},t.exports.luaH_new=function(t){return new Y(t)},t.exports.luaH_next=function(t,n,N){let M,es=t.stack[N];if(es.type===ec){if(!(M=n.f))return!1}else{let N=z(t,es);if(M=n.strong.get(N)){if(!(M=M.n))return!1}else{if(!(M=n.dead_weak&&n.dead_weak.get(N)||n.dead_strong.get(N)))return ey.luaG_runerror(t,em("invalid key to 'next'"));do if(!(M=M.n))return!1;while(M.key.ttisdeadkey())}}return ev.setobj2s(t,N,M.key),ev.setobj2s(t,N+1,M.value),!0},t.exports.Table=Y},function(t,n,N){let{is_luastring:M,luastring_eq:es,luastring_from:ea,to_luastring:eo}=N(1),{lua_assert:el}=N(4);let c=class c{constructor(t,n){this.hash=null,this.realstring=n}getstr(){return this.realstring}tsslen(){return this.realstring.length}};let p=function(t){el(M(t));let n=t.length,N="|";for(let M=0;M<n;M++)N+=t[M].toString(16);return N},T=function(t,n){return el(n instanceof Uint8Array),new c(t,n)};t.exports.luaS_eqlngstr=function(t,n){return el(t instanceof c),el(n instanceof c),t==n||es(t.realstring,n.realstring)},t.exports.luaS_hash=p,t.exports.luaS_hashlongstr=function(t){return el(t instanceof c),null===t.hash&&(t.hash=p(t.getstr())),t.hash},t.exports.luaS_bless=T,t.exports.luaS_new=function(t,n){return T(t,ea(n))},t.exports.luaS_newliteral=function(t,n){return T(t,eo(n))},t.exports.TString=c},function(t,n,N){let{LUA_HOOKCOUNT:M,LUA_HOOKLINE:es,LUA_MASKCOUNT:ea,LUA_MASKLINE:eo,constant_types:{LUA_TBOOLEAN:el,LUA_TNIL:eu,LUA_TTABLE:ec},thread_status:{LUA_ERRRUN:ef,LUA_YIELD:eh},from_userstring:ep,luastring_eq:ed,luastring_indexOf:e_,to_luastring:eg}=N(1),{api_check:em,lua_assert:eb}=N(4),{LUA_IDSIZE:ey}=N(3),ev=N(18),ek=N(8),eL=N(13),eA=N(20),ex=N(6),ew=N(16),eT=N(12),eO=N(9),eE=N(14),eS=N(15),it=function(t){return eb(t.callstatus&eT.CIST_LUA),t.l_savedpc-1},k=function(t){return 0!==t.func.value.p.lineinfo.length?t.func.value.p.lineinfo[it(t)]:-1},$=function(t){if(t.status===eh){let n=t.ci,N=n.funcOff;n.func=t.stack[n.extra],n.funcOff=n.extra,n.extra=N}},ft=function(t,n){eb(n<t.upvalues.length);let N=t.upvalues[n].name;return null===N?eg("?",!0):N.getstr()},ht=function(t,n,N){let M,es=null;if(n.callstatus&eT.CIST_LUA){if(N<0){var ea;let t;return ea=-N,t=n.func.value.p.numparams,ea>=n.l_base-n.funcOff-t?null:{pos:n.funcOff+t+ea,name:eg("(*vararg)",!0)}}M=n.l_base,es=eL.luaF_getlocalname(n.func.value.p,N,it(n))}else M=n.funcOff+1;if(null===es){if(!((n===t.ci?t.top:n.next.funcOff)-M>=N&&N>0))return null;es=eg("(*temporary)",!0)}return{pos:M+(N-1),name:es}},dt=function(t,n){if(null===n||n instanceof ex.CClosure)t.source=eg("=[JS]",!0),t.linedefined=-1,t.lastlinedefined=-1,t.what=eg("J",!0);else{let N=n.p;t.source=N.source?N.source.getstr():eg("=?",!0),t.linedefined=N.linedefined,t.lastlinedefined=N.lastlinedefined,t.what=0===t.linedefined?eg("main",!0):eg("Lua",!0)}t.short_src=ex.luaO_chunkid(t.source,ey)},mt=function(t,n){let N={name:null,funcname:null};return null===n?null:n.callstatus&eT.CIST_FIN?(N.name=eg("__gc",!0),N.funcname=eg("metamethod",!0),N):!(n.callstatus&eT.CIST_TAIL)&&n.previous.callstatus&eT.CIST_LUA?gt(t,n.previous):null},V=function(t,n,N){let M={name:null,funcname:null};if(ew.ISK(N)){let n=t.k[ew.INDEXK(N)];if(n.ttisstring())return M.name=n.svalue(),M}else{let M=P(t,n,N);if(M&&99===M.funcname[0])return M}return M.name=eg("?",!0),M},U=function(t,n){return t<n?-1:t},P=function(t,n,N){let M={name:eL.luaF_getlocalname(t,N+1,n),funcname:null};if(M.name)return M.funcname=eg("local",!0),M;let es=function(t,n,N){let M=-1,es=0,ea=ew.OpCodesI;for(let eo=0;eo<n;eo++){let el=t.code[eo],eu=el.A;switch(el.opcode){case ea.OP_LOADNIL:{let t=el.B;eu<=N&&N<=eu+t&&(M=U(eo,es));break}case ea.OP_TFORCALL:N>=eu+2&&(M=U(eo,es));break;case ea.OP_CALL:case ea.OP_TAILCALL:N>=eu&&(M=U(eo,es));break;case ea.OP_JMP:{let t=eo+1+el.sBx;eo<t&&t<=n&&t>es&&(es=t);break}default:ew.testAMode(el.opcode)&&N===eu&&(M=U(eo,es))}}return M}(t,n,N),ea=ew.OpCodesI;if(-1!==es){let n=t.code[es];switch(n.opcode){case ea.OP_MOVE:{let N=n.B;if(N<n.A)return P(t,es,N);break}case ea.OP_GETTABUP:case ea.OP_GETTABLE:{let N=n.C,eo=n.B,el=n.opcode===ea.OP_GETTABLE?eL.luaF_getlocalname(t,eo+1,es):ft(t,eo);return M.name=V(t,es,N).name,M.funcname=el&&ed(el,eA.LUA_ENV)?eg("global",!0):eg("field",!0),M}case ea.OP_GETUPVAL:return M.name=ft(t,n.B),M.funcname=eg("upvalue",!0),M;case ea.OP_LOADK:case ea.OP_LOADKX:{let N=n.opcode===ea.OP_LOADK?n.Bx:t.code[es+1].Ax;if(t.k[N].ttisstring())return M.name=t.k[N].svalue(),M.funcname=eg("constant",!0),M;break}case ea.OP_SELF:{let N=n.C;return M.name=V(t,es,N).name,M.funcname=eg("method",!0),M}}}return null},gt=function(t,n){let N={name:null,funcname:null},M=0,es=n.func.value.p,ea=it(n),eo=es.code[ea],el=ew.OpCodesI;if(n.callstatus&eT.CIST_HOOKED)return N.name=eg("?",!0),N.funcname=eg("hook",!0),N;switch(eo.opcode){case el.OP_CALL:case el.OP_TAILCALL:return P(es,ea,eo.A);case el.OP_TFORCALL:return N.name=eg("for iterator",!0),N.funcname=eg("for iterator",!0),N;case el.OP_SELF:case el.OP_GETTABUP:case el.OP_GETTABLE:M=eE.TMS.TM_INDEX;break;case el.OP_SETTABUP:case el.OP_SETTABLE:M=eE.TMS.TM_NEWINDEX;break;case el.OP_ADD:M=eE.TMS.TM_ADD;break;case el.OP_SUB:M=eE.TMS.TM_SUB;break;case el.OP_MUL:M=eE.TMS.TM_MUL;break;case el.OP_MOD:M=eE.TMS.TM_MOD;break;case el.OP_POW:M=eE.TMS.TM_POW;break;case el.OP_DIV:M=eE.TMS.TM_DIV;break;case el.OP_IDIV:M=eE.TMS.TM_IDIV;break;case el.OP_BAND:M=eE.TMS.TM_BAND;break;case el.OP_BOR:M=eE.TMS.TM_BOR;break;case el.OP_BXOR:M=eE.TMS.TM_BXOR;break;case el.OP_SHL:M=eE.TMS.TM_SHL;break;case el.OP_SHR:M=eE.TMS.TM_SHR;break;case el.OP_UNM:M=eE.TMS.TM_UNM;break;case el.OP_BNOT:M=eE.TMS.TM_BNOT;break;case el.OP_LEN:M=eE.TMS.TM_LEN;break;case el.OP_CONCAT:M=eE.TMS.TM_CONCAT;break;case el.OP_EQ:M=eE.TMS.TM_EQ;break;case el.OP_LT:M=eE.TMS.TM_LT;break;case el.OP_LE:M=eE.TMS.TM_LE;break;default:return null}return N.name=t.l_G.tmname[M].getstr(),N.funcname=eg("metamethod",!0),N},_t=function(t,n){let N=t.ci,M=null;if(N.callstatus&eT.CIST_LUA){M=function(t,n,N){let M=n.func.value;for(let t=0;t<M.nupvalues;t++)if(M.upvals[t]===N)return{name:ft(M.p,t),funcname:eg("upvalue",!0)};return null}(0,N,n);let es=function(t,n,N){for(let M=n.l_base;M<n.top;M++)if(t.stack[M]===N)return M;return!1}(t,N,n);!M&&es&&(M=P(N.func.value.p,it(N),es-N.l_base))}return M?ex.luaO_pushfstring(t,eg(" (%s '%s')",!0),M.funcname,M.name):eg("",!0)},St=function(t,n,N){let M=eE.luaT_objtypename(t,n);ee(t,eg("attempt to %s a %s value%s",!0),N,M,_t(t,n))},Xt=function(t,n,N,M){let es;return es=N?ex.luaO_chunkid(N.getstr(),ey):eg("?",!0),ex.luaO_pushfstring(t,eg("%s:%d: %s",!0),es,M,n)},ee=function(t,n,...N){let M=t.ci,es=ex.luaO_pushvfstring(t,n,N);M.callstatus&eT.CIST_LUA&&Xt(t,es,M.func.value.p.source,k(M)),Yt(t)},Yt=function(t){if(0!==t.errfunc){let n=t.errfunc;ex.pushobj2s(t,t.stack[t.top-1]),ex.setobjs2s(t,t.top-2,n),ek.luaD_callnoyield(t,t.top-2,1)}ek.luaD_throw(t,ef)};t.exports.luaG_addinfo=Xt,t.exports.luaG_concaterror=function(t,n,N){(n.ttisstring()||eS.cvt2str(n))&&(n=N),St(t,n,eg("concatenate",!0))},t.exports.luaG_errormsg=Yt,t.exports.luaG_opinterror=function(t,n,N,M){!1===eS.tonumber(n)&&(N=n),St(t,N,M)},t.exports.luaG_ordererror=function(t,n,N){let M=eE.luaT_objtypename(t,n),es=eE.luaT_objtypename(t,N);ed(M,es)?ee(t,eg("attempt to compare two %s values",!0),M):ee(t,eg("attempt to compare %s with %s",!0),M,es)},t.exports.luaG_runerror=ee,t.exports.luaG_tointerror=function(t,n,N){!1===eS.tointeger(n)&&(N=n),ee(t,eg("number%s has no integer representation",!0),_t(t,N))},t.exports.luaG_traceexec=function(t){let n=t.ci,N=t.hookmask,el=0==--t.hookcount&&N&ea;if(el)t.hookcount=t.basehookcount;else if(!(N&eo))return;if(n.callstatus&eT.CIST_HOOKYIELD)n.callstatus&=~eT.CIST_HOOKYIELD;else{if(el&&ek.luaD_hook(t,M,-1),N&eo){let N=n.func.value.p,M=n.l_savedpc-1,ea=0!==N.lineinfo.length?N.lineinfo[M]:-1;(0===M||n.l_savedpc<=t.oldpc||ea!==(0!==N.lineinfo.length?N.lineinfo[t.oldpc-1]:-1))&&ek.luaD_hook(t,es,ea)}t.oldpc=n.l_savedpc,t.status===eh&&(el&&(t.hookcount=1),n.l_savedpc--,n.callstatus|=eT.CIST_HOOKYIELD,n.funcOff=t.top-1,n.func=t.stack[n.funcOff],ek.luaD_throw(t,eh))}},t.exports.luaG_typeerror=St,t.exports.lua_gethook=function(t){return t.hook},t.exports.lua_gethookcount=function(t){return t.basehookcount},t.exports.lua_gethookmask=function(t){return t.hookmask},t.exports.lua_getinfo=function(t,n,N){let M,es,ea,eo;return n=ep(n),$(t),62===n[0]?(ea=null,eo=t.stack[t.top-1],em(t,eo.ttisfunction(),"function expected"),n=n.subarray(1),t.top--):(eo=(ea=N.i_ci).func,eb(ea.func.ttisfunction())),M=function(t,n,N,M,es){let ea=1;for(;n.length>0;n=n.subarray(1))switch(n[0]){case 83:dt(N,M);break;case 108:N.currentline=es&&es.callstatus&eT.CIST_LUA?k(es):-1;break;case 117:N.nups=null===M?0:M.nupvalues,null===M||M instanceof ex.CClosure?(N.isvararg=!0,N.nparams=0):(N.isvararg=M.p.is_vararg,N.nparams=M.p.numparams);break;case 116:N.istailcall=es?es.callstatus&eT.CIST_TAIL:0;break;case 110:{let n=mt(t,es);null===n?(N.namewhat=eg("",!0),N.name=null):(N.namewhat=n.funcname,N.name=n.name);break}case 76:case 102:break;default:ea=0}return ea}(t,n,N,es=eo.ttisclosure()?eo.value:null,ea),e_(n,102)>=0&&(ex.pushobj2s(t,eo),em(t,t.top<=t.ci.top,"stack overflow")),$(t),e_(n,76)>=0&&function(t,n){if(null===n||n instanceof ex.CClosure)t.stack[t.top]=new ex.TValue(eu,null),ev.api_incr_top(t);else{let N=n.p.lineinfo,M=eO.luaH_new(t);t.stack[t.top]=new ex.TValue(ec,M),ev.api_incr_top(t);let es=new ex.TValue(el,!0);for(let t=0;t<N.length;t++)eO.luaH_setint(M,N[t],es)}}(t,es),M},t.exports.lua_getlocal=function(t,n,N){let M;if($(t),null===n)M=t.stack[t.top-1].ttisLclosure()?eL.luaF_getlocalname(t.stack[t.top-1].value.p,N,0):null;else{let es=ht(t,n.i_ci,N);es?(M=es.name,ex.pushobj2s(t,t.stack[es.pos]),em(t,t.top<=t.ci.top,"stack overflow")):M=null}return $(t),M},t.exports.lua_getstack=function(t,n,N){let M,es;if(n<0)return 0;for(M=t.ci;n>0&&M!==t.base_ci;M=M.previous)n--;return 0===n&&M!==t.base_ci?(es=1,N.i_ci=M):es=0,es},t.exports.lua_sethook=function(t,n,N,M){null!==n&&0!==N||(N=0,n=null),t.ci.callstatus&eT.CIST_LUA&&(t.oldpc=t.ci.l_savedpc),t.hook=n,t.basehookcount=M,t.hookcount=t.basehookcount,t.hookmask=N},t.exports.lua_setlocal=function(t,n,N){let M;$(t);let es=ht(t,n.i_ci,N);return es?(M=es.name,ex.setobjs2s(t,es.pos,t.top-1),delete t.stack[--t.top]):M=null,$(t),M}},function(t,n,N){let{LUA_MINSTACK:M,LUA_RIDX_GLOBALS:es,LUA_RIDX_MAINTHREAD:ea,constant_types:{LUA_NUMTAGS:eo,LUA_TNIL:el,LUA_TTABLE:eu,LUA_TTHREAD:ec},thread_status:{LUA_OK:ef}}=N(1),eh=N(6),ep=N(8),ed=N(18),e_=N(9),eg=N(14),em=2*M;let v=class v{constructor(){this.func=null,this.funcOff=NaN,this.top=NaN,this.previous=null,this.next=null,this.l_base=NaN,this.l_code=null,this.l_savedpc=NaN,this.c_k=null,this.c_old_errfunc=null,this.c_ctx=null,this.nresults=NaN,this.callstatus=NaN}};let R=class R{constructor(t){this.id=t.id_counter++,this.base_ci=new v,this.top=NaN,this.stack_last=NaN,this.oldpc=NaN,this.l_G=t,this.stack=null,this.ci=null,this.errorJmp=null,this.nCcalls=0,this.hook=null,this.hookmask=0,this.basehookcount=0,this.allowhook=1,this.hookcount=this.basehookcount,this.nny=1,this.status=ef,this.errfunc=0}};let B=function(t){t.ci.next=null},j=function(t,n){t.stack=Array(em),t.top=0,t.stack_last=em-5;let N=t.base_ci;N.next=N.previous=null,N.callstatus=0,N.funcOff=t.top,N.func=t.stack[t.top],t.stack[t.top++]=new eh.TValue(el,null),N.top=t.top+M,t.ci=N},F=function(t){t.ci=t.base_ci,B(t),t.stack=null},Z=function(t){let n,N=t.l_G;j(t),n=e_.luaH_new(t),N.l_registry.sethvalue(n),e_.luaH_setint(n,ea,new eh.TValue(ec,t)),e_.luaH_setint(n,es,new eh.TValue(eu,e_.luaH_new(t))),eg.luaT_init(t),N.version=ed.lua_version(null)};t.exports.lua_State=R,t.exports.CallInfo=v,t.exports.CIST_OAH=1,t.exports.CIST_LUA=2,t.exports.CIST_HOOKED=4,t.exports.CIST_FRESH=8,t.exports.CIST_YPCALL=16,t.exports.CIST_TAIL=32,t.exports.CIST_HOOKYIELD=64,t.exports.CIST_LEQ=128,t.exports.CIST_FIN=256,t.exports.EXTRA_STACK=5,t.exports.lua_close=function(t){F(t=t.l_G.mainthread)},t.exports.lua_newstate=function(){let t=new class{constructor(){this.id_counter=1,this.ids=new WeakMap,this.mainthread=null,this.l_registry=new eh.TValue(el,null),this.panic=null,this.atnativeerror=null,this.version=null,this.tmname=Array(eg.TMS.TM_N),this.mt=Array(eo)}},n=new R(t);return t.mainthread=n,ep.luaD_rawrunprotected(n,Z,null)!==ef&&(n=null),n},t.exports.lua_newthread=function(t){let n=t.l_G,N=new R(n);return t.stack[t.top]=new eh.TValue(ec,N),ed.api_incr_top(t),N.hookmask=t.hookmask,N.basehookcount=t.basehookcount,N.hook=t.hook,N.hookcount=N.basehookcount,j(N),N},t.exports.luaE_extendCI=function(t){let n=new v;return t.ci.next=n,n.previous=t.ci,n.next=null,t.ci=n,n},t.exports.luaE_freeCI=B,t.exports.luaE_freethread=function(t,n){F(n)}},function(t,n,N){let{constant_types:{LUA_TNIL:M}}=N(1),es=N(6);t.exports.MAXUPVAL=255,t.exports.Proto=class{constructor(t){this.id=t.l_G.id_counter++,this.k=[],this.p=[],this.code=[],this.cache=null,this.lineinfo=[],this.upvalues=[],this.numparams=0,this.is_vararg=!1,this.maxstacksize=0,this.locvars=[],this.linedefined=0,this.lastlinedefined=0,this.source=null}},t.exports.luaF_findupval=function(t,n){return t.stack[n]},t.exports.luaF_close=function(t,n){for(let N=n;N<t.top;N++){let n=t.stack[N];t.stack[N]=new es.TValue(n.type,n.value)}},t.exports.luaF_getlocalname=function(t,n,N){for(let M=0;M<t.locvars.length&&t.locvars[M].startpc<=N;M++)if(N<t.locvars[M].endpc&&0==--n)return t.locvars[M].varname.getstr();return null},t.exports.luaF_initupvals=function(t,n){for(let t=0;t<n.nupvalues;t++)n.upvals[t]=new es.TValue(M,null)},t.exports.luaF_newLclosure=function(t,n){return new es.LClosure(t,n)}},function(t,n,N){let{constant_types:{LUA_TTABLE:M,LUA_TUSERDATA:es},to_luastring:ea}=N(1),{lua_assert:eo}=N(4),el=N(6),eu=N(8),ec=N(12),{luaS_bless:ef,luaS_new:eh}=N(10),ep=N(9),ed=N(11),e_=N(15),eg=["no value","nil","boolean","userdata","number","string","table","function","userdata","thread","proto"].map(t=>ea(t)),g=function(t){return eg[t+1]},em={TM_INDEX:0,TM_NEWINDEX:1,TM_GC:2,TM_MODE:3,TM_LEN:4,TM_EQ:5,TM_ADD:6,TM_SUB:7,TM_MUL:8,TM_MOD:9,TM_POW:10,TM_DIV:11,TM_IDIV:12,TM_BAND:13,TM_BOR:14,TM_BXOR:15,TM_SHL:16,TM_SHR:17,TM_UNM:18,TM_BNOT:19,TM_LT:20,TM_LE:21,TM_CONCAT:22,TM_CALL:23,TM_N:24},eb=ea("__name",!0),B=function(t,n,N,M,es,ea){let eo=t.top;if(el.pushobj2s(t,n),el.pushobj2s(t,N),el.pushobj2s(t,M),ea||el.pushobj2s(t,es),t.ci.callstatus&ec.CIST_LUA?eu.luaD_call(t,eo,ea):eu.luaD_callnoyield(t,eo,ea),ea){let n=t.stack[t.top-1];delete t.stack[--t.top],es.setfrom(n)}},j=function(t,n,N,M,es){let ea=Z(t,n,es);return ea.ttisnil()&&(ea=Z(t,N,es)),!ea.ttisnil()&&(B(t,ea,n,N,M,1),!0)},F=function(t,n,N){let M=ep.luaH_getstr(t,N);return eo(n<=em.TM_EQ),M.ttisnil()?(t.flags|=1<<n,null):M},Z=function(t,n,N){let ea;switch(n.ttnov()){case M:case es:ea=n.value.metatable;break;default:ea=t.l_G.mt[n.ttnov()]}return ea?ep.luaH_getstr(ea,t.l_G.tmname[N]):el.luaO_nilobject};t.exports.fasttm=function(t,n,N){return null===n||n.flags&1<<N?null:F(n,N,t.l_G.tmname[N])},t.exports.TMS=em,t.exports.luaT_callTM=B,t.exports.luaT_callbinTM=j,t.exports.luaT_trybinTM=function(t,n,N,M,es){if(!j(t,n,N,M,es))switch(es){case em.TM_CONCAT:return ed.luaG_concaterror(t,n,N);case em.TM_BAND:case em.TM_BOR:case em.TM_BXOR:case em.TM_SHL:case em.TM_SHR:case em.TM_BNOT:{let M=e_.tonumber(n),es=e_.tonumber(N);return!1!==M&&!1!==es?ed.luaG_tointerror(t,n,N):ed.luaG_opinterror(t,n,N,ea("perform bitwise operation on",!0))}default:return ed.luaG_opinterror(t,n,N,ea("perform arithmetic on",!0))}},t.exports.luaT_callorderTM=function(t,n,N,M){let es=new el.TValue;return j(t,n,N,es,M)?!es.l_isfalse():null},t.exports.luaT_gettm=F,t.exports.luaT_gettmbyobj=Z,t.exports.luaT_init=function(t){t.l_G.tmname[em.TM_INDEX]=new eh(t,ea("__index",!0)),t.l_G.tmname[em.TM_NEWINDEX]=new eh(t,ea("__newindex",!0)),t.l_G.tmname[em.TM_GC]=new eh(t,ea("__gc",!0)),t.l_G.tmname[em.TM_MODE]=new eh(t,ea("__mode",!0)),t.l_G.tmname[em.TM_LEN]=new eh(t,ea("__len",!0)),t.l_G.tmname[em.TM_EQ]=new eh(t,ea("__eq",!0)),t.l_G.tmname[em.TM_ADD]=new eh(t,ea("__add",!0)),t.l_G.tmname[em.TM_SUB]=new eh(t,ea("__sub",!0)),t.l_G.tmname[em.TM_MUL]=new eh(t,ea("__mul",!0)),t.l_G.tmname[em.TM_MOD]=new eh(t,ea("__mod",!0)),t.l_G.tmname[em.TM_POW]=new eh(t,ea("__pow",!0)),t.l_G.tmname[em.TM_DIV]=new eh(t,ea("__div",!0)),t.l_G.tmname[em.TM_IDIV]=new eh(t,ea("__idiv",!0)),t.l_G.tmname[em.TM_BAND]=new eh(t,ea("__band",!0)),t.l_G.tmname[em.TM_BOR]=new eh(t,ea("__bor",!0)),t.l_G.tmname[em.TM_BXOR]=new eh(t,ea("__bxor",!0)),t.l_G.tmname[em.TM_SHL]=new eh(t,ea("__shl",!0)),t.l_G.tmname[em.TM_SHR]=new eh(t,ea("__shr",!0)),t.l_G.tmname[em.TM_UNM]=new eh(t,ea("__unm",!0)),t.l_G.tmname[em.TM_BNOT]=new eh(t,ea("__bnot",!0)),t.l_G.tmname[em.TM_LT]=new eh(t,ea("__lt",!0)),t.l_G.tmname[em.TM_LE]=new eh(t,ea("__le",!0)),t.l_G.tmname[em.TM_CONCAT]=new eh(t,ea("__concat",!0)),t.l_G.tmname[em.TM_CALL]=new eh(t,ea("__call",!0))},t.exports.luaT_objtypename=function(t,n){let N;if(n.ttistable()&&null!==(N=n.value.metatable)||n.ttisfulluserdata()&&null!==(N=n.value.metatable)){let n=ep.luaH_getstr(N,ef(t,eb));if(n.ttisstring())return n.svalue()}return g(n.ttnov())},t.exports.ttypename=g},function(t,n,N){let{LUA_MASKLINE:M,LUA_MASKCOUNT:es,LUA_MULTRET:ea,constant_types:{LUA_TBOOLEAN:eo,LUA_TLCF:el,LUA_TLIGHTUSERDATA:eu,LUA_TLNGSTR:ec,LUA_TNIL:ef,LUA_TNUMBER:eh,LUA_TNUMFLT:ep,LUA_TNUMINT:ed,LUA_TSHRSTR:e_,LUA_TTABLE:eg,LUA_TUSERDATA:em},to_luastring:eb}=N(1),{INDEXK:ey,ISK:ev,LFIELDS_PER_FLUSH:ek,OpCodesI:{OP_ADD:eL,OP_BAND:eA,OP_BNOT:ex,OP_BOR:ew,OP_BXOR:eT,OP_CALL:eO,OP_CLOSURE:eE,OP_CONCAT:eS,OP_DIV:eN,OP_EQ:eU,OP_EXTRAARG:eI,OP_FORLOOP:eR,OP_FORPREP:eC,OP_GETTABLE:eP,OP_GETTABUP:eM,OP_GETUPVAL:eB,OP_IDIV:eD,OP_JMP:eK,OP_LE:eF,OP_LEN:eV,OP_LOADBOOL:ej,OP_LOADK:eG,OP_LOADKX:ez,OP_LOADNIL:eH,OP_LT:eX,OP_MOD:e$,OP_MOVE:eW,OP_MUL:eq,OP_NEWTABLE:eZ,OP_NOT:eY,OP_POW:eJ,OP_RETURN:eQ,OP_SELF:e1,OP_SETLIST:e0,OP_SETTABLE:e2,OP_SETTABUP:e3,OP_SETUPVAL:e5,OP_SHL:e4,OP_SHR:e8,OP_SUB:e6,OP_TAILCALL:e9,OP_TEST:e7,OP_TESTSET:ta,OP_TFORCALL:to,OP_TFORLOOP:tl,OP_UNM:tu,OP_VARARG:tc}}=N(16),{LUA_MAXINTEGER:tf,LUA_MININTEGER:th,lua_numbertointeger:tp}=N(3),{lua_assert:td,luai_nummod:t_}=N(4),tg=N(6),tm=N(13),tb=N(12),{luaS_bless:ty,luaS_eqlngstr:tv,luaS_hashlongstr:tk}=N(10),tL=N(8),tA=N(14),tx=N(9),tw=N(11),u=function(t,n,N){return n+N.A},A=function(t,n,N){return n+N.B},h=function(t,n,N,M){return ev(M.B)?N[ey(M.B)]:t.stack[n+M.B]},x=function(t,n,N,M){return ev(M.C)?N[ey(M.C)]:t.stack[n+M.C]},H=function(t,n,N,M){let es=N.A;0!==es&&tm.luaF_close(t,n.l_base+es-1),n.l_savedpc+=N.sBx+M},I=function(t,n){H(t,n,n.l_code[n.l_savedpc],1)},ct=function(t,n,N){if(n.ttisnumber()&&N.ttisnumber())return W(n,N)?1:0;if(n.ttisstring()&&N.ttisstring())return 0>bt(n.tsvalue(),N.tsvalue())?1:0;{let M=tA.luaT_callorderTM(t,n,N,tA.TMS.TM_LT);return null===M&&tw.luaG_ordererror(t,n,N),M?1:0}},Vt=function(t,n,N){let M;return n.ttisnumber()&&N.ttisnumber()?Rt(n,N)?1:0:n.ttisstring()&&N.ttisstring()?0>=bt(n.tsvalue(),N.tsvalue())?1:0:null!==(M=tA.luaT_callorderTM(t,n,N,tA.TMS.TM_LE))?M?1:0:(t.ci.callstatus|=tb.CIST_LEQ,M=tA.luaT_callorderTM(t,N,n,tA.TMS.TM_LT),t.ci.callstatus^=tb.CIST_LEQ,null===M&&tw.luaG_ordererror(t,n,N),M?0:1)},Jt=function(t,n,N){let M;if(n.ttype()!==N.ttype())return n.ttnov()!==N.ttnov()||n.ttnov()!==eh?0:n.value===N.value?1:0;switch(n.ttype()){case ef:return 1;case eo:return n.value==N.value?1:0;case eu:case ed:case ep:case el:return n.value===N.value?1:0;case e_:case ec:return tv(n.tsvalue(),N.tsvalue())?1:0;case em:case eg:if(n.value===N.value)return 1;if(null===t)return 0;null===(M=tA.fasttm(t,n.value.metatable,tA.TMS.TM_EQ))&&(M=tA.fasttm(t,N.value.metatable,tA.TMS.TM_EQ));break;default:return n.value===N.value?1:0}if(null===M)return 0;let es=new tg.TValue;return tA.luaT_callTM(t,M,n,N,es,1),es.l_isfalse()?0:1},ve=function(t,n){let N=!1,M=ke(t,n<0?2:1);if(!1===M){let es=zt(t);if(!1===es)return!1;0<es?(M=tf,n<0&&(N=!0)):(M=th,n>=0&&(N=!0))}return{stopnow:N,ilimit:M}},ke=function(t,n){if(t.ttisfloat()){let N=t.value,M=Math.floor(N);if(N!==M){if(0===n)return!1;n>1&&(M+=1)}return tp(M)}if(t.ttisinteger())return t.value;if(Ae(t)){let N=new tg.TValue;if(tg.luaO_str2num(t.svalue(),N)===t.vslen()+1)return ke(N,n)}return!1},vt=function(t){return t.ttisinteger()?t.value:ke(t,0)},zt=function(t){if(t.ttnov()===eh)return t.value;if(Ae(t)){let n=new tg.TValue;if(tg.luaO_str2num(t.svalue(),n)===t.vslen()+1)return n.value}return!1},W=function(t,n){return t.value<n.value},Rt=function(t,n){return t.value<=n.value},bt=function(t,n){let N=tk(t),M=tk(n);return N===M?0:N<M?-1:1},Zt=function(t,n,N){let M;switch(N.ttype()){case eg:{let es=N.value;if(null!==(M=tA.fasttm(t,es.metatable,tA.TMS.TM_LEN)))break;return void n.setivalue(tx.luaH_getn(es))}case e_:case ec:return void n.setivalue(N.vslen());default:(M=tA.luaT_gettmbyobj(t,N,tA.TMS.TM_LEN)).ttisnil()&&tw.luaG_typeerror(t,N,eb("get length of",!0))}tA.luaT_callTM(t,M,N,N,n,1)},tT=Math.imul||function(t,n){let N=65535&t,M=65535&n;return N*M+((t>>>16&65535)*M+N*(n>>>16&65535)<<16>>>0)|0},pe=function(t,n,N){return 0===N&&tw.luaG_runerror(t,eb("attempt to divide by zero")),0|Math.floor(n/N)},ue=function(t,n,N){return 0===N&&tw.luaG_runerror(t,eb("attempt to perform 'n%%0'")),n-Math.floor(n/N)*N|0},xe=function(t,n){return n<0?n<=-32?0:t>>>-n:n>=32?0:t<<n},Ke=function(t,n,N,M){let es=t.cache;if(null!==es){let ea=t.upvalues,eo=ea.length;for(let t=0;t<eo;t++){let eo=ea[t].instack?N[M+ea[t].idx]:n[ea[t].idx];if(es.upvals[t]!==eo)return null}}return es},me=function(t,n,N,M,es){let ea=n.upvalues.length,eo=n.upvalues,el=new tg.LClosure(t,ea);el.p=n,t.stack[es].setclLvalue(el);for(let n=0;n<ea;n++)eo[n].instack?el.upvals[n]=tm.luaF_findupval(t,M+eo[n].idx):el.upvals[n]=N[eo[n].idx];n.cache=el},Ee=function(t){return t.ttisnumber()},Ae=function(t){return t.ttisstring()},Pe=function(t,n){let N=t.stack[n];return!!N.ttisstring()||!!Ee(N)&&(tg.luaO_tostring(t,N),!0)},Me=function(t){return t.ttisstring()&&0===t.vslen()},We=function(t,n,N,M){let es=0;do{let ea=t.stack[n-N],eo=ea.vslen(),el=ea.svalue();M.set(el,es),es+=eo}while(--N>0)},Ge=function(t,n){td(n>=2);do{let N=t.top,M=2;if((t.stack[N-2].ttisstring()||Ee(t.stack[N-2]))&&Pe(t,N-1)){if(Me(t.stack[N-1]))Pe(t,N-2);else if(Me(t.stack[N-2]))tg.setobjs2s(t,N-2,N-1);else{let es=t.stack[N-1].vslen();for(M=1;M<n&&Pe(t,N-M-1);M++)es+=t.stack[N-M-1].vslen();let ea=new Uint8Array(es);We(t,N,M,ea);let eo=ty(t,ea);tg.setsvalue2s(t,N-M,eo)}}else tA.luaT_trybinTM(t,t.stack[N-2],t.stack[N-1],t.stack[N-2],tA.TMS.TM_CONCAT);for(n-=M-1;t.top>N-(M-1);)delete t.stack[--t.top]}while(n>1)},Ze=function(t,n,N,M){for(let es=0;es<2e3;es++){let es;if(n.ttistable()){let ea=tx.luaH_get(t,n.value,N);if(!ea.ttisnil())return void tg.setobj2s(t,M,ea);if(null===(es=tA.fasttm(t,n.value.metatable,tA.TMS.TM_INDEX)))return void t.stack[M].setnilvalue()}else(es=tA.luaT_gettmbyobj(t,n,tA.TMS.TM_INDEX)).ttisnil()&&tw.luaG_typeerror(t,n,eb("index",!0));if(es.ttisfunction())return void tA.luaT_callTM(t,es,n,N,t.stack[M],1);n=es}tw.luaG_runerror(t,eb("'__index' chain too long; possible loop",!0))},Xe=function(t,n,N,M){for(let es=0;es<2e3;es++){let es;if(n.ttistable()){let ea=n.value;if(!tx.luaH_get(t,ea,N).ttisnil()||null===(es=tA.fasttm(t,ea.metatable,tA.TMS.TM_NEWINDEX)))return tx.luaH_setfrom(t,ea,N,M),void tx.invalidateTMcache(ea)}else(es=tA.luaT_gettmbyobj(t,n,tA.TMS.TM_NEWINDEX)).ttisnil()&&tw.luaG_typeerror(t,n,eb("index",!0));if(es.ttisfunction())return void tA.luaT_callTM(t,es,n,N,M,0);n=es}tw.luaG_runerror(t,eb("'__newindex' chain too long; possible loop",!0))};t.exports.cvt2str=Ee,t.exports.cvt2num=Ae,t.exports.luaV_gettable=Ze,t.exports.luaV_concat=Ge,t.exports.luaV_div=pe,t.exports.luaV_equalobj=Jt,t.exports.luaV_execute=function(t){let n=t.ci;for(n.callstatus|=tb.CIST_FRESH;;){td(n===t.ci);let N=n.func.value,eo=N.p.k,el=n.l_base,eu=n.l_code[n.l_savedpc++];t.hookmask&(M|es)&&tw.luaG_traceexec(t);let ec=u(0,el,eu);switch(eu.opcode){case eW:tg.setobjs2s(t,ec,A(0,el,eu));break;case eG:{let n=eo[eu.Bx];tg.setobj2s(t,ec,n);break}case ez:{td(n.l_code[n.l_savedpc].opcode===eI);let N=eo[n.l_code[n.l_savedpc++].Ax];tg.setobj2s(t,ec,N);break}case ej:t.stack[ec].setbvalue(0!==eu.B),0!==eu.C&&n.l_savedpc++;break;case eH:for(let n=0;n<=eu.B;n++)t.stack[ec+n].setnilvalue();break;case eB:{let n=eu.B;tg.setobj2s(t,ec,N.upvals[n]);break}case eM:{let n=N.upvals[eu.B],M=x(t,el,eo,eu);Ze(t,n,M,ec);break}case eP:{let n=t.stack[A(0,el,eu)],N=x(t,el,eo,eu);Ze(t,n,N,ec);break}case e3:{let n=N.upvals[eu.A],M=h(t,el,eo,eu),es=x(t,el,eo,eu);Xe(t,n,M,es);break}case e5:N.upvals[eu.B].setfrom(t.stack[ec]);break;case e2:{let n=t.stack[ec],N=h(t,el,eo,eu),M=x(t,el,eo,eu);Xe(t,n,N,M);break}case eZ:t.stack[ec].sethvalue(tx.luaH_new(t));break;case e1:{let n=A(0,el,eu),N=x(t,el,eo,eu);tg.setobjs2s(t,ec+1,n),Ze(t,t.stack[n],N,ec);break}case eL:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);M.ttisinteger()&&es.ttisinteger()?t.stack[ec].setivalue(M.value+es.value|0):!1!==(n=zt(M))&&!1!==(N=zt(es))?t.stack[ec].setfltvalue(n+N):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_ADD);break}case e6:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);M.ttisinteger()&&es.ttisinteger()?t.stack[ec].setivalue(M.value-es.value|0):!1!==(n=zt(M))&&!1!==(N=zt(es))?t.stack[ec].setfltvalue(n-N):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_SUB);break}case eq:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);M.ttisinteger()&&es.ttisinteger()?t.stack[ec].setivalue(tT(M.value,es.value)):!1!==(n=zt(M))&&!1!==(N=zt(es))?t.stack[ec].setfltvalue(n*N):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_MUL);break}case e$:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);M.ttisinteger()&&es.ttisinteger()?t.stack[ec].setivalue(ue(t,M.value,es.value)):!1!==(n=zt(M))&&!1!==(N=zt(es))?t.stack[ec].setfltvalue(t_(t,n,N)):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_MOD);break}case eJ:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);!1!==(n=zt(M))&&!1!==(N=zt(es))?t.stack[ec].setfltvalue(Math.pow(n,N)):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_POW);break}case eN:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);!1!==(n=zt(M))&&!1!==(N=zt(es))?t.stack[ec].setfltvalue(n/N):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_DIV);break}case eD:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);M.ttisinteger()&&es.ttisinteger()?t.stack[ec].setivalue(pe(t,M.value,es.value)):!1!==(n=zt(M))&&!1!==(N=zt(es))?t.stack[ec].setfltvalue(Math.floor(n/N)):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_IDIV);break}case eA:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);!1!==(n=vt(M))&&!1!==(N=vt(es))?t.stack[ec].setivalue(n&N):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_BAND);break}case ew:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);!1!==(n=vt(M))&&!1!==(N=vt(es))?t.stack[ec].setivalue(n|N):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_BOR);break}case eT:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);!1!==(n=vt(M))&&!1!==(N=vt(es))?t.stack[ec].setivalue(n^N):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_BXOR);break}case e4:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);!1!==(n=vt(M))&&!1!==(N=vt(es))?t.stack[ec].setivalue(xe(n,N)):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_SHL);break}case e8:{let n,N,M=h(t,el,eo,eu),es=x(t,el,eo,eu);!1!==(n=vt(M))&&!1!==(N=vt(es))?t.stack[ec].setivalue(xe(n,-N)):tA.luaT_trybinTM(t,M,es,t.stack[ec],tA.TMS.TM_SHR);break}case tu:{let n,N=t.stack[A(0,el,eu)];N.ttisinteger()?t.stack[ec].setivalue(0|-N.value):!1!==(n=zt(N))?t.stack[ec].setfltvalue(-n):tA.luaT_trybinTM(t,N,N,t.stack[ec],tA.TMS.TM_UNM);break}case ex:{let n=t.stack[A(0,el,eu)];n.ttisinteger()?t.stack[ec].setivalue(~n.value):tA.luaT_trybinTM(t,n,n,t.stack[ec],tA.TMS.TM_BNOT);break}case eY:{let n=t.stack[A(0,el,eu)];t.stack[ec].setbvalue(n.l_isfalse());break}case eV:Zt(t,t.stack[ec],t.stack[A(0,el,eu)]);break;case eS:{let N=eu.B,M=eu.C;t.top=el+M+1,Ge(t,M-N+1);let es=el+N;tg.setobjs2s(t,ec,es),tL.adjust_top(t,n.top);break}case eK:H(t,n,eu,0);break;case eU:Jt(t,h(t,el,eo,eu),x(t,el,eo,eu))!==eu.A?n.l_savedpc++:I(t,n);break;case eX:ct(t,h(t,el,eo,eu),x(t,el,eo,eu))!==eu.A?n.l_savedpc++:I(t,n);break;case eF:Vt(t,h(t,el,eo,eu),x(t,el,eo,eu))!==eu.A?n.l_savedpc++:I(t,n);break;case e7:(eu.C?t.stack[ec].l_isfalse():!t.stack[ec].l_isfalse())?n.l_savedpc++:I(t,n);break;case ta:{let N=A(0,el,eu),M=t.stack[N];(eu.C?M.l_isfalse():!M.l_isfalse())?n.l_savedpc++:(tg.setobjs2s(t,ec,N),I(t,n));break}case eO:{let N=eu.B,M=eu.C-1;if(0!==N&&tL.adjust_top(t,ec+N),!tL.luaD_precall(t,ec,M)){n=t.ci;continue}M>=0&&tL.adjust_top(t,n.top);break}case e9:{let M=eu.B;if(0!==M&&tL.adjust_top(t,ec+M),!tL.luaD_precall(t,ec,ea)){let M=t.ci,es=M.previous,ea=M.func,eo=M.funcOff,el=es.funcOff,eu=M.l_base+ea.value.p.numparams;N.p.p.length>0&&tm.luaF_close(t,es.l_base);for(let n=0;eo+n<eu;n++)tg.setobjs2s(t,el+n,eo+n);es.l_base=el+(M.l_base-eo),es.top=el+(t.top-eo),tL.adjust_top(t,es.top),es.l_code=M.l_code,es.l_savedpc=M.l_savedpc,es.callstatus|=tb.CIST_TAIL,es.next=null,n=t.ci=es,td(t.top===es.l_base+t.stack[el].value.p.maxstacksize);continue}break}case eQ:{N.p.p.length>0&&tm.luaF_close(t,el);let M=tL.luaD_poscall(t,n,ec,0!==eu.B?eu.B-1:t.top-ec);if(n.callstatus&tb.CIST_FRESH)return;n=t.ci,M&&tL.adjust_top(t,n.top),td(n.callstatus&tb.CIST_LUA),td(n.l_code[n.l_savedpc-1].opcode===eO);continue}case eR:if(t.stack[ec].ttisinteger()){let N=t.stack[ec+2].value,M=t.stack[ec].value+N|0,es=t.stack[ec+1].value;(0<N?M<=es:es<=M)&&(n.l_savedpc+=eu.sBx,t.stack[ec].chgivalue(M),t.stack[ec+3].setivalue(M))}else{let N=t.stack[ec+2].value,M=t.stack[ec].value+N,es=t.stack[ec+1].value;(0<N?M<=es:es<=M)&&(n.l_savedpc+=eu.sBx,t.stack[ec].chgfltvalue(M),t.stack[ec+3].setfltvalue(M))}break;case eC:{let N,M=t.stack[ec],es=t.stack[ec+1],ea=t.stack[ec+2];if(M.ttisinteger()&&ea.ttisinteger()&&(N=ve(es,ea.value))){let t=N.stopnow?0:M.value;es.value=N.ilimit,M.value=t-ea.value|0}else{let n,N,eo;!1===(n=zt(es))&&tw.luaG_runerror(t,eb("'for' limit must be a number",!0)),t.stack[ec+1].setfltvalue(n),!1===(N=zt(ea))&&tw.luaG_runerror(t,eb("'for' step must be a number",!0)),t.stack[ec+2].setfltvalue(N),!1===(eo=zt(M))&&tw.luaG_runerror(t,eb("'for' initial value must be a number",!0)),t.stack[ec].setfltvalue(eo-N)}n.l_savedpc+=eu.sBx;break}case to:{let N=ec+3;tg.setobjs2s(t,N+2,ec+2),tg.setobjs2s(t,N+1,ec+1),tg.setobjs2s(t,N,ec),tL.adjust_top(t,N+3),tL.luaD_call(t,N,eu.C),tL.adjust_top(t,n.top),ec=u(0,el,eu=n.l_code[n.l_savedpc++]),td(eu.opcode===tl)}case tl:t.stack[ec+1].ttisnil()||(tg.setobjs2s(t,ec,ec+1),n.l_savedpc+=eu.sBx);break;case e0:{let N=eu.B,M=eu.C;0===N&&(N=t.top-ec-1),0===M&&(td(n.l_code[n.l_savedpc].opcode===eI),M=n.l_code[n.l_savedpc++].Ax);let es=t.stack[ec].value,ea=(M-1)*ek+N;for(;N>0;N--)tx.luaH_setint(es,ea--,t.stack[ec+N]);tL.adjust_top(t,n.top);break}case eE:{let n=N.p.p[eu.Bx],M=Ke(n,N.upvals,t.stack,el);null===M?me(t,n,N.upvals,el,ec):t.stack[ec].setclLvalue(M);break}case tc:{let M,es=eu.B-1,ea=el-n.funcOff-N.p.numparams-1;for(ea<0&&(ea=0),es<0&&(es=ea,tL.luaD_checkstack(t,ea),tL.adjust_top(t,ec+ea)),M=0;M<es&&M<ea;M++)tg.setobjs2s(t,ec+M,el-ea+M);for(;M<es;M++)t.stack[ec+M].setnilvalue();break}case eI:throw Error("invalid opcode")}}},t.exports.luaV_finishOp=function(t){let n=t.ci,N=n.l_base,M=n.l_code[n.l_savedpc-1],es=M.opcode;switch(es){case eL:case e6:case eq:case eN:case eD:case eA:case ew:case eT:case e4:case e8:case e$:case eJ:case tu:case ex:case eV:case eM:case eP:case e1:tg.setobjs2s(t,N+M.A,t.top-1),delete t.stack[--t.top];break;case eF:case eX:case eU:{let N=!t.stack[t.top-1].l_isfalse();delete t.stack[--t.top],n.callstatus&tb.CIST_LEQ&&(td(es===eF),n.callstatus^=tb.CIST_LEQ,N=!N),td(n.l_code[n.l_savedpc].opcode===eK),!!M.A!==N&&n.l_savedpc++;break}case eS:{let es=t.top-1,ea=es-1-(N+M.B);tg.setobjs2s(t,es-2,es),ea>1&&(t.top=es-1,Ge(t,ea)),tg.setobjs2s(t,n.l_base+M.A,t.top-1),tL.adjust_top(t,n.top);break}case to:td(n.l_code[n.l_savedpc].opcode===tl),tL.adjust_top(t,n.top);break;case eO:M.C-1>=0&&tL.adjust_top(t,n.top)}},t.exports.luaV_imul=tT,t.exports.luaV_lessequal=Vt,t.exports.luaV_lessthan=ct,t.exports.luaV_mod=ue,t.exports.luaV_objlen=Zt,t.exports.luaV_rawequalobj=function(t,n){return Jt(null,t,n)},t.exports.luaV_shiftl=xe,t.exports.luaV_tointeger=ke,t.exports.settable=Xe,t.exports.tointeger=vt,t.exports.tonumber=zt},function(t,n,N){let M=[96,113,65,84,80,80,92,108,60,16,60,84,108,124,124,124,124,124,124,124,124,124,124,124,124,96,96,96,96,104,34,188,188,188,132,228,84,84,16,98,98,4,98,20,81,80,23],s=function(t,n){return~(-1<<t)<<n},a=function(t,n){return~s(t,n)},i=function(t,n,N,M){return t.code=t.code&a(M,N)|n<<N&s(M,N),c(t)},l=function(t,n){return i(t,n,14,18)},c=function(t){if("number"==typeof t)return{code:t,opcode:t>>0&s(6,0),A:t>>6&s(8,0),B:t>>23&s(9,0),C:t>>14&s(9,0),Bx:t>>14&s(18,0),Ax:t>>6&s(26,0),sBx:(t>>14&s(18,0))-131071};{let n=t.code;return t.opcode=n>>0&s(6,0),t.A=n>>6&s(8,0),t.B=n>>23&s(9,0),t.C=n>>14&s(9,0),t.Bx=n>>14&s(18,0),t.Ax=n>>6&s(26,0),t.sBx=(n>>14&s(18,0))-131071,t}};t.exports.BITRK=256,t.exports.CREATE_ABC=function(t,n,N,M){return c(t<<0|n<<6|N<<23|M<<14)},t.exports.CREATE_ABx=function(t,n,N){return c(t<<0|n<<6|N<<14)},t.exports.CREATE_Ax=function(t,n){return c(t<<0|n<<6)},t.exports.GET_OPCODE=function(t){return t.opcode},t.exports.GETARG_A=function(t){return t.A},t.exports.GETARG_B=function(t){return t.B},t.exports.GETARG_C=function(t){return t.C},t.exports.GETARG_Bx=function(t){return t.Bx},t.exports.GETARG_Ax=function(t){return t.Ax},t.exports.GETARG_sBx=function(t){return t.sBx},t.exports.INDEXK=function(t){return -257&t},t.exports.ISK=function(t){return 256&t},t.exports.LFIELDS_PER_FLUSH=50,t.exports.MAXARG_A=255,t.exports.MAXARG_Ax=67108863,t.exports.MAXARG_B=511,t.exports.MAXARG_Bx=262143,t.exports.MAXARG_C=511,t.exports.MAXARG_sBx=131071,t.exports.MAXINDEXRK=255,t.exports.NO_REG=255,t.exports.OpArgK=3,t.exports.OpArgN=0,t.exports.OpArgR=2,t.exports.OpArgU=1,t.exports.OpCodes=["MOVE","LOADK","LOADKX","LOADBOOL","LOADNIL","GETUPVAL","GETTABUP","GETTABLE","SETTABUP","SETUPVAL","SETTABLE","NEWTABLE","SELF","ADD","SUB","MUL","MOD","POW","DIV","IDIV","BAND","BOR","BXOR","SHL","SHR","UNM","BNOT","NOT","LEN","CONCAT","JMP","EQ","LT","LE","TEST","TESTSET","CALL","TAILCALL","RETURN","FORLOOP","FORPREP","TFORCALL","TFORLOOP","SETLIST","CLOSURE","VARARG","EXTRAARG"],t.exports.OpCodesI={OP_MOVE:0,OP_LOADK:1,OP_LOADKX:2,OP_LOADBOOL:3,OP_LOADNIL:4,OP_GETUPVAL:5,OP_GETTABUP:6,OP_GETTABLE:7,OP_SETTABUP:8,OP_SETUPVAL:9,OP_SETTABLE:10,OP_NEWTABLE:11,OP_SELF:12,OP_ADD:13,OP_SUB:14,OP_MUL:15,OP_MOD:16,OP_POW:17,OP_DIV:18,OP_IDIV:19,OP_BAND:20,OP_BOR:21,OP_BXOR:22,OP_SHL:23,OP_SHR:24,OP_UNM:25,OP_BNOT:26,OP_NOT:27,OP_LEN:28,OP_CONCAT:29,OP_JMP:30,OP_EQ:31,OP_LT:32,OP_LE:33,OP_TEST:34,OP_TESTSET:35,OP_CALL:36,OP_TAILCALL:37,OP_RETURN:38,OP_FORLOOP:39,OP_FORPREP:40,OP_TFORCALL:41,OP_TFORLOOP:42,OP_SETLIST:43,OP_CLOSURE:44,OP_VARARG:45,OP_EXTRAARG:46},t.exports.POS_A=6,t.exports.POS_Ax=6,t.exports.POS_B=23,t.exports.POS_Bx=14,t.exports.POS_C=14,t.exports.POS_OP=0,t.exports.RKASK=function(t){return 256|t},t.exports.SETARG_A=function(t,n){return i(t,n,6,8)},t.exports.SETARG_Ax=function(t,n){return i(t,n,6,26)},t.exports.SETARG_B=function(t,n){return i(t,n,23,9)},t.exports.SETARG_Bx=l,t.exports.SETARG_C=function(t,n){return i(t,n,14,9)},t.exports.SETARG_sBx=function(t,n){return l(t,n+131071)},t.exports.SET_OPCODE=function(t,n){return t.code=t.code&a(6,0)|n<<0&s(6,0),c(t)},t.exports.SIZE_A=8,t.exports.SIZE_Ax=26,t.exports.SIZE_B=9,t.exports.SIZE_Bx=18,t.exports.SIZE_C=9,t.exports.SIZE_OP=6,t.exports.fullins=c,t.exports.getBMode=function(t){return M[t]>>4&3},t.exports.getCMode=function(t){return M[t]>>2&3},t.exports.getOpMode=function(t){return 3&M[t]},t.exports.iABC=0,t.exports.iABx=1,t.exports.iAsBx=2,t.exports.iAx=3,t.exports.testAMode=function(t){return 64&M[t]},t.exports.testTMode=function(t){return 128&M[t]}},function(t,n,N){let{LUA_VERSION_MAJOR:M,LUA_VERSION_MINOR:es}=N(2);t.exports.LUA_VERSUFFIX="_"+M+"_"+es,t.exports.lua_assert=function(t){},t.exports.luaopen_base=N(24).luaopen_base,t.exports.LUA_COLIBNAME="coroutine",t.exports.luaopen_coroutine=N(25).luaopen_coroutine,t.exports.LUA_TABLIBNAME="table",t.exports.luaopen_table=N(26).luaopen_table,t.exports.LUA_OSLIBNAME="os",t.exports.luaopen_os=N(27).luaopen_os,t.exports.LUA_STRLIBNAME="string",t.exports.luaopen_string=N(28).luaopen_string,t.exports.LUA_UTF8LIBNAME="utf8",t.exports.luaopen_utf8=N(29).luaopen_utf8,t.exports.LUA_BITLIBNAME="bit32",t.exports.LUA_MATHLIBNAME="math",t.exports.luaopen_math=N(30).luaopen_math,t.exports.LUA_DBLIBNAME="debug",t.exports.luaopen_debug=N(31).luaopen_debug,t.exports.LUA_LOADLIBNAME="package",t.exports.luaopen_package=N(32).luaopen_package,t.exports.LUA_FENGARILIBNAME="fengari",t.exports.luaopen_fengari=N(33).luaopen_fengari;let ea=N(39);t.exports.luaL_openlibs=ea.luaL_openlibs},function(t,n,N){let{LUA_MULTRET:M,LUA_OPBNOT:es,LUA_OPEQ:ea,LUA_OPLE:eo,LUA_OPLT:el,LUA_OPUNM:eu,LUA_REGISTRYINDEX:ec,LUA_RIDX_GLOBALS:ef,LUA_VERSION_NUM:eh,constant_types:{LUA_NUMTAGS:ep,LUA_TBOOLEAN:ed,LUA_TCCL:e_,LUA_TFUNCTION:eg,LUA_TLCF:em,LUA_TLCL:eb,LUA_TLIGHTUSERDATA:ey,LUA_TLNGSTR:ev,LUA_TNIL:ek,LUA_TNONE:eL,LUA_TNUMFLT:eA,LUA_TNUMINT:ex,LUA_TSHRSTR:ew,LUA_TTABLE:eT,LUA_TTHREAD:eO,LUA_TUSERDATA:eE},thread_status:{LUA_OK:eS},from_userstring:eN,to_luastring:eU}=N(1),{api_check:eI}=N(4),eR=N(11),eC=N(8),{luaU_dump:eP}=N(37),eM=N(13),eB=N(6),eD=N(12),{luaS_bless:eK,luaS_new:eF,luaS_newliteral:eV}=N(10),ej=N(14),{LUAI_MAXSTACK:eG}=N(3),ez=N(15),eH=N(9),{ZIO:eX}=N(19),e$=eB.TValue,eW=eB.CClosure,xt=function(t){t.top++,eI(t,t.top<=t.ci.top,"stack overflow")},Kt=function(t,n){eI(t,n<t.top-t.ci.funcOff,"not enough elements in the stack")},m=function(t){if(!t)throw TypeError("invalid argument")},pt=function(t){m("number"==typeof t&&(0|t)===t)},tt=function(t){return t!==eB.luaO_nilobject},w=function(t,n){let N=t.ci;if(n>0){let M=N.funcOff+n;return eI(t,n<=N.top-(N.funcOff+1),"unacceptable index"),M>=t.top?eB.luaO_nilobject:t.stack[M]}return n>ec?(eI(t,0!==n&&-n<=t.top,"invalid index"),t.stack[t.top+n]):n===ec?t.l_G.l_registry:(eI(t,(n=ec-n)<=eM.MAXUPVAL+1,"upvalue index too large"),N.func.ttislcf()?eB.luaO_nilobject:n<=N.func.value.nupvalues?N.func.value.upvalue[n-1]:eB.luaO_nilobject)},S=function(t,n){let N=t.ci;if(n>0){let M=N.funcOff+n;return eI(t,n<=N.top-(N.funcOff+1),"unacceptable index"),M>=t.top?null:M}if(n>ec)return eI(t,0!==n&&-n<=t.top,"invalid index"),t.top+n;throw Error("attempt to use pseudo-index")},b=function(t,n){let N,M=t.ci.funcOff;n>=0?(eI(t,n<=t.stack_last-(M+1),"new top too large"),N=M+1+n):(eI(t,-(n+1)<=t.top-(M+1),"invalid new top"),N=t.top+n+1),eC.adjust_top(t,N)},q=function(t,n){b(t,-n-1)},st=function(t,n,N){for(;n<N;n++,N--){let M=t.stack[n],es=new e$(M.type,M.value);eB.setobjs2s(t,n,N),eB.setobj2s(t,N,es)}},O=function(t,n,N){let M=t.top-1,es=S(t,n),ea=t.stack[es];eI(t,tt(ea)&&n>ec,"index not in the stack"),eI(t,(N>=0?N:-N)<=M-es+1,"invalid 'n'");let eo=N>=0?M-N:es-N-1;st(t,es,eo),st(t,eo+1,t.top-1),st(t,es,t.top-1)},Q=function(t,n,N){let M=w(t,n);w(t,N).setfrom(M)},lt=function(t,n,N){if(m("function"==typeof n),pt(N),0===N)t.stack[t.top]=new e$(em,n);else{Kt(t,N),eI(t,N<=eM.MAXUPVAL,"upvalue index too large");let M=new eW(t,n,N);for(let n=0;n<N;n++)M.upvalue[n].setfrom(t.stack[t.top-N+n]);for(let n=1;n<N;n++)delete t.stack[--t.top];N>0&&--t.top,t.stack[t.top].setclCvalue(M)}xt(t)},Ft=function(t,n){lt(t,n,0)},fe=function(t,n,N){let M=eF(t,eN(N));Kt(t,1),eB.pushsvalue2s(t,M),eI(t,t.top<=t.ci.top,"stack overflow"),ez.settable(t,n,t.stack[t.top-1],t.stack[t.top-2]),delete t.stack[--t.top],delete t.stack[--t.top]},Te=function(t,n){fe(t,eH.luaH_getint(t.l_G.l_registry.value,ef),n)},Oe=function(t,n,N){let M=eF(t,eN(N));return eB.pushsvalue2s(t,M),eI(t,t.top<=t.ci.top,"stack overflow"),ez.luaV_gettable(t,n,t.stack[t.top-1],t.top-1),t.stack[t.top-1].ttnov()},Re=function(t,n,N){let M=w(t,n);return pt(N),eI(t,M.ttistable(),"table expected"),eB.pushobj2s(t,eH.luaH_getint(M.value,N)),eI(t,t.top<=t.ci.top,"stack overflow"),t.stack[t.top-1].ttnov()},K=function(t,n,N){let M=new eB.TValue(eT,eH.luaH_new(t));t.stack[t.top]=M,xt(t)},Ct=function(t,n,N){switch(pt(N),n.ttype()){case e_:{let t=n.value;return 1<=N&&N<=t.nupvalues?{name:eU("",!0),val:t.upvalue[N-1]}:null}case eb:{let t=n.value,M=t.p;if(!(1<=N&&N<=M.upvalues.length))return null;let es=M.upvalues[N-1].name;return{name:es?es.getstr():eU("(*no name)",!0),val:t.upvals[N-1]}}default:return null}},Gt=function(t,n){let N=w(t,n);if(!N.ttisstring()){if(!ez.cvt2str(N))return null;eB.luaO_tostring(t,N)}return N.svalue()},Tt=function(t,n){return ez.tointeger(w(t,n))},Pt=function(t,n){return ez.tonumber(w(t,n))},eq=new WeakMap,_e=function(t,n){eC.luaD_callnoyield(t,n.funcOff,n.nresults)},ge=function(t,n){let N=w(t,n);return tt(N)?N.ttnov():eL},eZ=eU("?"),Ie=function(t,n,N){eI(t,N===M||t.ci.top-t.top>=N-n,"results from function overflow current stack size")},ae=function(t,n,N,es,ea){eI(t,null===ea||!(t.ci.callstatus&eD.CIST_LUA),"cannot use continuations inside hooks"),Kt(t,n+1),eI(t,t.status===eS,"cannot do calls on non-normal thread"),Ie(t,n,N);let eo=t.top-(n+1);null!==ea&&0===t.nny?(t.ci.c_k=ea,t.ci.c_ctx=es,eC.luaD_call(t,eo,N)):eC.luaD_callnoyield(t,eo,N),N===M&&t.ci.top<t.top&&(t.ci.top=t.top)},ce=function(t,n,N,es,ea,eo){let el,eu;eI(t,null===eo||!(t.ci.callstatus&eD.CIST_LUA),"cannot use continuations inside hooks"),Kt(t,n+1),eI(t,t.status===eS,"cannot do calls on non-normal thread"),Ie(t,n,N),eu=0===es?0:S(t,es);let ec=t.top-(n+1);if(null===eo||t.nny>0)el=eC.luaD_pcall(t,_e,{funcOff:ec,nresults:N},ec,eu);else{let n=t.ci;n.c_k=eo,n.c_ctx=ea,n.extra=ec,n.c_old_errfunc=t.errfunc,t.errfunc=eu,n.callstatus&=~eD.CIST_OAH|t.allowhook,n.callstatus|=eD.CIST_YPCALL,eC.luaD_call(t,ec,N),n.callstatus&=~eD.CIST_YPCALL,t.errfunc=n.c_old_errfunc,el=eS}return N===M&&t.ci.top<t.top&&(t.ci.top=t.top),el},Le=function(t,n,N){let M=w(t,n);eI(t,M.ttisLclosure(),"Lua function expected");let es=M.value;return pt(N),eI(t,1<=N&&N<=es.p.upvalues.length,"invalid upvalue index"),{f:es,i:N-1}};t.exports.api_incr_top=xt,t.exports.api_checknelems=Kt,t.exports.lua_absindex=function(t,n){return n>0||n<=ec?n:t.top-t.ci.funcOff+n},t.exports.lua_arith=function(t,n){n!==eu&&n!==es?Kt(t,2):(Kt(t,1),eB.pushobj2s(t,t.stack[t.top-1]),eI(t,t.top<=t.ci.top,"stack overflow")),eB.luaO_arith(t,n,t.stack[t.top-2],t.stack[t.top-1],t.stack[t.top-2]),delete t.stack[--t.top]},t.exports.lua_atpanic=function(t,n){let N=t.l_G.panic;return t.l_G.panic=n,N},t.exports.lua_atnativeerror=function(t,n){let N=t.l_G.atnativeerror;return t.l_G.atnativeerror=n,N},t.exports.lua_call=function(t,n,N){ae(t,n,N,0,null)},t.exports.lua_callk=ae,t.exports.lua_checkstack=function(t,n){let N,M=t.ci;return eI(t,n>=0,"negative 'n'"),t.stack_last-t.top>n?N=!0:t.top+eD.EXTRA_STACK>eG-n?N=!1:(eC.luaD_growstack(t,n),N=!0),N&&M.top<t.top+n&&(M.top=t.top+n),N},t.exports.lua_compare=function(t,n,N,M){let es=w(t,n),eu=w(t,N),ec=0;if(tt(es)&&tt(eu))switch(M){case ea:ec=ez.luaV_equalobj(t,es,eu);break;case el:ec=ez.luaV_lessthan(t,es,eu);break;case eo:ec=ez.luaV_lessequal(t,es,eu);break;default:eI(t,!1,"invalid option")}return ec},t.exports.lua_concat=function(t,n){Kt(t,n),n>=2?ez.luaV_concat(t,n):0===n&&(eB.pushsvalue2s(t,eK(t,eU("",!0))),eI(t,t.top<=t.ci.top,"stack overflow"))},t.exports.lua_copy=Q,t.exports.lua_createtable=K,t.exports.lua_dump=function(t,n,N,M){Kt(t,1);let es=t.stack[t.top-1];return es.ttisLclosure()?eP(t,es.value.p,n,N,M):1},t.exports.lua_error=function(t){Kt(t,1),eR.luaG_errormsg(t)},t.exports.lua_gc=function(){},t.exports.lua_getallocf=function(){return console.warn("lua_getallocf is not available"),0},t.exports.lua_getextraspace=function(){return console.warn("lua_getextraspace is not available"),0},t.exports.lua_getfield=function(t,n,N){return Oe(t,w(t,n),N)},t.exports.lua_getglobal=function(t,n){return Oe(t,eH.luaH_getint(t.l_G.l_registry.value,ef),n)},t.exports.lua_geti=function(t,n,N){let M=w(t,n);return pt(N),t.stack[t.top]=new e$(ex,N),xt(t),ez.luaV_gettable(t,M,t.stack[t.top-1],t.top-1),t.stack[t.top-1].ttnov()},t.exports.lua_getmetatable=function(t,n){let N,M=w(t,n),es=!1;switch(M.ttnov()){case eT:case eE:N=M.value.metatable;break;default:N=t.l_G.mt[M.ttnov()]}return null!=N&&(t.stack[t.top]=new e$(eT,N),xt(t),es=!0),es},t.exports.lua_gettable=function(t,n){let N=w(t,n);return ez.luaV_gettable(t,N,t.stack[t.top-1],t.top-1),t.stack[t.top-1].ttnov()},t.exports.lua_gettop=function(t){return t.top-(t.ci.funcOff+1)},t.exports.lua_getupvalue=function(t,n,N){let M=Ct(0,w(t,n),N);if(M){let n=M.name,N=M.val;return eB.pushobj2s(t,N),eI(t,t.top<=t.ci.top,"stack overflow"),n}return null},t.exports.lua_getuservalue=function(t,n){let N=w(t,n);eI(t,N.ttisfulluserdata(),"full userdata expected");let M=N.value.uservalue;return t.stack[t.top]=new e$(M.type,M.value),xt(t),t.stack[t.top-1].ttnov()},t.exports.lua_insert=function(t,n){O(t,n,1)},t.exports.lua_isboolean=function(t,n){return ge(t,n)===ed},t.exports.lua_iscfunction=function(t,n){let N=w(t,n);return N.ttislcf(N)||N.ttisCclosure()},t.exports.lua_isfunction=function(t,n){return ge(t,n)===eg},t.exports.lua_isinteger=function(t,n){return w(t,n).ttisinteger()},t.exports.lua_islightuserdata=function(t,n){return ge(t,n)===ey},t.exports.lua_isnil=function(t,n){return ge(t,n)===ek},t.exports.lua_isnone=function(t,n){return ge(t,n)===eL},t.exports.lua_isnoneornil=function(t,n){return 0>=ge(t,n)},t.exports.lua_isnumber=function(t,n){return!1!==ez.tonumber(w(t,n))},t.exports.lua_isproxy=function(t,n){let N=eq.get(t);return!!N&&(null===n||n.l_G===N)},t.exports.lua_isstring=function(t,n){let N=w(t,n);return N.ttisstring()||ez.cvt2str(N)},t.exports.lua_istable=function(t,n){return w(t,n).ttistable()},t.exports.lua_isthread=function(t,n){return ge(t,n)===eO},t.exports.lua_isuserdata=function(t,n){let N=w(t,n);return N.ttisfulluserdata(N)||N.ttislightuserdata()},t.exports.lua_len=function(t,n){let N=w(t,n),M=new e$;ez.luaV_objlen(t,M,N),t.stack[t.top]=M,xt(t)},t.exports.lua_load=function(t,n,N,M,es){M=M?eN(M):eZ,null!==es&&(es=eN(es));let ea=new eX(t,n,N),eo=eC.luaD_protectedparser(t,ea,M,es);if(eo===eS){let n=t.stack[t.top-1].value;if(n.nupvalues>=1){let N=eH.luaH_getint(t.l_G.l_registry.value,ef);n.upvals[0].setfrom(N)}}return eo},t.exports.lua_newtable=function(t){K(t)},t.exports.lua_newuserdata=function(t,n){let N=new eB.Udata(t,n);return t.stack[t.top]=new eB.TValue(eE,N),xt(t),N.data},t.exports.lua_next=function(t,n){let N=w(t,n);return eI(t,N.ttistable(),"table expected"),t.stack[t.top]=new e$,eH.luaH_next(t,N.value,t.top-1)?(xt(t),1):(delete t.stack[t.top],delete t.stack[--t.top],0)},t.exports.lua_pcall=function(t,n,N,M){return ce(t,n,N,M,0,null)},t.exports.lua_pcallk=ce,t.exports.lua_pop=q,t.exports.lua_pushboolean=function(t,n){t.stack[t.top]=new e$(ed,!!n),xt(t)},t.exports.lua_pushcclosure=lt,t.exports.lua_pushcfunction=Ft,t.exports.lua_pushfstring=function(t,n,...N){return n=eN(n),eB.luaO_pushvfstring(t,n,N)},t.exports.lua_pushglobaltable=function(t){Re(t,ec,ef)},t.exports.lua_pushinteger=function(t,n){pt(n),t.stack[t.top]=new e$(ex,n),xt(t)},t.exports.lua_pushjsclosure=lt,t.exports.lua_pushjsfunction=Ft,t.exports.lua_pushlightuserdata=function(t,n){t.stack[t.top]=new e$(ey,n),xt(t)},t.exports.lua_pushliteral=function(t,n){if(null==n)t.stack[t.top]=new e$(ek,null),t.top++;else{m("string"==typeof n);let N=eV(t,n);eB.pushsvalue2s(t,N),n=N.getstr()}return eI(t,t.top<=t.ci.top,"stack overflow"),n},t.exports.lua_pushlstring=function(t,n,N){let M;return pt(N),0===N?M=eK(t,n=eU("",!0)):(eI(t,(n=eN(n)).length>=N,"invalid length to lua_pushlstring"),M=eF(t,n.subarray(0,N))),eB.pushsvalue2s(t,M),eI(t,t.top<=t.ci.top,"stack overflow"),M.value},t.exports.lua_pushnil=function(t){t.stack[t.top]=new e$(ek,null),xt(t)},t.exports.lua_pushnumber=function(t,n){m("number"==typeof n),t.stack[t.top]=new e$(eA,n),xt(t)},t.exports.lua_pushstring=function(t,n){if(null==n)t.stack[t.top]=new e$(ek,null),t.top++;else{let N=eF(t,eN(n));eB.pushsvalue2s(t,N),n=N.getstr()}return eI(t,t.top<=t.ci.top,"stack overflow"),n},t.exports.lua_pushthread=function(t){return t.stack[t.top]=new e$(eO,t),xt(t),t.l_G.mainthread===t},t.exports.lua_pushvalue=function(t,n){eB.pushobj2s(t,w(t,n)),eI(t,t.top<=t.ci.top,"stack overflow")},t.exports.lua_pushvfstring=function(t,n,N){return n=eN(n),eB.luaO_pushvfstring(t,n,N)},t.exports.lua_rawequal=function(t,n,N){let M=w(t,n),es=w(t,N);return tt(M)&&tt(es)?ez.luaV_equalobj(null,M,es):0},t.exports.lua_rawget=function(t,n){let N=w(t,n);return eI(t,N.ttistable(N),"table expected"),eB.setobj2s(t,t.top-1,eH.luaH_get(t,N.value,t.stack[t.top-1])),t.stack[t.top-1].ttnov()},t.exports.lua_rawgeti=Re,t.exports.lua_rawgetp=function(t,n,N){let M=w(t,n);eI(t,M.ttistable(),"table expected");let es=new e$(ey,N);return eB.pushobj2s(t,eH.luaH_get(t,M.value,es)),eI(t,t.top<=t.ci.top,"stack overflow"),t.stack[t.top-1].ttnov()},t.exports.lua_rawlen=function(t,n){let N=w(t,n);switch(N.ttype()){case ew:case ev:return N.vslen();case eE:return N.value.len;case eT:return eH.luaH_getn(N.value);default:return 0}},t.exports.lua_rawset=function(t,n){Kt(t,2);let N=w(t,n);eI(t,N.ttistable(),"table expected");let M=t.stack[t.top-2],es=t.stack[t.top-1];eH.luaH_setfrom(t,N.value,M,es),eH.invalidateTMcache(N.value),delete t.stack[--t.top],delete t.stack[--t.top]},t.exports.lua_rawseti=function(t,n,N){pt(N),Kt(t,1);let M=w(t,n);eI(t,M.ttistable(),"table expected"),eH.luaH_setint(M.value,N,t.stack[t.top-1]),delete t.stack[--t.top]},t.exports.lua_rawsetp=function(t,n,N){Kt(t,1);let M=w(t,n);eI(t,M.ttistable(),"table expected");let es=new e$(ey,N),ea=t.stack[t.top-1];eH.luaH_setfrom(t,M.value,es,ea),delete t.stack[--t.top]},t.exports.lua_register=function(t,n,N){Ft(t,N),Te(t,n)},t.exports.lua_remove=function(t,n){O(t,n,-1),q(t,1)},t.exports.lua_replace=function(t,n){Q(t,-1,n),q(t,1)},t.exports.lua_rotate=O,t.exports.lua_setallocf=function(){return console.warn("lua_setallocf is not available"),0},t.exports.lua_setfield=function(t,n,N){fe(t,w(t,n),N)},t.exports.lua_setglobal=Te,t.exports.lua_seti=function(t,n,N){pt(N),Kt(t,1);let M=w(t,n);t.stack[t.top]=new e$(ex,N),xt(t),ez.settable(t,M,t.stack[t.top-1],t.stack[t.top-2]),delete t.stack[--t.top],delete t.stack[--t.top]},t.exports.lua_setmetatable=function(t,n){let N;Kt(t,1);let M=w(t,n);switch(t.stack[t.top-1].ttisnil()?N=null:(eI(t,t.stack[t.top-1].ttistable(),"table expected"),N=t.stack[t.top-1].value),M.ttnov()){case eE:case eT:M.value.metatable=N;break;default:t.l_G.mt[M.ttnov()]=N}return delete t.stack[--t.top],!0},t.exports.lua_settable=function(t,n){Kt(t,2);let N=w(t,n);ez.settable(t,N,t.stack[t.top-2],t.stack[t.top-1]),delete t.stack[--t.top],delete t.stack[--t.top]},t.exports.lua_settop=b,t.exports.lua_setupvalue=function(t,n,N){let M=w(t,n);Kt(t,1);let es=Ct(0,M,N);if(es){let n=es.name;return es.val.setfrom(t.stack[t.top-1]),delete t.stack[--t.top],n}return null},t.exports.lua_setuservalue=function(t,n){Kt(t,1);let N=w(t,n);eI(t,N.ttisfulluserdata(),"full userdata expected"),N.value.uservalue.setfrom(t.stack[t.top-1]),delete t.stack[--t.top]},t.exports.lua_status=function(t){return t.status},t.exports.lua_stringtonumber=function(t,n){let N=new e$,M=eB.luaO_str2num(n,N);return 0!==M&&(t.stack[t.top]=N,xt(t)),M},t.exports.lua_toboolean=function(t,n){return!w(t,n).l_isfalse()},t.exports.lua_tocfunction=function(t,n){let N=w(t,n);return N.ttislcf()||N.ttisCclosure()?N.value:null},t.exports.lua_todataview=function(t,n){let N=Gt(t,n);return new DataView(N.buffer,N.byteOffset,N.byteLength)},t.exports.lua_tointeger=function(t,n){let N=Tt(t,n);return!1===N?0:N},t.exports.lua_tointegerx=Tt,t.exports.lua_tojsstring=function(t,n){let N=w(t,n);if(!N.ttisstring()){if(!ez.cvt2str(N))return null;eB.luaO_tostring(t,N)}return N.jsstring()},t.exports.lua_tolstring=Gt,t.exports.lua_tonumber=function(t,n){let N=Pt(t,n);return!1===N?0:N},t.exports.lua_tonumberx=Pt,t.exports.lua_topointer=function(t,n){let N=w(t,n);switch(N.ttype()){case eT:case eb:case e_:case em:case eO:case eE:case ey:return N.value;default:return null}},t.exports.lua_toproxy=function(t,n){var N,M,es;let ea,eo=w(t,n);return N=t.l_G,M=eo.type,es=eo.value,ea=function(t){eI(t,t instanceof eD.lua_State&&N===t.l_G,"must be from same global state"),t.stack[t.top]=new e$(M,es),xt(t)},eq.set(ea,N),ea},t.exports.lua_tostring=Gt,t.exports.lua_tothread=function(t,n){let N=w(t,n);return N.ttisthread()?N.value:null},t.exports.lua_touserdata=function(t,n){let N=w(t,n);switch(N.ttnov()){case eE:return N.value.data;case ey:return N.value;default:return null}},t.exports.lua_type=ge,t.exports.lua_typename=function(t,n){return eI(t,eL<=n&&n<ep,"invalid tag"),ej.ttypename(n)},t.exports.lua_upvalueid=function(t,n,N){let M=w(t,n);switch(M.ttype()){case eb:{let M=Le(t,n,N);return M.f.upvals[M.i]}case e_:{let n=M.value;return eI(t,(0|N)===N&&N>0&&N<=n.nupvalues,"invalid upvalue index"),n.upvalue[N-1]}default:return eI(t,!1,"closure expected"),null}},t.exports.lua_upvaluejoin=function(t,n,N,M,es){let ea=Le(t,n,N),eo=Le(t,M,es),el=eo.f.upvals[eo.i];ea.f.upvals[ea.i]=el},t.exports.lua_version=function(t){return null===t?eh:t.l_G.version},t.exports.lua_xmove=function(t,n,N){if(t!==n){Kt(t,N),eI(t,t.l_G===n.l_G,"moving among independent states"),eI(t,n.ci.top-n.top>=N,"stack overflow"),t.top-=N;for(let M=0;M<N;M++)n.stack[n.top]=new eB.TValue,eB.setobj2s(n,n.top,t.stack[t.top+M]),delete t.stack[t.top+M],n.top++}}},function(t,n,N){let{lua_assert:M}=N(4),s=function(t){let n=t.reader(t.L,t.data);if(null===n)return -1;M(n instanceof Uint8Array,"Should only load binary of array of bytes");let N=n.length;return 0===N?-1:(t.buffer=n,t.off=0,t.n=N-1,t.buffer[t.off++])};t.exports.EOZ=-1,t.exports.luaZ_buffer=function(t){return t.buffer.subarray(0,t.n)},t.exports.luaZ_buffremove=function(t,n){t.n-=n},t.exports.luaZ_fill=s,t.exports.luaZ_read=function(t,n,N,M){for(;M;){if(0===t.n){if(-1===s(t))return M;t.n++,t.off--}let es=M<=t.n?M:t.n;for(let M=0;M<es;M++)n[N++]=t.buffer[t.off++];t.n-=es,0===t.n&&(t.buffer=null),M-=es}return 0},t.exports.luaZ_resetbuffer=function(t){t.n=0},t.exports.luaZ_resizebuffer=function(t,n,N){let M=new Uint8Array(N);n.buffer&&M.set(n.buffer),n.buffer=M},t.exports.MBuffer=class{constructor(){this.buffer=null,this.n=0}},t.exports.ZIO=class{constructor(t,n,N){this.L=t,M("function"==typeof n,"ZIO requires a reader"),this.reader=n,this.data=N,this.n=0,this.buffer=null,this.off=0}zgetc(){return this.n-- >0?this.buffer[this.off++]:s(this)}}},function(t,n,N){let{constant_types:{LUA_TBOOLEAN:M,LUA_TLNGSTR:es},thread_status:{LUA_ERRSYNTAX:ea},to_luastring:eo}=N(1),{LUA_MINBUFFER:el,MAX_INT:eu,lua_assert:ec}=N(4),ef=N(11),eh=N(8),{lisdigit:ep,lislalnum:ed,lislalpha:e_,lisspace:eg,lisxdigit:em}=N(22),eb=N(6),{luaS_bless:ey,luaS_hash:ev,luaS_hashlongstr:ek,luaS_new:eL}=N(10),eA=N(9),{EOZ:ex,luaZ_buffer:ew,luaZ_buffremove:eT,luaZ_resetbuffer:eO,luaZ_resizebuffer:eE}=N(19),eS=eo("_ENV",!0),eN=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","//","..","...","==",">=","<=","~=","<<",">>","::","<eof>","<number>","<integer>","<name>","<string>"].map((t,n)=>eo(t));let $=class ${constructor(){this.r=NaN,this.i=NaN,this.ts=null}};let ft=class ft{constructor(){this.token=NaN,this.seminfo=new $}};let ht=function(t,n){let N=t.buff;if(N.n+1>N.buffer.length){N.buffer.length>=eu/2&&Yt(t,eo("lexical element too long",!0),0);let n=2*N.buffer.length;eE(t.L,N,n)}N.buffer[N.n++]=n<0?255+n+1:n},dt=function(t,n){if(n<257)return eb.luaO_pushfstring(t.L,eo("'%c'",!0),n);{let N=eN[n-257];return n<289?eb.luaO_pushfstring(t.L,eo("'%s'",!0),N):N}},mt=function(t){return 10===t.current||13===t.current},V=function(t){t.current=t.z.zgetc()},U=function(t){ht(t,t.current),V(t)},eU=new eb.TValue(M,!0),gt=function(t,n){let N=t.L,M=eL(N,n),ea=t.h.strong.get(ek(M));if(ea)M=ea.key.tsvalue();else{let n=new eb.TValue(es,M);eA.luaH_setfrom(N,t.h,n,eU)}return M},_t=function(t){let n=t.current;ec(mt(t)),V(t),mt(t)&&t.current!==n&&V(t),++t.linenumber>=eu&&Yt(t,eo("chunk has too many lines",!0),0)},St=function(t,n){return t.current===n&&(V(t),!0)},Xt=function(t,n){return(t.current===n[0].charCodeAt(0)||t.current===n[1].charCodeAt(0))&&(U(t),!0)},ee=function(t,n){let N="Ee",M=t.current;for(ec(ep(t.current)),U(t),48===M&&Xt(t,"xX")&&(N="Pp");;)if(Xt(t,N)&&Xt(t,"-+"),em(t.current))U(t);else{if(46!==t.current)break;U(t)}let es=new eb.TValue;return 0===eb.luaO_str2num(ew(t.buff),es)&&Yt(t,eo("malformed number",!0),290),es.ttisinteger()?(n.i=es.value,291):(ec(es.ttisfloat()),n.r=es.value,290)},Yt=function(t,n,N){n=ef.luaG_addinfo(t.L,n,t.source,t.linenumber),N&&eb.luaO_pushfstring(t.L,eo("%s near %s"),n,function(t,n){switch(n){case 292:case 293:case 290:case 291:return eb.luaO_pushfstring(t.L,eo("'%s'",!0),ew(t.buff));default:return dt(t,n)}}(t,N)),eh.luaD_throw(t.L,ea)},rt=function(t){let n=0,N=t.current;for(ec(91===N||93===N),U(t);61===t.current;)U(t),n++;return t.current===N?n:-n-1},ot=function(t,n,N){let M=t.linenumber;U(t),mt(t)&&_t(t);let es=!1;for(;!es;)switch(t.current){case ex:Yt(t,eo(`unfinished long ${n?"string":"comment"} (starting at line ${M})`),289);break;case 93:rt(t)===N&&(U(t),es=!0);break;case 10:case 13:ht(t,10),_t(t),n||eO(t.buff);break;default:n?U(t):V(t)}n&&(n.ts=gt(t,t.buff.buffer.subarray(2+N,t.buff.n-(2+N))))},It=function(t,n,N){n||(t.current!==ex&&U(t),Yt(t,N,293))},xt=function(t){return U(t),It(t,em(t.current),eo("hexadecimal digit expected",!0)),eb.luaO_hexavalue(t.current)},Kt=function(t){let n=xt(t);return n=(n<<4)+xt(t),eT(t.buff,2),n},m=function(t){let n=new Uint8Array(eb.UTF8BUFFSZ),N=eb.luaO_utf8esc(n,function(t){let n=4;U(t),It(t,123===t.current,eo("missing '{'",!0));let N=xt(t);for(U(t);em(t.current);)n++,N=(N<<4)+eb.luaO_hexavalue(t.current),It(t,N<=1114111,eo("UTF-8 value too large",!0)),U(t);return It(t,125===t.current,eo("missing '}'",!0)),V(t),eT(t.buff,n),N}(t));for(;N>0;N--)ht(t,n[eb.UTF8BUFFSZ-N])},pt=function(t){let n,N=0;for(n=0;n<3&&ep(t.current);n++)N=10*N+t.current-48,U(t);return It(t,N<=255,eo("decimal escape too large",!0)),eT(t.buff,n),N},tt=function(t,n,N){for(U(t);t.current!==n;)switch(t.current){case ex:Yt(t,eo("unfinished string",!0),289);break;case 10:case 13:Yt(t,eo("unfinished string",!0),293);break;case 92:{let n,N;switch(U(t),t.current){case 97:N=7,n="read_save";break;case 98:N=8,n="read_save";break;case 102:N=12,n="read_save";break;case 110:N=10,n="read_save";break;case 114:N=13,n="read_save";break;case 116:N=9,n="read_save";break;case 118:N=11,n="read_save";break;case 120:N=Kt(t),n="read_save";break;case 117:m(t),n="no_save";break;case 10:case 13:_t(t),N=10,n="only_save";break;case 92:case 34:case 39:N=t.current,n="read_save";break;case ex:n="no_save";break;case 122:for(eT(t.buff,1),V(t);eg(t.current);)mt(t)?_t(t):V(t);n="no_save";break;default:It(t,ep(t.current),eo("invalid escape sequence",!0)),N=pt(t),n="only_save"}"read_save"===n&&V(t),"read_save"!==n&&"only_save"!==n||(eT(t.buff,1),ht(t,N));break}default:U(t)}U(t),N.ts=gt(t,t.buff.buffer.subarray(1,t.buff.n-1))},eI=Object.create(null);eN.forEach((t,n)=>eI[ev(t)]=n);let S=function(t,n){for(eO(t.buff);;)switch(ec("number"==typeof t.current),t.current){case 10:case 13:_t(t);break;case 32:case 12:case 9:case 11:V(t);break;case 45:if(V(t),45!==t.current)return 45;if(V(t),91===t.current){let n=rt(t);if(eO(t.buff),n>=0){ot(t,null,n),eO(t.buff);break}}for(;!mt(t)&&t.current!==ex;)V(t);break;case 91:{let N=rt(t);return N>=0?(ot(t,n,N),293):(-1!==N&&Yt(t,eo("invalid long string delimiter",!0),293),91)}case 61:return V(t),St(t,61)?282:61;case 60:return V(t),St(t,61)?284:St(t,60)?286:60;case 62:return V(t),St(t,61)?283:St(t,62)?287:62;case 47:return V(t),St(t,47)?279:47;case 126:return V(t),St(t,61)?285:126;case 58:return V(t),St(t,58)?288:58;case 34:case 39:return tt(t,t.current,n),293;case 46:return U(t),St(t,46)?St(t,46)?281:280:ep(t.current)?ee(t,n):46;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return ee(t,n);case ex:return 289;default:if(e_(t.current)){do U(t);while(ed(t.current));let N=gt(t,ew(t.buff));n.ts=N;let M=eI[ek(N)];return void 0!==M&&M<=22?M+257:292}{let n=t.current;return V(t),n}}};t.exports.FIRST_RESERVED=257,t.exports.LUA_ENV=eS,t.exports.LexState=class{constructor(){this.current=NaN,this.linenumber=NaN,this.lastline=NaN,this.t=new ft,this.lookahead=new ft,this.fs=null,this.L=null,this.z=null,this.buff=null,this.h=null,this.dyd=null,this.source=null,this.envn=null}},t.exports.RESERVED={TK_AND:257,TK_BREAK:258,TK_DO:259,TK_ELSE:260,TK_ELSEIF:261,TK_END:262,TK_FALSE:263,TK_FOR:264,TK_FUNCTION:265,TK_GOTO:266,TK_IF:267,TK_IN:268,TK_LOCAL:269,TK_NIL:270,TK_NOT:271,TK_OR:272,TK_REPEAT:273,TK_RETURN:274,TK_THEN:275,TK_TRUE:276,TK_UNTIL:277,TK_WHILE:278,TK_IDIV:279,TK_CONCAT:280,TK_DOTS:281,TK_EQ:282,TK_GE:283,TK_LE:284,TK_NE:285,TK_SHL:286,TK_SHR:287,TK_DBCOLON:288,TK_EOS:289,TK_FLT:290,TK_INT:291,TK_NAME:292,TK_STRING:293},t.exports.isreserved=function(t){let n=eI[ek(t)];return void 0!==n&&n<=22},t.exports.luaX_lookahead=function(t){return ec(289===t.lookahead.token),t.lookahead.token=S(t,t.lookahead.seminfo),t.lookahead.token},t.exports.luaX_newstring=gt,t.exports.luaX_next=function(t){t.lastline=t.linenumber,289!==t.lookahead.token?(t.t.token=t.lookahead.token,t.t.seminfo.i=t.lookahead.seminfo.i,t.t.seminfo.r=t.lookahead.seminfo.r,t.t.seminfo.ts=t.lookahead.seminfo.ts,t.lookahead.token=289):t.t.token=S(t,t.t.seminfo)},t.exports.luaX_setinput=function(t,n,N,M,es){n.t={token:0,seminfo:new $},n.L=t,n.current=es,n.lookahead={token:289,seminfo:new $},n.z=N,n.fs=null,n.linenumber=1,n.lastline=1,n.source=M,n.envn=ey(t,eS),eE(t,n.buff,el)},t.exports.luaX_syntaxerror=function(t,n){Yt(t,n,t.t.token)},t.exports.luaX_token2str=dt,t.exports.luaX_tokens=eN},function(t,n,N){let M,es,ea;let{lua:eo,lauxlib:el,lualib:eu,to_luastring:ec}=N(0),{LUA_MULTRET:ef,LUA_OK:eh,LUA_REGISTRYINDEX:ep,LUA_RIDX_MAINTHREAD:ed,LUA_TBOOLEAN:e_,LUA_TFUNCTION:eg,LUA_TLIGHTUSERDATA:em,LUA_TNIL:eb,LUA_TNONE:ey,LUA_TNUMBER:ev,LUA_TSTRING:ek,LUA_TTABLE:eL,LUA_TTHREAD:eA,LUA_TUSERDATA:ex,lua_atnativeerror:ew,lua_call:eT,lua_getfield:eO,lua_gettable:eE,lua_gettop:eS,lua_isnil:eN,lua_isproxy:eU,lua_newuserdata:eI,lua_pcall:eR,lua_pop:eC,lua_pushboolean:eP,lua_pushcfunction:eM,lua_pushinteger:eB,lua_pushlightuserdata:eD,lua_pushliteral:eK,lua_pushnil:eF,lua_pushnumber:eV,lua_pushstring:ej,lua_pushvalue:eG,lua_rawgeti:ez,lua_rawgetp:eH,lua_rawsetp:eX,lua_rotate:e$,lua_setfield:eW,lua_settable:eq,lua_settop:eZ,lua_toboolean:eY,lua_tojsstring:eJ,lua_tonumber:eQ,lua_toproxy:e1,lua_tothread:e0,lua_touserdata:e2,lua_type:e3}=eo,{luaL_argerror:e5,luaL_checkany:e4,luaL_checkoption:e8,luaL_checkstack:e6,luaL_checkudata:e9,luaL_error:e7,luaL_getmetafield:ta,luaL_newlib:to,luaL_newmetatable:tl,luaL_requiref:tu,luaL_setfuncs:tc,luaL_setmetatable:tf,luaL_testudata:th,luaL_tolstring:tp}=el,{luaopen_base:td}=eu,t_="u">typeof window?window:"u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this");if("u">typeof Reflect)M=Reflect.apply,es=Reflect.construct,ea=Reflect.deleteProperty;else{let t=Function.apply,n=Function.bind;M=function(n,N,M){return t.call(n,N,M)},es=function(t,N){switch(N.length){case 0:return new t;case 1:return new t(N[0]);case 2:return new t(N[0],N[1]);case 3:return new t(N[0],N[1],N[2]);case 4:return new t(N[0],N[1],N[2],N[3])}let M=[null];return M.push.apply(M,N),new(n.apply(t,M))},ea=Function("t","k","delete t[k]")}let tg=String.prototype.concat.bind(""),Wt=function(t){return"object"==typeof t?null!==t:"function"==typeof t},tm=ec("js object"),ge=function(t,n){let N=th(t,n,tm);return N?N.data:void 0},ye=function(t,n){return e9(t,n,tm).data},Ie=function(t,n){eI(t).data=n,tf(t,tm)},ae=function(t){ez(t,ep,ed);let n=e0(t,-1);return eC(t,1),n},tb=new WeakMap,Le=function(t,n){switch(typeof n){case"undefined":eF(t);break;case"number":eV(t,n);break;case"string":ej(t,ec(n));break;case"boolean":eP(t,n);break;case"symbol":eD(t,n);break;case"function":if(eU(n,t)){n(t);break}case"object":if(null===n){if(eH(t,ep,null)!==ex)throw Error("js library not loaded into lua_State");break}default:{let N=tb.get(ae(t));if(!N)throw Error("js library not loaded into lua_State");let M=N.get(n);M?M(t):(Ie(t,n),M=e1(t,-1),N.set(n,M))}}},o=function(t){let n=e2(t,1);return Le(t,n),1},u=function(t,n){switch(e3(t,n)){case ey:case eb:return;case e_:return eY(t,n);case em:return e2(t,n);case ev:return eQ(t,n);case ek:return eJ(t,n);case ex:{let N=ge(t,n);if(void 0!==N)return N}default:return ke(t,e1(t,n))}},A=function(t,n){let N=eR(t,n,1,0),M=u(t,-1);if(eC(t,1),N===eh)return M;throw M},h=function(t,n,N,M,es){if(!Wt(M))throw TypeError("`args` argument must be an object");let ea=+M.length;ea>=0||(ea=0),e6(t,2+ea,null);let eo=eS(t);n(t),Le(t,N);for(let n=0;n<ea;n++)Le(t,M[n]);if(eR(t,1+ea,es,0)===eh){let n=eS(t)-eo,N=Array(n);for(let M=0;M<n;M++)N[M]=u(t,eo+M+1);return eZ(t,eo),N}{let n=u(t,-1);throw eZ(t,eo),n}},x=function(t){return eE(t,1),1},H=function(t,n,N){return e6(t,3,null),eM(t,x),n(t),Le(t,N),A(t,2)},I=function(t,n,N){if(e6(t,3,null),eM(t,x),n(t),Le(t,N),eR(t,2,1,0)===eh){let n=eN(t,-1);return eC(t,1),!n}{let n=u(t,-1);throw eC(t,1),n}},ct=function(t,n,N,M){if(e6(t,4,null),eM(t,function(t){return eq(t,1),0}),n(t),Le(t,N),Le(t,M),eR(t,3,0,0)!==eh){let n=u(t,-1);throw eC(t,1),n}},Vt=function(t,n,N){if(e6(t,4,null),eM(t,function(t){return eq(t,1),0}),n(t),Le(t,N),eF(t),eR(t,3,0,0)!==eh){let n=u(t,-1);throw eC(t,1),n}},Jt=function(t,n){return e6(t,2,null),eM(t,function(t){return tp(t,1),1}),n(t),A(t,1)},ve=function(){let t=this.L;e6(t,3,null);let n=eS(t);if(this.iter(t),this.state(t),this.last(t),eR(t,2,ef,0)===eh){let N;if(this.last=e1(t,n+1),eN(t,-1))N={done:!0,value:void 0};else{let M=eS(t)-n,es=Array(M);for(let N=0;N<M;N++)es[N]=u(t,n+N+1);N={done:!1,value:es}}return eZ(t,n),N}{let n=u(t,-1);throw eC(t,1),n}},ke=function(t,n){let N=ae(t),Zt=function(){return h(N,n,this,arguments,1)[0]};Zt.apply=function(t,M){return h(N,n,t,M,1)[0]},Zt.invoke=function(t,M){return h(N,n,t,M,ef)},Zt.get=function(t){return H(N,n,t)},Zt.has=function(t){return I(N,n,t)},Zt.set=function(t,M){return ct(N,n,t,M)},Zt.delete=function(t){return Vt(N,n,t)},Zt.toString=function(){return Jt(N,n)},"function"==typeof Symbol&&(Zt[Symbol.toStringTag]="Fengari object",Zt[Symbol.iterator]=function(){return function(t,n){if(e6(t,1,null),eM(t,function(t){return tu(t,ec("_G"),td,0),eO(t,-1,ec("pairs")),n(t),eT(t,1,3),3}),eR(t,0,3,0)===eh){let n=e1(t,-3),N=e1(t,-2),M=e1(t,-1);return eC(t,3),{L:t,iter:n,state:N,last:M,next:ve}}{let n=u(t,-1);throw eC(t,1),n}}(N,n)},Symbol.toPrimitive&&(Zt[Symbol.toPrimitive]=function(t){if("string"===t)return Jt(N,n)}));let M=tb.get(N);if(!M)throw Error("js library not loaded into lua_State");return M.set(Zt,n),Zt},ty={new:function(t){let n=u(t,1),N=eS(t)-1,M=Array(N);for(let n=0;n<N;n++)M[n]=u(t,n+2);return Le(t,es(n,M)),1},tonumber:function(t){let n=u(t,1);return eV(t,+n),1},tostring:function(t){let n=u(t,1);return eK(t,tg(n)),1},instanceof:function(t){let n=u(t,1),N=u(t,2);return eP(t,n instanceof N),1},typeof:function(t){let n=u(t,1);return eK(t,typeof n),1}};if("function"==typeof Symbol&&Symbol.iterator){let W=function(t,n){let N=ye(t,n),es=N[Symbol.iterator];es||e5(t,n,ec("object not iterable"));let ea=M(es,N,[]);return Wt(ea)||e5(t,n,ec("Result of the Symbol.iterator method is not an object")),ea},Rt=function(t){let n=u(t,1).next();return n.done?0:(Le(t,n.value),1)};ty.of=function(t){let n=W(t,1);return eM(t,Rt),Le(t,n),2}}if("function"==typeof Proxy&&"function"==typeof Symbol){let t=Symbol("lua_State"),n=Symbol("fengari-proxy"),N={apply:function(N,M,es){return h(N[t],N[n],M,es,1)[0]},construct:function(N,M){let es=N[t],ea=N[n],eo=M.length;e6(es,2+eo,null),ea(es);let el=eS(es);if(ta(es,el,ec("construct"))===eb)throw eC(es,1),TypeError("not a constructor");e$(es,el,1);for(let t=0;t<eo;t++)Le(es,M[t]);return A(es,1+eo)},defineProperty:function(N,M,es){let ea=N[t],eo=N[n];return e6(ea,4,null),eo(ea),ta(ea,-1,ec("defineProperty"))===eb?(eC(ea,1),!1):(e$(ea,-2,1),Le(ea,M),Le(ea,es),A(ea,3))},deleteProperty:function(N,M){return Vt(N[t],N[n],M)},get:function(N,M){return H(N[t],N[n],M)},getOwnPropertyDescriptor:function(N,M){let es=N[t],ea=N[n];if(e6(es,3,null),ea(es),ta(es,-1,ec("getOwnPropertyDescriptor"))!==eb)return e$(es,-2,1),Le(es,M),A(es,2);eC(es,1)},getPrototypeOf:function(N){let M=N[t],es=N[n];return e6(M,2,null),es(M),ta(M,-1,ec("getPrototypeOf"))===eb?(eC(M,1),null):(e$(M,-2,1),A(M,1))},has:function(N,M){return I(N[t],N[n],M)},ownKeys:function(N){let M=N[t],es=N[n];if(e6(M,2,null),es(M),ta(M,-1,ec("ownKeys"))===eb)throw eC(M,1),Error("ownKeys unknown for fengari object");return e$(M,-2,1),A(M,1)},set:function(N,M,es){return ct(N[t],N[n],M,es),!0},setPrototypeOf:function(N,M){let es=N[t],ea=N[n];return e6(es,3,null),ea(es),ta(es,-1,ec("setPrototypeOf"))===eb?(eC(es,1),!1):(e$(es,-2,1),Le(es,M),A(es,2))}},Zt=function(){let t=(function(){}).bind();return delete t.length,delete t.name,t},M=Function("return ()=>void 0;"),pe=function(){let t=M();return delete t.length,delete t.name,t},ue=function(M,es,ea){let eo;let el=ae(M);switch(ea){case"function":eo=Zt();break;case"arrow_function":eo=pe();break;case"object":eo={};break;default:throw TypeError("invalid type to createproxy")}return eo[n]=es,eo[t]=el,new Proxy(eo,N)},es=["function","arrow_function","object"],ea=es.map(t=>ec(t));ty.createproxy=function(t){e4(t,1);let n=es[e8(t,2,ea[0],ea)],N=ue(t,e1(t,1),n);return Le(t,N),1}}let tv={__index:function(t){let n=ye(t,1),N=u(t,2);return Le(t,n[N]),1},__newindex:function(t){let n=ye(t,1),N=u(t,2),M=u(t,3);return void 0===M?ea(n,N):n[N]=M,0},__tostring:function(t){let n=tg(ye(t,1));return ej(t,ec(n)),1},__call:function(t){let n,N=ye(t,1),es=eS(t)-1,ea=Array(Math.max(0,es-1));if(es>0&&(n=u(t,2),es-- >0))for(let n=0;n<es;n++)ea[n]=u(t,n+3);return Le(t,M(N,n,ea)),1},__pairs:function(t){let n,N,es,ea,eo=ye(t,1);if("function"!=typeof Symbol||void 0===(n=eo[Symbol.for("__pairs")]))N=function(t){if(this.index>=this.keys.length)return;let n=this.keys[this.index++];return[n,this.object[n]]},es={object:eo,keys:Object.keys(eo),index:0};else{let el=M(n,eo,[]);void 0===el&&e7(t,ec("bad '__pairs' result (object with keys 'iter', 'state', 'first' expected)")),void 0===(N=el.iter)&&e7(t,ec("bad '__pairs' result (object.iter is missing)")),es=el.state,ea=el.first}return eM(t,function(){let n=u(t,1),es=u(t,2),ea=M(N,n,[es]);if(void 0===ea)return 0;Array.isArray(ea)||e7(t,ec("bad iterator result (Array or undefined expected)")),e6(t,ea.length,null);for(let n=0;n<ea.length;n++)Le(t,ea[n]);return ea.length}),Le(t,es),Le(t,ea),3},__len:function(t){let n,N=ye(t,1);return Le(t,"function"!=typeof Symbol||void 0===(n=N[Symbol.for("__len")])?N.length:M(n,N,[])),1}};t.exports.FENGARI_INTEROP_VERSION="0.1",t.exports.FENGARI_INTEROP_VERSION_NUM=1,t.exports.FENGARI_INTEROP_RELEASE="0.1.2",t.exports.checkjs=ye,t.exports.testjs=ge,t.exports.pushjs=Ie,t.exports.push=Le,t.exports.tojs=u,t.exports.luaopen_js=function(t){return tb.set(ae(t),new WeakMap),ew(t,o),to(t,ty),eK(t,"0.1"),eW(t,-2,ec("_VERSION")),eB(t,1),eW(t,-2,ec("_VERSION_NUM")),eK(t,"0.1.2"),eW(t,-2,ec("_RELEASE")),tl(t,tm),tc(t,tv,0),eC(t,1),Ie(t,null),eG(t,-1),eX(t,ep,null),eW(t,-2,ec("null")),Le(t,t_),eW(t,-2,ec("global")),1}},function(t,n,N){let{luastring_of:M}=N(1),es=M(0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,22,22,22,22,22,22,22,22,22,22,4,4,4,4,4,4,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,5,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);t.exports.lisdigit=function(t){return(2&es[t+1])!=0},t.exports.lislalnum=function(t){return(3&es[t+1])!=0},t.exports.lislalpha=function(t){return(1&es[t+1])!=0},t.exports.lisprint=function(t){return(4&es[t+1])!=0},t.exports.lisspace=function(t){return(8&es[t+1])!=0},t.exports.lisxdigit=function(t){return(16&es[t+1])!=0}},function(t,n,N){let{LUA_MULTRET:M,to_luastring:es}=N(1),{BinOpr:{OPR_ADD:ea,OPR_AND:eo,OPR_BAND:el,OPR_BOR:eu,OPR_BXOR:ec,OPR_CONCAT:ef,OPR_DIV:eh,OPR_EQ:ep,OPR_GE:ed,OPR_GT:e_,OPR_IDIV:eg,OPR_LE:em,OPR_LT:eb,OPR_MOD:ey,OPR_MUL:ev,OPR_NE:ek,OPR_NOBINOPR:eL,OPR_OR:eA,OPR_POW:ex,OPR_SHL:ew,OPR_SHR:eT,OPR_SUB:eO},UnOpr:{OPR_BNOT:eE,OPR_LEN:eS,OPR_MINUS:eN,OPR_NOT:eU,OPR_NOUNOPR:eI},NO_JUMP:eR,getinstruction:eC,luaK_checkstack:eP,luaK_codeABC:eM,luaK_codeABx:eB,luaK_codeAsBx:eD,luaK_codek:eK,luaK_concat:eF,luaK_dischargevars:eV,luaK_exp2RK:ej,luaK_exp2anyreg:eG,luaK_exp2anyregup:ez,luaK_exp2nextreg:eH,luaK_exp2val:eX,luaK_fixline:e$,luaK_getlabel:eW,luaK_goiffalse:eq,luaK_goiftrue:eZ,luaK_indexed:eY,luaK_infix:eJ,luaK_intK:eQ,luaK_jump:e1,luaK_jumpto:e0,luaK_nil:e2,luaK_patchclose:e3,luaK_patchlist:e5,luaK_patchtohere:e4,luaK_posfix:e8,luaK_prefix:e6,luaK_reserveregs:e9,luaK_ret:e7,luaK_self:ta,luaK_setlist:to,luaK_setmultret:tl,luaK_setoneret:tu,luaK_setreturns:tc,luaK_storevar:tf,luaK_stringK:th}=N(35),tp=N(8),td=N(13),t_=N(20),{LUAI_MAXCCALLS:tg,MAX_INT:tm,lua_assert:tb}=N(4),ty=N(6),{OpCodesI:{OP_CALL:tv,OP_CLOSURE:tk,OP_FORLOOP:tL,OP_FORPREP:tA,OP_GETUPVAL:tx,OP_MOVE:tw,OP_NEWTABLE:tT,OP_SETTABLE:tO,OP_TAILCALL:tE,OP_TFORCALL:tS,OP_TFORLOOP:tN,OP_VARARG:tU},LFIELDS_PER_FLUSH:tI,SETARG_B:tR,SETARG_C:tC,SET_OPCODE:tP}=N(16),{luaS_eqlngstr:tM,luaS_new:tB,luaS_newliteral:tD}=N(10),tK=N(9),tF=td.Proto,tV=t_.RESERVED,Zt=function(t){return t===tj.VCALL||t===tj.VVARARG},he=function(t,n){return tM(t,n)};let pe=class pe{constructor(){this.previous=null,this.firstlabel=NaN,this.firstgoto=NaN,this.nactvar=NaN,this.upval=NaN,this.isloop=NaN}};let tj={VVOID:0,VNIL:1,VTRUE:2,VFALSE:3,VK:4,VKFLT:5,VKINT:6,VNONRELOC:7,VLOCAL:8,VUPVAL:9,VINDEXED:10,VJMP:11,VRELOCABLE:12,VCALL:13,VVARARG:14};let xe=class xe{constructor(){this.k=NaN,this.u={ival:NaN,nval:NaN,info:NaN,ind:{idx:NaN,t:NaN,vt:NaN}},this.t=NaN,this.f=NaN}to(t){this.k=t.k,this.u=t.u,this.t=t.t,this.f=t.f}};let Ke=class Ke{constructor(){this.f=null,this.prev=null,this.ls=null,this.bl=null,this.pc=NaN,this.lasttarget=NaN,this.jpc=NaN,this.nk=NaN,this.np=NaN,this.firstlocal=NaN,this.nlocvars=NaN,this.nactvar=NaN,this.nups=NaN,this.freereg=NaN}};let me=class me{constructor(){this.arr=[],this.n=NaN,this.size=NaN}};let Ee=function(t,n){t.t.token=0,t_.luaX_syntaxerror(t,n)},Ae=function(t,n){t_.luaX_syntaxerror(t,ty.luaO_pushfstring(t.L,es("%s expected",!0),t_.luaX_token2str(t,n)))},Pe=function(t,n,N,M){let ea,eo,el,eu;n>N&&(ea=t.ls.L,el=0===(eo=t.f.linedefined)?es("main function",!0):ty.luaO_pushfstring(ea,es("function at line %d",!0),eo),eu=ty.luaO_pushfstring(ea,es("too many %s (limit is %d) in %s",!0),M,N,el),t_.luaX_syntaxerror(t.ls,eu))},Me=function(t,n){return t.t.token===n&&(t_.luaX_next(t),!0)},We=function(t,n){t.t.token!==n&&Ae(t,n)},Ge=function(t,n){We(t,n),t_.luaX_next(t)},Ze=function(t,n,N){n||t_.luaX_syntaxerror(t,N)},Xe=function(t,n,N,M){Me(t,n)||(M===t.linenumber?Ae(t,n):t_.luaX_syntaxerror(t,ty.luaO_pushfstring(t.L,es("%s expected (to close %s at line %d)"),t_.luaX_token2str(t,n),t_.luaX_token2str(t,N),M)))},D=function(t){We(t,tV.TK_NAME);let n=t.t.seminfo.ts;return t_.luaX_next(t),n},kt=function(t,n,N){t.f=t.t=eR,t.k=n,t.u.info=N},Ht=function(t,n,N){kt(n,tj.VK,th(t.fs,N))},qt=function(t,n){Ht(t,n,D(t))},se=function(t,n){let N,M;let ea=t.fs,eo=t.dyd,el=((M=(N=t.fs).f).locvars[N.nlocvars]=new ty.LocVar,M.locvars[N.nlocvars].varname=n,N.nlocvars++);Pe(ea,eo.actvar.n+1-ea.firstlocal,200,es("local variables",!0)),eo.actvar.arr[eo.actvar.n]=new class{constructor(){this.idx=NaN}},eo.actvar.arr[eo.actvar.n].idx=el,eo.actvar.n++},jt=function(t,n){se(t,t_.luaX_newstring(t,es(n,!0)))},$t=function(t,n){let N=t.ls.dyd.actvar.arr[t.firstlocal+n].idx;return tb(N<t.nlocvars),t.f.locvars[N]},Bt=function(t,n){let N=t.fs;for(N.nactvar=N.nactvar+n;n;n--)$t(N,N.nactvar-n).startpc=N.pc},te=function(t,n,N){let M=t.f;return Pe(t,t.nups+1,td.MAXUPVAL,es("upvalues",!0)),M.upvalues[t.nups]={instack:N.k===tj.VLOCAL,idx:N.u.info,name:n},t.nups++},le=function(t,n,N,M){if(null===t)kt(N,tj.VVOID,0);else{let es=function(t,n){for(let N=t.nactvar-1;N>=0;N--)if(he(n,$t(t,N).varname))return N;return -1}(t,n);if(es>=0)kt(N,tj.VLOCAL,es),M||function(t,n){let N=t.bl;for(;N.nactvar>n;)N=N.previous;N.upval=1}(t,es);else{let M=function(t,n){let N=t.f.upvalues;for(let M=0;M<t.nups;M++)if(he(N[M].name,n))return M;return -1}(t,n);if(M<0){if(le(t.prev,n,N,0),N.k===tj.VVOID)return;M=te(t,n,N)}kt(N,tj.VUPVAL,M)}}},y=function(t,n){let N=D(t),M=t.fs;if(le(M,N,n,1),n.k===tj.VVOID){let es=new xe;le(M,t.envn,n,1),tb(n.k!==tj.VVOID),Ht(t,es,N),eY(M,n,es)}},nt=function(t,n,N,M){let es=t.fs,ea=n-N;if(Zt(M.k))++ea<0&&(ea=0),tc(es,M,ea),ea>1&&e9(es,ea-1);else if(M.k!==tj.VVOID&&eH(es,M),ea>0){let t=es.freereg;e9(es,ea),e2(es,t,ea)}N>n&&(t.fs.freereg-=N-n)},et=function(t){let n=t.L;++n.nCcalls,Pe(t.fs,n.nCcalls,tg,es("JS levels",!0))},wt=function(t){return t.L.nCcalls--},yt=function(t,n,N){let M=t.fs,ea=t.dyd.gt,eo=ea.arr[n];if(tb(he(eo.name,N.name)),eo.nactvar<N.nactvar){let n=$t(M,eo.nactvar).varname,N=ty.luaO_pushfstring(t.L,es("<goto %s> at line %d jumps into the scope of local '%s'"),eo.name.getstr(),eo.line,n.getstr());Ee(t,N)}e5(M,eo.pc,N.pc);for(let t=n;t<ea.n-1;t++)ea.arr[t]=ea.arr[t+1];ea.n--},Lt=function(t,n){let N=t.fs.bl,M=t.dyd,es=M.gt.arr[n];for(let ea=N.firstlabel;ea<M.label.n;ea++){let eo=M.label.arr[ea];if(he(eo.name,es.name))return es.nactvar>eo.nactvar&&(N.upval||M.label.n>N.firstlabel)&&e3(t.fs,es.pc,eo.nactvar),yt(t,n,eo),!0}return!1},oe=function(t,n,N,M,es){let ea=n.n;return n.arr[ea]=new class{constructor(){this.name=null,this.pc=NaN,this.line=NaN,this.nactvar=NaN}},n.arr[ea].name=N,n.arr[ea].line=M,n.arr[ea].nactvar=t.fs.nactvar,n.arr[ea].pc=es,n.n=ea+1,ea},de=function(t,n){let N=t.dyd.gt,M=t.fs.bl.firstgoto;for(;M<N.n;)he(N.arr[M].name,n.name)?yt(t,M,n):M++},be=function(t,n,N){n.isloop=N,n.nactvar=t.nactvar,n.firstlabel=t.ls.dyd.label.n,n.firstgoto=t.ls.dyd.gt.n,n.upval=0,n.previous=t.bl,t.bl=n,tb(t.freereg===t.nactvar)},Ne=function(t,n,N){n.prev=t.fs,n.ls=t,t.fs=n,n.pc=0,n.lasttarget=0,n.jpc=eR,n.freereg=0,n.nk=0,n.np=0,n.nups=0,n.nlocvars=0,n.nactvar=0,n.firstlocal=t.dyd.actvar.n,n.bl=null;let M=n.f;M.source=t.source,M.maxstacksize=2,be(n,N,!1)},C=function(t){var n;let N,M,ea,eo=t.bl,el=t.ls;if(eo.previous&&eo.upval){let n=e1(t);e3(t,n,eo.nactvar),e4(t,n)}eo.isloop&&(N=tD(el.L,"break"),M=oe(el,el.dyd.label,N,0,el.fs.pc),de(el,el.dyd.label.arr[M])),t.bl=eo.previous,function(t,n){for(t.ls.dyd.actvar.n-=t.nactvar-n;t.nactvar>n;)$t(t,--t.nactvar).endpc=t.pc}(t,eo.nactvar),tb(eo.nactvar===t.nactvar),t.freereg=t.nactvar,el.dyd.label.n=eo.firstlabel,eo.previous?function(t,n){let N=n.firstgoto,M=t.ls.dyd.gt;for(;N<M.n;){let es=M.arr[N];es.nactvar>n.nactvar&&(n.upval&&e3(t,es.pc,n.nactvar),es.nactvar=n.nactvar),Lt(t.ls,N)||N++}}(t,eo):eo.firstgoto<el.dyd.gt.n&&(n=el.dyd.gt.arr[eo.firstgoto],ea=t_.isreserved(n.name)?"<%s> at line %d not inside a loop":"no visible label '%s' for <goto> at line %d",ea=ty.luaO_pushfstring(el.L,es(ea),n.name.getstr(),n.line),Ee(el,ea))},J=function(t){let n=t.fs;e7(n,0,0),C(n),tb(null===n.bl),t.fs=n.prev},Et=function(t,n){switch(t.t.token){case tV.TK_ELSE:case tV.TK_ELSEIF:case tV.TK_END:case tV.TK_EOS:return!0;case tV.TK_UNTIL:return n;default:return!1}},re=function(t){for(;!Et(t,1);){if(t.t.token===tV.TK_RETURN)return void Ir(t);Ir(t)}},we=function(t,n){let N=t.fs,M=new xe;ez(N,n),t_.luaX_next(t),qt(t,M),eY(N,n,M)},Be=function(t,n){t_.luaX_next(t),cn(t,n),eX(t.fs,n),Ge(t,93)},$e=function(t,n){let N=t.fs,M=t.fs.freereg,ea=new xe,eo=new xe;t.t.token===tV.TK_NAME?(Pe(N,n.nh,tm,es("items in a constructor",!0)),qt(t,ea)):Be(t,ea),n.nh++,Ge(t,61);let el=ej(N,ea);cn(t,eo),eM(N,tO,n.t.u.info,el,ej(N,eo)),N.freereg=M},pn=function(t,n){n.v.k!==tj.VVOID&&(eH(t,n.v),n.v.k=tj.VVOID,n.tostore===tI&&(to(t,n.t.u.info,n.na,n.tostore),n.tostore=0))},vn=function(t,n){cn(t,n.v),Pe(t.fs,n.na,tm,es("items in a constructor",!0)),n.na++,n.tostore++},bn=function(t,n){switch(t.t.token){case tV.TK_NAME:61!==t_.luaX_lookahead(t)?vn(t,n):$e(t,n);break;case 91:$e(t,n);break;default:vn(t,n)}},ln=function(t,n){let N=t.fs,es=t.linenumber,ea=eM(N,tT,0,0,0),eo=new class{constructor(){this.v=new xe,this.t=new xe,this.nh=NaN,this.na=NaN,this.tostore=NaN}};eo.na=eo.nh=eo.tostore=0,eo.t=n,kt(n,tj.VRELOCABLE,ea),kt(eo.v,tj.VVOID,0),eH(t.fs,n),Ge(t,123);do{if(tb(eo.v.k===tj.VVOID||eo.tostore>0),125===t.t.token)break;pn(N,eo),bn(t,eo)}while(Me(t,44)||Me(t,59));Xe(t,125,123,es),0!==eo.tostore&&(Zt(eo.v.k)?(tl(N,eo.v),to(N,eo.t.u.info,eo.na,M),eo.na--):(eo.v.k!==tj.VVOID&&eH(N,eo.v),to(N,eo.t.u.info,eo.na,eo.tostore))),tR(N.f.code[ea],ty.luaO_int2fb(eo.na)),tC(N.f.code[ea],ty.luaO_int2fb(eo.nh))},je=function(t,n,N,M){let ea,eo,el,eu,ec=new Ke,ef=new pe;ec.f=(ea=t.L,eo=new tF(ea),(el=t.fs).f.p[el.np++]=eo,eo),ec.f.linedefined=M,Ne(t,ec,ef),Ge(t,40),N&&(jt(t,"self"),Bt(t,1)),function(t){let n=t.fs,N=n.f,M=0;if(N.is_vararg=!1,41!==t.t.token)do switch(t.t.token){case tV.TK_NAME:se(t,D(t)),M++;break;case tV.TK_DOTS:t_.luaX_next(t),N.is_vararg=!0;break;default:t_.luaX_syntaxerror(t,es("<name> or '...' expected",!0))}while(!N.is_vararg&&Me(t,44));Bt(t,M),N.numparams=n.nactvar,e9(n,n.nactvar)}(t),Ge(t,41),re(t),ec.f.lastlinedefined=t.linenumber,Xe(t,tV.TK_END,tV.TK_FUNCTION,M),eu=t.fs.prev,kt(n,tj.VRELOCABLE,eB(eu,tk,0,eu.np-1)),eH(eu,n),J(t)},un=function(t,n){let N=1;for(cn(t,n);Me(t,44);)eH(t.fs,n),cn(t,n),N++;return N},ps=function(t,n,N){let ea,eo=t.fs,el=new xe;switch(t.t.token){case 40:t_.luaX_next(t),41===t.t.token?el.k=tj.VVOID:(un(t,el),tl(eo,el)),Xe(t,41,40,N);break;case 123:ln(t,el);break;case tV.TK_STRING:Ht(t,el,t.t.seminfo.ts),t_.luaX_next(t);break;default:t_.luaX_syntaxerror(t,es("function arguments expected",!0))}tb(n.k===tj.VNONRELOC);let eu=n.u.info;Zt(el.k)?ea=M:(el.k!==tj.VVOID&&eH(eo,el),ea=eo.freereg-(eu+1)),kt(n,tj.VCALL,eM(eo,tv,eu,ea+1,2)),e$(eo,N),eo.freereg=eu+1},Sr=function(t,n){let N=t.fs,M=t.linenumber;for(!function(t,n){switch(t.t.token){case 40:{let N=t.linenumber;return t_.luaX_next(t),cn(t,n),Xe(t,41,40,N),void eV(t.fs,n)}case tV.TK_NAME:return void y(t,n);default:t_.luaX_syntaxerror(t,es("unexpected symbol",!0))}}(t,n);;)switch(t.t.token){case 46:we(t,n);break;case 91:{let M=new xe;ez(N,n),Be(t,M),eY(N,n,M);break}case 58:{let es=new xe;t_.luaX_next(t),qt(t,es),ta(N,n,es),ps(t,n,M);break}case 40:case tV.TK_STRING:case 123:eH(N,n),ps(t,n,M);break;default:return}},tG=[{left:10,right:10},{left:10,right:10},{left:11,right:11},{left:11,right:11},{left:14,right:13},{left:11,right:11},{left:11,right:11},{left:6,right:6},{left:4,right:4},{left:5,right:5},{left:7,right:7},{left:7,right:7},{left:9,right:8},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:2,right:2},{left:1,right:1}],Nr=function(t,n,N){et(t);let M=function(t){switch(t){case tV.TK_NOT:return eU;case 45:return eN;case 126:return eE;case 35:return eS;default:return eI}}(t.t.token);if(M!==eI){let N=t.linenumber;t_.luaX_next(t),Nr(t,n,12),e6(t.fs,M,n,N)}else!function(t,n){switch(t.t.token){case tV.TK_FLT:kt(n,tj.VKFLT,0),n.u.nval=t.t.seminfo.r;break;case tV.TK_INT:kt(n,tj.VKINT,0),n.u.ival=t.t.seminfo.i;break;case tV.TK_STRING:Ht(t,n,t.t.seminfo.ts);break;case tV.TK_NIL:kt(n,tj.VNIL,0);break;case tV.TK_TRUE:kt(n,tj.VTRUE,0);break;case tV.TK_FALSE:kt(n,tj.VFALSE,0);break;case tV.TK_DOTS:{let N=t.fs;Ze(t,N.f.is_vararg,es("cannot use '...' outside a vararg function",!0)),kt(n,tj.VVARARG,eM(N,tU,0,1,0));break}case 123:return void ln(t,n);case tV.TK_FUNCTION:return t_.luaX_next(t),void je(t,n,0,t.linenumber);default:return void Sr(t,n)}t_.luaX_next(t)}(t,n);let eR=function(t){switch(t){case 43:return ea;case 45:return eO;case 42:return ev;case 37:return ey;case 94:return ex;case 47:return eh;case tV.TK_IDIV:return eg;case 38:return el;case 124:return eu;case 126:return ec;case tV.TK_SHL:return ew;case tV.TK_SHR:return eT;case tV.TK_CONCAT:return ef;case tV.TK_NE:return ek;case tV.TK_EQ:return ep;case 60:return eb;case tV.TK_LE:return em;case 62:return e_;case tV.TK_GE:return ed;case tV.TK_AND:return eo;case tV.TK_OR:return eA;default:return eL}}(t.t.token);for(;eR!==eL&&tG[eR].left>N;){let N=new xe,M=t.linenumber;t_.luaX_next(t),eJ(t.fs,eR,n);let es=Nr(t,N,tG[eR].right);e8(t.fs,eR,n,N,M),eR=es}return wt(t),eR},cn=function(t,n){Nr(t,n,0)},Yn=function(t){let n=t.fs;be(n,new pe,0),re(t),C(n)};let _s=class _s{constructor(){this.prev=null,this.v=new xe}};let ms=function(t,n,N){var M;let ea=new xe;if(Ze(t,(M=n.v.k,tj.VLOCAL<=M&&M<=tj.VINDEXED),es("syntax error",!0)),Me(t,44)){let M=new _s;M.prev=n,Sr(t,M.v),M.v.k!==tj.VINDEXED&&function(t,n,N){let M=t.fs,es=M.freereg,ea=!1;for(;n;n=n.prev)n.v.k===tj.VINDEXED&&(n.v.u.ind.vt===N.k&&n.v.u.ind.t===N.u.info&&(ea=!0,n.v.u.ind.vt=tj.VLOCAL,n.v.u.ind.t=es),N.k===tj.VLOCAL&&n.v.u.ind.idx===N.u.info&&(ea=!0,n.v.u.ind.idx=es));ea&&(eM(M,N.k===tj.VLOCAL?tw:tx,es,N.u.info,0),e9(M,1))}(t,n,M.v),Pe(t.fs,N+t.L.nCcalls,tg,es("JS levels",!0)),ms(t,M,N+1)}else{Ge(t,61);let M=un(t,ea);if(M===N)return tu(t.fs,ea),void tf(t.fs,n.v,ea);nt(t,N,M,ea)}kt(ea,tj.VNONRELOC,t.fs.freereg-1),tf(t.fs,n.v,ea)},gs=function(t){let n=new xe;return cn(t,n),n.k===tj.VNIL&&(n.k=tj.VFALSE),eZ(t.fs,n),n.f},vs=function(t,n){let N,M=t.linenumber;Me(t,tV.TK_GOTO)?N=D(t):(t_.luaX_next(t),N=tD(t.L,"break"));let es=oe(t,t.dyd.gt,N,M,n);Lt(t,es)},Ca=function(t,n,N){let M,ea=t.fs,eo=t.dyd.label;(function(t,n,N){for(let M=t.bl.firstlabel;M<n.n;M++)if(he(N,n.arr[M].name)){let ea=ty.luaO_pushfstring(t.ls.L,es("label '%s' already defined on line %d",!0),N.getstr(),n.arr[M].line);Ee(t.ls,ea)}})(ea,eo,n),Ge(t,tV.TK_DBCOLON),M=oe(t,eo,n,N,eW(ea)),function(t){for(;59===t.t.token||t.t.token===tV.TK_DBCOLON;)Ir(t)}(t),Et(t,0)&&(eo.arr[M].nactvar=ea.bl.nactvar),de(t,eo.arr[M])},Rr=function(t){let n=new xe;return cn(t,n),eH(t.fs,n),tb(n.k===tj.VNONRELOC),n.u.info},bs=function(t,n,N,M,es){let ea,eo=new pe,el=t.fs;Bt(t,3),Ge(t,tV.TK_DO);let eu=es?eD(el,tA,n,eR):e1(el);be(el,eo,0),Bt(t,M),e9(el,M),Yn(t),C(el),e4(el,eu),es?ea=eD(el,tL,n,eR):(eM(el,tS,n,0,M),e$(el,N),ea=eD(el,tN,n+2,eR)),e5(el,ea,eu+1),e$(el,N)},Pa=function(t,n){let N=t.fs;be(N,new pe,1),t_.luaX_next(t);let M=D(t);switch(t.t.token){case 61:let ea,eo;eo=(ea=t.fs).freereg,jt(t,"(for index)"),jt(t,"(for limit)"),jt(t,"(for step)"),se(t,M),Ge(t,61),Rr(t),Ge(t,44),Rr(t),Me(t,44)?Rr(t):(eK(ea,ea.freereg,eQ(ea,1)),e9(ea,1)),bs(t,eo,n,1,1);break;case 44:case tV.TK_IN:!function(t,n){let N=t.fs,M=new xe,es=4,ea=N.freereg;for(jt(t,"(for generator)"),jt(t,"(for state)"),jt(t,"(for control)"),se(t,n);Me(t,44);)se(t,D(t)),es++;Ge(t,tV.TK_IN);let eo=t.linenumber;nt(t,3,un(t,M),M),eP(N,3),bs(t,ea,eo,es-3,0)}(t,M);break;default:t_.luaX_syntaxerror(t,es("'=' or 'in' expected",!0))}Xe(t,tV.TK_END,tV.TK_FOR,n),C(N)},ks=function(t,n){let N,M=new pe,es=t.fs,ea=new xe;if(t_.luaX_next(t),cn(t,ea),Ge(t,tV.TK_THEN),t.t.token===tV.TK_GOTO||t.t.token===tV.TK_BREAK){for(eq(t.fs,ea),be(es,M,!1),vs(t,ea.t);Me(t,59););if(Et(t,0))return C(es),n;N=e1(es)}else eZ(t.fs,ea),be(es,M,!1),N=ea.f;return re(t),C(es),t.t.token!==tV.TK_ELSE&&t.t.token!==tV.TK_ELSEIF||(n=eF(es,n,e1(es))),e4(es,N),n},Ma=function(t,n){let N=new xe,M=new xe;t_.luaX_next(t);let es=function(t,n){let N=0;for(y(t,n);46===t.t.token;)we(t,n);return 58===t.t.token&&(N=1,we(t,n)),N}(t,N);je(t,M,es,n),tf(t.fs,N,M),e$(t.fs,n)},Ir=function(t){let n=t.linenumber;switch(et(t),t.t.token){case 59:t_.luaX_next(t);break;case tV.TK_IF:!function(t,n){let N=t.fs,M=eR;for(M=ks(t,M);t.t.token===tV.TK_ELSEIF;)M=ks(t,M);Me(t,tV.TK_ELSE)&&Yn(t),Xe(t,tV.TK_END,tV.TK_IF,n),e4(N,M)}(t,n);break;case tV.TK_WHILE:let N,ea,eo,el;N=t.fs,ea=new pe,t_.luaX_next(t),eo=eW(N),el=gs(t),be(N,ea,1),Ge(t,tV.TK_DO),Yn(t),e0(N,eo),Xe(t,tV.TK_END,tV.TK_WHILE,n),C(N),e4(N,el);break;case tV.TK_DO:t_.luaX_next(t),Yn(t),Xe(t,tV.TK_END,tV.TK_DO,n);break;case tV.TK_FOR:Pa(t,n);break;case tV.TK_REPEAT:let eu,ec,ef,eh,ep;ec=eW(eu=t.fs),ef=new pe,eh=new pe,be(eu,ef,1),be(eu,eh,0),t_.luaX_next(t),re(t),Xe(t,tV.TK_UNTIL,tV.TK_REPEAT,n),ep=gs(t),eh.upval&&e3(eu,ep,eh.nactvar),C(eu),e5(eu,ep,ec),C(eu);break;case tV.TK_FUNCTION:Ma(t,n);break;case tV.TK_LOCAL:let ed,e_;t_.luaX_next(t),Me(t,tV.TK_FUNCTION)?(ed=new xe,e_=t.fs,se(t,D(t)),Bt(t,1),je(t,ed,0,t.linenumber),$t(e_,ed.u.info).startpc=e_.pc):function(t){let n,N=0,M=new xe;do se(t,D(t)),N++;while(Me(t,44));Me(t,61)?n=un(t,M):(M.k=tj.VVOID,n=0),nt(t,N,n,M),Bt(t,N)}(t);break;case tV.TK_DBCOLON:t_.luaX_next(t),Ca(t,D(t),n);break;case tV.TK_RETURN:let eg,em,eb,ey;t_.luaX_next(t),eb=t.fs,ey=new xe,Et(t,1)||59===t.t.token?eg=em=0:(em=un(t,ey),Zt(ey.k)?(tl(eb,ey),ey.k===tj.VCALL&&1===em&&(tP(eC(eb,ey),tE),tb(eC(eb,ey).A===eb.nactvar)),eg=eb.nactvar,em=M):1===em?eg=eG(eb,ey):(eH(eb,ey),eg=eb.nactvar,tb(em===eb.freereg-eg))),e7(eb,eg,em),Me(t,59);break;case tV.TK_BREAK:case tV.TK_GOTO:vs(t,e1(t.fs));break;default:let ev,ek;ev=t.fs,Sr(t,(ek=new _s).v),61===t.t.token||44===t.t.token?(ek.prev=null,ms(t,ek,1)):(Ze(t,ek.v.k===tj.VCALL,es("syntax error",!0)),tC(eC(ev,ek.v),1))}tb(t.fs.f.maxstacksize>=t.fs.freereg&&t.fs.freereg>=t.fs.nactvar),t.fs.freereg=t.fs.nactvar,wt(t)};t.exports.Dyndata=class{constructor(){this.actvar={arr:[],n:NaN,size:NaN},this.gt=new me,this.label=new me}},t.exports.expkind=tj,t.exports.expdesc=xe,t.exports.luaY_parser=function(t,n,N,M,es,ea){let eo,el,eu=new t_.LexState,ec=new Ke,ef=td.luaF_newLclosure(t,1);return tp.luaD_inctop(t),t.stack[t.top-1].setclLvalue(ef),eu.h=tK.luaH_new(t),tp.luaD_inctop(t),t.stack[t.top-1].sethvalue(eu.h),ec.f=ef.p=new tF(t),ec.f.source=tB(t,es),eu.buff=N,eu.dyd=M,M.actvar.n=M.gt.n=M.label.n=0,t_.luaX_setinput(t,eu,n,ec.f.source,ea),eo=new pe,el=new xe,Ne(eu,ec,eo),ec.f.is_vararg=!0,kt(el,tj.VLOCAL,0),te(ec,eu.envn,el),t_.luaX_next(eu),re(eu),We(eu,tV.TK_EOS),J(eu),tb(!ec.prev&&1===ec.nups&&!eu.fs),tb(0===M.actvar.n&&0===M.gt.n&&0===M.label.n),delete t.stack[--t.top],ef},t.exports.vkisinreg=function(t){return t===tj.VNONRELOC||t===tj.VLOCAL}},function(t,n,N){let M,es;let{LUA_MULTRET:ea,LUA_OK:eo,LUA_TFUNCTION:el,LUA_TNIL:eu,LUA_TNONE:ec,LUA_TNUMBER:ef,LUA_TSTRING:eh,LUA_TTABLE:ep,LUA_VERSION:ed,LUA_YIELD:e_,lua_call:eg,lua_callk:em,lua_concat:eb,lua_error:ey,lua_getglobal:ev,lua_geti:ek,lua_getmetatable:eL,lua_gettop:eA,lua_insert:ex,lua_isnil:ew,lua_isnone:eT,lua_isstring:eO,lua_load:eE,lua_next:eS,lua_pcallk:eN,lua_pop:eU,lua_pushboolean:eI,lua_pushcfunction:eR,lua_pushglobaltable:eC,lua_pushinteger:eP,lua_pushliteral:eM,lua_pushnil:eB,lua_pushstring:eD,lua_pushvalue:eK,lua_rawequal:eF,lua_rawget:eV,lua_rawlen:ej,lua_rawset:eG,lua_remove:ez,lua_replace:eH,lua_rotate:eX,lua_setfield:e$,lua_setmetatable:eW,lua_settop:eq,lua_setupvalue:eZ,lua_stringtonumber:eY,lua_toboolean:eJ,lua_tolstring:eQ,lua_tostring:e1,lua_type:e0,lua_typename:e2}=N(2),{luaL_argcheck:e3,luaL_checkany:e5,luaL_checkinteger:e4,luaL_checkoption:e8,luaL_checkstack:e6,luaL_checktype:e9,luaL_error:e7,luaL_getmetafield:ta,luaL_loadbufferx:to,luaL_loadfile:tl,luaL_loadfilex:tu,luaL_optinteger:tc,luaL_optstring:tf,luaL_setfuncs:th,luaL_tolstring:tp,luaL_where:td}=N(7),{to_jsstring:t_,to_luastring:tg}=N(5);if("function"==typeof TextDecoder){let t="",n=new TextDecoder("utf-8");M=function(N){t+=n.decode(N,{stream:!0})};let N=new Uint8Array(0);es=function(){console.log(t+=n.decode(N)),t=""}}else{let t=[];M=function(n){try{n=t_(n)}catch{let t=new Uint8Array(n.length);t.set(n),n=t}t.push(n)},es=function(){console.log.apply(console.log,t),t=[]}}let tm=["stop","restart","collect","count","step","setpause","setstepmul","isrunning"].map(t=>tg(t)),_e=function(t){return e9(t,1,ep),eq(t,2),eS(t,1)?2:(eB(t),1)},ge=function(t){let n=e4(t,2)+1;return eP(t,n),ek(t,1,n)===eu?1:2},ye=function(t){let n=tc(t,2,1);return eq(t,1),e0(t,1)===eh&&n>0&&(td(t,n),eK(t,1),eb(t,2)),ey(t)},Ie=function(t,n,N){return n!==eo&&n!==e_?(eI(t,0),eK(t,-2),2):eA(t)-N},ae=function(t,n,N){return n===eo?(0!==N&&(eK(t,N),eZ(t,-2,1)||eU(t,1)),1):(eB(t),ex(t,-2),2)},ce=function(t,n){return e6(t,2,"too many nested functions"),eK(t,1),eg(t,0,1),ew(t,-1)?(eU(t,1),null):(eO(t,-1)||e7(t,tg("reader function must return a string")),eH(t,5),e1(t,5))},Le=function(t,n,N){return eA(t)-1},tb={assert:function(t){return eJ(t,1)?eA(t):(e5(t,1),ez(t,1),eM(t,"assertion failed!"),eq(t,1),ye(t))},collectgarbage:function(t){e8(t,1,"collect",tm),tc(t,2,0),e7(t,tg("lua_gc not implemented"))},dofile:function(t){let n=tf(t,1,null);return eq(t,1),tl(t,n)!==eo?ey(t):(em(t,0,ea,0,Le),Le(t))},error:ye,getmetatable:function(t){return e5(t,1),eL(t,1)?ta(t,1,tg("__metatable",!0)):eB(t),1},ipairs:function(t){return e5(t,1),eR(t,ge),eK(t,1),eP(t,0),3},load:function(t){let n,N=e1(t,1),M=tf(t,3,"bt"),es=eT(t,4)?0:4;if(null!==N){let es=tf(t,2,N);n=to(t,N,N.length,es,M)}else{let N=tf(t,2,"=(load)");e9(t,1,el),eq(t,5),n=eE(t,ce,null,N,M)}return ae(t,n,es)},loadfile:function(t){let n=tf(t,1,null),N=tf(t,2,null),M=eT(t,3)?0:3,es=tu(t,n,N);return ae(t,es,M)},next:_e,pairs:function(t){var n;return n=tg("__pairs",!0),e5(t,1),ta(t,1,n)===eu?(eR(t,_e),eK(t,1),eB(t)):(eK(t,1),eg(t,1,3)),3},pcall:function(t){e5(t,1),eI(t,1),ex(t,1);let n=eN(t,eA(t)-2,ea,0,0,Ie);return Ie(t,n,0)},print:function(t){let n=eA(t);ev(t,tg("tostring",!0));for(let N=1;N<=n;N++){eK(t,-1),eK(t,N),eg(t,1,1);let n=eQ(t,-1);if(null===n)return e7(t,tg("'tostring' must return a string to 'print'"));N>1&&M(tg("	")),M(n),eU(t,1)}return es(),0},rawequal:function(t){return e5(t,1),e5(t,2),eI(t,eF(t,1,2)),1},rawget:function(t){return e9(t,1,ep),e5(t,2),eq(t,2),eV(t,1),1},rawlen:function(t){let n=e0(t,1);return e3(t,n===ep||n===eh,1,"table or string expected"),eP(t,ej(t,1)),1},rawset:function(t){return e9(t,1,ep),e5(t,2),e5(t,3),eq(t,3),eG(t,1),1},select:function(t){let n=eA(t);if(e0(t,1)===eh&&35===e1(t,1)[0])return eP(t,n-1),1;{let N=e4(t,1);return N<0?N=n+N:N>n&&(N=n),e3(t,1<=N,1,"index out of range"),n-N}},setmetatable:function(t){let n=e0(t,2);return e9(t,1,ep),e3(t,n===eu||n===ep,2,"nil or table expected"),ta(t,1,tg("__metatable",!0))!==eu?e7(t,tg("cannot change a protected metatable")):(eq(t,2),eW(t,1),1)},tonumber:function(t){if(0>=e0(t,2)){if(e5(t,1),e0(t,1)===ef)return eq(t,1),1;{let n=e1(t,1);if(null!==n&&eY(t,n)===n.length+1)return 1}}else{let n=e4(t,2);e9(t,1,eh);let N=e1(t,1);e3(t,2<=n&&n<=36,2,"base out of range");let M=function(t,n){try{t=t_(t)}catch{return null}let N=/^[\t\v\f \n\r]*([+-]?)0*([0-9A-Za-z]+)[\t\v\f \n\r]*$/.exec(t);if(!N)return null;let M=parseInt(N[1]+N[2],n);return isNaN(M)?null:0|M}(N,n);if(null!==M)return eP(t,M),1}return eB(t),1},tostring:function(t){return e5(t,1),tp(t,1),1},type:function(t){let n=e0(t,1);return e3(t,n!==ec,1,"value expected"),eD(t,e2(t,n)),1},xpcall:function(t){let n=eA(t);e9(t,2,el),eI(t,1),eK(t,1),eX(t,3,2);let N=eN(t,n-2,ea,2,2,Ie);return Ie(t,N,2)}};t.exports.luaopen_base=function(t){return eC(t),th(t,tb,0),eK(t,-1),e$(t,-2,tg("_G")),eM(t,ed),e$(t,-2,tg("_VERSION")),1}},function(t,n,N){let{LUA_OK:M,LUA_TFUNCTION:es,LUA_TSTRING:ea,LUA_YIELD:eo,lua_Debug:el,lua_checkstack:eu,lua_concat:ec,lua_error:ef,lua_getstack:eh,lua_gettop:ep,lua_insert:ed,lua_isyieldable:e_,lua_newthread:eg,lua_pop:em,lua_pushboolean:eb,lua_pushcclosure:ey,lua_pushliteral:ev,lua_pushthread:ek,lua_pushvalue:eL,lua_resume:eA,lua_status:ex,lua_tothread:ew,lua_type:eT,lua_upvalueindex:eO,lua_xmove:eE,lua_yield:eS}=N(2),{luaL_argcheck:eN,luaL_checktype:eU,luaL_newlib:eI,luaL_where:eR}=N(7),ht=function(t){let n=ew(t,1);return eN(t,n,1,"thread expected"),n},dt=function(t,n,N){if(!eu(n,N))return ev(t,"too many arguments to resume"),-1;if(ex(n)===M&&0===ep(n))return ev(t,"cannot resume dead coroutine"),-1;eE(t,n,N);let es=eA(n,t,N);if(es===M||es===eo){let N=ep(n);return eu(t,N+1)?(eE(n,t,N),N):(em(n,N),ev(t,"too many results to resume"),-1)}return eE(n,t,1),-1},mt=function(t){let n=ew(t,eO(1)),N=dt(t,n,ep(t));return N<0?(eT(t,-1)===ea&&(eR(t,1),ed(t,-2),ec(t,2)),ef(t)):N},V=function(t){eU(t,1,es);let n=eg(t);return eL(t,1),eE(t,n,1),1},eC={create:V,isyieldable:function(t){return eb(t,e_(t)),1},resume:function(t){let n=ht(t),N=dt(t,n,ep(t)-1);return N<0?(eb(t,0),ed(t,-2),2):(eb(t,1),ed(t,-(N+1)),N+1)},running:function(t){return eb(t,ek(t)),2},status:function(t){let n=ht(t);if(t===n)ev(t,"running");else switch(ex(n)){case eo:ev(t,"suspended");break;case M:eh(n,0,new el)>0?ev(t,"normal"):0===ep(n)?ev(t,"dead"):ev(t,"suspended");break;default:ev(t,"dead")}return 1},wrap:function(t){return V(t),ey(t,mt,1),1},yield:function(t){return eS(t,ep(t))}};t.exports.luaopen_coroutine=function(t){return eI(t,eC),1}},function(t,n,N){let{LUA_MAXINTEGER:M}=N(3),{LUA_OPEQ:es,LUA_OPLT:ea,LUA_TFUNCTION:eo,LUA_TNIL:el,LUA_TTABLE:eu,lua_call:ec,lua_checkstack:ef,lua_compare:eh,lua_createtable:ep,lua_geti:ed,lua_getmetatable:e_,lua_gettop:eg,lua_insert:em,lua_isnil:eb,lua_isnoneornil:ey,lua_isstring:ev,lua_pop:ek,lua_pushinteger:eL,lua_pushnil:eA,lua_pushstring:ex,lua_pushvalue:ew,lua_rawget:eT,lua_setfield:eO,lua_seti:eE,lua_settop:eS,lua_toboolean:eN,lua_type:eU}=N(2),{luaL_Buffer:eI,luaL_addlstring:eR,luaL_addvalue:eC,luaL_argcheck:eP,luaL_buffinit:eM,luaL_checkinteger:eB,luaL_checktype:eD,luaL_error:eK,luaL_len:eF,luaL_newlib:eV,luaL_opt:ej,luaL_optinteger:eG,luaL_optlstring:ez,luaL_pushresult:eH,luaL_typename:eX}=N(7),e$=N(17),{to_luastring:eW}=N(5),xt=function(t,n,N){return ex(t,n),eT(t,-N)!==el},Kt=function(t,n,N){if(eU(t,n)!==eu){let M=1;e_(t,n)&&(!(1&N)||xt(t,eW("__index",!0),++M))&&(!(2&N)||xt(t,eW("__newindex",!0),++M))&&(!(4&N)||xt(t,eW("__len",!0),++M))?ek(t,M):eD(t,n,eu)}},m=function(t,n,N){return Kt(t,n,4|N),eF(t,n)},pt=function(t,n,N){ed(t,1,N),ev(t,-1)||eK(t,eW("invalid value (%s) at index %d in table for 'concat'"),eX(t,-1),N),eC(n)},tt=function(t,n,N){eE(t,1,n),eE(t,1,N)},w=function(t,n,N){if(eb(t,2))return eh(t,n,N,ea);{ew(t,2),ew(t,n-1),ew(t,N-2),ec(t,2,1);let M=eN(t,-1);return ek(t,1),M}},S=function(t,n,N){let M=n,es=N-1;for(;;){for(;ed(t,1,++M),w(t,-1,-2);)M==N-1&&eK(t,eW("invalid order function for sorting")),ek(t,1);for(;ed(t,1,--es),w(t,-3,-1);)es<M&&eK(t,eW("invalid order function for sorting")),ek(t,1);if(es<M)return ek(t,1),tt(t,N-1,M),M;tt(t,M,es)}},b=function(t,n,N){let M=Math.floor((n-t)/4),es=N%(2*M)+(t+M);return e$.lua_assert(t+M<=es&&es<=n-M),es},q=function(t,n,N,M){for(;n<N;){let es,ea;if(ed(t,1,n),ed(t,1,N),w(t,-1,-2)?tt(t,n,N):ek(t,2),N-n==1||(ed(t,1,es=N-n<100||0===M?Math.floor((n+N)/2):b(n,N,M)),ed(t,1,n),w(t,-2,-1)?tt(t,es,n):(ek(t,1),ed(t,1,N),w(t,-1,-2)?tt(t,es,N):ek(t,2)),N-n==2))return;ed(t,1,es),ew(t,-1),ed(t,1,N-1),tt(t,es,N-1),(es=S(t,n,N))-n<N-es?(q(t,n,es-1,M),ea=es-n,n=es+1):(q(t,es+1,N,M),ea=N-es,N=es-1),(N-n)/128>ea&&(M=Math.floor(4294967296*Math.random()))}},eq={concat:function(t){let n=m(t,1,1),N=ez(t,2,""),M=N.length,es=eG(t,3,1);n=eG(t,4,n);let ea=new eI;for(eM(t,ea);es<n;es++)pt(t,ea,es),eR(ea,N,M);return es===n&&pt(t,ea,es),eH(ea),1},insert:function(t){let n,N=m(t,1,3)+1;switch(eg(t)){case 2:n=N;break;case 3:n=eB(t,2),eP(t,1<=n&&n<=N,2,"position out of bounds");for(let M=N;M>n;M--)ed(t,1,M-1),eE(t,1,M);break;default:return eK(t,"wrong number of arguments to 'insert'")}return eE(t,1,n),0},move:function(t){let n=eB(t,2),N=eB(t,3),ea=eB(t,4),eo=ey(t,5)?1:5;if(Kt(t,1,1),Kt(t,eo,2),N>=n){eP(t,n>0||N<M+n,3,"too many elements to move");let el=N-n+1;if(eP(t,ea<=M-el+1,4,"destination wrap around"),ea>N||ea<=n||1!==eo&&1!==eh(t,1,eo,es))for(let N=0;N<el;N++)ed(t,1,n+N),eE(t,eo,ea+N);else for(let N=el-1;N>=0;N--)ed(t,1,n+N),eE(t,eo,ea+N)}return ew(t,eo),1},pack:function(t){let n=eg(t);ep(t,n,1),em(t,1);for(let N=n;N>=1;N--)eE(t,1,N);return eL(t,n),eO(t,1,eW("n")),1},remove:function(t){let n=m(t,1,3),N=eG(t,2,n);for(N!==n&&eP(t,1<=N&&N<=n+1,1,"position out of bounds"),ed(t,1,N);N<n;N++)ed(t,1,N+1),eE(t,1,N);return eA(t),eE(t,1,N),1},sort:function(t){let n=m(t,1,3);return n>1&&(eP(t,n<M,1,"array too big"),ey(t,2)||eD(t,2,eo),eS(t,2),q(t,1,n,0)),0},unpack:function(t){let n=eG(t,2,1),N=ej(t,eB,3,eF(t,1));if(n>N)return 0;let M=N-n;if(M>=Number.MAX_SAFE_INTEGER||!ef(t,++M))return eK(t,eW("too many results to unpack"));for(;n<N;n++)ed(t,1,n);return ed(t,1,N),M}};t.exports.luaopen_table=function(t){return eV(t,eq),1}},function(t,n,N){let{LUA_TNIL:M,LUA_TTABLE:es,lua_close:ea,lua_createtable:eo,lua_getfield:el,lua_isboolean:eu,lua_isnoneornil:ec,lua_pop:ef,lua_pushboolean:eh,lua_pushfstring:ep,lua_pushinteger:ed,lua_pushliteral:e_,lua_pushnil:eg,lua_pushnumber:em,lua_pushstring:eb,lua_setfield:ey,lua_settop:ev,lua_toboolean:ek,lua_tointegerx:eL}=N(2),{luaL_Buffer:eA,luaL_addchar:ex,luaL_addstring:ew,luaL_argerror:eT,luaL_buffinit:eO,luaL_checkinteger:eE,luaL_checkstring:eS,luaL_checktype:eN,luaL_error:eU,luaL_execresult:eI,luaL_fileresult:eR,luaL_newlib:eC,luaL_optinteger:eP,luaL_optlstring:eM,luaL_optstring:eB,luaL_pushresult:eD}=N(7),{luastring_eq:eK,to_jsstring:eF,to_luastring:eV}=N(5),ej=eV("aAbBcCdDeFhHIjklmMnpPrRStTuUwWxXyYzZ%"),Xt=function(t,n,N){ed(t,N),ey(t,-2,eV(n,!0))},ee=function(t,n,N){Xt(t,"sec",N?n.getUTCSeconds():n.getSeconds()),Xt(t,"min",N?n.getUTCMinutes():n.getMinutes()),Xt(t,"hour",N?n.getUTCHours():n.getHours()),Xt(t,"day",N?n.getUTCDate():n.getDate()),Xt(t,"month",(N?n.getUTCMonth():n.getMonth())+1),Xt(t,"year",N?n.getUTCFullYear():n.getFullYear()),Xt(t,"wday",(N?n.getUTCDay():n.getDay())+1),Xt(t,"yday",Math.floor((n-new Date(n.getFullYear(),0,0))/864e5))},eG=Number.MAX_SAFE_INTEGER/2,rt=function(t,n,N,es){let ea=el(t,-1,eV(n,!0)),eo=eL(t,-1);if(!1===eo){if(ea!==M)return eU(t,eV("field '%s' is not an integer"),n);if(N<0)return eU(t,eV("field '%s' missing in date table"),n);eo=N}else{if(!(-eG<=eo&&eo<=eG))return eU(t,eV("field '%s' is out-of-bound"),n);eo-=es}return ef(t,1),eo},ez={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(t=>eV(t)),shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>eV(t)),months:["January","February","March","April","May","June","July","August","September","October","November","December"].map(t=>eV(t)),shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(t=>eV(t)),AM:eV("AM"),PM:eV("PM"),am:eV("am"),pm:eV("pm"),formats:{c:eV("%a %b %e %H:%M:%S %Y"),D:eV("%m/%d/%y"),F:eV("%Y-%m-%d"),R:eV("%H:%M"),r:eV("%I:%M:%S %p"),T:eV("%H:%M:%S"),X:eV("%T"),x:eV("%D")}},It=function(t,n){let N=t.getDay();return"monday"===n&&(0===N?N=6:N--),Math.floor(((t-new Date(t.getFullYear(),0,1))/864e5+7-N)/7)},xt=function(t,n,N){n<10&&ex(t,N),ew(t,eV(String(n)))},Kt=function(t,n,N,M){let es=0;for(;es<N.length;)if(37!==N[es])ex(n,N[es++]);else{let ea=m(t,N,++es);switch(N[es]){case 37:ex(n,37);break;case 65:ew(n,ez.days[M.getDay()]);break;case 66:ew(n,ez.months[M.getMonth()]);break;case 67:xt(n,Math.floor(M.getFullYear()/100),48);break;case 68:Kt(t,n,ez.formats.D,M);break;case 70:Kt(t,n,ez.formats.F,M);break;case 72:xt(n,M.getHours(),48);break;case 73:xt(n,(M.getHours()+11)%12+1,48);break;case 77:xt(n,M.getMinutes(),48);break;case 80:ew(n,12>M.getHours()?ez.am:ez.pm);break;case 82:Kt(t,n,ez.formats.R,M);break;case 83:xt(n,M.getSeconds(),48);break;case 84:Kt(t,n,ez.formats.T,M);break;case 85:xt(n,It(M,"sunday"),48);break;case 87:xt(n,It(M,"monday"),48);break;case 88:Kt(t,n,ez.formats.X,M);break;case 89:ew(n,eV(String(M.getFullYear())));break;case 90:{let t=M.toString().match(/\(([\w\s]+)\)/);t&&ew(n,eV(t[1]));break}case 97:ew(n,ez.shortDays[M.getDay()]);break;case 98:case 104:ew(n,ez.shortMonths[M.getMonth()]);break;case 99:Kt(t,n,ez.formats.c,M);break;case 100:xt(n,M.getDate(),48);break;case 101:xt(n,M.getDate(),32);break;case 106:{let t=Math.floor((M-new Date(M.getFullYear(),0,1))/864e5);t<100&&(t<10&&ex(n,48),ex(n,48)),ew(n,eV(String(t)));break}case 107:xt(n,M.getHours(),32);break;case 108:xt(n,(M.getHours()+11)%12+1,32);break;case 109:xt(n,M.getMonth()+1,48);break;case 110:ex(n,10);break;case 112:ew(n,12>M.getHours()?ez.AM:ez.PM);break;case 114:Kt(t,n,ez.formats.r,M);break;case 115:ew(n,eV(String(Math.floor(M/1e3))));break;case 116:ex(n,8);break;case 117:{let t=M.getDay();ew(n,eV(String(0===t?7:t)));break}case 119:ew(n,eV(String(M.getDay())));break;case 120:Kt(t,n,ez.formats.x,M);break;case 121:xt(n,M.getFullYear()%100,48);break;case 122:{let t=M.getTimezoneOffset();t>0?ex(n,45):(t=-t,ex(n,43)),xt(n,Math.floor(t/60),48),xt(n,t%60,48)}}es+=ea}},m=function(t,n,N){let M=0,es=1;for(;M<ej.length&&es<=n.length-N;M+=es)if(124===ej[M])es++;else if(eK(n.subarray(N,N+es),ej.subarray(M,M+es)))return es;eT(t,1,ep(t,eV("invalid conversion specifier '%%%s'"),n))},pt=function(t,n){return eE(t,n)},eH={date:function(t){let n=eM(t,1,"%c"),N=ec(t,2)?new Date:new Date(1e3*pt(t,2)),M=!1,es=0;if(33===n[0]&&(M=!0,es++),42===n[es]&&116===n[es+1])eo(t,0,9),ee(t,N,M);else{new Uint8Array(4)[0]=37;let M=new eA;eO(t,M),Kt(t,M,n,N),eD(M)}return 1},difftime:function(t){let n=pt(t,1),N=pt(t,2);return em(t,n-N),1},time:function(t){let n;return ec(t,1)?n=new Date:(eN(t,1,es),ev(t,1),n=new Date(rt(t,"year",-1,0),rt(t,"month",-1,1),rt(t,"day",-1,0),rt(t,"hour",12,0),rt(t,"min",0,0),rt(t,"sec",0,0)),ee(t,n)),ed(t,Math.floor(n/1e3)),1},clock:function(t){return em(t,performance.now()/1e3),1}};t.exports.luaopen_os=function(t){return eC(t,eH),1}},function(t,n,N){let{sprintf:M}=N(38),{LUA_INTEGER_FMT:es,LUA_INTEGER_FRMLEN:ea,LUA_MININTEGER:eo,LUA_NUMBER_FMT:el,LUA_NUMBER_FRMLEN:eu,frexp:ec,lua_getlocaledecpoint:ef}=N(3),{LUA_TBOOLEAN:eh,LUA_TFUNCTION:ep,LUA_TNIL:ed,LUA_TNUMBER:e_,LUA_TSTRING:eg,LUA_TTABLE:em,lua_call:eb,lua_createtable:ey,lua_dump:ev,lua_gettable:ek,lua_gettop:eL,lua_isinteger:eA,lua_isstring:ex,lua_pop:ew,lua_pushcclosure:eT,lua_pushinteger:eO,lua_pushlightuserdata:eE,lua_pushliteral:eS,lua_pushlstring:eN,lua_pushnil:eU,lua_pushnumber:eI,lua_pushstring:eR,lua_pushvalue:eC,lua_remove:eP,lua_setfield:eM,lua_setmetatable:eB,lua_settop:eD,lua_toboolean:eK,lua_tointeger:eF,lua_tonumber:eV,lua_tostring:ej,lua_touserdata:eG,lua_type:ez,lua_upvalueindex:eH}=N(2),{luaL_Buffer:eX,luaL_addchar:e$,luaL_addlstring:eW,luaL_addsize:eq,luaL_addstring:eZ,luaL_addvalue:eY,luaL_argcheck:eJ,luaL_argerror:eQ,luaL_buffinit:e1,luaL_buffinitsize:e0,luaL_checkinteger:e2,luaL_checknumber:e3,luaL_checkstack:e5,luaL_checkstring:e4,luaL_checktype:e8,luaL_error:e6,luaL_newlib:e9,luaL_optinteger:e7,luaL_optstring:ta,luaL_prepbuffsize:to,luaL_pushresult:tl,luaL_pushresultsize:tu,luaL_tolstring:tc,luaL_typename:tf}=N(7),th=N(17),{luastring_eq:tp,luastring_indexOf:td,to_jsstring:t_,to_luastring:tg}=N(5),_e=function(t){let n=td(t,0);return n>-1?n:t.length},ge=function(t,n){return t>=0?t:0-t>n?0:n+t+1},ye=function(t,n,N,M){return eW(M,n,N),0},tm=eu.length+1,ae=function(t,n,N){let es=function(t){if(Object.is(t,1/0))return tg("inf");if(Object.is(t,-1/0))return tg("-inf");if(Number.isNaN(t))return tg("nan");if(0===t){let n=M(el+"x0p+0",t);return Object.is(t,-0)&&(n="-"+n),tg(n)}{let n="",N=ec(t),es=N[0],ea=N[1];return es<0&&(n+="-",es=-es),tg(n+="0x"+(2*es).toString(16)+M("p%+d",ea-=1))}}(N);if(65===n[tm])for(let t=0;t<es.length;t++){let n=es[t];n>=97&&(es[t]=223&n)}else 97!==n[tm]&&e6(t,tg("modifiers for format '%%a'/'%%A' not implemented"));return es},tb=tg("-+ #0"),Le=t=>97<=t&&t<=122||65<=t&&t<=90,o=t=>48<=t&&t<=57,u=t=>0<=t&&t<=31||127===t,A=t=>33<=t&&t<=126,h=t=>97<=t&&t<=122,x=t=>65<=t&&t<=90,H=t=>97<=t&&t<=122||65<=t&&t<=90||48<=t&&t<=57,I=t=>A(t)&&!H(t),ct=t=>32===t||t>=9&&t<=13,Vt=t=>48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102,Jt=function(t,n,N){switch(ez(t,N)){case eg:{let M=ej(t,N);!function(t,n,N){e$(t,34);let M=0;for(;N--;){if(34===n[M]||92===n[M]||10===n[M])e$(t,92),e$(t,n[M]);else if(u(n[M])){let N=""+n[M];o(n[M+1])&&(N="0".repeat(3-N.length)+N),eZ(t,tg("\\"+N))}else e$(t,n[M]);M++}e$(t,34)}(n,M,M.length);break}case e_:{let el;if(eA(t,N)){let n=eF(t,N);el=tg(M(n===eo?"0x%"+ea+"x":es,n))}else{let n=eV(t,N);!function(t){if(0>td(t,46)){let n=td(t,ef());n&&(t[n]=46)}}(el=ae(t,tg(`%${ea}a`),n))}eZ(n,el);break}case ed:case eh:tc(t,N),eY(n);break;default:eQ(t,N,tg("value has no literal form"))}},ve=function(t,n,N,M){let es=N;for(;0!==n[es]&&td(tb,n[es])>=0;)es++;es-N>=tb.length&&e6(t,tg("invalid format (repeated flags)")),o(n[es])&&es++,o(n[es])&&es++,46===n[es]&&(o(n[++es])&&es++,o(n[es])&&es++),o(n[es])&&e6(t,tg("invalid format (width or precision too long)")),M[0]=37;for(let t=0;t<es-N+1;t++)M[t+1]=n[N+t];return es},ke=function(t,n){let N=t.length,M=n.length,es=t[N-1];for(let es=0;es<M;es++)t[es+N-1]=n[es];t[N+M-1]=es};let vt=class vt{constructor(t){this.L=t,this.islittle=!0,this.maxalign=1}};let W=function(t,n){if(t.off>=t.s.length||!o(t.s[t.off]))return n;{let n=0;do n=10*n+(t.s[t.off++]-48);while(t.off<t.s.length&&o(t.s[t.off])&&n<=214748363.8);return n}},Rt=function(t,n,N){let M=W(n,N);return(M>16||M<=0)&&e6(t.L,tg("integral size (%d) out of limits [1,%d]"),M,16),M},bt=function(t,n){let N={opt:n.s[n.off++],size:0};switch(N.opt){case 98:return N.size=1,N.opt=0,N;case 66:return N.size=1,N.opt=1,N;case 104:return N.size=2,N.opt=0,N;case 72:return N.size=2,N.opt=1,N;case 108:case 106:return N.size=4,N.opt=0,N;case 76:case 74:case 84:return N.size=4,N.opt=1,N;case 102:return N.size=4,N.opt=2,N;case 100:case 110:return N.size=8,N.opt=2,N;case 105:return N.size=Rt(t,n,4),N.opt=0,N;case 73:return N.size=Rt(t,n,4),N.opt=1,N;case 115:return N.size=Rt(t,n,4),N.opt=4,N;case 99:return N.size=W(n,-1),-1===N.size&&e6(t.L,tg("missing size for format option 'c'")),N.opt=3,N;case 122:return N.opt=5,N;case 120:return N.size=1,N.opt=6,N;case 88:return N.opt=7,N;case 32:break;case 60:case 61:t.islittle=!0;break;case 62:t.islittle=!1;break;case 33:t.maxalign=Rt(t,n,8);break;default:e6(t.L,tg("invalid format option '%c'"),N.opt)}return N.opt=8,N},Zt=function(t,n,N){let M={opt:NaN,size:NaN,ntoalign:NaN},es=bt(t,N);M.size=es.size,M.opt=es.opt;let ea=M.size;if(7===M.opt){if(N.off>=N.s.length||0===N.s[N.off])eQ(t.L,1,tg("invalid next option for option 'X'"));else{let n=bt(t,N);ea=n.size,3!==(n=n.opt)&&0!==ea||eQ(t.L,1,tg("invalid next option for option 'X'"))}}return ea<=1||3===M.opt?M.ntoalign=0:(ea>t.maxalign&&(ea=t.maxalign),ea&ea-1&&eQ(t.L,1,tg("format asks for alignment not power of 2")),M.ntoalign=ea-(n&ea-1)&ea-1),M},he=function(t,n,N,M,es){let ea=to(t,M);ea[N?0:M-1]=255&n;for(let t=1;t<M;t++)n>>=8,ea[N?t:M-1-t]=255&n;if(es&&M>4)for(let t=4;t<M;t++)ea[N?t:M-1-t]=255;eq(t,M)},pe=function(t,n,N,M,es){let ea=0,eo=M<=4?M:4;for(let t=eo-1;t>=0;t--)ea<<=8,ea|=n[N?t:M-1-t];if(M<4){if(es){let t=1<<8*M-1;ea=(ea^t)-t}}else if(M>4){let el=!es||ea>=0?0:255;for(let es=eo;es<M;es++)n[N?es:M-1-es]!==el&&e6(t,tg("%d-byte integer does not fit into Lua Integer"),M)}return ea},ue=function(t,n,N,M){th.lua_assert(n.length>=M);let es=new DataView(new ArrayBuffer(M));for(let t=0;t<M;t++)es.setUint8(t,n[t],N);return 4==M?es.getFloat32(0,N):es.getFloat64(0,N)},ty=tg("^$*+?.([%-");let Ke=class Ke{constructor(t){this.src=null,this.src_init=null,this.src_end=null,this.p=null,this.p_end=null,this.L=t,this.matchdepth=NaN,this.level=NaN,this.capture=[]}};let me=function(t,n){switch(t.p[n++]){case 37:return n===t.p_end&&e6(t.L,tg("malformed pattern (ends with '%%')")),n+1;case 91:94===t.p[n]&&n++;do n===t.p_end&&e6(t.L,tg("malformed pattern (missing ']')")),37===t.p[n++]&&n<t.p_end&&n++;while(93!==t.p[n]);return n+1;default:return n}},Ee=function(t,n){switch(n){case 97:return Le(t);case 65:return!Le(t);case 99:return u(t);case 67:return!u(t);case 100:return o(t);case 68:return!o(t);case 103:return A(t);case 71:return!A(t);case 108:return h(t);case 76:return!h(t);case 112:return I(t);case 80:return!I(t);case 115:return ct(t);case 83:return!ct(t);case 117:return x(t);case 85:return!x(t);case 119:return H(t);case 87:return!H(t);case 120:return Vt(t);case 88:return!Vt(t);case 122:return 0===t;case 90:return 0!==t;default:return n===t}},Ae=function(t,n,N,M){let es=!0;for(94===t.p[N+1]&&(es=!1,N++);++N<M;)if(37===t.p[N]){if(N++,Ee(n,t.p[N]))return es}else if(45===t.p[N+1]&&N+2<M){if(N+=2,t.p[N-2]<=n&&n<=t.p[N])return es}else if(t.p[N]===n)return es;return!es},Pe=function(t,n,N,M){if(n>=t.src_end)return!1;{let es=t.src[n];switch(t.p[N]){case 46:return!0;case 37:return Ee(es,t.p[N+1]);case 91:return Ae(t,es,N,M-1);default:return t.p[N]===es}}},Me=function(t,n,N){if(N>=t.p_end-1&&e6(t.L,tg("malformed pattern (missing arguments to '%%b'")),t.src[n]!==t.p[N])return null;{let M=t.p[N],es=t.p[N+1],ea=1;for(;++n<t.src_end;)if(t.src[n]===es){if(0==--ea)return n+1}else t.src[n]===M&&ea++}return null},We=function(t,n,N,M){let es=0;for(;Pe(t,n+es,N,M);)es++;for(;es>=0;){let N=kt(t,n+es,M+1);if(N)return N;es--}return null},Ge=function(t,n,N,M){for(;;){let es=kt(t,n,M+1);if(null!==es)return es;if(!Pe(t,n,N,M))return null;n++}},Ze=function(t,n,N,M){let es,ea=t.level;return ea>=32&&e6(t.L,tg("too many captures")),t.capture[ea]=t.capture[ea]?t.capture[ea]:{},t.capture[ea].init=n,t.capture[ea].len=M,t.level=ea+1,null===(es=kt(t,n,N))&&t.level--,es},Xe=function(t,n,N){let M,es=function(t){let n=t.level;for(n--;n>=0;n--)if(-1===t.capture[n].len)return n;return e6(t.L,tg("invalid pattern capture"))}(t);return t.capture[es].len=n-t.capture[es].init,null===(M=kt(t,n,N))&&(t.capture[es].len=-1),M},D=function(t,n,N){var M,es,ea,eo;N=(M=N-49)<0||M>=t.level||-1===t.capture[M].len?e6(t.L,tg("invalid capture index %%%d"),M+1):M;let el=t.capture[N].len;return t.src_end-n>=el&&(es=t.src,ea=t.capture[N].init,eo=t.src,tp(es.subarray(ea,ea+el),eo.subarray(n,n+el)))?n+el:null},kt=function(t,n,N){let M=!1,es=!0;for(0==t.matchdepth--&&e6(t.L,tg("pattern too complex"));es||M;)if(es=!1,N!==t.p_end)switch(M?void 0:t.p[N]){case 40:n=41===t.p[N+1]?Ze(t,n,N+2,-2):Ze(t,n,N+1,-1);break;case 41:n=Xe(t,n,N+1);break;case 36:if(N+1!==t.p_end){M=!0;break}n=t.src.length-n==0?n:null;break;case 37:switch(t.p[N+1]){case 98:null!==(n=Me(t,n,N+2))&&(N+=4,es=!0);break;case 102:{N+=2,91!==t.p[N]&&e6(t.L,tg("missing '[' after '%%f' in pattern"));let M=me(t,N),ea=n===t.src_init?0:t.src[n-1];if(!Ae(t,ea,N,M-1)&&Ae(t,n===t.src_end?0:t.src[n],N,M-1)){N=M,es=!0;break}n=null;break}case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:null!==(n=D(t,n,t.p[N+1]))&&(N+=2,es=!0);break;default:M=!0}break;default:{M=!1;let ea=me(t,N);if(Pe(t,n,N,ea))switch(t.p[ea]){case 63:{let M;null!==(M=kt(t,n+1,ea+1))?n=M:(N=ea+1,es=!0);break}case 43:n++;case 42:n=We(t,n,N,ea);break;case 45:n=Ge(t,n,N,ea);break;default:n++,N=ea,es=!0}else{if(42===t.p[ea]||63===t.p[ea]||45===t.p[ea]){N=ea+1,es=!0;break}n=null}}}return t.matchdepth++,n},Ht=function(t,n,N,M){if(n>=t.level)0===n?eN(t.L,t.src.subarray(N,M),M-N):e6(t.L,tg("invalid capture index %%%d"),n+1);else{let N=t.capture[n].len;-1===N&&e6(t.L,tg("unfinished capture")),-2===N?eO(t.L,t.capture[n].init-t.src_init+1):eN(t.L,t.src.subarray(t.capture[n].init),N)}},qt=function(t,n,N){let M=0===t.level&&t.src.subarray(n)?1:t.level;e5(t.L,M,"too many captures");for(let es=0;es<M;es++)Ht(t,es,n,N);return M},se=function(t,n,N,M,es,ea){t.L=n,t.matchdepth=200,t.src=N,t.src_init=0,t.src_end=M,t.p=es,t.p_end=ea},jt=function(t){t.level=0,th.lua_assert(200===t.matchdepth)},$t=function(t,n){let N=e4(t,1),M=e4(t,2),es=N.length,ea=M.length,eo=ge(e7(t,3,1),es);if(eo<1)eo=1;else if(eo>es+1)return eU(t),1;if(n&&(eK(t,4)||function(t,n){for(let N=0;N<n;N++)if(-1!==td(ty,t[N]))return!1;return!0}(M,ea))){let n=function(t,n,N){var M=0,es=n.length;if(0===es)return M;for(;-1!==(M=t.indexOf(n[0],M));M++)if(tp(t.subarray(M,M+es),n))return M;return -1}(N.subarray(eo-1),M,0);if(n>-1)return eO(t,eo+n),eO(t,eo+n+ea-1),2}else{let el=new Ke(t),eu=eo-1,ec=94===M[0];ec&&(M=M.subarray(1),ea--),se(el,t,N,es,M,ea);do{let N;if(jt(el),null!==(N=kt(el,eu,0)))return n?(eO(t,eu+1),eO(t,N),qt(el,null,0)+2):qt(el,eu,N)}while(eu++<el.src_end&&!ec)}return eU(t),1},Bt=function(t){let n=eG(t,eH(3));n.ms.L=t;for(let t=n.src;t<=n.ms.src_end;t++){let N;if(jt(n.ms),null!==(N=kt(n.ms,t,n.p))&&N!==n.lastmatch)return n.src=n.lastmatch=N,qt(n.ms,t,N)}return 0},te=function(t,n,N,M,es){let ea=t.L;switch(es){case ep:eC(ea,3),eb(ea,qt(t,N,M),1);break;case em:Ht(t,0,N,M),ek(ea,3);break;default:return void function(t,n,N,M){let es=t.L,ea=ej(es,3),eo=ea.length;for(let el=0;el<eo;el++)37!==ea[el]?e$(n,ea[el]):o(ea[++el])?48===ea[el]?eW(n,t.src.subarray(N,M),M-N):(Ht(t,ea[el]-49,N,M),tc(es,-1),eP(es,-2),eY(n)):(37!==ea[el]&&e6(es,tg("invalid use of '%c' in replacement string"),37),e$(n,ea[el]))}(t,n,N,M)}eK(ea,-1)?ex(ea,-1)||e6(ea,tg("invalid replacement value (a %s)"),tf(ea,-1)):(ew(ea,1),eN(ea,t.src.subarray(N,M),M-N)),eY(n)},tv={byte:function(t){let n=e4(t,1),N=n.length,M=ge(e7(t,2,1),N),es=ge(e7(t,3,M),N);if(M<1&&(M=1),es>N&&(es=N),M>es)return 0;if(es-M>=Number.MAX_SAFE_INTEGER)return e6(t,"string slice too long");let ea=es-M+1;e5(t,ea,"string slice too long");for(let N=0;N<ea;N++)eO(t,n[M+N-1]);return ea},char:function(t){let n=eL(t),N=new eX,M=e0(t,N,n);for(let N=1;N<=n;N++){let n=e2(t,N);eJ(t,n>=0&&n<=255,"value out of range"),M[N-1]=n}return tu(N,n),1},dump:function(t){let n=new eX,N=eK(t,2);return e8(t,1,ep),eD(t,1),e1(t,n),0!==ev(t,ye,n,N)?e6(t,tg("unable to dump given function")):(tl(n),1)},find:function(t){return $t(t,1)},format:function(t){let n=eL(t),N=1,es=e4(t,1),eo=0,el=new eX;for(e1(t,el);eo<es.length;)if(37!==es[eo])e$(el,es[eo++]);else if(37===es[++eo])e$(el,es[eo++]);else{let eu=[];switch(++N>n&&eQ(t,N,tg("no value")),eo=ve(t,es,eo,eu),String.fromCharCode(es[eo++])){case"c":e$(el,e2(t,N));break;case"d":case"i":case"o":case"u":case"x":case"X":{let n=e2(t,N);ke(eu,tg(ea,!0)),eZ(el,tg(M(String.fromCharCode(...eu),n)));break}case"a":case"A":ke(eu,tg(ea,!0)),eZ(el,ae(t,eu,e3(t,N)));break;case"e":case"E":case"f":case"g":case"G":{let n=e3(t,N);ke(eu,tg(ea,!0)),eZ(el,tg(M(String.fromCharCode(...eu),n)));break}case"q":Jt(t,el,N);break;case"s":{let n=tc(t,N);eu.length<=2||0===eu[2]?eY(el):(eJ(t,n.length===_e(n),N,"string contains zeros"),0>td(eu,46)&&n.length>=100?eY(el):(eZ(el,tg(M(String.fromCharCode(...eu),t_(n)))),ew(t,1)));break}default:return e6(t,tg("invalid option '%%%c' to 'format'"),es[eo-1])}}return tl(el),1},gmatch:function(t){let n=e4(t,1),N=e4(t,2),M=n.length,es=N.length;eD(t,2);let ea=new class{constructor(){this.src=NaN,this.p=NaN,this.lastmatch=NaN,this.ms=new Ke}};return eE(t,ea),se(ea.ms,t,n,M,N,es),ea.src=0,ea.p=0,ea.lastmatch=null,eT(t,Bt,3),1},gsub:function(t){let n=e4(t,1),N=n.length,M=e4(t,2),es=M.length,ea=null,eo=ez(t,3),el=e7(t,4,N+1),eu=94===M[0],ec=0,ef=new Ke(t),eh=new eX;for(eJ(t,eo===e_||eo===eg||eo===ep||eo===em,3,"string/function/table expected"),e1(t,eh),eu&&(M=M.subarray(1),es--),se(ef,t,n,N,M,es),n=0,M=0;ec<el;){let t;if(jt(ef),null!==(t=kt(ef,n,M))&&t!==ea)ec++,te(ef,eh,n,t,eo),n=ea=t;else{if(!(n<ef.src_end))break;e$(eh,ef.src[n++])}if(eu)break}return eW(eh,ef.src.subarray(n,ef.src_end),ef.src_end-n),tl(eh),eO(t,ec),2},len:function(t){return eO(t,e4(t,1).length),1},lower:function(t){let n=e4(t,1),N=n.length,M=new Uint8Array(N);for(let t=0;t<N;t++){let N=n[t];x(N)&&(N|=32),M[t]=N}return eR(t,M),1},match:function(t){return $t(t,0)},pack:function(t){let n=new eX,N=new vt(t),M={s:e4(t,1),off:0},es=1,ea=0;for(eU(t),e1(t,n);M.off<M.s.length;){let eo=Zt(N,ea,M),el=eo.opt,eu=eo.size,ec=eo.ntoalign;for(ea+=ec+eu;ec-- >0;)e$(n,0);switch(es++,el){case 0:{let M=e2(t,es);if(eu<4){let n=1<<8*eu-1;eJ(t,-n<=M&&M<n,es,"integer overflow")}he(n,M,N.islittle,eu,M<0);break}case 1:{let M=e2(t,es);eu<4&&eJ(t,M>>>0<1<<8*eu,es,"unsigned overflow"),he(n,M>>>0,N.islittle,eu,!1);break}case 2:{let M=to(n,eu),ea=e3(t,es),eo=new DataView(M.buffer,M.byteOffset,M.byteLength);4===eu?eo.setFloat32(0,ea,N.islittle):eo.setFloat64(0,ea,N.islittle),eq(n,eu);break}case 3:{let N=e4(t,es),M=N.length;for(eJ(t,M<=eu,es,"string longer than given size"),eW(n,N,M);M++<eu;)e$(n,0);break}case 4:{let M=e4(t,es),eo=M.length;eJ(t,eu>=4||eo<1<<8*eu,es,"string length does not fit in given size"),he(n,eo,N.islittle,eu,0),eW(n,M,eo),ea+=eo;break}case 5:{let N=e4(t,es),M=N.length;eJ(t,0>td(N,0),es,"strings contains zeros"),eW(n,N,M),e$(n,0),ea+=M+1;break}case 6:e$(n,0);case 7:case 8:es--}}return tl(n),1},packsize:function(t){let n=new vt(t),N={s:e4(t,1),off:0},M=0;for(;N.off<N.s.length;){let es=Zt(n,M,N),ea=es.opt,eo=es.size;switch(eJ(t,M<=2147483647-(eo+=es.ntoalign),1,"format result too large"),M+=eo,ea){case 4:case 5:eQ(t,1,"variable-length format")}}return eO(t,M),1},rep:function(t){let n=e4(t,1),N=n.length,M=e2(t,2),es=ta(t,3,""),ea=es.length;if(M<=0)eS(t,"");else{if(N+ea<N||N+ea>2147483647/M)return e6(t,tg("resulting string too large"));{let eo=M*N+(M-1)*ea,el=new eX,eu=e0(t,el,eo),ec=0;for(;M-- >1;)eu.set(n,ec),ec+=N,ea>0&&(eu.set(es,ec),ec+=ea);eu.set(n,ec),tu(el,eo)}}return 1},reverse:function(t){let n=e4(t,1),N=n.length,M=new Uint8Array(N);for(let t=0;t<N;t++)M[t]=n[N-1-t];return eR(t,M),1},sub:function(t){let n=e4(t,1),N=n.length,M=ge(e2(t,2),N),es=ge(e7(t,3,-1),N);return M<1&&(M=1),es>N&&(es=N),M<=es?eR(t,n.subarray(M-1,M-1+(es-M+1))):eS(t,""),1},unpack:function(t){let n=new vt(t),N={s:e4(t,1),off:0},M=e4(t,2),es=M.length,ea=ge(e7(t,3,1),es)-1,eo=0;for(eJ(t,ea<=es&&ea>=0,3,"initial position out of string");N.off<N.s.length;){let el=Zt(n,ea,N),eu=el.opt,ec=el.size,ef=el.ntoalign;switch(ea+ef+ec>es&&eQ(t,2,tg("data string too short")),ea+=ef,e5(t,2,"too many results"),eo++,eu){case 0:case 1:{let N=pe(t,M.subarray(ea),n.islittle,ec,0===eu);eO(t,N);break}case 2:eI(t,ue(0,M.subarray(ea),n.islittle,ec));break;case 3:eR(t,M.subarray(ea,ea+ec));break;case 4:{let N=pe(t,M.subarray(ea),n.islittle,ec,0);eJ(t,ea+N+ec<=es,2,"data string too short"),eR(t,M.subarray(ea+ec,ea+ec+N)),ea+=N;break}case 5:{let n=td(M,0,ea);-1===n&&(n=M.length-ea),eR(t,M.subarray(ea,n)),ea=n+1;break}case 7:case 6:case 8:eo--}ea+=ec}return eO(t,ea+1),eo+1},upper:function(t){let n=e4(t,1),N=n.length,M=new Uint8Array(N);for(let t=0;t<N;t++){let N=n[t];h(N)&&(N&=223),M[t]=N}return eR(t,M),1}};t.exports.luaopen_string=function(t){return e9(t,tv),ey(t,0,1),eS(t,""),eC(t,-2),eB(t,-2),ew(t,1),eC(t,-2),eM(t,-2,tg("__index",!0)),ew(t,1),1}},function(t,n,N){let{lua_gettop:M,lua_pushcfunction:es,lua_pushfstring:ea,lua_pushinteger:eo,lua_pushnil:el,lua_pushstring:eu,lua_pushvalue:ec,lua_setfield:ef,lua_tointeger:eh}=N(2),{luaL_Buffer:ep,luaL_addvalue:ed,luaL_argcheck:e_,luaL_buffinit:eg,luaL_checkinteger:em,luaL_checkstack:eb,luaL_checkstring:ey,luaL_error:ev,luaL_newlib:ek,luaL_optinteger:eL,luaL_pushresult:eA}=N(7),{luastring_of:ex,to_luastring:ew}=N(5),z=function(t){return(192&t)==128},Y=function(t,n){return t>=0?t:0-t>n?0:n+t+1},eT=[255,127,2047,65535],G=function(t,n){let N=t[n],M=0;if(N<128)M=N;else{let es=0;for(;64&N;){let ea=t[n+ ++es];if((192&ea)!=128)return null;M=M<<6|63&ea,N<<=1}if(M|=(127&N)<<5*es,es>3||M>1114111||M<=eT[es])return null;n+=es}return{code:M,pos:n+1}},eO=ew("%U"),k=function(t,n){let N=em(t,n);e_(t,0<=N&&N<=1114111,n,"value out of range"),ea(t,eO,N)},$=function(t){let n=ey(t,1),N=n.length,M=eh(t,2)-1;if(M<0)M=0;else if(M<N)for(M++;z(n[M]);)M++;if(M>=N)return 0;{let N=G(n,M);return null===N||z(n[N.pos])?ev(t,ew("invalid UTF-8 code")):(eo(t,M+1),eo(t,N.code),2)}},eE={char:function(t){let n=M(t);if(1===n)k(t,1);else{let N=new ep;eg(t,N);for(let M=1;M<=n;M++)k(t,M),ed(N);eA(N)}return 1},codepoint:function(t){let n=ey(t,1),N=Y(eL(t,2,1),n.length),M=Y(eL(t,3,N),n.length);if(e_(t,N>=1,2,"out of range"),e_(t,M<=n.length,3,"out of range"),N>M)return 0;if(M-N>=Number.MAX_SAFE_INTEGER)return ev(t,"string slice too long");let es=M-N+1;for(eb(t,es,"string slice too long"),es=0,N-=1;N<M;){let M=G(n,N);if(null===M)return ev(t,"invalid UTF-8 code");eo(t,M.code),N=M.pos,es++}return es},codes:function(t){return ey(t,1),es(t,$),ec(t,1),eo(t,0),3},len:function(t){let n=0,N=ey(t,1),M=N.length,es=Y(eL(t,2,1),M),ea=Y(eL(t,3,-1),M);for(e_(t,1<=es&&--es<=M,2,"initial position out of string"),e_(t,--ea<M,3,"final position out of string");es<=ea;){let M=G(N,es);if(null===M)return el(t),eo(t,es+1),2;es=M.pos,n++}return eo(t,n),1},offset:function(t){let n=ey(t,1),N=em(t,2),M=N>=0?1:n.length+1;if(M=Y(eL(t,3,M),n.length),e_(t,1<=M&&--M<=n.length,3,"position out of range"),0===N)for(;M>0&&z(n[M]);)M--;else if(z(n[M])&&ev(t,"initial position is a continuation byte"),N<0)for(;N<0&&M>0;){do M--;while(M>0&&z(n[M]));N++}else for(N--;N>0&&M<n.length;){do M++;while(z(n[M]));N--}return 0===N?eo(t,M+1):el(t),1}},eS=ex(91,0,45,127,194,45,244,93,91,128,45,191,93,42);t.exports.luaopen_utf8=function(t){return ek(t,eE),eu(t,eS),ef(t,-2,ew("charpattern",!0)),1}},function(t,n,N){let M;let{LUA_OPLT:es,LUA_TNUMBER:ea,lua_compare:eo,lua_gettop:el,lua_isinteger:eu,lua_isnoneornil:ec,lua_pushboolean:ef,lua_pushinteger:eh,lua_pushliteral:ep,lua_pushnil:ed,lua_pushnumber:e_,lua_pushvalue:eg,lua_setfield:em,lua_settop:eb,lua_tointeger:ey,lua_tointegerx:ev,lua_type:ek}=N(2),{luaL_argcheck:eL,luaL_argerror:eA,luaL_checkany:ex,luaL_checkinteger:ew,luaL_checknumber:eT,luaL_error:eO,luaL_newlib:eE,luaL_optnumber:eS}=N(7),{LUA_MAXINTEGER:eN,LUA_MININTEGER:eU,lua_numbertointeger:eI}=N(3),{to_luastring:eR}=N(5),ht=function(){return M=1103515245*M+12345&2147483647},dt=function(t,n){let N=eI(n);!1!==N?eh(t,N):e_(t,n)},eC={abs:function(t){if(eu(t,1)){let n=ey(t,1);n<0&&(n=0|-n),eh(t,n)}else e_(t,Math.abs(eT(t,1)));return 1},acos:function(t){return e_(t,Math.acos(eT(t,1))),1},asin:function(t){return e_(t,Math.asin(eT(t,1))),1},atan:function(t){let n=eT(t,1),N=eS(t,2,1);return e_(t,Math.atan2(n,N)),1},ceil:function(t){return eu(t,1)?eb(t,1):dt(t,Math.ceil(eT(t,1))),1},cos:function(t){return e_(t,Math.cos(eT(t,1))),1},deg:function(t){return e_(t,eT(t,1)*(180/Math.PI)),1},exp:function(t){return e_(t,Math.exp(eT(t,1))),1},floor:function(t){return eu(t,1)?eb(t,1):dt(t,Math.floor(eT(t,1))),1},fmod:function(t){if(eu(t,1)&&eu(t,2)){let n=ey(t,2);0===n?eA(t,2,"zero"):eh(t,ey(t,1)%n|0)}else{let n=eT(t,1),N=eT(t,2);e_(t,n%N)}return 1},log:function(t){let n,N=eT(t,1);if(ec(t,2))n=Math.log(N);else{let M=eT(t,2);n=2===M?Math.log2(N):10===M?Math.log10(N):Math.log(N)/Math.log(M)}return e_(t,n),1},max:function(t){let n=el(t),N=1;eL(t,n>=1,1,"value expected");for(let M=2;M<=n;M++)eo(t,N,M,es)&&(N=M);return eg(t,N),1},min:function(t){let n=el(t),N=1;eL(t,n>=1,1,"value expected");for(let M=2;M<=n;M++)eo(t,M,N,es)&&(N=M);return eg(t,N),1},modf:function(t){if(eu(t,1))eb(t,1),e_(t,0);else{let n=eT(t,1),N=n<0?Math.ceil(n):Math.floor(n);dt(t,N),e_(t,n===N?0:n-N)}return 2},rad:function(t){return e_(t,eT(t,1)*(Math.PI/180)),1},random:function(t){let n,N,es=void 0===M?Math.random():ht()/2147483648;switch(el(t)){case 0:return e_(t,es),1;case 1:n=1,N=ew(t,1);break;case 2:n=ew(t,1),N=ew(t,2);break;default:return eO(t,"wrong number of arguments")}return eL(t,n<=N,1,"interval is empty"),eL(t,n>=0||N<=eN+n,1,"interval too large"),eh(t,Math.floor(es*=N-n+1)+n),1},randomseed:function(t){return 0==(M=0|eT(t,1))&&(M=1),ht(),0},sin:function(t){return e_(t,Math.sin(eT(t,1))),1},sqrt:function(t){return e_(t,Math.sqrt(eT(t,1))),1},tan:function(t){return e_(t,Math.tan(eT(t,1))),1},tointeger:function(t){let n=ev(t,1);return!1!==n?eh(t,n):(ex(t,1),ed(t)),1},type:function(t){return ek(t,1)===ea?eu(t,1)?ep(t,"integer"):ep(t,"float"):(ex(t,1),ed(t)),1},ult:function(t){let n=ew(t,1),N=ew(t,2);return ef(t,n>=0?N<0||n<N:N<0&&n<N),1}};t.exports.luaopen_math=function(t){return eE(t,eC),e_(t,Math.PI),em(t,-2,eR("pi",!0)),e_(t,1/0),em(t,-2,eR("huge",!0)),eh(t,eN),em(t,-2,eR("maxinteger",!0)),eh(t,eU),em(t,-2,eR("mininteger",!0)),1}},function(t,n,N){let M;let{LUA_MASKCALL:es,LUA_MASKCOUNT:ea,LUA_MASKLINE:eo,LUA_MASKRET:el,LUA_REGISTRYINDEX:eu,LUA_TFUNCTION:ec,LUA_TNIL:ef,LUA_TTABLE:eh,LUA_TUSERDATA:ep,lua_Debug:ed,lua_call:e_,lua_checkstack:eg,lua_gethook:em,lua_gethookcount:eb,lua_gethookmask:ey,lua_getinfo:ev,lua_getlocal:ek,lua_getmetatable:eL,lua_getstack:eA,lua_getupvalue:ex,lua_getuservalue:ew,lua_insert:eT,lua_iscfunction:eO,lua_isfunction:eE,lua_isnoneornil:eS,lua_isthread:eN,lua_newtable:eU,lua_pcall:eI,lua_pop:eR,lua_pushboolean:eC,lua_pushfstring:eP,lua_pushinteger:eM,lua_pushlightuserdata:eB,lua_pushliteral:eD,lua_pushnil:eK,lua_pushstring:eF,lua_pushvalue:eV,lua_rawgetp:ej,lua_rawsetp:eG,lua_rotate:ez,lua_setfield:eH,lua_sethook:eX,lua_setlocal:e$,lua_setmetatable:eW,lua_settop:eq,lua_setupvalue:eZ,lua_setuservalue:eY,lua_tojsstring:eJ,lua_toproxy:eQ,lua_tostring:e1,lua_tothread:e0,lua_touserdata:e2,lua_type:e3,lua_upvalueid:e5,lua_upvaluejoin:e4,lua_xmove:e8}=N(2),{luaL_argcheck:e6,luaL_argerror:e9,luaL_checkany:e7,luaL_checkinteger:ta,luaL_checkstring:to,luaL_checktype:tl,luaL_error:tu,luaL_loadbuffer:tc,luaL_newlib:tf,luaL_optinteger:th,luaL_optstring:tp,luaL_traceback:td,lua_writestringerror:t_}=N(7),tg=N(17),{luastring_indexOf:tm,to_luastring:tb}=N(5),_e=function(t,n,N){t===n||eg(n,N)||tu(t,tb("stack overflow",!0))},ge=function(t){return eN(t,1)?{arg:1,thread:e0(t,1)}:{arg:0,thread:t}},ye=function(t,n,N){eF(t,N),eH(t,-2,n)},Ie=function(t,n,N){eM(t,N),eH(t,-2,n)},ae=function(t,n,N){eC(t,N),eH(t,-2,n)},ce=function(t,n,N){t==n?ez(t,-2,1):e8(n,t,1),eH(t,-2,N)},Le=function(t,n){let N=ta(t,2);tl(t,1,ec);let M=n?ex(t,1,N):eZ(t,1,N);return null===M?0:(eF(t,M),eT(t,-(n+1)),n+1)},o=function(t,n,N){let M=ta(t,N);return tl(t,n,ec),e6(t,null!==ex(t,n,M),N,"invalid upvalue index"),M},ty=tb("__hooks__",!0),tv=["call","return","line","count","tail call"].map(t=>tb(t)),h=function(t,n){ej(t,eu,ty);let N=e2(t,-1).get(t);N&&(N(t),eF(t,tv[n.event]),n.currentline>=0?eM(t,n.currentline):eK(t),tg.lua_assert(ev(t,tb("lS"),n)),e_(t,2,0))},tk={gethook:function(t){let n,N=ge(t).thread,M=new Uint8Array(5),ea=ey(N),ec=em(N);return null===ec?eK(t):ec!==h?eD(t,"external hook"):(ej(t,eu,ty),e2(t,-1).get(N)(t)),eF(t,(n=0,ea&es&&(M[n++]=99),ea&el&&(M[n++]=114),ea&eo&&(M[n++]=108),M.subarray(0,n))),eM(t,eb(N)),3},getinfo:function(t){let n=new ed,N=ge(t),M=N.arg,es=N.thread,ea=tp(t,M+2,"flnStu");if(_e(t,es,3),eE(t,M+1))ea=eP(t,tb(">%s"),ea),eV(t,M+1),e8(t,es,1);else if(!eA(es,ta(t,M+1),n))return eK(t),1;return ev(es,ea,n)||e9(t,M+2,"invalid option"),eU(t),tm(ea,83)>-1&&(ye(t,tb("source",!0),n.source),ye(t,tb("short_src",!0),n.short_src),Ie(t,tb("linedefined",!0),n.linedefined),Ie(t,tb("lastlinedefined",!0),n.lastlinedefined),ye(t,tb("what",!0),n.what)),tm(ea,108)>-1&&Ie(t,tb("currentline",!0),n.currentline),tm(ea,117)>-1&&(Ie(t,tb("nups",!0),n.nups),Ie(t,tb("nparams",!0),n.nparams),ae(t,tb("isvararg",!0),n.isvararg)),tm(ea,110)>-1&&(ye(t,tb("name",!0),n.name),ye(t,tb("namewhat",!0),n.namewhat)),tm(ea,116)>-1&&ae(t,tb("istailcall",!0),n.istailcall),tm(ea,76)>-1&&ce(t,es,tb("activelines",!0)),tm(ea,102)>-1&&ce(t,es,tb("func",!0)),1},getlocal:function(t){let n=ge(t),N=n.thread,M=n.arg,es=new ed,ea=ta(t,M+2);if(eE(t,M+1))return eV(t,M+1),eF(t,ek(t,null,ea)),1;{if(!eA(N,ta(t,M+1),es))return e9(t,M+1,"level out of range");_e(t,N,1);let n=ek(N,es,ea);return n?(e8(N,t,1),eF(t,n),ez(t,-2,1),2):(eK(t),1)}},getmetatable:function(t){return e7(t,1),eL(t,1)||eK(t),1},getregistry:function(t){return eV(t,eu),1},getupvalue:function(t){return Le(t,1)},getuservalue:function(t){return e3(t,1)!==ep?eK(t):ew(t,1),1},sethook:function(t){let n,N,M,eh,ep=ge(t),ed=ep.thread,e_=ep.arg;if(eS(t,e_+1))eq(t,e_+1),M=null,n=0,N=0;else{var eg;let eu;let ef=to(t,e_+2);tl(t,e_+1,ec),N=th(t,e_+3,0),M=h,eg=N,eu=0,tm(ef,99)>-1&&(eu|=es),tm(ef,114)>-1&&(eu|=el),tm(ef,108)>-1&&(eu|=eo),eg>0&&(eu|=ea),n=eu}ej(t,eu,ty)===ef?(eB(t,eh=new WeakMap),eG(t,eu,ty)):eh=e2(t,-1);let em=eQ(t,e_+1);return eh.set(ed,em),eX(ed,M,n,N),0},setlocal:function(t){let n=ge(t),N=n.thread,M=n.arg,es=new ed,ea=ta(t,M+1),eo=ta(t,M+2);if(!eA(N,ea,es))return e9(t,M+1,"level out of range");e7(t,M+3),eq(t,M+3),_e(t,N,1),e8(t,N,1);let el=e$(N,es,eo);return null===el&&eR(N,1),eF(t,el),1},setmetatable:function(t){let n=e3(t,2);return e6(t,n==ef||n==eh,2,"nil or table expected"),eq(t,2),eW(t,1),1},setupvalue:function(t){return e7(t,3),Le(t,0)},setuservalue:function(t){return tl(t,1,ep),e7(t,2),eq(t,2),eY(t,1),1},traceback:function(t){let n=ge(t),N=n.thread,M=n.arg,es=e1(t,M+1);if(null!==es||eS(t,M+1)){let n=th(t,M+2,t===N?1:0);td(t,N,es,n)}else eV(t,M+1);return 1},upvalueid:function(t){let n=o(t,1,2);return eB(t,e5(t,1,n)),1},upvaluejoin:function(t){let n=o(t,1,2),N=o(t,3,4);return e6(t,!eO(t,1),1,"Lua function expected"),e6(t,!eO(t,3),3,"Lua function expected"),e4(t,1,n,3,N),0}};"u">typeof window&&(M=function(){let t=prompt("lua_debug>","");return null!==t?t:""}),M&&(tk.debug=function(t){for(;;){let n=M();if("cont"===n)return 0;if(0===n.length)continue;let N=tb(n);(tc(t,N,N.length,tb("=(debug command)",!0))||eI(t,0,0,0))&&t_(eJ(t,-1),`
`),eq(t,0)}}),t.exports.luaopen_debug=function(t){return tf(t,tk),1}},function(t,n,N){let M,es;let{LUA_DIRSEP:ea,LUA_EXEC_DIR:eo,LUA_JSPATH_DEFAULT:el,LUA_PATH_DEFAULT:eu,LUA_PATH_MARK:ec,LUA_PATH_SEP:ef}=N(3),{LUA_OK:eh,LUA_REGISTRYINDEX:ep,LUA_TNIL:ed,LUA_TTABLE:e_,lua_callk:eg,lua_createtable:em,lua_getfield:eb,lua_insert:ey,lua_isfunction:ev,lua_isnil:ek,lua_isstring:eL,lua_newtable:eA,lua_pop:ex,lua_pushboolean:ew,lua_pushcclosure:eT,lua_pushcfunction:eO,lua_pushfstring:eE,lua_pushglobaltable:eS,lua_pushlightuserdata:eN,lua_pushliteral:eU,lua_pushlstring:eI,lua_pushnil:eR,lua_pushstring:eC,lua_pushvalue:eP,lua_rawgeti:eM,lua_rawgetp:eB,lua_rawseti:eD,lua_rawsetp:eK,lua_remove:eF,lua_setfield:eV,lua_setmetatable:ej,lua_settop:eG,lua_toboolean:ez,lua_tostring:eH,lua_touserdata:eX,lua_upvalueindex:e$}=N(2),{LUA_LOADED_TABLE:eW,LUA_PRELOAD_TABLE:eq,luaL_Buffer:eZ,luaL_addvalue:eY,luaL_buffinit:eJ,luaL_checkstring:eQ,luaL_error:e1,luaL_getsubtable:e0,luaL_gsub:e2,luaL_len:e3,luaL_loadfile:e5,luaL_newlib:e4,luaL_optstring:e8,luaL_pushresult:e6,luaL_setfuncs:e9}=N(7),e7=N(17),{luastring_indexOf:ta,to_jsstring:to,to_luastring:tl,to_uristring:tu}=N(5),tc=N(0),tf="u">typeof window?window:"u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this"),th=tl("__JSLIBS__"),tp=tl("luaopen_"),td=tl("_"),t_=tl("\x01");M=function(t,n,N){n=tu(n);let M=new XMLHttpRequest;if(M.open("GET",n,!1),M.send(),M.status<200||M.status>=300)return eC(t,tl(`${M.status}: ${M.statusText}`)),null;let es,ea=M.response;/\/\/[#@] sourceURL=/.test(ea)||(ea+=" //# sourceURL="+n);try{es=Function("fengari",ea)}catch(n){return eC(t,tl(`${n.name}: ${n.message}`)),null}let eo=es(tc);return"function"==typeof eo||"object"==typeof eo&&null!==eo?eo:void 0===eo?tf:(eC(t,tl(`library returned unexpected type (${typeof eo})`)),null)},es=function(t){t=tu(t);let n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(),n.status>=200&&n.status<=299};let _e=function(t,n,N){let es=Ie(t,n);if(null===es){if(null===(es=M(t,n,42===N[0])))return 1;ae(t,n,es)}if(42===N[0])return ew(t,1),0;{let n;let M=(n=es[to(N)])&&"function"==typeof n?n:(eE(t,tl("undefined symbol: %s"),N),null);return null===M?2:(eO(t,M),0)}},ye=function(t,n,N,M){let es,ea=`${N}${e7.LUA_VERSUFFIX}`;eC(t,tl(ea));let eo=tf[ea];void 0===eo&&(eo=tf[N]),void 0===eo||(eb(t,ep,tl("LUA_NOENV")),es=ez(t,-1),ex(t,1),es)?eC(t,M):(eo=e2(t,tl(eo),tl(ef+ef,!0),tl(ef+to(t_)+ef,!0)),e2(t,eo,t_,M),eF(t,-2)),eV(t,-3,n),ex(t,1)},Ie=function(t,n){eB(t,ep,th),eb(t,-1,n);let N=eX(t,-1);return ex(t,2),N},ae=function(t,n,N){eB(t,ep,th),eN(t,N),eP(t,-1),eV(t,-3,n),eD(t,-2,e3(t,-2)+1),ex(t,1)},ce=function(t,n){for(;n[0]===ef.charCodeAt(0);)n=n.subarray(1);if(0===n.length)return null;let N=ta(n,ef.charCodeAt(0));return N<0&&(N=n.length),eI(t,n,N),n.subarray(N)},Le=function(t,n,N,M,ea){let eo=new eZ;for(eJ(t,eo),0!==M[0]&&(n=e2(t,n,M,ea));null!==(N=ce(t,N));){let N=e2(t,eH(t,-1),tl(ec,!0),n);if(eF(t,-2),es(N))return N;eE(t,tl(`
	no file '%s'`),N),eF(t,-2),eY(eo)}return e6(eo),null},o=function(t,n,N,M){eb(t,e$(1),N);let es=eH(t,-1);return null===es&&e1(t,tl("'package.%s' must be a string"),N),Le(t,n,es,tl("."),M)},u=function(t,n,N){return n?(eC(t,N),2):e1(t,tl(`error loading module '%s' from file '%s':
	%s`),eH(t,1),N,eH(t,-1))},A=function(t){let n=eQ(t,1),N=o(t,n,tl("path",!0),tl(ea,!0));return null===N?1:u(t,e5(t,N)===eh,N)},h=function(t,n,N){let M;let es=ta(N=e2(t,N,tl("."),td),45);if(es>=0){M=eI(t,N,es),M=eE(t,tl("%s%s"),tp,M);let ea=_e(t,n,M);if(2!==ea)return ea;N=es+1}return M=eE(t,tl("%s%s"),tp,N),_e(t,n,M)},x=function(t){let n=eQ(t,1),N=o(t,n,tl("jspath",!0),tl(ea,!0));return null===N?1:u(t,0===h(t,N,n),N)},H=function(t){let n,N=eQ(t,1),M=ta(N,46);if(M<0)return 0;eI(t,N,M);let es=o(t,eH(t,-1),tl("jspath",!0),tl(ea,!0));return null===es?1:0!==(n=h(t,es,N))?2!=n?u(t,0,es):(eC(t,tl(`
	no module '%s' in file '%s'`),N,es),1):(eC(t,es),2)},I=function(t){let n=eQ(t,1);return eb(t,ep,eq),eb(t,-1,n)===ed&&eE(t,tl(`
	no field package.preload['%s']`),n),1},ct=function(t,n,N){for(;n===eh?(eM(t,3,N.i)===ed&&(ex(t,1),e6(N.msg),e1(t,tl("module '%s' not found:%s"),N.name,eH(t,-1))),eC(t,N.name),eg(t,1,2,N,ct)):n=eh,!ev(t,-2);N.i++)eL(t,-2)?(ex(t,1),eY(N.msg)):ex(t,2);return N.k(t,eh,N.ctx)},Vt=function(t,n,N){return eC(t,N),ey(t,-2),eg(t,2,1,N,Jt),Jt(t,eh,N)},Jt=function(t,n,N){return ek(t,-1)||eV(t,2,N),eb(t,2,N)==ed&&(ew(t,1),eP(t,-1),eV(t,2,N)),1},tg={loadlib:function(t){let n=eQ(t,1),N=eQ(t,2),M=_e(t,n,N);return 0===M?1:(eR(t),ey(t,-2),eU(t,1===M?"open":"init"),3)},searchpath:function(t){return null!==Le(t,eQ(t,1),eQ(t,2),e8(t,3,"."),e8(t,4,ea))?1:(eR(t),ey(t,-2),2)}},tm={require:function(t){let n,N=eQ(t,1);return eG(t,1),eb(t,ep,eW),eb(t,2,N),ez(t,-1)?1:(ex(t,1),eJ(t,n=new eZ),eb(t,e$(1),tl("searchers",!0))!==e_&&e1(t,tl("'package.searchers' must be a table")),ct(t,eh,{name:N,i:1,msg:n,ctx:N,k:Vt}))}};t.exports.luaopen_package=function(t){return eA(t),em(t,0,1),ej(t,-2),eK(t,ep,th),e4(t,tg),function(t){let n=[I,A,x,H,null];em(t);for(let N=0;n[N];N++)eP(t,-2),eT(t,n[N],1),eD(t,-2,N+1);eV(t,-2,tl("searchers",!0))}(t),ye(t,tl("path",!0),"LUA_PATH",eu),ye(t,tl("jspath",!0),"LUA_JSPATH",el),eU(t,ea+`
`+ef+`
`+ec+`
`+eo+`
-
`),eV(t,-2,tl("config",!0)),e0(t,ep,eW),eV(t,-2,tl("loaded",!0)),e0(t,ep,eq),eV(t,-2,tl("preload",!0)),eS(t),eP(t,-2),e9(t,tm,1),ex(t,1),1}},function(t,n,N){let{lua_pushinteger:M,lua_pushliteral:es,lua_setfield:ea}=N(2),{luaL_newlib:eo}=N(7),{FENGARI_AUTHORS:el,FENGARI_COPYRIGHT:eu,FENGARI_RELEASE:ec,FENGARI_VERSION:ef,FENGARI_VERSION_MAJOR:eh,FENGARI_VERSION_MINOR:ep,FENGARI_VERSION_NUM:ed,FENGARI_VERSION_RELEASE:e_,to_luastring:eg}=N(5);t.exports.luaopen_fengari=function(t){return eo(t,{}),es(t,el),ea(t,-2,eg("AUTHORS")),es(t,eu),ea(t,-2,eg("COPYRIGHT")),es(t,ec),ea(t,-2,eg("RELEASE")),es(t,ef),ea(t,-2,eg("VERSION")),es(t,eh),ea(t,-2,eg("VERSION_MAJOR")),es(t,ep),ea(t,-2,eg("VERSION_MINOR")),M(t,ed),ea(t,-2,eg("VERSION_NUM")),es(t,e_),ea(t,-2,eg("VERSION_RELEASE")),1}},function(t,n,N){N.r(n),N.d(n,"L",function(){return eN}),N.d(n,"load",function(){return k});var M=N(0);N.d(n,"FENGARI_AUTHORS",function(){return M.FENGARI_AUTHORS}),N.d(n,"FENGARI_COPYRIGHT",function(){return M.FENGARI_COPYRIGHT}),N.d(n,"FENGARI_RELEASE",function(){return M.FENGARI_RELEASE}),N.d(n,"FENGARI_VERSION",function(){return M.FENGARI_VERSION}),N.d(n,"FENGARI_VERSION_MAJOR",function(){return M.FENGARI_VERSION_MAJOR}),N.d(n,"FENGARI_VERSION_MINOR",function(){return M.FENGARI_VERSION_MINOR}),N.d(n,"FENGARI_VERSION_NUM",function(){return M.FENGARI_VERSION_NUM}),N.d(n,"FENGARI_VERSION_RELEASE",function(){return M.FENGARI_VERSION_RELEASE}),N.d(n,"luastring_eq",function(){return M.luastring_eq}),N.d(n,"luastring_indexOf",function(){return M.luastring_indexOf}),N.d(n,"luastring_of",function(){return M.luastring_of}),N.d(n,"to_jsstring",function(){return M.to_jsstring}),N.d(n,"to_luastring",function(){return M.to_luastring}),N.d(n,"to_uristring",function(){return M.to_uristring}),N.d(n,"lua",function(){return M.lua}),N.d(n,"lauxlib",function(){return M.lauxlib}),N.d(n,"lualib",function(){return M.lualib});var es=N(21);N.d(n,"interop",function(){return es});let{LUA_ERRRUN:ea,LUA_ERRSYNTAX:eo,LUA_OK:el,LUA_VERSION_MAJOR:eu,LUA_VERSION_MINOR:ec,lua_Debug:ef,lua_getinfo:eh,lua_getstack:ep,lua_gettop:ed,lua_insert:e_,lua_pcall:eg,lua_pop:em,lua_pushcfunction:eb,lua_pushstring:ey,lua_remove:ev,lua_setglobal:ek,lua_tojsstring:eL}=M.lua,{luaL_loadbuffer:eA,luaL_newstate:ex,luaL_requiref:ew}=M.lauxlib,{checkjs:eT,luaopen_js:eO,push:eE,tojs:eS}=es,eN=ex();function k(t,n){if("string"==typeof t)t=Object(M.to_luastring)(t);else if(!(t instanceof Uint8Array))throw TypeError("expects an array of bytes or javascript string");let N,es=eA(eN,t,null,n=n?Object(M.to_luastring)(n):null);if(N=es===eo?SyntaxError(eL(eN,-1)):eS(eN,-1),em(eN,1),es!==el)throw N;return N}if(M.lualib.luaL_openlibs(eN),ew(eN,Object(M.to_luastring)("js"),eO,1),em(eN,1),ey(eN,Object(M.to_luastring)(M.FENGARI_COPYRIGHT)),ek(eN,Object(M.to_luastring)("_COPYRIGHT")),"u">typeof document&&document instanceof HTMLDocument){let $=function(t){switch(t){case"anonymous":return"omit";case"use-credentials":return"include";default:return"same-origin"}},ft=function(t){let n=new ef;return ep(t,2,n)&&eh(t,Object(M.to_luastring)("Sl"),n),eE(t,new ErrorEvent("error",{bubbles:!0,cancelable:!0,message:eL(t,1),error:eS(t,1),filename:n.short_src?Object(M.to_jsstring)(n.short_src):void 0,lineno:n.currentline>0?n.currentline:void 0})),1},ht=function(t,n,N){let M,es=eA(eN,n,null,N);if(es===eo){let n=eL(eN,-1),N=t.src?t.src:document.location,es,ea=SyntaxError(n,N,es);M=new ErrorEvent("error",{message:n,error:ea,filename:N,lineno:es})}else if(es===el){let n=ed(eN);eb(eN,ft),e_(eN,n),Object.defineProperty(document,"currentScript",{value:t,configurable:!0}),es=eg(eN,0,0,n),delete document.currentScript,ev(eN,n),es===ea&&(M=eT(eN,-1))}es!==el&&(void 0===M&&(M=new ErrorEvent("error",{message:eL(eN,-1),error:eS(eN,-1)})),em(eN,1),window.dispatchEvent(M)&&console.error("uncaught exception",M.error))},dt=function(t,n,N){if(t.status>=200&&t.status<300){let es=t.response;ht(n,es="string"==typeof es?Object(M.to_luastring)(t.response):new Uint8Array(es),N)}else n.dispatchEvent(new Event("error"))},mt=function(t){if(t.src){let n=Object(M.to_luastring)("@"+t.src);if("complete"===document.readyState||t.async){if("function"==typeof fetch)fetch(t.src,{method:"GET",credentials:$(t.crossorigin),redirect:"follow",integrity:t.integrity}).then(function(t){if(t.ok)return t.arrayBuffer();throw Error("unable to fetch")}).then(function(N){ht(t,new Uint8Array(N),n)}).catch(function(n){t.dispatchEvent(new Event("error"))});else{let N=new XMLHttpRequest;N.open("GET",t.src,!0),N.responseType="arraybuffer",N.onreadystatechange=function(){4===N.readyState&&dt(N,t,n)},N.send()}}else{let N=new XMLHttpRequest;N.open("GET",t.src,!1),N.send(),dt(N,t,n)}}else{let n=Object(M.to_luastring)(t.innerHTML),N=t.id?Object(M.to_luastring)("="+t.id):n;ht(t,n,N)}},t=/^(.*?\/.*?)([\t ]*;.*)?$/,n=/^(\d+)\.(\d+)$/,P=function(N){if("SCRIPT"!==N.tagName)return;let M=t.exec(N.type);if(!M)return;let es=M[1];if("application/lua"===es||"text/lua"===es){if(N.hasAttribute("lua-version")){let t=n.exec(N.getAttribute("lua-version"));if(!t||t[1]!==eu||t[2]!==ec)return}mt(N)}};"u">typeof MutationObserver?new MutationObserver(function(t,n){for(let n=0;n<t.length;n++){let N=t[n];for(let t=0;t<N.addedNodes.length;t++)P(N.addedNodes[t])}}).observe(document,{childList:!0,subtree:!0}):console.warn&&console.warn("fengari-web: MutationObserver not found; lua script tags will not be run when inserted"),Array.prototype.forEach.call(document.querySelectorAll('script[type^="application/lua"], script[type^="text/lua"]'),P)}},function(t,n,N){let{LUA_MULTRET:M,LUA_OPADD:es,LUA_OPBAND:ea,LUA_OPBNOT:eo,LUA_OPBOR:el,LUA_OPBXOR:eu,LUA_OPDIV:ec,LUA_OPIDIV:ef,LUA_OPMOD:eh,LUA_OPSHL:ep,LUA_OPSHR:ed,LUA_OPUNM:e_,constant_types:{LUA_TBOOLEAN:eg,LUA_TLIGHTUSERDATA:em,LUA_TLNGSTR:eb,LUA_TNIL:ey,LUA_TNUMFLT:ev,LUA_TNUMINT:ek,LUA_TTABLE:eL},to_luastring:eA}=N(1),{lua_assert:ex}=N(4),ew=N(20),eT=N(6),eO=N(16),eE=N(23),eS=N(9),eN=N(15),eU=eO.OpCodesI,eI=eT.TValue,eR={OPR_ADD:0,OPR_SUB:1,OPR_MUL:2,OPR_MOD:3,OPR_POW:4,OPR_DIV:5,OPR_IDIV:6,OPR_BAND:7,OPR_BOR:8,OPR_BXOR:9,OPR_SHL:10,OPR_SHR:11,OPR_CONCAT:12,OPR_EQ:13,OPR_LT:14,OPR_LE:15,OPR_NE:16,OPR_GT:17,OPR_GE:18,OPR_AND:19,OPR_OR:20,OPR_NOBINOPR:21},eC={OPR_MINUS:0,OPR_BNOT:1,OPR_NOT:2,OPR_LEN:3,OPR_NOUNOPR:4},dt=function(t){return t.t!==t.f},mt=function(t,n){let N=eE.expkind;if(dt(t))return!1;switch(t.k){case N.VKINT:return!n||new eI(ek,t.u.ival);case N.VKFLT:return!n||new eI(ev,t.u.nval);default:return!1}},V=function(t,n,N){let M,es=n+N-1;if(t.pc>t.lasttarget&&(M=t.f.code[t.pc-1]).opcode===eU.OP_LOADNIL){let t=M.A,N=t+M.B;if(t<=n&&n<=N+1||n<=t&&t<=es+1)return t<n&&(n=t),N>es&&(es=N),eO.SETARG_A(M,n),void eO.SETARG_B(M,es-n)}tt(t,eU.OP_LOADNIL,n,N-1,0)},U=function(t,n){return t.f.code[n.u.info]},P=function(t,n){let N=t.f.code[n].sBx;return -1===N?-1:n+1+N},gt=function(t,n,N){let M=t.f.code[n],es=N-(n+1);ex(-1!==N),Math.abs(es)>eO.MAXARG_sBx&&ew.luaX_syntaxerror(t.ls,eA("control structure too long",!0)),eO.SETARG_sBx(M,es)},_t=function(t,n,N){if(-1===N)return n;if(-1===n)n=N;else{let M=n,es=P(t,M);for(;-1!==es;)es=P(t,M=es);gt(t,M,N)}return n},St=function(t){let n=t.jpc;t.jpc=-1;let N=S(t,eU.OP_JMP,0,-1);return _t(t,N,n)},Xt=function(t,n,N,M,es){return tt(t,n,N,M,es),St(t)},ee=function(t){return t.lasttarget=t.pc,t.pc},Yt=function(t,n){return n>=1&&eO.testTMode(t.f.code[n-1].opcode)?n-1:n},rt=function(t,n){return t.f.code[Yt(t,n)]},ot=function(t,n,N){let M=Yt(t,n),es=t.f.code[M];return es.opcode===eU.OP_TESTSET&&(N!==eO.NO_REG&&N!==es.B?eO.SETARG_A(es,N):t.f.code[M]=eO.CREATE_ABC(eU.OP_TEST,es.B,0,es.C),!0)},It=function(t,n){for(;-1!==n;n=P(t,n))ot(t,n,eO.NO_REG)},xt=function(t,n,N,M,es){for(;-1!==n;){let ea=P(t,n);ot(t,n,M)?gt(t,n,N):gt(t,n,es),n=ea}},Kt=function(t,n){ee(t),t.jpc=_t(t,t.jpc,n)},m=function(t,n,N){N===t.pc?Kt(t,n):(ex(N<t.pc),xt(t,n,N,eO.NO_REG,N))},pt=function(t,n){let N=t.f;return xt(t,t.jpc,t.pc,eO.NO_REG,t.pc),t.jpc=-1,N.code[t.pc]=n,N.lineinfo[t.pc]=t.ls.lastline,t.pc++},tt=function(t,n,N,M,es){return ex(eO.getOpMode(n)===eO.iABC),ex(eO.getBMode(n)!==eO.OpArgN||0===M),ex(eO.getCMode(n)!==eO.OpArgN||0===es),ex(N<=eO.MAXARG_A&&M<=eO.MAXARG_B&&es<=eO.MAXARG_C),pt(t,eO.CREATE_ABC(n,N,M,es))},w=function(t,n,N,M){return ex(eO.getOpMode(n)===eO.iABx||eO.getOpMode(n)===eO.iAsBx),ex(eO.getCMode(n)===eO.OpArgN),ex(N<=eO.MAXARG_A&&M<=eO.MAXARG_Bx),pt(t,eO.CREATE_ABx(n,N,M))},S=function(t,n,N,M){return w(t,n,N,M+eO.MAXARG_sBx)},b=function(t,n){return ex(n<=eO.MAXARG_Ax),pt(t,eO.CREATE_Ax(eU.OP_EXTRAARG,n))},q=function(t,n,N){if(N<=eO.MAXARG_Bx)return w(t,eU.OP_LOADK,n,N);{let M=w(t,eU.OP_LOADKX,n,0);return b(t,N),M}},st=function(t,n){let N=t.freereg+n;N>t.f.maxstacksize&&(N>=255&&ew.luaX_syntaxerror(t.ls,eA("function or expression needs too many registers",!0)),t.f.maxstacksize=N)},O=function(t,n){st(t,n),t.freereg+=n},Q=function(t,n){!eO.ISK(n)&&n>=t.nactvar&&(t.freereg--,ex(n===t.freereg))},lt=function(t,n){n.k===eE.expkind.VNONRELOC&&Q(t,n.u.info)},Nt=function(t,n,N){let M=n.k===eE.expkind.VNONRELOC?n.u.info:-1,es=N.k===eE.expkind.VNONRELOC?N.u.info:-1;M>es?(Q(t,M),Q(t,es)):(Q(t,es),Q(t,M))},Ft=function(t,n,N){let M=t.f,es=eS.luaH_get(t.L,t.ls.h,n);if(es.ttisinteger()){let n=es.value;if(n<t.nk&&M.k[n].ttype()===N.ttype()&&M.k[n].value===N.value)return n}let ea=t.nk;return eS.luaH_setfrom(t.L,t.ls.h,n,new eT.TValue(ek,ea)),M.k[ea]=N,t.nk++,ea},ne=function(t,n){return Ft(t,new eI(em,n),new eI(ek,n))},fe=function(t,n){let N=new eI(ev,n);return Ft(t,N,N)},Te=function(t,n){let N=new eI(eg,n);return Ft(t,N,N)},Oe=function(t,n,N){let es=eE.expkind;if(n.k===es.VCALL)eO.SETARG_C(U(t,n),N+1);else if(n.k===es.VVARARG){let M=U(t,n);eO.SETARG_B(M,N+1),eO.SETARG_A(M,t.freereg),O(t,1)}else ex(N===M)},Re=function(t,n){let N=eE.expkind;n.k===N.VCALL?(ex(2===U(t,n).C),n.k=N.VNONRELOC,n.u.info=U(t,n).A):n.k===N.VVARARG&&(eO.SETARG_B(U(t,n),2),n.k=N.VRELOCABLE)},K=function(t,n){let N=eE.expkind;switch(n.k){case N.VLOCAL:n.k=N.VNONRELOC;break;case N.VUPVAL:n.u.info=tt(t,eU.OP_GETUPVAL,0,n.u.info,0),n.k=N.VRELOCABLE;break;case N.VINDEXED:{let M;Q(t,n.u.ind.idx),n.u.ind.vt===N.VLOCAL?(Q(t,n.u.ind.t),M=eU.OP_GETTABLE):(ex(n.u.ind.vt===N.VUPVAL),M=eU.OP_GETTABUP),n.u.info=tt(t,M,0,n.u.ind.t,n.u.ind.idx),n.k=N.VRELOCABLE;break}case N.VVARARG:case N.VCALL:Re(t,n)}},Ct=function(t,n,N,M){return ee(t),tt(t,eU.OP_LOADBOOL,n,N,M)},Gt=function(t,n,N){let M=eE.expkind;switch(K(t,n),n.k){case M.VNIL:V(t,N,1);break;case M.VFALSE:case M.VTRUE:tt(t,eU.OP_LOADBOOL,N,n.k===M.VTRUE,0);break;case M.VK:q(t,N,n.u.info);break;case M.VKFLT:q(t,N,fe(t,n.u.nval));break;case M.VKINT:q(t,N,ne(t,n.u.ival));break;case M.VRELOCABLE:{let M=U(t,n);eO.SETARG_A(M,N);break}case M.VNONRELOC:N!==n.u.info&&tt(t,eU.OP_MOVE,N,n.u.info,0);break;default:return void ex(n.k===M.VJMP)}n.u.info=N,n.k=M.VNONRELOC},Mt=function(t,n){n.k!==eE.expkind.VNONRELOC&&(O(t,1),Gt(t,n,t.freereg-1))},Tt=function(t,n){for(;-1!==n;n=P(t,n))if(rt(t,n).opcode!==eU.OP_TESTSET)return!0;return!1},Pt=function(t,n,N){let M=eE.expkind;if(Gt(t,n,N),n.k===M.VJMP&&(n.t=_t(t,n.t,n.u.info)),dt(n)){let es,ea=-1,eo=-1;if(Tt(t,n.t)||Tt(t,n.f)){let es=n.k===M.VJMP?-1:St(t);ea=Ct(t,N,0,1),eo=Ct(t,N,1,0),Kt(t,es)}es=ee(t),xt(t,n.f,es,N,ea),xt(t,n.t,es,N,eo)}n.f=n.t=-1,n.u.info=N,n.k=M.VNONRELOC},Wt=function(t,n){K(t,n),lt(t,n),O(t,1),Pt(t,n,t.freereg-1)},_e=function(t,n){if(K(t,n),n.k===eE.expkind.VNONRELOC){if(!dt(n))return n.u.info;if(n.u.info>=t.nactvar)return Pt(t,n,n.u.info),n.u.info}return Wt(t,n),n.u.info},ge=function(t,n){dt(n)?_e(t,n):K(t,n)},ye=function(t,n){let N=eE.expkind,M=!1;switch(ge(t,n),n.k){case N.VTRUE:n.u.info=Te(t,!0),M=!0;break;case N.VFALSE:n.u.info=Te(t,!1),M=!0;break;case N.VNIL:let es,ea;n.u.info=(es=new eI(ey,null),ea=new eI(eL,t.ls.h),Ft(t,ea,es)),M=!0;break;case N.VKINT:n.u.info=ne(t,n.u.ival),M=!0;break;case N.VKFLT:n.u.info=fe(t,n.u.nval),M=!0;break;case N.VK:M=!0}return M&&(n.k=N.VK,n.u.info<=eO.MAXINDEXRK)?eO.RKASK(n.u.info):_e(t,n)},Ie=function(t,n){let N=rt(t,n.u.info);ex(eO.testTMode(N.opcode)&&N.opcode!==eU.OP_TESTSET&&N.opcode!==eU.OP_TEST),eO.SETARG_A(N,!N.A)},ae=function(t,n,N){if(n.k===eE.expkind.VRELOCABLE){let M=U(t,n);if(M.opcode===eU.OP_NOT)return t.pc--,Xt(t,eU.OP_TEST,M.B,0,!N)}return Mt(t,n),lt(t,n),Xt(t,eU.OP_TESTSET,eO.NO_REG,n.u.info,N)},ce=function(t,n){let N,M=eE.expkind;switch(K(t,n),n.k){case M.VJMP:Ie(t,n),N=n.u.info;break;case M.VK:case M.VKFLT:case M.VKINT:case M.VTRUE:N=-1;break;default:N=ae(t,n,0)}n.f=_t(t,n.f,N),Kt(t,n.t),n.t=-1},Le=function(t,n){let N,M=eE.expkind;switch(K(t,n),n.k){case M.VJMP:N=n.u.info;break;case M.VNIL:case M.VFALSE:N=-1;break;default:N=ae(t,n,1)}n.t=_t(t,n.t,N),Kt(t,n.f),n.f=-1},o=function(t,n,N){let M,es,e_=eE.expkind;if(!(M=mt(n,!0))||!(es=mt(N,!0))||!function(t,n,N){switch(t){case ea:case el:case eu:case ep:case ed:case eo:return!1!==eN.tointeger(n)&&!1!==eN.tointeger(N);case ec:case ef:case eh:return 0!==N.value;default:return 1}}(t,M,es))return 0;let eg=new eI;if(eT.luaO_arith(null,t,M,es,eg),eg.ttisinteger())n.k=e_.VKINT,n.u.ival=eg.value;else{let t=eg.value;if(isNaN(t)||0===t)return!1;n.k=e_.VKFLT,n.u.nval=t}return!0},u=function(t,n,N,M,es){let ea=ye(t,M),eo=ye(t,N);Nt(t,N,M),N.u.info=tt(t,n,0,eo,ea),N.k=eE.expkind.VRELOCABLE,A(t,es)},A=function(t,n){t.f.lineinfo[t.pc-1]=n};t.exports.BinOpr=eR,t.exports.NO_JUMP=-1,t.exports.UnOpr=eC,t.exports.getinstruction=U,t.exports.luaK_checkstack=st,t.exports.luaK_code=pt,t.exports.luaK_codeABC=tt,t.exports.luaK_codeABx=w,t.exports.luaK_codeAsBx=S,t.exports.luaK_codek=q,t.exports.luaK_concat=_t,t.exports.luaK_dischargevars=K,t.exports.luaK_exp2RK=ye,t.exports.luaK_exp2anyreg=_e,t.exports.luaK_exp2anyregup=function(t,n){(n.k!==eE.expkind.VUPVAL||dt(n))&&_e(t,n)},t.exports.luaK_exp2nextreg=Wt,t.exports.luaK_exp2val=ge,t.exports.luaK_fixline=A,t.exports.luaK_getlabel=ee,t.exports.luaK_goiffalse=Le,t.exports.luaK_goiftrue=ce,t.exports.luaK_indexed=function(t,n,N){let M=eE.expkind;ex(!dt(n)&&(eE.vkisinreg(n.k)||n.k===M.VUPVAL)),n.u.ind.t=n.u.info,n.u.ind.idx=ye(t,N),n.u.ind.vt=n.k===M.VUPVAL?M.VUPVAL:M.VLOCAL,n.k=M.VINDEXED},t.exports.luaK_infix=function(t,n,N){switch(n){case eR.OPR_AND:ce(t,N);break;case eR.OPR_OR:Le(t,N);break;case eR.OPR_CONCAT:Wt(t,N);break;case eR.OPR_ADD:case eR.OPR_SUB:case eR.OPR_MUL:case eR.OPR_DIV:case eR.OPR_IDIV:case eR.OPR_MOD:case eR.OPR_POW:case eR.OPR_BAND:case eR.OPR_BOR:case eR.OPR_BXOR:case eR.OPR_SHL:case eR.OPR_SHR:mt(N,!1)||ye(t,N);break;default:ye(t,N)}},t.exports.luaK_intK=ne,t.exports.luaK_jump=St,t.exports.luaK_jumpto=function(t,n){return m(t,St(t),n)},t.exports.luaK_nil=V,t.exports.luaK_numberK=fe,t.exports.luaK_patchclose=function(t,n,N){for(N++;-1!==n;n=P(t,n)){let M=t.f.code[n];ex(M.opcode===eU.OP_JMP&&(0===M.A||M.A>=N)),eO.SETARG_A(M,N)}},t.exports.luaK_patchlist=m,t.exports.luaK_patchtohere=Kt,t.exports.luaK_posfix=function(t,n,N,M,ea){let eo=eE.expkind;switch(n){case eR.OPR_AND:ex(-1===N.t),K(t,M),M.f=_t(t,M.f,N.f),N.to(M);break;case eR.OPR_OR:ex(-1===N.f),K(t,M),M.t=_t(t,M.t,N.t),N.to(M);break;case eR.OPR_CONCAT:{ge(t,M);let n=U(t,M);M.k===eo.VRELOCABLE&&n.opcode===eU.OP_CONCAT?(ex(N.u.info===n.B-1),lt(t,N),eO.SETARG_B(n,N.u.info),N.k=eo.VRELOCABLE,N.u.info=M.u.info):(Wt(t,M),u(t,eU.OP_CONCAT,N,M,ea));break}case eR.OPR_ADD:case eR.OPR_SUB:case eR.OPR_MUL:case eR.OPR_DIV:case eR.OPR_IDIV:case eR.OPR_MOD:case eR.OPR_POW:case eR.OPR_BAND:case eR.OPR_BOR:case eR.OPR_BXOR:case eR.OPR_SHL:case eR.OPR_SHR:o(n+es,N,M)||u(t,n+eU.OP_ADD,N,M,ea);break;case eR.OPR_EQ:case eR.OPR_LT:case eR.OPR_LE:case eR.OPR_NE:case eR.OPR_GT:case eR.OPR_GE:(function(t,n,N,M){let es,ea=eE.expkind;N.k===ea.VK?es=eO.RKASK(N.u.info):(ex(N.k===ea.VNONRELOC),es=N.u.info);let eo=ye(t,M);switch(Nt(t,N,M),n){case eR.OPR_NE:N.u.info=Xt(t,eU.OP_EQ,0,es,eo);break;case eR.OPR_GT:case eR.OPR_GE:{let M=n-eR.OPR_NE+eU.OP_EQ;N.u.info=Xt(t,M,1,eo,es);break}default:{let M=n-eR.OPR_EQ+eU.OP_EQ;N.u.info=Xt(t,M,1,es,eo)}}N.k=ea.VJMP})(t,n,N,M)}return N},t.exports.luaK_prefix=function(t,n,N,M){let es=new eE.expdesc;switch(es.k=eE.expkind.VKINT,es.u.ival=es.u.nval=es.u.info=0,es.t=-1,es.f=-1,n){case eC.OPR_MINUS:case eC.OPR_BNOT:if(o(n+e_,N,es))break;case eC.OPR_LEN:var ea;let eo;ea=n+eU.OP_UNM,eo=_e(t,N),lt(t,N),N.u.info=tt(t,ea,0,eo,0),N.k=eE.expkind.VRELOCABLE,A(t,M);break;case eC.OPR_NOT:(function(t,n){let N=eE.expkind;switch(K(t,n),n.k){case N.VNIL:case N.VFALSE:n.k=N.VTRUE;break;case N.VK:case N.VKFLT:case N.VKINT:case N.VTRUE:n.k=N.VFALSE;break;case N.VJMP:Ie(t,n);break;case N.VRELOCABLE:case N.VNONRELOC:Mt(t,n),lt(t,n),n.u.info=tt(t,eU.OP_NOT,0,n.u.info,0),n.k=N.VRELOCABLE}{let t=n.f;n.f=n.t,n.t=t}It(t,n.f),It(t,n.t)})(t,N)}},t.exports.luaK_reserveregs=O,t.exports.luaK_ret=function(t,n,N){tt(t,eU.OP_RETURN,n,N+1,0)},t.exports.luaK_self=function(t,n,N){_e(t,n);let M=n.u.info;lt(t,n),n.u.info=t.freereg,n.k=eE.expkind.VNONRELOC,O(t,2),tt(t,eU.OP_SELF,n.u.info,M,ye(t,N)),lt(t,N)},t.exports.luaK_setlist=function(t,n,N,es){let ea=(N-1)/eO.LFIELDS_PER_FLUSH+1,eo=es===M?0:es;ex(0!==es&&es<=eO.LFIELDS_PER_FLUSH),ea<=eO.MAXARG_C?tt(t,eU.OP_SETLIST,n,eo,ea):ea<=eO.MAXARG_Ax?(tt(t,eU.OP_SETLIST,n,eo,0),b(t,ea)):ew.luaX_syntaxerror(t.ls,eA("constructor too long",!0)),t.freereg=n+1},t.exports.luaK_setmultret=function(t,n){Oe(t,n,M)},t.exports.luaK_setoneret=Re,t.exports.luaK_setreturns=Oe,t.exports.luaK_storevar=function(t,n,N){let M=eE.expkind;switch(n.k){case M.VLOCAL:return lt(t,N),void Pt(t,N,n.u.info);case M.VUPVAL:{let M=_e(t,N);tt(t,eU.OP_SETUPVAL,M,n.u.info,0);break}case M.VINDEXED:{let es=n.u.ind.vt===M.VLOCAL?eU.OP_SETTABLE:eU.OP_SETTABUP,ea=ye(t,N);tt(t,es,n.u.ind.t,n.u.ind.idx,ea)}}lt(t,N)},t.exports.luaK_stringK=function(t,n){let N=new eI(eb,n);return Ft(t,N,N)}},function(t,n,N){let{LUA_SIGNATURE:M,constant_types:{LUA_TBOOLEAN:es,LUA_TLNGSTR:ea,LUA_TNIL:eo,LUA_TNUMFLT:el,LUA_TNUMINT:eu,LUA_TSHRSTR:ec},thread_status:{LUA_ERRSYNTAX:ef},is_luastring:eh,luastring_eq:ep,to_luastring:ed}=N(1),e_=N(8),eg=N(13),em=N(6),{MAXARG_sBx:eb,POS_A:ey,POS_Ax:ev,POS_B:ek,POS_Bx:eL,POS_C:eA,POS_OP:ex,SIZE_A:ew,SIZE_Ax:eT,SIZE_B:eO,SIZE_Bx:eE,SIZE_C:eS,SIZE_OP:eN}=N(16),{lua_assert:eU}=N(4),{luaS_bless:eI}=N(10),{luaZ_read:eR,ZIO:eC}=N(19),eP=[25,147,13,10,26,10];let mt=class mt{constructor(t,n,N){this.intSize=4,this.size_tSize=4,this.instructionSize=4,this.integerSize=4,this.numberSize=8,eU(n instanceof eC,"BytecodeParser only operates on a ZIO"),eU(eh(N)),64===N[0]||61===N[0]?this.name=N.subarray(1):N[0]==M[0]?this.name=ed("binary string",!0):this.name=N,this.L=t,this.Z=n,this.arraybuffer=new ArrayBuffer(Math.max(this.intSize,this.size_tSize,this.instructionSize,this.integerSize,this.numberSize)),this.dv=new DataView(this.arraybuffer),this.u8=new Uint8Array(this.arraybuffer)}read(t){let n=new Uint8Array(t);return 0!==eR(this.Z,n,0,t)&&this.error("truncated"),n}LoadByte(){return 0!==eR(this.Z,this.u8,0,1)&&this.error("truncated"),this.u8[0]}LoadInt(){return 0!==eR(this.Z,this.u8,0,this.intSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadNumber(){return 0!==eR(this.Z,this.u8,0,this.numberSize)&&this.error("truncated"),this.dv.getFloat64(0,!0)}LoadInteger(){return 0!==eR(this.Z,this.u8,0,this.integerSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadSize_t(){return this.LoadInteger()}LoadString(){let t=this.LoadByte();return 255===t&&(t=this.LoadSize_t()),0===t?null:eI(this.L,this.read(t-1))}static MASK1(t,n){return~(-1<<t)<<n}LoadCode(t){let n=this.LoadInt();for(let N=0;N<n;N++){0!==eR(this.Z,this.u8,0,this.instructionSize)&&this.error("truncated");let n=this.dv.getUint32(0,!0);t.code[N]={code:n,opcode:n>>ex&mt.MASK1(eN,0),A:n>>ey&mt.MASK1(ew,0),B:n>>ek&mt.MASK1(eO,0),C:n>>eA&mt.MASK1(eS,0),Bx:n>>eL&mt.MASK1(eE,0),Ax:n>>ev&mt.MASK1(eT,0),sBx:(n>>eL&mt.MASK1(eE,0))-eb}}}LoadConstants(t){let n=this.LoadInt();for(let N=0;N<n;N++){let n=this.LoadByte();switch(n){case eo:t.k.push(new em.TValue(eo,null));break;case es:t.k.push(new em.TValue(es,0!==this.LoadByte()));break;case el:t.k.push(new em.TValue(el,this.LoadNumber()));break;case eu:t.k.push(new em.TValue(eu,this.LoadInteger()));break;case ec:case ea:t.k.push(new em.TValue(ea,this.LoadString()));break;default:this.error(`unrecognized constant '${n}'`)}}}LoadProtos(t){let n=this.LoadInt();for(let N=0;N<n;N++)t.p[N]=new eg.Proto(this.L),this.LoadFunction(t.p[N],t.source)}LoadUpvalues(t){let n=this.LoadInt();for(let N=0;N<n;N++)t.upvalues[N]={name:null,instack:this.LoadByte(),idx:this.LoadByte()}}LoadDebug(t){let n=this.LoadInt();for(let N=0;N<n;N++)t.lineinfo[N]=this.LoadInt();n=this.LoadInt();for(let N=0;N<n;N++)t.locvars[N]={varname:this.LoadString(),startpc:this.LoadInt(),endpc:this.LoadInt()};n=this.LoadInt();for(let N=0;N<n;N++)t.upvalues[N].name=this.LoadString()}LoadFunction(t,n){t.source=this.LoadString(),null===t.source&&(t.source=n),t.linedefined=this.LoadInt(),t.lastlinedefined=this.LoadInt(),t.numparams=this.LoadByte(),t.is_vararg=0!==this.LoadByte(),t.maxstacksize=this.LoadByte(),this.LoadCode(t),this.LoadConstants(t),this.LoadUpvalues(t),this.LoadProtos(t),this.LoadDebug(t)}checkliteral(t,n){ep(this.read(t.length),t)||this.error(n)}checkHeader(){this.checkliteral(M.subarray(1),"not a"),83!==this.LoadByte()&&this.error("version mismatch in"),0!==this.LoadByte()&&this.error("format mismatch in"),this.checkliteral(eP,"corrupted"),this.intSize=this.LoadByte(),this.size_tSize=this.LoadByte(),this.instructionSize=this.LoadByte(),this.integerSize=this.LoadByte(),this.numberSize=this.LoadByte(),this.checksize(this.intSize,4,"int"),this.checksize(this.size_tSize,4,"size_t"),this.checksize(this.instructionSize,4,"instruction"),this.checksize(this.integerSize,4,"integer"),this.checksize(this.numberSize,8,"number"),22136!==this.LoadInteger()&&this.error("endianness mismatch in"),370.5!==this.LoadNumber()&&this.error("float format mismatch in")}error(t){em.luaO_pushfstring(this.L,ed("%s: %s precompiled chunk"),this.name,ed(t)),e_.luaD_throw(this.L,ef)}checksize(t,n,N){t!==n&&this.error(`${N} size mismatch in`)}};t.exports.luaU_undump=function(t,n,N){let M=new mt(t,n,N);M.checkHeader();let es=eg.luaF_newLclosure(t,M.LoadByte());return e_.luaD_inctop(t),t.stack[t.top-1].setclLvalue(es),es.p=new eg.Proto(t),M.LoadFunction(es.p,null),eU(es.nupvalues===es.p.upvalues.length),es}},function(t,n,N){let{LUA_SIGNATURE:M,LUA_VERSION_MAJOR:es,LUA_VERSION_MINOR:ea,constant_types:{LUA_TBOOLEAN:eo,LUA_TLNGSTR:el,LUA_TNIL:eu,LUA_TNUMFLT:ec,LUA_TNUMINT:ef,LUA_TSHRSTR:eh},luastring_of:ep}=N(1),ed=ep(25,147,13,10,26,10),e_=16*Number(es)+Number(ea),f=function(t,n,N){0===N.status&&n>0&&(N.status=N.writer(N.L,t,n,N.data))},g=function(t,n){f(ep(t),1,n)},v=function(t,n){let N=new ArrayBuffer(4);new DataView(N).setInt32(0,t,!0),f(new Uint8Array(N),4,n)},R=function(t,n){let N=new ArrayBuffer(4);new DataView(N).setInt32(0,t,!0),f(new Uint8Array(N),4,n)},B=function(t,n){let N=new ArrayBuffer(8);new DataView(N).setFloat64(0,t,!0),f(new Uint8Array(N),8,n)},j=function(t,n){if(null===t)g(0,n);else{let N=t.tsslen()+1,M=t.getstr();N<255?g(N,n):(g(255,n),R(N,n)),f(M,N-1,n)}},F=function(t,n,N){N.strip||t.source===n?j(null,N):j(t.source,N),v(t.linedefined,N),v(t.lastlinedefined,N),g(t.numparams,N),g(t.is_vararg?1:0,N),g(t.maxstacksize,N),function(t,n){let N=t.code.map(t=>t.code);v(N.length,n);for(let t=0;t<N.length;t++)v(N[t],n)}(t,N),function(t,n){let N=t.k.length;v(N,n);for(let M=0;M<N;M++){let N=t.k[M];switch(g(N.ttype(),n),N.ttype()){case eu:break;case eo:g(N.value?1:0,n);break;case ec:B(N.value,n);break;case ef:R(N.value,n);break;case eh:case el:j(N.tsvalue(),n)}}}(t,N),function(t,n){let N=t.upvalues.length;v(N,n);for(let M=0;M<N;M++)g(t.upvalues[M].instack?1:0,n),g(t.upvalues[M].idx,n)}(t,N),function(t,n){let N=t.p.length;v(N,n);for(let M=0;M<N;M++)F(t.p[M],t.source,n)}(t,N),function(t,n){let N=n.strip?0:t.lineinfo.length;v(N,n);for(let M=0;M<N;M++)v(t.lineinfo[M],n);v(N=n.strip?0:t.locvars.length,n);for(let M=0;M<N;M++)j(t.locvars[M].varname,n),v(t.locvars[M].startpc,n),v(t.locvars[M].endpc,n);v(N=n.strip?0:t.upvalues.length,n);for(let M=0;M<N;M++)j(t.upvalues[M].name,n)}(t,N)};t.exports.luaU_dump=function(t,n,N,es,ea){let eo=new class{constructor(){this.L=null,this.write=null,this.data=null,this.strip=NaN,this.status=NaN}};return eo.L=t,eo.writer=N,eo.data=es,eo.strip=ea,eo.status=0,f(M,M.length,eo),g(e_,eo),g(0,eo),f(ed,ed.length,eo),g(4,eo),g(4,eo),g(4,eo),g(4,eo),g(8,eo),R(22136,eo),B(370.5,eo),g(n.upvalues.length,eo),F(n,null,eo),eo.status}},function(t,n,N){var M;!function(){var es={not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function a(t){return function(t,n){var N,M,ea,eo,el,eu,ec,ef,eh,ep=1,ed=t.length,e_="";for(M=0;M<ed;M++)if("string"==typeof t[M])e_+=t[M];else if(Array.isArray(t[M])){if((eo=t[M])[2])for(N=n[ep],ea=0;ea<eo[2].length;ea++){if(!N.hasOwnProperty(eo[2][ea]))throw Error(a('[sprintf] property "%s" does not exist',eo[2][ea]));N=N[eo[2][ea]]}else N=eo[1]?n[eo[1]]:n[ep++];if(es.not_type.test(eo[8])&&es.not_primitive.test(eo[8])&&N instanceof Function&&(N=N()),es.numeric_arg.test(eo[8])&&"number"!=typeof N&&isNaN(N))throw TypeError(a("[sprintf] expecting number but found %T",N));switch(es.number.test(eo[8])&&(ef=N>=0),eo[8]){case"b":N=parseInt(N,10).toString(2);break;case"c":N=String.fromCharCode(parseInt(N,10));break;case"d":case"i":N=parseInt(N,10);break;case"j":N=JSON.stringify(N,null,eo[6]?parseInt(eo[6]):0);break;case"e":N=eo[7]?parseFloat(N).toExponential(eo[7]):parseFloat(N).toExponential();break;case"f":N=eo[7]?parseFloat(N).toFixed(eo[7]):parseFloat(N);break;case"g":N=eo[7]?String(Number(N.toPrecision(eo[7]))):parseFloat(N);break;case"o":N=(parseInt(N,10)>>>0).toString(8);break;case"s":N=String(N),N=eo[7]?N.substring(0,eo[7]):N;break;case"t":N=String(!!N),N=eo[7]?N.substring(0,eo[7]):N;break;case"T":N=Object.prototype.toString.call(N).slice(8,-1).toLowerCase(),N=eo[7]?N.substring(0,eo[7]):N;break;case"u":N=parseInt(N,10)>>>0;break;case"v":N=N.valueOf(),N=eo[7]?N.substring(0,eo[7]):N;break;case"x":N=(parseInt(N,10)>>>0).toString(16);break;case"X":N=(parseInt(N,10)>>>0).toString(16).toUpperCase()}es.json.test(eo[8])?e_+=N:(es.number.test(eo[8])&&(!ef||eo[3])?(eh=ef?"+":"-",N=N.toString().replace(es.sign,"")):eh="",eu=eo[4]?"0"===eo[4]?"0":eo[4].charAt(1):" ",ec=eo[6]-(eh+N).length,el=eo[6]&&ec>0?eu.repeat(ec):"",e_+=eo[5]?eh+N+el:"0"===eu?eh+el+N:el+eh+N)}return e_}(function(t){if(ea[t])return ea[t];for(var n,N=t,M=[],eo=0;N;){if(null!==(n=es.text.exec(N)))M.push(n[0]);else if(null!==(n=es.modulo.exec(N)))M.push("%");else{if(null===(n=es.placeholder.exec(N)))throw SyntaxError("[sprintf] unexpected placeholder");if(n[2]){eo|=1;var el=[],eu=n[2],ec=[];if(null===(ec=es.key.exec(eu)))throw SyntaxError("[sprintf] failed to parse named argument key");for(el.push(ec[1]);""!==(eu=eu.substring(ec[0].length));)if(null!==(ec=es.key_access.exec(eu)))el.push(ec[1]);else{if(null===(ec=es.index_access.exec(eu)))throw SyntaxError("[sprintf] failed to parse named argument key");el.push(ec[1])}n[2]=el}else eo|=2;if(3===eo)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");M.push(n)}N=N.substring(n[0].length)}return ea[t]=M}(t),arguments)}function i(t,n){return a.apply(null,[t].concat(n||[]))}var ea=Object.create(null);n.sprintf=a,n.vsprintf=i,"u">typeof window&&(window.sprintf=a,window.vsprintf=i,void 0===(M=(function(){return{sprintf:a,vsprintf:i}}).call(n,N,n,t))||(t.exports=M))}()},function(t,n,N){let{lua_pop:M}=N(2),{luaL_requiref:es}=N(7),{to_luastring:ea}=N(5),eo={};t.exports.luaL_openlibs=function(t){for(let n in eo)es(t,ea(n),eo[n],1),M(t,1)};let el=N(17),{luaopen_base:eu}=N(24),{luaopen_coroutine:ec}=N(25),{luaopen_debug:ef}=N(31),{luaopen_math:eh}=N(30),{luaopen_package:ep}=N(32),{luaopen_os:ed}=N(27),{luaopen_string:e_}=N(28),{luaopen_table:eg}=N(26),{luaopen_utf8:em}=N(29);eo._G=eu,eo[el.LUA_LOADLIBNAME]=ep,eo[el.LUA_COLIBNAME]=ec,eo[el.LUA_TABLIBNAME]=eg,eo[el.LUA_OSLIBNAME]=ed,eo[el.LUA_STRLIBNAME]=e_,eo[el.LUA_MATHLIBNAME]=eh,eo[el.LUA_UTF8LIBNAME]=em,eo[el.LUA_DBLIBNAME]=ef;let{luaopen_fengari:eb}=N(33);eo[el.LUA_FENGARILIBNAME]=eb}]);function pr(t,n){if("boolean"==typeof n)ec.lua.lua_pushboolean(t,n);else if("number"==typeof n)ec.lua.lua_pushnumber(t,n);else if("string"==typeof n)ec.lua.lua_pushstring(t,ec.to_luastring(n));else if(Array.isArray(n))ec.lua.lua_newtable(t),n.forEach((n,N)=>{pr(t,n),ec.lua.lua_rawseti(t,-2,N+1)});else if("object"==typeof n)ec.lua.lua_newtable(t),Object.entries(n).forEach(([n,N])=>{pr(t,N),ec.lua.lua_setfield(t,-2,n)});else throw`unknown type ${typeof n}`}function Wr(t,n){return ec.lua.lua_tojsstring(t,n)}function Ls(t,n){ec.lua.lua_pushnil(t);let N={};for(;0!=ec.lua.lua_next(t,-2);)N[Wr(t,-2)]=Zr(t,-1),ec.lua.lua_pop(t,1);return N}function ws(t){let n=Zr(t,-1);return ec.lua.lua_pop(t,1),n}function Zr(t,n){if(!ec.lua.lua_isnil(t,n)){if(ec.lua.lua_isboolean(t,n))return ec.lua.lua_toboolean(t,n);if(ec.lua.lua_isnumber(t,n))return ec.lua.lua_tonumber(t,n);if(ec.lua.lua_isstring(t,n))return Wr(t,n);if(ec.lua.lua_istable(t,n))return function(t,n){let N=ec.lua.lua_rawlen(t,n);if(0===N)return Ls(t);let M=[];for(let n=0;n<N;++n){if(ec.lua.lua_rawgeti(t,-1,n+1),ec.lua.lua_isnil(t,-1))return ec.lua.lua_pop(t,1),Ls(t);M.push(Zr(t,-1)),ec.lua.lua_pop(t,1)}return M}(t,n);throw`unknown type ${ec.lua.lua_typename(t,ec.lua.lua_type(t,n))}`}}function Ur(t,n,...N){if(ec.lua.lua_getglobal(t,ec.to_luastring(n,!0)),N.forEach(n=>{pr(t,n)}),ec.lua.lua_call(t,N.length,1)!==ec.lua.LUA_OK){let n=Wr(t,-1);if(n)throw Error(n)}}let qa=class qa{get luaState(){return this._luaState}constructor(t){this._luaState=t}};let Za=class Za{get luaState(){return this._instance.luaState}constructor(t){this._instance=t}saveState(){return Ur(this.luaState,"saveState"),ws(this.luaState)}loadState(t){Ur(this.luaState,"loadState",t)}inputs(t){return Ur(this.luaState,"inputs",t),ws(this.luaState)}};let Ja=class Ja{constructor(){this._exceptionLogged=!1}get id(){return 0}get label(){return"Agent"}get isBound(){return void 0!==this._vm}get isAgent(){return!0}get isPlayer(){return!1}loadAgent(t){return new Promise(n=>{let s=(t,N,M)=>{let es=function(t,n){switch(t){case"lua":return function(t){let n=function(t){let n=ec.lauxlib.luaL_newstate(),e=function(t,N){pr(n,N),ec.lua.lua_setglobal(n,ec.to_luastring(t))};if(void 0!==t.globals&&Object.entries(t.globals).forEach(([t,n])=>{console.log("register Lua global",t),e(t,n)}),void 0!==t.api&&Object.entries(t.api).forEach(([t,N])=>{console.log("register Lua api",t),ec.lua.lua_register(n,t,n=>{try{return N(n)}catch(n){throw Error(`error in ${t} implementation: ${n}`)}})}),void 0!==t.script&&ec.lauxlib.luaL_dostring(n,ec.to_luastring(t.script))!=ec.lua.LUA_OK){console.error(ec.to_jsstring(ec.lua.lua_tostring(n,-1)));return}return new qa(n)}({script:t});return void 0!==n?new Za(n):void 0}(n);case"javascript":return function(t){let n={},N={exports:n},M=Object.keys(N),es=Function(...M,`${t}
; ${eu.map(t=>`if (typeof ${t} !== "undefined") exports.${t} = ${t}`).join(";")}`);return es(...M.map(t=>N[t])),new Da(es,n)}(n);default:return}}(t,M);this._agent={language:t,url:N,code:M},this.unloadAgent(),this._vm=es,this._exceptionLogged=!1,n()};void 0!==t.url?fetch(t.url).then(t=>t.text()).then(n=>s(void 0!==t.language?t.language:t.url.endsWith(".lua")?"lua":"javascript",t.url,n)):void 0!==t.code&&s(t.language??"javascript",void 0,t.code)})}unloadAgent(){this._vm=void 0}inputs(t){if(void 0!==this._vm)try{return this._vm.inputs(t)}catch(t){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling inputs",t))}return{}}saveState(){if(void 0!==this._vm)try{return this._vm.saveState()}catch(t){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling saveState",t))}return{}}loadState(t){if(void 0!==this._vm)try{this._vm.loadState(t)}catch(t){this._exceptionLogged||(this._exceptionLogged=!0,console.log("error calling loadState",t))}}};let xs=class xs{get id(){return this._id}get label(){return this._agentController.isBound?this._agentController.label:void 0!==this._inputController?"human":"<>"}get isBound(){return void 0!==this._inputController}get isAgent(){return this._agentController.isBound}get isPlayer(){return this.isBound&&!this.isAgent}constructor(t,n){this._id=t,this._inputController=n,this._agentController=new Ja}inputs(t){return this._agentController.isBound?this._agentController.inputs(t):void 0!==this._inputController?this._inputController.inputs:{}}loadAgent(t){return this._agentController.loadAgent(t)}unloadAgent(){this._agentController.unloadAgent()}saveState(){return this._agentController.saveState()}loadState(t){this._agentController.loadState(t)}};let ti=class ti{constructor(t){this._controllers=new Map,this._controllersArray=[new xs(0,t.inputController()),new xs(1)],this._controllers.set(0,this._controllersArray[0]),this._controllers.set(1,this._controllersArray[1])}get ids(){return[...this._controllers.keys()]}get controllers(){return this._controllers}get(t){return this._controllers.get(t)}inputs(t){return this._controllersArray.map(n=>({label:n.label,isBound:n.isBound,isPlayer:n.isPlayer,isAgent:n.isAgent,inputs:n.inputs(t)}))}saveState(){return[this._controllers.get(0).saveState(),this._controllers.get(1).saveState()]}loadState(t){this._controllers.get(0).loadState(t),this._controllers.get(1).loadState(t)}};let Qn=class Qn{constructor(t,n){this._el=document.createElement("div"),this._el.style.boxSizing="border-box",this._el.style.display="block",this._el.style.position="absolute",this._el.style.width="32px",this._el.style.height="32px",this._el.style.margin="4px",this._el.style.border="4px solid #fff",this._el.style.borderRadius="50%",this._el.style.animation="moroboxai-spinner-rotate 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite",this._el.style.borderColor="#fff transparent transparent transparent",void 0!==n&&(this._el.style.animationDelay=`-${n}s`),t.appendChild(this._el)}};let ei=class ei{constructor(t){this._el=document.createElement("div"),this._el.style.display="inline-block",this._el.style.position="relative",this._el.style.width="40px",this._el.style.height="40px",new Qn(this._el,.45),new Qn(this._el,.3),new Qn(this._el,.15),new Qn(this._el),t.appendChild(this._el);let n=document.getElementById("moroboxai-dynamic-style");n||((n=document.createElement("style")).id="moroboxai-dynamic-style",document.body.appendChild(n)),n.innerHTML=`@keyframes moroboxai-spinner-rotate {
   0% {
      transform: rotate(0deg);
   }
   100% {
      transform: rotate(360deg);
   }
}`}remove(){this._el.remove()}};let Yr=class Yr{get style(){return this.el.style}constructor(t){this.el=document.createElement("div"),this.el.style.width="100%",this.el.style.height="100%",this.el.style.position="absolute",this.el.style.left="0",this.el.style.top="0",this.el.style.display="flex",this.el.style.flexDirection="column",this.el.style.justifyContent="center",this.el.style.alignItems="center",t.appendChild(this.el)}show(){this.el.style.display="flex"}hide(){this.el.style.display="none"}remove(){this.el.remove()}};let ni=class ni{constructor(t){this._overlay=new Yr(t),this._input=document.createElement("input"),this._input.type="button",this._input.value="Play",this._input.onclick=()=>{this.onPlay&&this.onPlay()},this._overlay.el.appendChild(this._input),t.appendChild(this._overlay.el)}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){}mouseMove(){}mouseLeave(){}remove(){this._overlay.remove()}};let ri=class ri{constructor(t){this._overlay=new Yr(t),this._overlay.style.backgroundColor="black",new ei(this._overlay.el),t.appendChild(this._overlay.el)}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){}mouseMove(){}mouseLeave(){}remove(){this._overlay.remove()}};let si=class si{constructor(t){this._overlay=new Yr(t),this._speed1=document.createElement("input"),this._speed1.type="button",this._speed1.value="x1",this._speed1.onclick=()=>{this.onSpeed&&this.onSpeed(1)},this._speed2=document.createElement("input"),this._speed2.type="button",this._speed2.value="x2",this._speed2.onclick=()=>{this.onSpeed&&this.onSpeed(2)},this._speed4=document.createElement("input"),this._speed4.type="button",this._speed4.value="x4",this._speed4.onclick=()=>{this.onSpeed&&this.onSpeed(4)},this._overlay.el.appendChild(this._speed1),this._overlay.el.appendChild(this._speed2),this._overlay.el.appendChild(this._speed4),this._overlay.hide(),t.appendChild(this._overlay.el)}playing(){}paused(){}show(){this._overlay.show()}hide(){this._overlay.hide()}mouseEnter(){this.show()}mouseMove(){}mouseLeave(){this.hide()}remove(){this._overlay.remove()}};let ai=class ai{constructor(t){this._root=t,this._playOverlay=new ni(t),this._selectedOverlay=this._playOverlay,this._playOverlay.onPlay=()=>{this.onPlay&&this.onPlay()},this._loadingOverlay=new ri(this._root),this._loadingOverlay.hide(),this._settingsOverlay=new si(this._root),this._settingsOverlay.hide(),this._settingsOverlay.onSpeed=t=>{this.onSpeed&&this.onSpeed(t)}}stopped(){this._selectedOverlay.hide(),this._selectedOverlay=this._playOverlay,this._playOverlay.show()}loading(){this._playOverlay.hide(),this._selectedOverlay=this._loadingOverlay,this._loadingOverlay.show()}playing(){this._loadingOverlay.hide(),this._selectedOverlay=this._settingsOverlay,this._settingsOverlay.hide(),this._settingsOverlay.playing()}paused(){this._settingsOverlay.paused()}show(){}hide(){}mouseEnter(){this._selectedOverlay.mouseEnter()}mouseMove(){this._selectedOverlay.mouseMove()}mouseLeave(){this._selectedOverlay.mouseLeave()}remove(){this._playOverlay.remove(),this._loadingOverlay.remove(),this._settingsOverlay.remove()}};let ci=class ci{constructor(t,n,N){this.sortedPlugins=new Map,this.unfulfilledActions=new Set,this.plugins=[...N?N.plugins:[],...n],this.pluginContexts=new Map(this.plugins.map(n=>[n,t]))}hookFirst(t,n,N,M){return this.hookFirstAndGetPlugin(t,n,N,M).then(t=>t&&t[0])}async hookFirstAndGetPlugin(t,n,N,M){for(let es of this.getSortedPlugins(t)){if(null!=M&&M.has(es))continue;let ea=await this.runHook(t,n,es,N);if(null!=ea)return[ea,es]}return null}async hookParallel(t,n,N){let M=[];for(let es of this.getSortedPlugins(t))es[t].sequential?(await Promise.all(M),M.length=0,await this.runHook(t,n,es,N)):M.push(this.runHook(t,n,es,N));await Promise.all(M)}hookReduceArg0(t,[n,...N],M,es){let ea=Promise.resolve(n);for(let n of this.getSortedPlugins(t))ea=ea.then(ea=>this.runHook(t,[ea,...N],n,es).then(t=>M.call(this.pluginContexts.get(n),ea,t,n)));return ea}getSortedPlugins(t,n){return function(t,n,N){let M=t.get(n);if(void 0!==M)return M;let es=N();return t.set(n,es),es}(this.sortedPlugins,t,()=>(function(t,n,N=function(t,n,N){if("function"!=typeof t)throw`invalid plugin hook ${n} ${N}`}){let M=[],es=[],ea=[];for(let eo of n){let n=eo[t];if(n){if("object"==typeof n){if(N(n.handler,t,eo),"pre"===n.order){M.push(eo);continue}if("post"===n.order){ea.push(eo);continue}}else N(n,t,eo);es.push(eo)}}return[...M,...es,...ea]})(t,this.plugins,n))}runHook(t,n,N,M){let es=N[t],ea="object"==typeof es?es.handler:es,eo=this.pluginContexts.get(N);M&&(eo=M(eo,N));let el=null;return Promise.resolve().then(()=>{if("function"!=typeof ea)return ea;let M=ea.apply(eo,n);return null!=M&&M.then?(el=[N.name,t,n],this.unfulfilledActions.add(el),Promise.resolve(M).then(t=>(this.unfulfilledActions.delete(el),t))):M}).catch(t=>{throw null!==el&&this.unfulfilledActions.delete(el),t})}};let ef=Symbol.for("yaml.alias"),eh=Symbol.for("yaml.document"),ep=Symbol.for("yaml.map"),ed=Symbol.for("yaml.pair"),e_=Symbol.for("yaml.scalar"),eg=Symbol.for("yaml.seq"),em=Symbol.for("yaml.node.type"),wn=t=>!!t&&"object"==typeof t&&t[em]===ef,Pn=t=>!!t&&"object"==typeof t&&t[em]===eh,Mn=t=>!!t&&"object"==typeof t&&t[em]===ep,Fe=t=>!!t&&"object"==typeof t&&t[em]===ed,Ve=t=>!!t&&"object"==typeof t&&t[em]===e_,Bn=t=>!!t&&"object"==typeof t&&t[em]===eg;function He(t){if(t&&"object"==typeof t)switch(t[em]){case ep:case eg:return!0}return!1}function ze(t){if(t&&"object"==typeof t)switch(t[em]){case ef:case ep:case e_:case eg:return!0}return!1}let pi=t=>(Ve(t)||He(t))&&!!t.anchor,eb=Symbol("break visit"),ey=Symbol("skip children"),ev=Symbol("remove node");function mn(t,n){let N=Vs(n);Pn(t)?Tn(null,t.contents,N,Object.freeze([t]))===ev&&(t.contents=null):Tn(null,t,N,Object.freeze([]))}function Tn(t,n,N,M){let es=Fs(t,n,N,M);if(ze(es)||Fe(es))return js(t,M,es),Tn(t,es,N,M);if("symbol"!=typeof es){if(He(n)){M=Object.freeze(M.concat(n));for(let t=0;t<n.items.length;++t){let es=Tn(t,n.items[t],N,M);if("number"==typeof es)t=es-1;else{if(es===eb)return eb;es===ev&&(n.items.splice(t,1),t-=1)}}}else if(Fe(n)){M=Object.freeze(M.concat(n));let t=Tn("key",n.key,N,M);if(t===eb)return eb;t===ev&&(n.key=null);let es=Tn("value",n.value,N,M);if(es===eb)return eb;es===ev&&(n.value=null)}}return es}async function dr(t,n){let N=Vs(n);Pn(t)?await En(null,t.contents,N,Object.freeze([t]))===ev&&(t.contents=null):await En(null,t,N,Object.freeze([]))}async function En(t,n,N,M){let es=await Fs(t,n,N,M);if(ze(es)||Fe(es))return js(t,M,es),En(t,es,N,M);if("symbol"!=typeof es){if(He(n)){M=Object.freeze(M.concat(n));for(let t=0;t<n.items.length;++t){let es=await En(t,n.items[t],N,M);if("number"==typeof es)t=es-1;else{if(es===eb)return eb;es===ev&&(n.items.splice(t,1),t-=1)}}}else if(Fe(n)){M=Object.freeze(M.concat(n));let t=await En("key",n.key,N,M);if(t===eb)return eb;t===ev&&(n.key=null);let es=await En("value",n.value,N,M);if(es===eb)return eb;es===ev&&(n.value=null)}}return es}function Vs(t){return"object"==typeof t&&(t.Collection||t.Node||t.Value)?Object.assign({Alias:t.Node,Map:t.Node,Scalar:t.Node,Seq:t.Node},t.Value&&{Map:t.Value,Scalar:t.Value,Seq:t.Value},t.Collection&&{Map:t.Collection,Seq:t.Collection},t):t}function Fs(t,n,N,M){var es,ea,eo,el,eu;return"function"==typeof N?N(t,n,M):Mn(n)?null==(es=N.Map)?void 0:es.call(N,t,n,M):Bn(n)?null==(ea=N.Seq)?void 0:ea.call(N,t,n,M):Fe(n)?null==(eo=N.Pair)?void 0:eo.call(N,t,n,M):Ve(n)?null==(el=N.Scalar)?void 0:el.call(N,t,n,M):wn(n)?null==(eu=N.Alias)?void 0:eu.call(N,t,n,M):void 0}function js(t,n,N){let M=n[n.length-1];if(He(M))M.items[t]=N;else if(Fe(M))"key"===t?M.key=N:M.value=N;else if(Pn(M))M.contents=N;else{let t=wn(M)?"alias":"scalar";throw Error(`Cannot replace node with ${t} parent`)}}mn.BREAK=eb,mn.SKIP=ey,mn.REMOVE=ev,dr.BREAK=eb,dr.SKIP=ey,dr.REMOVE=ev;let ek={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},_i=t=>t.replace(/[!,[\]{}]/g,t=>ek[t]);let Ye=class Ye{constructor(t,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Ye.defaultYaml,t),this.tags=Object.assign({},Ye.defaultTags,n)}clone(){let t=new Ye(this.yaml,this.tags);return t.docStart=this.docStart,t}atDocument(){let t=new Ye(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Ye.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Ye.defaultTags)}return t}add(t,n){this.atNextDocument&&(this.yaml={explicit:Ye.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Ye.defaultTags),this.atNextDocument=!1);let N=t.trim().split(/[ \t]+/),M=N.shift();switch(M){case"%TAG":{if(2!==N.length&&(n(0,"%TAG directive should contain exactly two parts"),N.length<2))return!1;let[t,M]=N;return this.tags[t]=M,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==N.length)return n(0,"%YAML directive should contain exactly one part"),!1;let[t]=N;if("1.1"===t||"1.2"===t)return this.yaml.version=t,!0;{let N=/^\d+\.\d+$/.test(t);return n(6,`Unsupported YAML version ${t}`,N),!1}}default:return n(0,`Unknown directive ${M}`,!0),!1}}tagName(t,n){if("!"===t)return"!";if("!"!==t[0])return n(`Not a valid tag: ${t}`),null;if("<"===t[1]){let N=t.slice(2,-1);return"!"===N||"!!"===N?(n(`Verbatim tags aren't resolved, so ${t} is invalid.`),null):(">"!==t[t.length-1]&&n("Verbatim tags must end with a >"),N)}let[,N,M]=t.match(/^(.*!)([^!]*)$/);M||n(`The ${t} tag has no suffix`);let es=this.tags[N];if(es)try{return es+decodeURIComponent(M)}catch(t){return n(String(t)),null}return"!"===N?t:(n(`Could not resolve tag: ${t}`),null)}tagString(t){for(let[n,N]of Object.entries(this.tags))if(t.startsWith(N))return n+_i(t.substring(N.length));return"!"===t[0]?t:`!<${t}>`}toString(t){let n;let N=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],M=Object.entries(this.tags);if(t&&M.length>0&&ze(t.contents)){let N={};mn(t.contents,(t,n)=>{ze(n)&&n.tag&&(N[n.tag]=!0)}),n=Object.keys(N)}else n=[];for(let[es,ea]of M)"!!"===es&&"tag:yaml.org,2002:"===ea||(!t||n.some(t=>t.startsWith(ea)))&&N.push(`%TAG ${es} ${ea}`);return N.join(`
`)}};function Hs(t){if(/[\x00-\x19\s,[\]{}]/.test(t)){let n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(t)}`;throw Error(n)}return!0}function zs(t){let n=new Set;return mn(t,{Value(t,N){N.anchor&&n.add(N.anchor)}}),n}function Xs(t,n){for(let N=1;;++N){let M=`${t}${N}`;if(!n.has(M))return M}}function On(t,n,N,M){if(M&&"object"==typeof M){if(Array.isArray(M))for(let n=0,N=M.length;n<N;++n){let N=M[n],es=On(t,M,String(n),N);void 0===es?delete M[n]:es!==N&&(M[n]=es)}else if(M instanceof Map)for(let n of Array.from(M.keys())){let N=M.get(n),es=On(t,M,n,N);void 0===es?M.delete(n):es!==N&&M.set(n,es)}else if(M instanceof Set)for(let n of Array.from(M)){let N=On(t,M,n,n);void 0===N?M.delete(n):N!==n&&(M.delete(n),M.add(N))}else for(let[n,N]of Object.entries(M)){let es=On(t,M,n,N);void 0===es?delete M[n]:es!==N&&(M[n]=es)}}return t.call(n,N,M)}function nn(t,n,N){if(Array.isArray(t))return t.map((t,n)=>nn(t,String(n),N));if(t&&"function"==typeof t.toJSON){if(!N||!pi(t))return t.toJSON(n,N);let M={aliasCount:0,count:1,res:void 0};N.anchors.set(t,M),N.onCreate=t=>{M.res=t,delete N.onCreate};let es=t.toJSON(n,N);return N.onCreate&&N.onCreate(es),es}return"bigint"!=typeof t||null!=N&&N.keep?t:Number(t)}Ye.defaultYaml={explicit:!1,version:"1.2"},Ye.defaultTags={"!!":"tag:yaml.org,2002:"};let Jr=class Jr{constructor(t){Object.defineProperty(this,em,{value:t})}clone(){let t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(t.range=this.range.slice()),t}toJS(t,{mapAsMap:n,maxAliasCount:N,onAnchor:M,reviver:es}={}){if(!Pn(t))throw TypeError("A document argument is required");let ea={anchors:new Map,doc:t,keep:!0,mapAsMap:!0===n,mapKeyWarned:!1,maxAliasCount:"number"==typeof N?N:100},eo=nn(this,"",ea);if("function"==typeof M)for(let{count:t,res:n}of ea.anchors.values())M(n,t);return"function"==typeof es?On(es,{"":eo},"",eo):eo}};let _r=class _r extends Jr{constructor(t){super(ef),this.source=t,Object.defineProperty(this,"tag",{set(){throw Error("Alias nodes cannot have tags")}})}resolve(t){let n;return mn(t,{Node:(t,N)=>{if(N===this)return mn.BREAK;N.anchor===this.source&&(n=N)}}),n}toJSON(t,n){if(!n)return{source:this.source};let{anchors:N,doc:M,maxAliasCount:es}=n,ea=this.resolve(M);if(!ea){let t=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw ReferenceError(t)}let eo=N.get(ea);if(eo||(nn(ea,null,n),eo=N.get(ea)),!eo||void 0===eo.res)throw ReferenceError("This should not happen: Alias anchor was not resolved?");if(es>=0&&(eo.count+=1,0===eo.aliasCount&&(eo.aliasCount=function ar(t,n,N){if(wn(n)){let M=n.resolve(t),es=N&&M&&N.get(M);return es?es.count*es.aliasCount:0}if(He(n)){let M=0;for(let es of n.items){let n=ar(t,es,N);n>M&&(M=n)}return M}if(Fe(n)){let M=ar(t,n.key,N),es=ar(t,n.value,N);return Math.max(M,es)}return 1}(M,ea,N)),eo.count*eo.aliasCount>es))throw ReferenceError("Excessive alias count indicates a resource exhaustion attack");return eo.res}toString(t,n,N){let M=`*${this.source}`;if(t){if(Hs(this.source),t.options.verifyAliasOrder&&!t.anchors.has(this.source)){let t=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw Error(t)}if(t.implicitKey)return`${M} `}return M}};let $s=t=>!t||"function"!=typeof t&&"object"!=typeof t;let Ue=class Ue extends Jr{constructor(t){super(e_),this.value=t}toJSON(t,n){return null!=n&&n.keep?this.value:nn(this.value,t,n)}toString(){return String(this.value)}};function zn(t,n,N){var M,es,ea;let eo;if(Pn(t)&&(t=t.contents),ze(t))return t;if(Fe(t)){let n=null==(es=(M=N.schema[ep]).createNode)?void 0:es.call(M,N.schema,null,N);return n.items.push(t),n}(t instanceof String||t instanceof Number||t instanceof Boolean||"u">typeof BigInt&&t instanceof BigInt)&&(t=t.valueOf());let{aliasDuplicateObjects:el,onAnchor:eu,onTagObj:ec,schema:ef,sourceObjects:eh}=N;if(el&&t&&"object"==typeof t){if(eo=eh.get(t))return eo.anchor||(eo.anchor=eu(t)),new _r(eo.anchor);eo={anchor:null,node:null},eh.set(t,eo)}null!=n&&n.startsWith("!!")&&(n="tag:yaml.org,2002:"+n.slice(2));let ed=function(t,n,N){if(n){let t=N.filter(t=>t.tag===n),M=t.find(t=>!t.format)??t[0];if(!M)throw Error(`Tag ${n} not found`);return M}return N.find(n=>{var N;return(null==(N=n.identify)?void 0:N.call(n,t))&&!n.format})}(t,n,ef.tags);if(!ed){if(t&&"function"==typeof t.toJSON&&(t=t.toJSON()),!t||"object"!=typeof t){let n=new Ue(t);return eo&&(eo.node=n),n}ed=t instanceof Map?ef[ep]:Symbol.iterator in Object(t)?ef[eg]:ef[ep]}ec&&(ec(ed),delete N.onTagObj);let e_=null!=ed&&ed.createNode?ed.createNode(N.schema,t,N):"function"==typeof(null==(ea=null==ed?void 0:ed.nodeClass)?void 0:ea.from)?ed.nodeClass.from(N.schema,t,N):new Ue(t);return n?e_.tag=n:ed.default||(e_.tag=ed.tag),eo&&(eo.node=e_),e_}function ur(t,n,N){let M=N;for(let t=n.length-1;t>=0;--t){let N=n[t];if("number"==typeof N&&Number.isInteger(N)&&N>=0){let t=[];t[N]=M,M=t}else M=new Map([[N,M]])}return zn(M,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw Error("This should not happen, please report a bug.")},schema:t,sourceObjects:new Map})}Ue.BLOCK_FOLDED="BLOCK_FOLDED",Ue.BLOCK_LITERAL="BLOCK_LITERAL",Ue.PLAIN="PLAIN",Ue.QUOTE_DOUBLE="QUOTE_DOUBLE",Ue.QUOTE_SINGLE="QUOTE_SINGLE";let jn=t=>null==t||"object"==typeof t&&!!t[Symbol.iterator]().next().done;let mr=class mr extends Jr{constructor(t,n){super(t),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(t){let n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return t&&(n.schema=t),n.items=n.items.map(n=>ze(n)||Fe(n)?n.clone(t):n),this.range&&(n.range=this.range.slice()),n}addIn(t,n){if(jn(t))this.add(n);else{let[N,...M]=t,es=this.get(N,!0);if(He(es))es.addIn(M,n);else if(void 0===es&&this.schema)this.set(N,ur(this.schema,M,n));else throw Error(`Expected YAML collection at ${N}. Remaining path: ${M}`)}}deleteIn(t){let[n,...N]=t;if(0===N.length)return this.delete(n);let M=this.get(n,!0);if(He(M))return M.deleteIn(N);throw Error(`Expected YAML collection at ${n}. Remaining path: ${N}`)}getIn(t,n){let[N,...M]=t,es=this.get(N,!0);return 0===M.length?!n&&Ve(es)?es.value:es:He(es)?es.getIn(M,n):void 0}hasAllNullValues(t){return this.items.every(n=>{if(!Fe(n))return!1;let N=n.value;return null==N||t&&Ve(N)&&null==N.value&&!N.commentBefore&&!N.comment&&!N.tag})}hasIn(t){let[n,...N]=t;if(0===N.length)return this.has(n);let M=this.get(n,!0);return!!He(M)&&M.hasIn(N)}setIn(t,n){let[N,...M]=t;if(0===M.length)this.set(N,n);else{let t=this.get(N,!0);if(He(t))t.setIn(M,n);else if(void 0===t&&this.schema)this.set(N,ur(this.schema,M,n));else throw Error(`Expected YAML collection at ${N}. Remaining path: ${M}`)}}};mr.maxFlowStringSingleLineLength=60;let bi=t=>t.replace(/^(?!$)(?: $)?/gm,"#");function fn(t,n){return/^\n+$/.test(t)?t.substring(1):n?t.replace(/^(?! *$)/gm,n):t}let dn=(t,n,N)=>t.endsWith(`
`)?fn(N,n):N.includes(`
`)?`
`+fn(N,n):(t.endsWith(" ")?"":" ")+N,eL="flow",eA="block",ex="quoted";function gr(t,n,N="flow",{indentAtStart:M,lineWidth:es=80,minContentWidth:ea=20,onFold:eo,onOverflow:el}={}){if(!es||es<0)return t;let eu=Math.max(1+ea,1+es-n.length);if(t.length<=eu)return t;let ec=[],ef={},eh=es-n.length;"number"==typeof M&&(M>es-Math.max(2,ea)?ec.push(0):eh=es-M);let ep,ed,e_=!1,eg=-1,em=-1,eb=-1;N===eA&&-1!==(eg=Ts(t,eg))&&(eh=eg+eu);for(let n;n=t[eg+=1];){if(N===ex&&"\\"===n){switch(em=eg,t[eg+1]){case"x":eg+=3;break;case"u":eg+=5;break;case"U":eg+=9;break;default:eg+=1}eb=eg}if(n===`
`)N===eA&&(eg=Ts(t,eg)),eh=eg+eu,ep=void 0;else{if(" "===n&&ed&&" "!==ed&&ed!==`
`&&"	"!==ed){let n=t[eg+1];n&&" "!==n&&n!==`
`&&"	"!==n&&(ep=eg)}if(eg>=eh){if(ep)ec.push(ep),eh=ep+eu,ep=void 0;else if(N===ex){for(;" "===ed||"	"===ed;)ed=n,n=t[eg+=1],e_=!0;let N=eg>eb+1?eg-2:em-1;if(ef[N])return t;ec.push(N),ef[N]=!0,eh=N+eu,ep=void 0}else e_=!0}}ed=n}if(e_&&el&&el(),0===ec.length)return t;eo&&eo();let ey=t.slice(0,ec[0]);for(let M=0;M<ec.length;++M){let es=ec[M],ea=ec[M+1]||t.length;0===es?ey=`
${n}${t.slice(0,ea)}`:(N===ex&&ef[es]&&(ey+=`${t[es]}\\`),ey+=`
${n}${t.slice(es+1,ea)}`)}return ey}function Ts(t,n){let N=t[n+1];for(;" "===N||"	"===N;){do N=t[n+=1];while(N&&N!==`
`);N=t[n+1]}return n}let vr=(t,n)=>({indentAtStart:n?t.indent.length:t.indentAtStart,lineWidth:t.options.lineWidth,minContentWidth:t.options.minContentWidth}),br=t=>/^(%|---|\.\.\.)/m.test(t);function Hn(t,n){let N=JSON.stringify(t);if(n.options.doubleQuotedAsJSON)return N;let{implicitKey:M}=n,es=n.options.doubleQuotedMinMultiLineLength,ea=n.indent||(br(t)?"  ":""),eo="",el=0;for(let t=0,n=N[t];n;n=N[++t])if(" "===n&&"\\"===N[t+1]&&"n"===N[t+2]&&(eo+=N.slice(el,t)+"\\ ",t+=1,el=t,n="\\"),"\\"===n)switch(N[t+1]){case"u":{eo+=N.slice(el,t);let n=N.substr(t+2,4);switch(n){case"0000":eo+="\\0";break;case"0007":eo+="\\a";break;case"000b":eo+="\\v";break;case"001b":eo+="\\e";break;case"0085":eo+="\\N";break;case"00a0":eo+="\\_";break;case"2028":eo+="\\L";break;case"2029":eo+="\\P";break;default:"00"===n.substr(0,2)?eo+="\\x"+n.substr(2):eo+=N.substr(t,6)}t+=5,el=t+1}break;case"n":if(M||'"'===N[t+2]||N.length<es)t+=1;else{for(eo+=N.slice(el,t)+`

`;"\\"===N[t+2]&&"n"===N[t+3]&&'"'!==N[t+4];)eo+=`
`,t+=2;eo+=ea," "===N[t+2]&&(eo+="\\"),t+=1,el=t+1}break;default:t+=1}return eo=el?eo+N.slice(el):N,M?eo:gr(eo,ea,ex,vr(n,!1))}function Hr(t,n){if(!1===n.options.singleQuote||n.implicitKey&&t.includes(`
`)||/[ \t]\n|\n[ \t]/.test(t))return Hn(t,n);let N=n.indent||(br(t)?"  ":""),M="'"+t.replace(/'/g,"''").replace(/\n+/g,`$&
${N}`)+"'";return n.implicitKey?M:gr(M,N,eL,vr(n,!1))}function Sn(t,n){let N;let{singleQuote:M}=n.options;if(!1===M)N=Hn;else{let n=t.includes('"'),es=t.includes("'");N=n&&!es?Hr:es&&!n?Hn:M?Hr:Hn}return N(t,n)}try{M=RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{M=/\n+(?!\n|$)/g}function or({comment:t,type:n,value:N},es,ea,eo){let el,eu;let{blockQuote:ec,commentString:ef,lineWidth:eh}=es.options;if(!ec||/\n[\t ]+$/.test(N)||/^\s*$/.test(N))return Sn(N,es);let ep=es.indent||(es.forceBlockIndent||br(N)?"  ":""),ed="literal"===ec||"folded"!==ec&&n!==Ue.BLOCK_FOLDED&&(n===Ue.BLOCK_LITERAL||!function(t,n,N){if(!n||n<0)return!1;let M=n-N,es=t.length;if(es<=M)return!1;for(let n=0,N=0;n<es;++n)if(t[n]===`
`){if(n-N>M)return!0;if(es-(N=n+1)<=M)return!1}return!0}(N,eh,ep.length));if(!N)return ed?`|
`:`>
`;for(eu=N.length;eu>0;--eu){let t=N[eu-1];if(t!==`
`&&"	"!==t&&" "!==t)break}let e_=N.substring(eu),eg=e_.indexOf(`
`);-1===eg?el="-":N===e_||eg!==e_.length-1?(el="+",eo&&eo()):el="",e_&&(N=N.slice(0,-e_.length),e_[e_.length-1]===`
`&&(e_=e_.slice(0,-1)),e_=e_.replace(M,`$&${ep}`));let em=!1,eb,ey=-1;for(eb=0;eb<N.length;++eb){let t=N[eb];if(" "===t)em=!0;else if(t===`
`)ey=eb;else break}let ev=N.substring(0,ey<eb?ey+1:eb);ev&&(N=N.substring(ev.length),ev=ev.replace(/\n+/g,`$&${ep}`));let ek=(ed?"|":">")+(em?ep?"2":"1":"")+el;if(t&&(ek+=" "+ef(t.replace(/ ?[\r\n]+/g," ")),ea&&ea()),ed)return N=N.replace(/\n+/g,`$&${ep}`),`${ek}
${ep}${ev}${N}${e_}`;N=N.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${ep}`);let eL=gr(`${ev}${N}${e_}`,ep,eA,vr(es,!0));return`${ek}
${ep}${eL}`}function qn(t,n,N,M){let{implicitKey:es,inFlow:ea}=n,eo="string"==typeof t.value?t:Object.assign({},t,{value:String(t.value)}),{type:el}=t;el!==Ue.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(eo.value)&&(el=Ue.QUOTE_DOUBLE);let c=t=>{switch(t){case Ue.BLOCK_FOLDED:case Ue.BLOCK_LITERAL:return es||ea?Sn(eo.value,n):or(eo,n,N,M);case Ue.QUOTE_DOUBLE:return Hn(eo.value,n);case Ue.QUOTE_SINGLE:return Hr(eo.value,n);case Ue.PLAIN:return function(t,n,N,M){let{type:es,value:ea}=t,{actualString:eo,implicitKey:el,indent:eu,indentStep:ec,inFlow:ef}=n;if(el&&ea.includes(`
`)||ef&&/[[\]{},]/.test(ea))return Sn(ea,n);if(!ea||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(ea))return el||ef||!ea.includes(`
`)?Sn(ea,n):or(t,n,N,M);if(!el&&!ef&&es!==Ue.PLAIN&&ea.includes(`
`))return or(t,n,N,M);if(br(ea)){if(""===eu)return n.forceBlockIndent=!0,or(t,n,N,M);if(el&&eu===ec)return Sn(ea,n)}let eh=ea.replace(/\n+/g,`$&
${eu}`);if(eo){let L=t=>{var n;return t.default&&"tag:yaml.org,2002:str"!==t.tag&&(null==(n=t.test)?void 0:n.test(eh))},{compat:t,tags:N}=n.doc.schema;if(N.some(L)||null!=t&&t.some(L))return Sn(ea,n)}return el?eh:gr(eh,eu,eL,vr(n,!1))}(eo,n,N,M);default:return null}},eu=c(el);if(null===eu){let{defaultKeyType:t,defaultStringType:N}=n.options,M=es&&t||N;if(null===(eu=c(M)))throw Error(`Unsupported default string type ${M}`)}return eu}function Ws(t,n){let N;let M=Object.assign({blockQuote:!0,commentString:bi,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},t.schema.toStringOptions,n);switch(M.collectionStyle){case"block":N=!1;break;case"flow":N=!0;break;default:N=null}return{anchors:new Set,doc:t,flowCollectionPadding:M.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof M.indent?" ".repeat(M.indent):"  ",inFlow:N,options:M}}function In(t,n,N,M){var es;let ea;if(Fe(t))return t.toString(n,N,M);if(wn(t)){if(n.doc.directives)return t.toString(n);if(null!=(es=n.resolvedAliases)&&es.has(t))throw TypeError("Cannot stringify circular structure without alias nodes");n.resolvedAliases?n.resolvedAliases.add(t):n.resolvedAliases=new Set([t]),t=t.resolve(n.doc)}let eo=ze(t)?t:n.doc.createNode(t,{onTagObj:t=>ea=t});ea||(ea=function(t,n){var N;let M,es;if(n.tag){let N=t.filter(t=>t.tag===n.tag);if(N.length>0)return N.find(t=>t.format===n.format)??N[0]}if(Ve(n)){es=n.value;let N=t.filter(t=>{var n;return null==(n=t.identify)?void 0:n.call(t,es)});M=N.find(t=>t.format===n.format)??N.find(t=>!t.format)}else es=n,M=t.find(t=>t.nodeClass&&es instanceof t.nodeClass);if(!M){let t=(null==(N=null==es?void 0:es.constructor)?void 0:N.name)??typeof es;throw Error(`Tag not resolved for ${t} value`)}return M}(n.doc.schema.tags,eo));let el=function(t,n,{anchors:N,doc:M}){if(!M.directives)return"";let es=[],ea=(Ve(t)||He(t))&&t.anchor;ea&&Hs(ea)&&(N.add(ea),es.push(`&${ea}`));let eo=t.tag?t.tag:n.default?null:n.tag;return eo&&es.push(M.directives.tagString(eo)),es.join(" ")}(eo,ea,n);el.length>0&&(n.indentAtStart=(n.indentAtStart??0)+el.length+1);let eu="function"==typeof ea.stringify?ea.stringify(eo,n,N,M):Ve(eo)?qn(eo,n,N,M):eo.toString(n,N,M);return el?Ve(eo)||"{"===eu[0]||"["===eu[0]?`${el} ${eu}`:`${el}
${n.indent}${eu}`:eu}function Zs(t,n){("debug"===t||"warn"===t)&&("u">typeof eo&&eo.emitWarning?eo.emitWarning(n):console.warn(n))}function Ys(t,n,{key:N,value:M}){if(null!=t&&t.doc.schema.merge&&Ai(N)){if(Bn(M=wn(M)?M.resolve(t.doc):M))for(let N of M.items)Cr(t,n,N);else if(Array.isArray(M))for(let N of M)Cr(t,n,N);else Cr(t,n,M)}else{let es=nn(N,"",t);if(n instanceof Map)n.set(es,nn(M,es,t));else if(n instanceof Set)n.add(es);else{let ea=function(t,n,N){if(null===n)return"";if("object"!=typeof n)return String(n);if(ze(t)&&null!=N&&N.doc){let n=Ws(N.doc,{});for(let t of(n.anchors=new Set,N.anchors.keys()))n.anchors.add(t.anchor);n.inFlow=!0,n.inStringifyKey=!0;let M=t.toString(n);if(!N.mapKeyWarned){let t=JSON.stringify(M);t.length>40&&(t=t.substring(0,36)+'..."'),Zs(N.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${t}. Set mapAsMap: true to use object keys.`),N.mapKeyWarned=!0}return M}return JSON.stringify(n)}(N,es,t),eo=nn(M,ea,t);ea in n?Object.defineProperty(n,ea,{value:eo,writable:!0,enumerable:!0,configurable:!0}):n[ea]=eo}}return n}let Ai=t=>"<<"===t||Ve(t)&&"<<"===t.value&&(!t.type||t.type===Ue.PLAIN);function Cr(t,n,N){let M=t&&wn(N)?N.resolve(t.doc):N;if(!Mn(M))throw Error("Merge sources must be maps or map aliases");let es=M.toJSON(null,t,Map);for(let[t,N]of es)n instanceof Map?n.has(t)||n.set(t,N):n instanceof Set?n.add(t):Object.prototype.hasOwnProperty.call(n,t)||Object.defineProperty(n,t,{value:N,writable:!0,enumerable:!0,configurable:!0});return n}function ts(t,n,N){let M=zn(t,void 0,N),es=zn(n,void 0,N);return new qe(M,es)}let qe=class qe{constructor(t,n=null){Object.defineProperty(this,em,{value:ed}),this.key=t,this.value=n}clone(t){let{key:n,value:N}=this;return ze(n)&&(n=n.clone(t)),ze(N)&&(N=N.clone(t)),new qe(n,N)}toJSON(t,n){let N=null!=n&&n.mapAsMap?new Map:{};return Ys(n,N,this)}toString(t,n,N){return null!=t&&t.doc?function({key:t,value:n},N,M,es){let ea,eo,el;let{allNullValues:eu,doc:ec,indent:ef,indentStep:eh,options:{commentString:ep,indentSeq:ed,simpleKeys:e_}}=N,eg=ze(t)&&t.comment||null;if(e_){if(eg)throw Error("With simple keys, key nodes cannot have comments");if(He(t))throw Error("With simple keys, collection cannot be used as a key value")}let em=!e_&&(!t||eg&&null==n&&!N.inFlow||He(t)||(Ve(t)?t.type===Ue.BLOCK_FOLDED||t.type===Ue.BLOCK_LITERAL:"object"==typeof t));N=Object.assign({},N,{allNullValues:!1,implicitKey:!em&&(e_||!eu),indent:ef+eh});let eb=!1,ey=!1,ev=In(t,N,()=>eb=!0,()=>ey=!0);if(!em&&!N.inFlow&&ev.length>1024){if(e_)throw Error("With simple keys, single line scalar must not span more than 1024 characters");em=!0}if(N.inFlow){if(eu||null==n)return eb&&M&&M(),""===ev?"?":em?`? ${ev}`:ev}else if(eu&&!e_||null==n&&em)return ev=`? ${ev}`,eg&&!eb?ev+=dn(ev,N.indent,ep(eg)):ey&&es&&es(),ev;eb&&(eg=null),em?(eg&&(ev+=dn(ev,N.indent,ep(eg))),ev=`? ${ev}
${ef}:`):(ev=`${ev}:`,eg&&(ev+=dn(ev,N.indent,ep(eg)))),ze(n)?(ea=!!n.spaceBefore,eo=n.commentBefore,el=n.comment):(ea=!1,eo=null,el=null,n&&"object"==typeof n&&(n=ec.createNode(n))),N.implicitKey=!1,!em&&!eg&&Ve(n)&&(N.indentAtStart=ev.length+1),ey=!1,!(!ed&&eh.length>=2&&!N.inFlow&&!em&&Bn(n))||n.flow||n.tag||n.anchor||(N.indent=N.indent.substring(2));let ek=!1,eL=In(n,N,()=>ek=!0,()=>ey=!0),eA=" ";if(eg||ea||eo){if(eA=ea?`
`:"",eo){let t=ep(eo);eA+=`
${fn(t,N.indent)}`}""!==eL||N.inFlow?eA+=`
${N.indent}`:eA===`
`&&(eA=`

`)}else if(!em&&He(n)){let t=eL[0],M=eL.indexOf(`
`),es=-1!==M,ea=N.inFlow??n.flow??0===n.items.length;if(es||!ea){let n=!1;if(es&&("&"===t||"!"===t)){let N=eL.indexOf(" ");"&"===t&&-1!==N&&N<M&&"!"===eL[N+1]&&(N=eL.indexOf(" ",N+1)),(-1===N||M<N)&&(n=!0)}n||(eA=`
${N.indent}`)}}else(""===eL||eL[0]===`
`)&&(eA="");return ev+=eA+eL,N.inFlow?ek&&M&&M():el&&!ek?ev+=dn(ev,N.indent,ep(el)):ey&&es&&es(),ev}(this,t,n,N):JSON.stringify(this)}};function Qs(t,n,N){return(n.inFlow??t.flow?function({comment:t,items:n},N,{flowChars:M,itemIndent:es,onComment:ea}){let eo;let{indent:el,indentStep:eu,flowCollectionPadding:ec,options:{commentString:ef}}=N;es+=eu;let eh=Object.assign({},N,{indent:es,inFlow:!0,type:null}),ep=!1,ed=0,e_=[];for(let t=0;t<n.length;++t){let M=n[t],ea=null;if(ze(M))M.spaceBefore&&e_.push(""),cr(N,e_,M.commentBefore,!1),M.comment&&(ea=M.comment);else if(Fe(M)){let t=ze(M.key)?M.key:null;t&&(t.spaceBefore&&e_.push(""),cr(N,e_,t.commentBefore,!1),t.comment&&(ep=!0));let n=ze(M.value)?M.value:null;n?(n.comment&&(ea=n.comment),n.commentBefore&&(ep=!0)):null==M.value&&null!=t&&t.comment&&(ea=t.comment)}ea&&(ep=!0);let eo=In(M,eh,()=>ea=null);t<n.length-1&&(eo+=","),ea&&(eo+=dn(eo,es,ef(ea))),!ep&&(e_.length>ed||eo.includes(`
`))&&(ep=!0),e_.push(eo),ed=e_.length}let{start:eg,end:em}=M;if(0===e_.length)eo=eg+em;else if(ep||(ep=e_.reduce((t,n)=>t+n.length+2,2)>mr.maxFlowStringSingleLineLength),ep){for(let t of(eo=eg,e_))eo+=t?`
${eu}${el}${t}`:`
`;eo+=`
${el}${em}`}else eo=`${eg}${ec}${e_.join(" ")}${ec}${em}`;return t&&(eo+=dn(eo,el,ef(t)),ea&&ea()),eo}:function({comment:t,items:n},N,{blockItemPrefix:M,flowChars:es,itemIndent:ea,onChompKeep:eo,onComment:el}){let eu;let{indent:ec,options:{commentString:ef}}=N,eh=Object.assign({},N,{indent:ea,type:null}),ep=!1,ed=[];for(let t=0;t<n.length;++t){let es=n[t],eo=null;if(ze(es))!ep&&es.spaceBefore&&ed.push(""),cr(N,ed,es.commentBefore,ep),es.comment&&(eo=es.comment);else if(Fe(es)){let t=ze(es.key)?es.key:null;t&&(!ep&&t.spaceBefore&&ed.push(""),cr(N,ed,t.commentBefore,ep))}ep=!1;let el=In(es,eh,()=>eo=null,()=>ep=!0);eo&&(el+=dn(el,ea,ef(eo))),ep&&eo&&(ep=!1),ed.push(M+el)}if(0===ed.length)eu=es.start+es.end;else{eu=ed[0];for(let t=1;t<ed.length;++t){let n=ed[t];eu+=n?`
${ec}${n}`:`
`}}return t?(eu+=`
`+fn(ef(t),ec),el&&el()):ep&&eo&&eo(),eu})(t,n,N)}function cr({indent:t,options:{commentString:n}},N,M,es){if(M&&es&&(M=M.replace(/^\n+/,"")),M){let es=fn(n(M),t);N.push(es.trimStart())}}function kn(t,n){let N=Ve(n)?n.value:n;for(let M of t)if(Fe(M)&&(M.key===n||M.key===N||Ve(M.key)&&M.key.value===N))return M}let tn=class tn extends mr{static get tagName(){return"tag:yaml.org,2002:map"}constructor(t){super(ep,t),this.items=[]}static from(t,n,N){let{keepUndefined:M,replacer:es}=N,ea=new this(t),l=(t,eo)=>{if("function"==typeof es)eo=es.call(n,t,eo);else if(Array.isArray(es)&&!es.includes(t))return;(void 0!==eo||M)&&ea.items.push(ts(t,eo,N))};if(n instanceof Map)for(let[t,N]of n)l(t,N);else if(n&&"object"==typeof n)for(let t of Object.keys(n))l(t,n[t]);return"function"==typeof t.sortMapEntries&&ea.items.sort(t.sortMapEntries),ea}add(t,n){var N;let M;M=Fe(t)?t:t&&"object"==typeof t&&"key"in t?new qe(t.key,t.value):new qe(t,null==t?void 0:t.value);let es=kn(this.items,M.key),ea=null==(N=this.schema)?void 0:N.sortMapEntries;if(es){if(!n)throw Error(`Key ${M.key} already set`);Ve(es.value)&&$s(M.value)?es.value.value=M.value:es.value=M.value}else if(ea){let t=this.items.findIndex(t=>0>ea(M,t));-1===t?this.items.push(M):this.items.splice(t,0,M)}else this.items.push(M)}delete(t){let n=kn(this.items,t);return!!n&&this.items.splice(this.items.indexOf(n),1).length>0}get(t,n){let N=kn(this.items,t),M=null==N?void 0:N.value;return(!n&&Ve(M)?M.value:M)??void 0}has(t){return!!kn(this.items,t)}set(t,n){this.add(new qe(t,n),!0)}toJSON(t,n,N){let M=N?new N:null!=n&&n.mapAsMap?new Map:{};for(let t of(null!=n&&n.onCreate&&n.onCreate(M),this.items))Ys(n,M,t);return M}toString(t,n,N){if(!t)return JSON.stringify(this);for(let t of this.items)if(!Fe(t))throw Error(`Map items must all be pairs; found ${JSON.stringify(t)} instead`);return!t.allNullValues&&this.hasAllNullValues(!1)&&(t=Object.assign({},t,{allNullValues:!0})),Qs(this,t,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:t.indent||"",onChompKeep:N,onComment:n})}};let ew={collection:"map",default:!0,nodeClass:tn,tag:"tag:yaml.org,2002:map",resolve:(t,n)=>(Mn(t)||n("Expected a mapping for this tag"),t),createNode:(t,n,N)=>tn.from(t,n,N)};let gn=class gn extends mr{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(t){super(eg,t),this.items=[]}add(t){this.items.push(t)}delete(t){let n=Jn(t);return"number"==typeof n&&this.items.splice(n,1).length>0}get(t,n){let N=Jn(t);if("number"!=typeof N)return;let M=this.items[N];return!n&&Ve(M)?M.value:M}has(t){let n=Jn(t);return"number"==typeof n&&n<this.items.length}set(t,n){let N=Jn(t);if("number"!=typeof N)throw Error(`Expected a valid index, not ${t}.`);let M=this.items[N];Ve(M)&&$s(n)?M.value=n:this.items[N]=n}toJSON(t,n){let N=[];null!=n&&n.onCreate&&n.onCreate(N);let M=0;for(let t of this.items)N.push(nn(t,String(M++),n));return N}toString(t,n,N){return t?Qs(this,t,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(t.indent||"")+"  ",onChompKeep:N,onComment:n}):JSON.stringify(this)}static from(t,n,N){let{replacer:M}=N,es=new this(t);if(n&&Symbol.iterator in Object(n)){let t=0;for(let ea of n){if("function"==typeof M){let N=n instanceof Set?ea:String(t++);ea=M.call(n,N,ea)}es.items.push(zn(ea,void 0,N))}}return es}};function Jn(t){let n=Ve(t)?t.value:t;return n&&"string"==typeof n&&(n=Number(n)),"number"==typeof n&&Number.isInteger(n)&&n>=0?n:null}let eT={collection:"seq",default:!0,nodeClass:gn,tag:"tag:yaml.org,2002:seq",resolve:(t,n)=>(Bn(t)||n("Expected a sequence for this tag"),t),createNode:(t,n,N)=>gn.from(t,n,N)},eO={identify:t=>"string"==typeof t,default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:(t,n,N,M)=>qn(t,n=Object.assign({actualString:!0},n),N,M)},eE={identify:t=>null==t,createNode:()=>new Ue(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new Ue(null),stringify:({source:t},n)=>"string"==typeof t&&eE.test.test(t)?t:n.options.nullStr},eS={identify:t=>"boolean"==typeof t,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:t=>new Ue("t"===t[0]||"T"===t[0]),stringify({source:t,value:n},N){if(t&&eS.test.test(t)){let N="t"===t[0]||"T"===t[0];if(n===N)return t}return n?N.options.trueStr:N.options.falseStr}};function an({format:t,minFractionDigits:n,tag:N,value:M}){if("bigint"==typeof M)return String(M);let es="number"==typeof M?M:Number(M);if(!isFinite(es))return isNaN(es)?".nan":es<0?"-.inf":".inf";let ea=JSON.stringify(M);if(!t&&n&&(!N||"tag:yaml.org,2002:float"===N)&&/^\d/.test(ea)){let t=ea.indexOf(".");t<0&&(t=ea.length,ea+=".");let N=n-(ea.length-t-1);for(;N-- >0;)ea+="0"}return ea}let eN={identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:t=>"nan"===t.slice(-3).toLowerCase()?NaN:"-"===t[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:an},eU={identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t),stringify(t){let n=Number(t.value);return isFinite(n)?n.toExponential():an(t)}},eI={identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(t){let n=new Ue(parseFloat(t)),N=t.indexOf(".");return -1!==N&&"0"===t[t.length-1]&&(n.minFractionDigits=t.length-N-1),n},stringify:an},Lr=t=>"bigint"==typeof t||Number.isInteger(t),ns=(t,n,N,{intAsBigInt:M})=>M?BigInt(t):parseInt(t.substring(n),N);function na(t,n,N){let{value:M}=t;return Lr(M)&&M>=0?N+M.toString(n):an(t)}let eR={identify:t=>Lr(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(t,n,N)=>ns(t,2,8,N),stringify:t=>na(t,8,"0o")},eC={identify:Lr,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(t,n,N)=>ns(t,0,10,N),stringify:an},eP={identify:t=>Lr(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(t,n,N)=>ns(t,2,16,N),stringify:t=>na(t,16,"0x")},eM=[ew,eT,eO,eE,eS,eR,eC,eP,eN,eU,eI];function Os(t){return"bigint"==typeof t||Number.isInteger(t)}let tr=({value:t})=>JSON.stringify(t),eB=[{identify:t=>"string"==typeof t,default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:tr},{identify:t=>null==t,createNode:()=>new Ue(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:tr},{identify:t=>"boolean"==typeof t,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:t=>"true"===t,stringify:tr},{identify:Os,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(t,n,{intAsBigInt:N})=>N?BigInt(t):parseInt(t,10),stringify:({value:t})=>Os(t)?t.toString():JSON.stringify(t)},{identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:t=>parseFloat(t),stringify:tr}],eD=[ew,eT].concat(eB,{default:!0,tag:"",test:/^/,resolve:(t,n)=>(n(`Unresolved plain scalar ${JSON.stringify(t)}`),t)}),eK={identify:t=>t instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(t,n){if("function"==typeof el)return el.from(t,"base64");if("function"!=typeof atob)return n("This environment does not support reading binary tags; either Buffer or atob is required"),t;{let n=atob(t.replace(/[\n\r]/g,"")),N=new Uint8Array(n.length);for(let t=0;t<n.length;++t)N[t]=n.charCodeAt(t);return N}},stringify({comment:t,type:n,value:N},M,es,ea){let eo;if("function"==typeof el)eo=N instanceof el?N.toString("base64"):el.from(N.buffer).toString("base64");else if("function"==typeof btoa){let t="";for(let n=0;n<N.length;++n)t+=String.fromCharCode(N[n]);eo=btoa(t)}else throw Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(n||(n=Ue.BLOCK_LITERAL),n!==Ue.QUOTE_DOUBLE){let t=Math.max(M.options.lineWidth-M.indent.length,M.options.minContentWidth),N=Math.ceil(eo.length/t),es=Array(N);for(let n=0,M=0;n<N;++n,M+=t)es[n]=eo.substr(M,t);eo=es.join(n===Ue.BLOCK_LITERAL?`
`:" ")}return qn({comment:t,type:n,value:eo},M,es,ea)}};function ia(t,n){if(Bn(t))for(let N=0;N<t.items.length;++N){let M=t.items[N];if(!Fe(M)){if(Mn(M)){M.items.length>1&&n("Each pair must have its own sequence indicator");let t=M.items[0]||new qe(new Ue(null));if(M.commentBefore&&(t.key.commentBefore=t.key.commentBefore?`${M.commentBefore}
${t.key.commentBefore}`:M.commentBefore),M.comment){let n=t.value??t.key;n.comment=n.comment?`${M.comment}
${n.comment}`:M.comment}M=t}t.items[N]=Fe(M)?M:new qe(M)}}else n("Expected a sequence for this tag");return t}function oa(t,n,N){let{replacer:M}=N,es=new gn(t);es.tag="tag:yaml.org,2002:pairs";let ea=0;if(n&&Symbol.iterator in Object(n))for(let t of n){let eo,el;if("function"==typeof M&&(t=M.call(n,String(ea++),t)),Array.isArray(t)){if(2===t.length)eo=t[0],el=t[1];else throw TypeError(`Expected [key, value] tuple: ${t}`)}else if(t&&t instanceof Object){let n=Object.keys(t);if(1===n.length)el=t[eo=n[0]];else throw TypeError(`Expected tuple with one key, not ${n.length} keys`)}else eo=t;es.items.push(ts(eo,el,N))}return es}let eF={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:ia,createNode:oa};let Nn=class Nn extends gn{constructor(){super(),this.add=tn.prototype.add.bind(this),this.delete=tn.prototype.delete.bind(this),this.get=tn.prototype.get.bind(this),this.has=tn.prototype.has.bind(this),this.set=tn.prototype.set.bind(this),this.tag=Nn.tag}toJSON(t,n){if(!n)return super.toJSON(t);let N=new Map;for(let t of(null!=n&&n.onCreate&&n.onCreate(N),this.items)){let M,es;if(Fe(t)?(M=nn(t.key,"",n),es=nn(t.value,M,n)):M=nn(t,"",n),N.has(M))throw Error("Ordered maps must not include duplicate keys");N.set(M,es)}return N}static from(t,n,N){let M=oa(t,n,N),es=new this;return es.items=M.items,es}};Nn.tag="tag:yaml.org,2002:omap";let eV={collection:"seq",identify:t=>t instanceof Map,nodeClass:Nn,default:!1,tag:"tag:yaml.org,2002:omap",resolve(t,n){let N=ia(t,n),M=[];for(let{key:t}of N.items)Ve(t)&&(M.includes(t.value)?n(`Ordered maps must not include duplicate keys: ${t.value}`):M.push(t.value));return Object.assign(new Nn,N)},createNode:(t,n,N)=>Nn.from(t,n,N)};function la({value:t,source:n},N){return n&&(t?ej:eG).test.test(n)?n:t?N.options.trueStr:N.options.falseStr}let ej={identify:t=>!0===t,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new Ue(!0),stringify:la},eG={identify:t=>!1===t,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>new Ue(!1),stringify:la},Wn=t=>"bigint"==typeof t||Number.isInteger(t);function wr(t,n,N,{intAsBigInt:M}){let es=t[0];if(("-"===es||"+"===es)&&(n+=1),t=t.substring(n).replace(/_/g,""),M){switch(N){case 2:t=`0b${t}`;break;case 8:t=`0o${t}`;break;case 16:t=`0x${t}`}let n=BigInt(t);return"-"===es?BigInt(-1)*n:n}let ea=parseInt(t,N);return"-"===es?-1*ea:ea}function is(t,n,N){let{value:M}=t;if(Wn(M)){let t=M.toString(n);return M<0?"-"+N+t.substr(1):N+t}return an(t)}let Rn=class Rn extends tn{constructor(t){super(t),this.tag=Rn.tag}add(t){let n;n=Fe(t)?t:t&&"object"==typeof t&&"key"in t&&"value"in t&&null===t.value?new qe(t.key,null):new qe(t,null),kn(this.items,n.key)||this.items.push(n)}get(t,n){let N=kn(this.items,t);return!n&&Fe(N)?Ve(N.key)?N.key.value:N.key:N}set(t,n){if("boolean"!=typeof n)throw Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);let N=kn(this.items,t);N&&!n?this.items.splice(this.items.indexOf(N),1):!N&&n&&this.items.push(new qe(t))}toJSON(t,n){return super.toJSON(t,n,Set)}toString(t,n,N){if(!t)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},t,{allNullValues:!0}),n,N);throw Error("Set items must all have null values")}static from(t,n,N){let{replacer:M}=N,es=new this(t);if(n&&Symbol.iterator in Object(n))for(let t of n)"function"==typeof M&&(t=M.call(n,t,t)),es.items.push(ts(t,null,N));return es}};Rn.tag="tag:yaml.org,2002:set";let ez={collection:"map",identify:t=>t instanceof Set,nodeClass:Rn,default:!1,tag:"tag:yaml.org,2002:set",createNode:(t,n,N)=>Rn.from(t,n,N),resolve(t,n){if(Mn(t)){if(t.hasAllNullValues(!0))return Object.assign(new Rn,t);n("Set items must all have null values")}else n("Expected a mapping for this tag");return t}};function ls(t,n){let N=t[0],M="-"===N||"+"===N?t.substring(1):t,s=t=>n?BigInt(t):Number(t),es=M.replace(/_/g,"").split(":").reduce((t,n)=>t*s(60)+s(n),s(0));return"-"===N?s(-1)*es:es}function fa(t){let{value:n}=t,e=t=>t;if("bigint"==typeof n)e=t=>BigInt(t);else if(isNaN(n)||!isFinite(n))return an(t);let N="";n<0&&(N="-",n*=e(-1));let M=e(60),es=[n%M];return n<60?es.unshift(0):(n=(n-es[0])/M,es.unshift(n%M),n>=60&&(n=(n-es[0])/M,es.unshift(n))),N+es.map(t=>String(t).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}let eH={identify:t=>"bigint"==typeof t||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,n,{intAsBigInt:N})=>ls(t,N),stringify:fa},eX={identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>ls(t,!1),stringify:fa},e$={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){let n=t.match(e$.test);if(!n)throw Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,N,M,es,ea,eo,el]=n.map(Number),eu=n[7]?Number((n[7]+"00").substr(1,3)):0,ec=Date.UTC(N,M-1,es,ea||0,eo||0,el||0,eu),ef=n[8];if(ef&&"Z"!==ef){let t=ls(ef,!1);30>Math.abs(t)&&(t*=60),ec-=6e4*t}return new Date(ec)},stringify:({value:t})=>t.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},eW=[ew,eT,eO,eE,ej,eG,{identify:Wn,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(t,n,N)=>wr(t,2,2,N),stringify:t=>is(t,2,"0b")},{identify:Wn,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(t,n,N)=>wr(t,1,8,N),stringify:t=>is(t,8,"0")},{identify:Wn,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(t,n,N)=>wr(t,0,10,N),stringify:an},{identify:Wn,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(t,n,N)=>wr(t,2,16,N),stringify:t=>is(t,16,"0x")},{identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:t=>"nan"===t.slice(-3).toLowerCase()?NaN:"-"===t[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:an},{identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t.replace(/_/g,"")),stringify(t){let n=Number(t.value);return isFinite(n)?n.toExponential():an(t)}},{identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(t){let n=new Ue(parseFloat(t.replace(/_/g,""))),N=t.indexOf(".");if(-1!==N){let M=t.substring(N+1).replace(/_/g,"");"0"===M[M.length-1]&&(n.minFractionDigits=M.length)}return n},stringify:an},eK,eV,eF,ez,eH,eX,e$],eq=new Map([["core",eM],["failsafe",[ew,eT,eO]],["json",eD],["yaml11",eW],["yaml-1.1",eW]]),eZ={binary:eK,bool:eS,float:eI,floatExp:eU,floatNaN:eN,floatTime:eX,int:eC,intHex:eP,intOct:eR,intTime:eH,map:ew,null:eE,omap:eV,pairs:eF,seq:eT,set:ez,timestamp:e$},eY={"tag:yaml.org,2002:binary":eK,"tag:yaml.org,2002:omap":eV,"tag:yaml.org,2002:pairs":eF,"tag:yaml.org,2002:set":ez,"tag:yaml.org,2002:timestamp":e$};function Pr(t,n){let N=eq.get(n);if(!N){if(Array.isArray(t))N=[];else{let t=Array.from(eq.keys()).filter(t=>"yaml11"!==t).map(t=>JSON.stringify(t)).join(", ");throw Error(`Unknown schema "${n}"; use one of ${t} or define customTags array`)}}if(Array.isArray(t))for(let n of t)N=N.concat(n);else"function"==typeof t&&(N=t(N.slice()));return N.map(t=>{if("string"!=typeof t)return t;let n=eZ[t];if(n)return n;let N=Object.keys(eZ).map(t=>JSON.stringify(t)).join(", ");throw Error(`Unknown custom tag "${t}"; use one of ${N}`)})}let Vi=(t,n)=>t.key<n.key?-1:t.key>n.key?1:0;let Ar=class Ar{constructor({compat:t,customTags:n,merge:N,resolveKnownTags:M,schema:es,sortMapEntries:ea,toStringDefaults:eo}){this.compat=Array.isArray(t)?Pr(t,"compat"):t?Pr(null,t):null,this.merge=!!N,this.name="string"==typeof es&&es||"core",this.knownTags=M?eY:{},this.tags=Pr(n,this.name),this.toStringOptions=eo??null,Object.defineProperty(this,ep,{value:ew}),Object.defineProperty(this,e_,{value:eO}),Object.defineProperty(this,eg,{value:eT}),this.sortMapEntries="function"==typeof ea?ea:!0===ea?Vi:null}clone(){let t=Object.create(Ar.prototype,Object.getOwnPropertyDescriptors(this));return t.tags=this.tags.slice(),t}};let Kn=class Kn{constructor(t,n,N){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,em,{value:eh});let M=null;"function"==typeof n||Array.isArray(n)?M=n:void 0===N&&n&&(N=n,n=void 0);let es=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},N);this.options=es;let{version:ea}=es;null!=N&&N._directives?(this.directives=N._directives.atDocument(),this.directives.yaml.explicit&&(ea=this.directives.yaml.version)):this.directives=new Ye({version:ea}),this.setSchema(ea,N),this.contents=void 0===t?null:this.createNode(t,M,N)}clone(){let t=Object.create(Kn.prototype,{[em]:{value:eh}});return t.commentBefore=this.commentBefore,t.comment=this.comment,t.errors=this.errors.slice(),t.warnings=this.warnings.slice(),t.options=Object.assign({},this.options),this.directives&&(t.directives=this.directives.clone()),t.schema=this.schema.clone(),t.contents=ze(this.contents)?this.contents.clone(t.schema):this.contents,this.range&&(t.range=this.range.slice()),t}add(t){xn(this.contents)&&this.contents.add(t)}addIn(t,n){xn(this.contents)&&this.contents.addIn(t,n)}createAlias(t,n){if(!t.anchor){let N=zs(this);t.anchor=!n||N.has(n)?Xs(n||"a",N):n}return new _r(t.anchor)}createNode(t,n,N){let M;if("function"==typeof n)t=n.call({"":t},"",t),M=n;else if(Array.isArray(n)){let t=n.filter(t=>"number"==typeof t||t instanceof String||t instanceof Number).map(String);t.length>0&&(n=n.concat(t)),M=n}else void 0===N&&n&&(N=n,n=void 0);let{aliasDuplicateObjects:es,anchorPrefix:ea,flow:eo,keepUndefined:el,onTagObj:eu,tag:ec}=N??{},{onAnchor:ef,setAnchors:eh,sourceObjects:ep}=function(t,n){let N=[],M=new Map,es=null;return{onAnchor:M=>{N.push(M),es||(es=zs(t));let ea=Xs(n,es);return es.add(ea),ea},setAnchors:()=>{for(let t of N){let n=M.get(t);if("object"==typeof n&&n.anchor&&(Ve(n.node)||He(n.node)))n.node.anchor=n.anchor;else{let n=Error("Failed to resolve repeated object (this should not happen)");throw n.source=t,n}}},sourceObjects:M}}(this,ea||"a"),ed={aliasDuplicateObjects:es??!0,keepUndefined:el??!1,onAnchor:ef,onTagObj:eu,replacer:M,schema:this.schema,sourceObjects:ep},e_=zn(t,ec,ed);return eo&&He(e_)&&(e_.flow=!0),eh(),e_}createPair(t,n,N={}){let M=this.createNode(t,null,N),es=this.createNode(n,null,N);return new qe(M,es)}delete(t){return!!xn(this.contents)&&this.contents.delete(t)}deleteIn(t){return jn(t)?null!=this.contents&&(this.contents=null,!0):!!xn(this.contents)&&this.contents.deleteIn(t)}get(t,n){return He(this.contents)?this.contents.get(t,n):void 0}getIn(t,n){return jn(t)?!n&&Ve(this.contents)?this.contents.value:this.contents:He(this.contents)?this.contents.getIn(t,n):void 0}has(t){return!!He(this.contents)&&this.contents.has(t)}hasIn(t){return jn(t)?void 0!==this.contents:!!He(this.contents)&&this.contents.hasIn(t)}set(t,n){null==this.contents?this.contents=ur(this.schema,[t],n):xn(this.contents)&&this.contents.set(t,n)}setIn(t,n){jn(t)?this.contents=n:null==this.contents?this.contents=ur(this.schema,Array.from(t),n):xn(this.contents)&&this.contents.setIn(t,n)}setSchema(t,n={}){let N;switch("number"==typeof t&&(t=String(t)),t){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Ye({version:"1.1"}),N={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=t:this.directives=new Ye({version:t}),N={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,N=null;break;default:{let n=JSON.stringify(t);throw Error(`Expected '1.1', '1.2' or null as first argument, but found: ${n}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(N)this.schema=new Ar(Object.assign(N,n));else throw Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:t,jsonArg:n,mapAsMap:N,maxAliasCount:M,onAnchor:es,reviver:ea}={}){let eo={anchors:new Map,doc:this,keep:!t,mapAsMap:!0===N,mapKeyWarned:!1,maxAliasCount:"number"==typeof M?M:100},el=nn(this.contents,n??"",eo);if("function"==typeof es)for(let{count:t,res:n}of eo.anchors.values())es(n,t);return"function"==typeof ea?On(ea,{"":el},"",el):el}toJSON(t,n){return this.toJS({json:!0,jsonArg:t,mapAsMap:!1,onAnchor:n})}toString(t={}){if(this.errors.length>0)throw Error("Document with errors cannot be stringified");if("indent"in t&&(!Number.isInteger(t.indent)||0>=Number(t.indent))){let n=JSON.stringify(t.indent);throw Error(`"indent" option must be a positive integer, not ${n}`)}return function(t,n){var N;let M=[],es=!0===n.directives;if(!1!==n.directives&&t.directives){let n=t.directives.toString(t);n?(M.push(n),es=!0):t.directives.docStart&&(es=!0)}es&&M.push("---");let ea=Ws(t,n),{commentString:eo}=ea.options;if(t.commentBefore){1!==M.length&&M.unshift("");let n=eo(t.commentBefore);M.unshift(fn(n,""))}let el=!1,eu=null;if(t.contents){if(ze(t.contents)){if(t.contents.spaceBefore&&es&&M.push(""),t.contents.commentBefore){let n=eo(t.contents.commentBefore);M.push(fn(n,""))}ea.forceBlockIndent=!!t.comment,eu=t.contents.comment}let n=eu?void 0:()=>el=!0,N=In(t.contents,ea,()=>eu=null,n);eu&&(N+=dn(N,"",eo(eu))),("|"===N[0]||">"===N[0])&&"---"===M[M.length-1]?M[M.length-1]=`--- ${N}`:M.push(N)}else M.push(In(t.contents,ea));if(null!=(N=t.directives)&&N.docEnd){if(t.comment){let n=eo(t.comment);n.includes(`
`)?(M.push("..."),M.push(fn(n,""))):M.push(`... ${n}`)}else M.push("...")}else{let n=t.comment;n&&el&&(n=n.replace(/^\n+/,"")),n&&((!el||eu)&&""!==M[M.length-1]&&M.push(""),M.push(fn(eo(n),"")))}return M.join(`
`)+`
`}(this,t)}};function xn(t){if(He(t))return!0;throw Error("Expected a YAML collection as document contents")}let us=class us extends Error{constructor(t,n,N,M){super(),this.name=t,this.code=N,this.message=M,this.pos=n}};let yn=class yn extends us{constructor(t,n,N){super("YAMLParseError",t,n,N)}};let da=class da extends us{constructor(t,n,N){super("YAMLWarning",t,n,N)}};let fr=(t,n)=>N=>{if(-1===N.pos[0])return;N.linePos=N.pos.map(t=>n.linePos(t));let{line:M,col:es}=N.linePos[0];N.message+=` at line ${M}, column ${es}`;let ea=es-1,eo=t.substring(n.lineStarts[M-1],n.lineStarts[M]).replace(/[\n\r]+$/,"");if(ea>=60&&eo.length>80){let t=Math.min(ea-39,eo.length-79);eo="…"+eo.substring(t),ea-=t-1}if(eo.length>80&&(eo=eo.substring(0,79)+"…"),M>1&&/^ *$/.test(eo.substring(0,ea))){let N=t.substring(n.lineStarts[M-2],n.lineStarts[M-1]);N.length>80&&(N=N.substring(0,79)+`…
`),eo=N+eo}if(/[^ ]/.test(eo)){let t=1,n=N.linePos[1];n&&n.line===M&&n.col>es&&(t=Math.max(1,Math.min(n.col-es,80-ea)));let el=" ".repeat(ea)+"^".repeat(t);N.message+=`:

${eo}
${el}
`}};function Un(t,{flow:n,indicator:N,next:M,offset:es,onError:ea,startOnNewline:eo}){let el=!1,eu=eo,ec=eo,ef="",eh="",ep=!1,ed=!1,e_=!1,eg=null,em=null,eb=null,ey=null,ev=null;for(let M of t)switch(e_&&("space"!==M.type&&"newline"!==M.type&&"comma"!==M.type&&ea(M.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),e_=!1),M.type){case"space":!n&&eu&&"doc-start"!==N&&"	"===M.source[0]&&ea(M,"TAB_AS_INDENT","Tabs are not allowed as indentation"),ec=!0;break;case"comment":{ec||ea(M,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let t=M.source.substring(1)||" ";ef?ef+=eh+t:ef=t,eh="",eu=!1;break}case"newline":eu?ef?ef+=M.source:el=!0:eh+=M.source,eu=!0,ep=!0,(eg||em)&&(ed=!0),ec=!0;break;case"anchor":eg&&ea(M,"MULTIPLE_ANCHORS","A node can have at most one anchor"),M.source.endsWith(":")&&ea(M.offset+M.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),eg=M,null===ev&&(ev=M.offset),eu=!1,ec=!1,e_=!0;break;case"tag":em&&ea(M,"MULTIPLE_TAGS","A node can have at most one tag"),em=M,null===ev&&(ev=M.offset),eu=!1,ec=!1,e_=!0;break;case N:(eg||em)&&ea(M,"BAD_PROP_ORDER",`Anchors and tags must be after the ${M.source} indicator`),ey&&ea(M,"UNEXPECTED_TOKEN",`Unexpected ${M.source} in ${n??"collection"}`),ey=M,eu=!1,ec=!1;break;case"comma":if(n){eb&&ea(M,"UNEXPECTED_TOKEN",`Unexpected , in ${n}`),eb=M,eu=!1,ec=!1;break}default:ea(M,"UNEXPECTED_TOKEN",`Unexpected ${M.type} token`),eu=!1,ec=!1}let ek=t[t.length-1],eL=ek?ek.offset+ek.source.length:es;return e_&&M&&"space"!==M.type&&"newline"!==M.type&&"comma"!==M.type&&("scalar"!==M.type||""!==M.source)&&ea(M.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:eb,found:ey,spaceBefore:el,comment:ef,hasNewline:ep,hasNewlineAfterProp:ed,anchor:eg,tag:em,end:eL,start:ev??eL}}function Xn(t){if(!t)return null;switch(t.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(t.source.includes(`
`))return!0;if(t.end){for(let n of t.end)if("newline"===n.type)return!0}return!1;case"flow-collection":for(let n of t.items){for(let t of n.start)if("newline"===t.type)return!0;if(n.sep){for(let t of n.sep)if("newline"===t.type)return!0}if(Xn(n.key)||Xn(n.value))return!0}return!1;default:return!0}}function Xr(t,n,N){if((null==n?void 0:n.type)==="flow-collection"){let M=n.end[0];M.indent===t&&("]"===M.source||"}"===M.source)&&Xn(n)&&N(M,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function _a(t,n,N){let{uniqueKeys:M}=t.options;if(!1===M)return!1;let es="function"==typeof M?M:(n,N)=>n===N||Ve(n)&&Ve(N)&&n.value===N.value&&!("<<"===n.value&&t.schema.merge);return n.some(t=>es(t.key,N))}let eJ="All mapping items must start at the same column";function Zn(t,n,N,M){let es="";if(t){let ea=!1,eo="";for(let el of t){let{source:t,type:eu}=el;switch(eu){case"space":ea=!0;break;case"comment":{N&&!ea&&M(el,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let n=t.substring(1)||" ";es?es+=eo+n:es=n,eo="";break}case"newline":es&&(eo+=t),ea=!0;break;default:M(el,"UNEXPECTED_TOKEN",`Unexpected ${eu} at node end`)}n+=t.length}}return{comment:es,offset:n}}let eQ="Block collections are not allowed within flow collections",Br=t=>t&&("block-map"===t.type||"block-seq"===t.type);function Dr(t,n,N,M,es,ea){let eo="block-map"===N.type?function({composeNode:t,composeEmptyNode:n},N,M,es,ea){var eo;let el=(null==ea?void 0:ea.nodeClass)??tn,eu=new el(N.schema);N.atRoot&&(N.atRoot=!1);let ec=M.offset,ef=null;for(let ea of M.items){let{start:el,key:eh,sep:ep,value:ed}=ea,e_=Un(el,{indicator:"explicit-key-ind",next:eh??(null==ep?void 0:ep[0]),offset:ec,onError:es,startOnNewline:!0}),eg=!e_.found;if(eg){if(eh&&("block-seq"===eh.type?es(ec,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in eh&&eh.indent!==M.indent&&es(ec,"BAD_INDENT",eJ)),!e_.anchor&&!e_.tag&&!ep){ef=e_.end,e_.comment&&(eu.comment?eu.comment+=`
`+e_.comment:eu.comment=e_.comment);continue}(e_.hasNewlineAfterProp||Xn(eh))&&es(eh??el[el.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else(null==(eo=e_.found)?void 0:eo.indent)!==M.indent&&es(ec,"BAD_INDENT",eJ);let em=e_.end,eb=eh?t(N,eh,e_,es):n(N,em,el,null,e_,es);N.schema.compat&&Xr(M.indent,eh,es),_a(N,eu.items,eb)&&es(em,"DUPLICATE_KEY","Map keys must be unique");let ey=Un(ep??[],{indicator:"map-value-ind",next:ed,offset:eb.range[2],onError:es,startOnNewline:!eh||"block-scalar"===eh.type});if(ec=ey.end,ey.found){eg&&((null==ed?void 0:ed.type)!=="block-map"||ey.hasNewline||es(ec,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),N.options.strict&&e_.start<ey.found.offset-1024&&es(eb.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let eo=ed?t(N,ed,ey,es):n(N,ec,ep,null,ey,es);N.schema.compat&&Xr(M.indent,ed,es),ec=eo.range[2];let el=new qe(eb,eo);N.options.keepSourceTokens&&(el.srcToken=ea),eu.items.push(el)}else{eg&&es(eb.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),ey.comment&&(eb.comment?eb.comment+=`
`+ey.comment:eb.comment=ey.comment);let t=new qe(eb);N.options.keepSourceTokens&&(t.srcToken=ea),eu.items.push(t)}}return ef&&ef<ec&&es(ef,"IMPOSSIBLE","Map comment with trailing content"),eu.range=[M.offset,ec,ef??ec],eu}(t,n,N,M,ea):"block-seq"===N.type?function({composeNode:t,composeEmptyNode:n},N,M,es,ea){let eo=(null==ea?void 0:ea.nodeClass)??gn,el=new eo(N.schema);N.atRoot&&(N.atRoot=!1);let eu=M.offset,ec=null;for(let{start:ea,value:eo}of M.items){let ef=Un(ea,{indicator:"seq-item-ind",next:eo,offset:eu,onError:es,startOnNewline:!0});if(!ef.found){if(ef.anchor||ef.tag||eo)eo&&"block-seq"===eo.type?es(ef.end,"BAD_INDENT","All sequence items must start at the same column"):es(eu,"MISSING_CHAR","Sequence item without - indicator");else{ec=ef.end,ef.comment&&(el.comment=ef.comment);continue}}let eh=eo?t(N,eo,ef,es):n(N,ef.end,ea,null,ef,es);N.schema.compat&&Xr(M.indent,eo,es),eu=eh.range[2],el.items.push(eh)}return el.range=[M.offset,eu,ec??eu],el}(t,n,N,M,ea):function({composeNode:t,composeEmptyNode:n},N,M,es,ea){let eo="{"===M.start.source,el=eo?"flow map":"flow sequence",eu=(null==ea?void 0:ea.nodeClass)??(eo?tn:gn),ec=new eu(N.schema);ec.flow=!0;let ef=N.atRoot;ef&&(N.atRoot=!1);let eh=M.offset+M.start.source.length;for(let ea=0;ea<M.items.length;++ea){let eu=M.items[ea],{start:ef,key:ep,sep:ed,value:e_}=eu,eg=Un(ef,{flow:el,indicator:"explicit-key-ind",next:ep??(null==ed?void 0:ed[0]),offset:eh,onError:es,startOnNewline:!1});if(!eg.found){if(!eg.anchor&&!eg.tag&&!ed&&!e_){0===ea&&eg.comma?es(eg.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${el}`):ea<M.items.length-1&&es(eg.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${el}`),eg.comment&&(ec.comment?ec.comment+=`
`+eg.comment:ec.comment=eg.comment),eh=eg.end;continue}!eo&&N.options.strict&&Xn(ep)&&es(ep,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(0===ea)eg.comma&&es(eg.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${el}`);else if(eg.comma||es(eg.start,"MISSING_CHAR",`Missing , between ${el} items`),eg.comment){let t="";e:for(let n of ef)switch(n.type){case"comma":case"space":break;case"comment":t=n.source.substring(1);break e;default:break e}if(t){let n=ec.items[ec.items.length-1];Fe(n)&&(n=n.value??n.key),n.comment?n.comment+=`
`+t:n.comment=t,eg.comment=eg.comment.substring(t.length+1)}}if(eo||ed||eg.found){let M=eg.end,ea=ep?t(N,ep,eg,es):n(N,M,ef,null,eg,es);Br(ep)&&es(ea.range,"BLOCK_IN_FLOW",eQ);let em=Un(ed??[],{flow:el,indicator:"map-value-ind",next:e_,offset:ea.range[2],onError:es,startOnNewline:!1});if(em.found){if(!eo&&!eg.found&&N.options.strict){if(ed)for(let t of ed){if(t===em.found)break;if("newline"===t.type){es(t,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}eg.start<em.found.offset-1024&&es(em.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else e_&&("source"in e_&&e_.source&&":"===e_.source[0]?es(e_,"MISSING_CHAR",`Missing space after : in ${el}`):es(em.start,"MISSING_CHAR",`Missing , or : between ${el} items`));let eb=e_?t(N,e_,em,es):em.found?n(N,em.end,ed,null,em,es):null;eb?Br(e_)&&es(eb.range,"BLOCK_IN_FLOW",eQ):em.comment&&(ea.comment?ea.comment+=`
`+em.comment:ea.comment=em.comment);let ey=new qe(ea,eb);if(N.options.keepSourceTokens&&(ey.srcToken=eu),eo)_a(N,ec.items,ea)&&es(M,"DUPLICATE_KEY","Map keys must be unique"),ec.items.push(ey);else{let t=new tn(N.schema);t.flow=!0,t.items.push(ey),ec.items.push(t)}eh=eb?eb.range[2]:em.end}else{let M=e_?t(N,e_,eg,es):n(N,eg.end,ed,null,eg,es);ec.items.push(M),eh=M.range[2],Br(e_)&&es(M.range,"BLOCK_IN_FLOW",eQ)}}let ep=eo?"}":"]",[ed,...e_]=M.end,eg=eh;if(ed&&ed.source===ep)eg=ed.offset+ed.source.length;else{let t=el[0].toUpperCase()+el.substring(1),n=ef?`${t} must end with a ${ep}`:`${t} in block collection must be sufficiently indented and end with a ${ep}`;es(eh,ef?"MISSING_CHAR":"BAD_INDENT",n),ed&&1!==ed.source.length&&e_.unshift(ed)}if(e_.length>0){let t=Zn(e_,eg,N.options.strict,es);t.comment&&(ec.comment?ec.comment+=`
`+t.comment:ec.comment=t.comment),ec.range=[M.offset,eg,t.offset]}else ec.range=[M.offset,eg,eg];return ec}(t,n,N,M,ea),el=eo.constructor;return"!"===es||es===el.tagName?eo.tag=el.tagName:es&&(eo.tag=es),eo}function ma(t,n,N){let M=t.offset,es=function({offset:t,props:n},N,M){if("block-scalar-header"!==n[0].type)return M(n[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:es}=n[0],ea=es[0],eo=0,el="",eu=-1;for(let n=1;n<es.length;++n){let N=es[n];if(el||"-"!==N&&"+"!==N){let M=Number(N);!eo&&M?eo=M:-1===eu&&(eu=t+n)}else el=N}-1!==eu&&M(eu,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${es}`);let ec=!1,ef="",eh=es.length;for(let t=1;t<n.length;++t){let es=n[t];switch(es.type){case"space":ec=!0;case"newline":eh+=es.source.length;break;case"comment":N&&!ec&&M(es,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),eh+=es.source.length,ef=es.source.substring(1);break;case"error":M(es,"UNEXPECTED_TOKEN",es.message),eh+=es.source.length;break;default:{let t=`Unexpected token in block scalar header: ${es.type}`;M(es,"UNEXPECTED_TOKEN",t);let n=es.source;n&&"string"==typeof n&&(eh+=n.length)}}}return{mode:ea,indent:eo,chomp:el,comment:ef,length:eh}}(t,n,N);if(!es)return{value:"",type:null,comment:"",range:[M,M,M]};let ea=">"===es.mode?Ue.BLOCK_FOLDED:Ue.BLOCK_LITERAL,eo=t.source?function(t){let n=t.split(/\n( *)/),N=n[0],M=N.match(/^( *)/),es=[null!=M&&M[1]?[M[1],N.slice(M[1].length)]:["",N]];for(let t=1;t<n.length;t+=2)es.push([n[t],n[t+1]]);return es}(t.source):[],el=eo.length;for(let t=eo.length-1;t>=0;--t){let n=eo[t][1];if(""===n||"\r"===n)el=t;else break}if(0===el){let n="+"===es.chomp&&eo.length>0?`
`.repeat(Math.max(1,eo.length-1)):"",N=M+es.length;return t.source&&(N+=t.source.length),{value:n,type:ea,comment:es.comment,range:[M,N,N]}}let eu=t.indent+es.indent,ec=t.offset+es.length,ef=0;for(let t=0;t<el;++t){let[n,M]=eo[t];if(""===M||"\r"===M)0===es.indent&&n.length>eu&&(eu=n.length);else{n.length<eu&&N(ec+n.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),0===es.indent&&(eu=n.length),ef=t;break}ec+=n.length+M.length+1}for(let t=eo.length-1;t>=el;--t)eo[t][0].length>eu&&(el=t+1);let eh="",ep="",ed=!1;for(let t=0;t<ef;++t)eh+=eo[t][0].slice(eu)+`
`;for(let t=ef;t<el;++t){let[n,M]=eo[t];ec+=n.length+M.length+1;let el="\r"===M[M.length-1];if(el&&(M=M.slice(0,-1)),M&&n.length<eu){let t=`Block scalar lines must not be less indented than their ${es.indent?"explicit indentation indicator":"first line"}`;N(ec-M.length-(el?2:1),"BAD_INDENT",t),n=""}ea===Ue.BLOCK_LITERAL?(eh+=ep+n.slice(eu)+M,ep=`
`):n.length>eu||"	"===M[0]?(" "===ep?ep=`
`:ed||ep!==`
`||(ep=`

`),eh+=ep+n.slice(eu)+M,ep=`
`,ed=!0):""===M?ep===`
`?eh+=`
`:ep=`
`:(eh+=ep+M,ep=" ",ed=!1)}switch(es.chomp){case"-":break;case"+":for(let t=el;t<eo.length;++t)eh+=`
`+eo[t][0].slice(eu);eh[eh.length-1]!==`
`&&(eh+=`
`);break;default:eh+=`
`}let e_=M+es.length+t.source.length;return{value:eh,type:ea,comment:es.comment,range:[M,e_,e_]}}function ga(t,n,N){let M,es;let{offset:ea,type:eo,source:el,end:eu}=t,p=(t,n,M)=>N(ea+t,n,M);switch(eo){case"scalar":M=Ue.PLAIN,es=function(t,n){let N="";switch(t[0]){case"	":N="a tab character";break;case",":N="flow indicator character ,";break;case"%":N="directive indicator character %";break;case"|":case">":N=`block scalar indicator ${t[0]}`;break;case"@":case"`":N=`reserved character ${t[0]}`}return N&&n(0,"BAD_SCALAR_START",`Plain value cannot start with ${N}`),va(t)}(el,p);break;case"single-quoted-scalar":M=Ue.QUOTE_SINGLE,("'"!==el[el.length-1]||1===el.length)&&p(el.length,"MISSING_CHAR","Missing closing 'quote"),es=va(el.slice(1,-1)).replace(/''/g,"'");break;case"double-quoted-scalar":M=Ue.QUOTE_DOUBLE,es=function(t,n){let N="";for(let M=1;M<t.length-1;++M){let es=t[M];if(!("\r"===es&&t[M+1]===`
`)){if(es===`
`){let{fold:n,offset:es}=function(t,n){let N="",M=t[n+1];for(;(" "===M||"	"===M||M===`
`||"\r"===M)&&!("\r"===M&&t[n+2]!==`
`);)M===`
`&&(N+=`
`),n+=1,M=t[n+1];return N||(N=" "),{fold:N,offset:n}}(t,M);N+=n,M=es}else if("\\"===es){let es=t[++M],ea=e1[es];if(ea)N+=ea;else if(es===`
`)for(es=t[M+1];" "===es||"	"===es;)es=t[++M+1];else if("\r"===es&&t[M+1]===`
`)for(es=t[++M+1];" "===es||"	"===es;)es=t[++M+1];else if("x"===es||"u"===es||"U"===es){let ea={x:2,u:4,U:8}[es];N+=function(t,n,N,M){let es=t.substr(n,N),ea=es.length===N&&/^[0-9a-fA-F]+$/.test(es)?parseInt(es,16):NaN;if(isNaN(ea)){let es=t.substr(n-2,N+2);return M(n-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${es}`),es}return String.fromCodePoint(ea)}(t,M+1,ea,n),M+=ea}else{let es=t.substr(M-1,2);n(M-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${es}`),N+=es}}else if(" "===es||"	"===es){let n=M,ea=t[M+1];for(;" "===ea||"	"===ea;)ea=t[++M+1];ea===`
`||"\r"===ea&&t[M+2]===`
`||(N+=M>n?t.slice(n,M+1):es)}else N+=es}}return('"'!==t[t.length-1]||1===t.length)&&n(t.length,"MISSING_CHAR",'Missing closing "quote'),N}(el,p);break;default:return N(t,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${eo}`),{value:"",type:null,comment:"",range:[ea,ea+el.length,ea+el.length]}}let ec=ea+el.length,ef=Zn(eu,ec,n,N);return{value:es,type:M,comment:ef.comment,range:[ea,ec,ef.offset]}}function va(t){let n,N;try{n=RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),N=RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{n=/(.*?)[ \t]*\r?\n/sy,N=/[ \t]*(.*?)[ \t]*\r?\n/sy}let M=n.exec(t);if(!M)return t;let es=M[1],ea=" ",eo=n.lastIndex;for(N.lastIndex=eo;M=N.exec(t);)""===M[1]?ea===`
`?es+=ea:ea=`
`:(es+=ea+M[1],ea=" "),eo=N.lastIndex;let el=/[ \t]*(.*)/sy;return el.lastIndex=eo,es+ea+((null==(M=el.exec(t))?void 0:M[1])??"")}let e1={0:"\x00",a:"\x07",b:"\b",e:"\x1b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xa0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function ba(t,n,N,M){let es;let{value:ea,type:eo,comment:el,range:eu}="block-scalar"===n.type?ma(n,t.options.strict,M):ga(n,t.options.strict,M),ec=N?t.directives.tagName(N.source,t=>M(N,"TAG_RESOLVE_FAILED",t)):null,ef=N&&ec?function(t,n,N,M,es){var ea;if("!"===N)return t[e_];let eo=[];for(let n of t.tags)if(!n.collection&&n.tag===N){if(!n.default||!n.test)return n;eo.push(n)}for(let t of eo)if(null!=(ea=t.test)&&ea.test(n))return t;let el=t.knownTags[N];return el&&!el.collection?(t.tags.push(Object.assign({},el,{default:!1,test:void 0})),el):(es(M,"TAG_RESOLVE_FAILED",`Unresolved tag: ${N}`,"tag:yaml.org,2002:str"!==N),t[e_])}(t.schema,ea,ec,N,M):"scalar"===n.type?function({directives:t,schema:n},N,M,es){let ea=n.tags.find(t=>{var n;return t.default&&(null==(n=t.test)?void 0:n.test(N))})||n[e_];if(n.compat){let eo=n.compat.find(t=>{var n;return t.default&&(null==(n=t.test)?void 0:n.test(N))})??n[e_];if(ea.tag!==eo.tag){let n=t.tagString(ea.tag),N=t.tagString(eo.tag),el=`Value may be parsed as either ${n} or ${N}`;es(M,"TAG_RESOLVE_FAILED",el,!0)}}return ea}(t,ea,n,M):t.schema[e_];try{let eo=ef.resolve(ea,t=>M(N??n,"TAG_RESOLVE_FAILED",t),t.options);es=Ve(eo)?eo:new Ue(eo)}catch(eo){let t=eo instanceof Error?eo.message:String(eo);M(N??n,"TAG_RESOLVE_FAILED",t),es=new Ue(ea)}return es.range=eu,es.source=ea,eo&&(es.type=eo),ec&&(es.tag=ec),ef.format&&(es.format=ef.format),el&&(es.comment=el),es}let e0={composeNode:ka,composeEmptyNode:cs};function ka(t,n,N,M){let{spaceBefore:es,comment:ea,anchor:eo,tag:el}=N,eu,ec=!0;switch(n.type){case"alias":eu=function({options:t},{offset:n,source:N,end:M},es){let ea=new _r(N.substring(1));""===ea.source&&es(n,"BAD_ALIAS","Alias cannot be an empty string"),ea.source.endsWith(":")&&es(n+N.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let eo=n+N.length,el=Zn(M,eo,t.strict,es);return ea.range=[n,eo,el.offset],el.comment&&(ea.comment=el.comment),ea}(t,n,M),(eo||el)&&M(n,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":eu=ba(t,n,el,M),eo&&(eu.anchor=eo.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":eu=function(t,n,N,M,es){var ea;let eo=M?n.directives.tagName(M.source,t=>es(M,"TAG_RESOLVE_FAILED",t)):null,el="block-map"===N.type?"map":"block-seq"===N.type?"seq":"{"===N.start.source?"map":"seq";if(!M||!eo||"!"===eo||eo===tn.tagName&&"map"===el||eo===gn.tagName&&"seq"===el||!el)return Dr(t,n,N,es,eo);let eu=n.schema.tags.find(t=>t.tag===eo&&t.collection===el);if(!eu){let ea=n.schema.knownTags[eo];if(!ea||ea.collection!==el)return null!=ea&&ea.collection?es(M,"BAD_COLLECTION_TYPE",`${ea.tag} used for ${el} collection, but expects ${ea.collection}`,!0):es(M,"TAG_RESOLVE_FAILED",`Unresolved tag: ${eo}`,!0),Dr(t,n,N,es,eo);n.schema.tags.push(Object.assign({},ea,{default:!1})),eu=ea}let ec=Dr(t,n,N,es,eo,eu),ef=(null==(ea=eu.resolve)?void 0:ea.call(eu,ec,t=>es(M,"TAG_RESOLVE_FAILED",t),n.options))??ec,eh=ze(ef)?ef:new Ue(ef);return eh.range=ec.range,eh.tag=eo,null!=eu&&eu.format&&(eh.format=eu.format),eh}(e0,t,n,el,M),eo&&(eu.anchor=eo.source.substring(1));break;default:{let es="error"===n.type?n.message:`Unsupported token (type: ${n.type})`;M(n,"UNEXPECTED_TOKEN",es),eu=cs(t,n.offset,void 0,null,N,M),ec=!1}}return eo&&""===eu.anchor&&M(eo,"BAD_ALIAS","Anchor cannot be an empty string"),es&&(eu.spaceBefore=!0),ea&&("scalar"===n.type&&""===n.source?eu.comment=ea:eu.commentBefore=ea),t.options.keepSourceTokens&&ec&&(eu.srcToken=n),eu}function cs(t,n,N,M,{spaceBefore:es,comment:ea,anchor:eo,tag:el,end:eu},ec){let ef={type:"scalar",offset:function(t,n,N){if(n){null===N&&(N=n.length);for(let M=N-1;M>=0;--M){let N=n[M];switch(N.type){case"space":case"comment":case"newline":t-=N.source.length;continue}for(N=n[++M];(null==N?void 0:N.type)==="space";)t+=N.source.length,N=n[++M];break}}return t}(n,N,M),indent:-1,source:""},eh=ba(t,ef,el,ec);return eo&&(eh.anchor=eo.source.substring(1),""===eh.anchor&&ec(eo,"BAD_ALIAS","Anchor cannot be an empty string")),es&&(eh.spaceBefore=!0),ea&&(eh.comment=ea,eh.range[2]=eu),eh}function Fn(t){if("number"==typeof t)return[t,t+1];if(Array.isArray(t))return 2===t.length?t:[t[0],t[1]];let{offset:n,source:N}=t;return[n,n+("string"==typeof N?N.length:1)]}function Us(t){var n;let N="",M=!1,es=!1;for(let ea=0;ea<t.length;++ea){let eo=t[ea];switch(eo[0]){case"#":N+=(""===N?"":es?`

`:`
`)+(eo.substring(1)||" "),M=!0,es=!1;break;case"%":(null==(n=t[ea+1])?void 0:n[0])!=="#"&&(ea+=1),M=!1;break;default:M||(es=!0),M=!1}}return{comment:N,afterEmptyLine:es}}let fs=class fs{constructor(t={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,n,N,M)=>{let es=Fn(t);M?this.warnings.push(new da(es,n,N)):this.errors.push(new yn(es,n,N))},this.directives=new Ye({version:t.version||"1.2"}),this.options=t}decorate(t,n){let{comment:N,afterEmptyLine:M}=Us(this.prelude);if(N){let es=t.contents;if(n)t.comment=t.comment?`${t.comment}
${N}`:N;else if(M||t.directives.docStart||!es)t.commentBefore=N;else if(He(es)&&!es.flow&&es.items.length>0){let t=es.items[0];Fe(t)&&(t=t.key);let n=t.commentBefore;t.commentBefore=n?`${N}
${n}`:N}else{let t=es.commentBefore;es.commentBefore=t?`${N}
${t}`:N}}n?(Array.prototype.push.apply(t.errors,this.errors),Array.prototype.push.apply(t.warnings,this.warnings)):(t.errors=this.errors,t.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Us(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(t,n=!1,N=-1){for(let n of t)yield*this.next(n);yield*this.end(n,N)}*next(t){switch(t.type){case"directive":this.directives.add(t.source,(n,N,M)=>{let es=Fn(t);es[0]+=n,this.onError(es,"BAD_DIRECTIVE",N,M)}),this.prelude.push(t.source),this.atDirectives=!0;break;case"document":{let n=function(t,n,{offset:N,start:M,value:es,end:ea},eo){let el=Object.assign({_directives:n},t),eu=new Kn(void 0,el),ec={atRoot:!0,directives:eu.directives,options:eu.options,schema:eu.schema},ef=Un(M,{indicator:"doc-start",next:es??(null==ea?void 0:ea[0]),offset:N,onError:eo,startOnNewline:!0});ef.found&&(eu.directives.docStart=!0,es&&("block-map"===es.type||"block-seq"===es.type)&&!ef.hasNewline&&eo(ef.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),eu.contents=es?ka(ec,es,ef,eo):cs(ec,ef.end,M,null,ef,eo);let eh=eu.contents.range[2],ep=Zn(ea,eh,!1,eo);return ep.comment&&(eu.comment=ep.comment),eu.range=[N,eh,ep.offset],eu}(this.options,this.directives,t,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(t,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(t.source);break;case"error":{let n=t.source?`${t.message}: ${JSON.stringify(t.source)}`:t.message,N=new yn(Fn(t),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(N):this.doc.errors.push(N);break}case"doc-end":{if(!this.doc){this.errors.push(new yn(Fn(t),"UNEXPECTED_TOKEN","Unexpected doc-end without preceding document"));break}this.doc.directives.docEnd=!0;let n=Zn(t.end,t.offset+t.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){let t=this.doc.comment;this.doc.comment=t?`${t}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new yn(Fn(t),"UNEXPECTED_TOKEN",`Unsupported token ${t.type}`))}}*end(t=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(t){let t=Object.assign({_directives:this.directives},this.options),N=new Kn(void 0,t);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),N.range=[0,n,n],this.decorate(N,!1),yield N}}};function ya(t,n){if(n)for(let N of n)switch(N.type){case"space":case"comment":t.push(N);break;case"newline":return t.push(N),!0}return!1}function Gr(t,n,N){switch(t.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":t.type=N,t.source=n;break;case"block-scalar":{let M=t.props.slice(1),es=n.length;for(let n of("block-scalar-header"===t.props[0].type&&(es-=t.props[0].source.length),M))n.offset+=es;delete t.props,Object.assign(t,{type:N,source:n,end:M});break}case"block-map":case"block-seq":{let M={type:"newline",offset:t.offset+n.length,indent:t.indent,source:`
`};delete t.items,Object.assign(t,{type:N,source:n,end:[M]});break}default:{let M="indent"in t?t.indent:-1,es="end"in t&&Array.isArray(t.end)?t.end.filter(t=>"space"===t.type||"comment"===t.type||"newline"===t.type):[];for(let n of Object.keys(t))"type"!==n&&"offset"!==n&&delete t[n];Object.assign(t,{type:N,indent:M,source:n,end:es})}}}function hr(t){switch(t.type){case"block-scalar":{let n="";for(let N of t.props)n+=hr(N);return n+t.source}case"block-map":case"block-seq":{let n="";for(let N of t.items)n+=lr(N);return n}case"flow-collection":{let n=t.start.source;for(let N of t.items)n+=lr(N);for(let N of t.end)n+=N.source;return n}case"document":{let n=lr(t);if(t.end)for(let N of t.end)n+=N.source;return n}default:{let n=t.source;if("end"in t&&t.end)for(let N of t.end)n+=N.source;return n}}}function lr({start:t,key:n,sep:N,value:M}){let es="";for(let n of t)es+=n.source;if(n&&(es+=hr(n)),N)for(let t of N)es+=t.source;return M&&(es+=hr(M)),es}let e2=Symbol("break visit"),e3=Symbol("skip children"),e5=Symbol("remove item");function Ln(t,n){"type"in t&&"document"===t.type&&(t={start:t.start,value:t.value}),function wa(t,n,N){let M=N(n,t);if("symbol"==typeof M)return M;for(let es of["key","value"]){let ea=n[es];if(ea&&"items"in ea){for(let n=0;n<ea.items.length;++n){let M=wa(Object.freeze(t.concat([[es,n]])),ea.items[n],N);if("number"==typeof M)n=M-1;else{if(M===e2)return e2;M===e5&&(ea.items.splice(n,1),n-=1)}}"function"==typeof M&&"key"===es&&(M=M(n,t))}}return"function"==typeof M?M(n,t):M}(Object.freeze([]),t,n)}function xa(t){switch(t){case"\uFEFF":return"byte-order-mark";case"\x02":return"doc-mode";case"\x18":return"flow-error-end";case"\x1f":return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(t[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}Ln.BREAK=e2,Ln.SKIP=e3,Ln.REMOVE=e5,Ln.itemAtPath=(t,n)=>{let N=t;for(let[t,M]of n){let n=null==N?void 0:N[t];if(!n||!("items"in n))return;N=n.items[M]}return N},Ln.parentCollection=(t,n)=>{let N=Ln.itemAtPath(t,n.slice(0,-1)),M=n[n.length-1][0],es=null==N?void 0:N[M];if(es&&"items"in es)return es;throw Error("Parent collection not found")};let e4=Object.freeze(Object.defineProperty({__proto__:null,BOM:"\uFEFF",DOCUMENT:"\x02",FLOW_END:"\x18",SCALAR:"\x1f",createScalarToken:function(t,n){let{implicitKey:N=!1,indent:M,inFlow:es=!1,offset:ea=-1,type:eo="PLAIN"}=n,el=qn({type:eo,value:t},{implicitKey:N,indent:M>0?" ".repeat(M):"",inFlow:es,options:{blockQuote:!0,lineWidth:-1}}),eu=n.end??[{type:"newline",offset:-1,indent:M,source:`
`}];switch(el[0]){case"|":case">":{let t=el.indexOf(`
`),n=el.substring(0,t),N=el.substring(t+1)+`
`,es=[{type:"block-scalar-header",offset:ea,indent:M,source:n}];return ya(es,eu)||es.push({type:"newline",offset:-1,indent:M,source:`
`}),{type:"block-scalar",offset:ea,indent:M,props:es,source:N}}case'"':return{type:"double-quoted-scalar",offset:ea,indent:M,source:el,end:eu};case"'":return{type:"single-quoted-scalar",offset:ea,indent:M,source:el,end:eu};default:return{type:"scalar",offset:ea,indent:M,source:el,end:eu}}},isCollection:t=>!!t&&"items"in t,isScalar:t=>!!t&&("scalar"===t.type||"single-quoted-scalar"===t.type||"double-quoted-scalar"===t.type||"block-scalar"===t.type),prettyToken:function(t){switch(t){case"\uFEFF":return"<BOM>";case"\x02":return"<DOC>";case"\x18":return"<FLOW_END>";case"\x1f":return"<SCALAR>";default:return JSON.stringify(t)}},resolveAsScalar:function(t,n=!0,N){if(t){let r=(t,n,M)=>{let es="number"==typeof t?t:Array.isArray(t)?t[0]:t.offset;if(N)N(es,n,M);else throw new yn([es,es+1],n,M)};switch(t.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return ga(t,n,r);case"block-scalar":return ma(t,n,r)}}return null},setScalarValue:function(t,n,N={}){let{afterKey:M=!1,implicitKey:es=!1,inFlow:ea=!1,type:eo}=N,el="indent"in t?t.indent:null;if(M&&"number"==typeof el&&(el+=2),!eo)switch(t.type){case"single-quoted-scalar":eo="QUOTE_SINGLE";break;case"double-quoted-scalar":eo="QUOTE_DOUBLE";break;case"block-scalar":{let n=t.props[0];if("block-scalar-header"!==n.type)throw Error("Invalid block scalar header");eo=">"===n.source[0]?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:eo="PLAIN"}let eu=qn({type:eo,value:n},{implicitKey:es||null===el,indent:null!==el&&el>0?" ".repeat(el):"",inFlow:ea,options:{blockQuote:!0,lineWidth:-1}});switch(eu[0]){case"|":case">":!function(t,n){let N=n.indexOf(`
`),M=n.substring(0,N),es=n.substring(N+1)+`
`;if("block-scalar"===t.type){let n=t.props[0];if("block-scalar-header"!==n.type)throw Error("Invalid block scalar header");n.source=M,t.source=es}else{let{offset:n}=t,N="indent"in t?t.indent:-1,ea=[{type:"block-scalar-header",offset:n,indent:N,source:M}];for(let n of(ya(ea,"end"in t?t.end:void 0)||ea.push({type:"newline",offset:-1,indent:N,source:`
`}),Object.keys(t)))"type"!==n&&"offset"!==n&&delete t[n];Object.assign(t,{type:"block-scalar",indent:N,props:ea,source:es})}}(t,eu);break;case'"':Gr(t,eu,"double-quoted-scalar");break;case"'":Gr(t,eu,"single-quoted-scalar");break;default:Gr(t,eu,"scalar")}},stringify:t=>"type"in t?hr(t):lr(t),tokenType:xa,visit:Ln},Symbol.toStringTag,{value:"Module"}));function en(t){switch(t){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}let e8="0123456789ABCDEFabcdef".split(""),e6="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),e9=",[]{}".split(""),e7=` ,[]{}
\r	`.split(""),Vr=t=>!t||e7.includes(t);let Aa=class Aa{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(t,n=!1){t&&(this.buffer=this.buffer?this.buffer+t:t,this.lineEndPos=null),this.atEnd=!n;let N=this.next??"stream";for(;N&&(n||this.hasChars(1));)N=yield*this.parseNext(N)}atLineEnd(){let t=this.pos,n=this.buffer[t];for(;" "===n||"	"===n;)n=this.buffer[++t];return!n||"#"===n||n===`
`||"\r"===n&&this.buffer[t+1]===`
`}charAt(t){return this.buffer[this.pos+t]}continueScalar(t){let n=this.buffer[t];if(this.indentNext>0){let N=0;for(;" "===n;)n=this.buffer[++N+t];if("\r"===n){let n=this.buffer[N+t+1];if(n===`
`||!n&&!this.atEnd)return t+N+1}return n!==`
`&&!(N>=this.indentNext)&&(n||this.atEnd)?-1:t+N}if("-"===n||"."===n){let n=this.buffer.substr(t,3);if(("---"===n||"..."===n)&&en(this.buffer[t+3]))return -1}return t}getLine(){let t=this.lineEndPos;return("number"!=typeof t||-1!==t&&t<this.pos)&&(t=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=t),-1===t?this.atEnd?this.buffer.substring(this.pos):null:("\r"===this.buffer[t-1]&&(t-=1),this.buffer.substring(this.pos,t))}hasChars(t){return this.pos+t<=this.buffer.length}setNext(t){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=t,null}peek(t){return this.buffer.substr(this.pos,t)}*parseNext(t){switch(t){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let t=this.getLine();if(null===t)return this.setNext("stream");if("\uFEFF"===t[0]&&(yield*this.pushCount(1),t=t.substring(1)),"%"===t[0]){let n=t.length,N=t.indexOf("#");if(-1!==N){let M=t[N-1];(" "===M||"	"===M)&&(n=N-1)}for(;;){let N=t[n-1];if(" "===N||"	"===N)n-=1;else break}let M=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(t.length-M),this.pushNewline(),"stream"}if(this.atLineEnd()){let n=yield*this.pushSpaces(!0);return yield*this.pushCount(t.length-n),yield*this.pushNewline(),"stream"}return yield"\x02",yield*this.parseLineStart()}*parseLineStart(){let t=this.charAt(0);if(!t&&!this.atEnd)return this.setNext("line-start");if("-"===t||"."===t){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let t=this.peek(3);if("---"===t&&en(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if("..."===t&&en(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!en(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){let[t,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if(("-"===t||"?"===t||":"===t)&&en(n)){let t=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=t,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let t=this.getLine();if(null===t)return this.setNext("doc");let n=yield*this.pushIndicators();switch(t[n]){case"#":yield*this.pushCount(t.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Vr),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=(yield*this.parseBlockScalarHeader())+(yield*this.pushSpaces(!0)),yield*this.pushCount(t.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let t,n,N=-1;do(t=yield*this.pushNewline())>0?(n=yield*this.pushSpaces(!1),this.indentValue=N=n):n=0,n+=yield*this.pushSpaces(!0);while(t+n>0);let M=this.getLine();if(null===M)return this.setNext("flow");if((-1!==N&&N<this.indentNext&&"#"!==M[0]||0===N&&(M.startsWith("---")||M.startsWith("..."))&&en(M[3]))&&!(N===this.indentNext-1&&1===this.flowLevel&&("]"===M[0]||"}"===M[0])))return this.flowLevel=0,yield"\x18",yield*this.parseLineStart();let es=0;for(;","===M[es];)es+=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0)),this.flowKey=!1;switch(M[es+=yield*this.pushIndicators()]){case void 0:return"flow";case"#":return yield*this.pushCount(M.length-es),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Vr),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let t=this.charAt(1);if(this.flowKey||en(t)||","===t)return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let t=this.charAt(0),n=this.buffer.indexOf(t,this.pos+1);if("'"===t)for(;-1!==n&&"'"===this.buffer[n+1];)n=this.buffer.indexOf("'",n+2);else for(;-1!==n;){let t=0;for(;"\\"===this.buffer[n-1-t];)t+=1;if(t%2==0)break;n=this.buffer.indexOf('"',n+1)}let N=this.buffer.substring(0,n),M=N.indexOf(`
`,this.pos);if(-1!==M){for(;-1!==M;){let t=this.continueScalar(M+1);if(-1===t)break;M=N.indexOf(`
`,t)}-1!==M&&(n=M-("\r"===N[M-1]?2:1))}if(-1===n){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let t=this.pos;for(;;){let n=this.buffer[++t];if("+"===n)this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if("-"!==n)break}return yield*this.pushUntil(t=>en(t)||"#"===t)}*parseBlockScalar(){let t=this.pos-1,n=0,N;e:for(let M=this.pos;N=this.buffer[M];++M)switch(N){case" ":n+=1;break;case`
`:t=M,n=0;break;case"\r":{let t=this.buffer[M+1];if(!t&&!this.atEnd)return this.setNext("block-scalar");if(t===`
`)break}default:break e}if(!N&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){-1===this.blockScalarIndent?this.indentNext=n:this.indentNext+=this.blockScalarIndent;do{let n=this.continueScalar(t+1);if(-1===n)break;t=this.buffer.indexOf(`
`,n)}while(-1!==t);if(-1===t){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}if(!this.blockScalarKeep)for(;;){let N=t-1,M=this.buffer[N];"\r"===M&&(M=this.buffer[--N]);let es=N;for(;" "===M||"	"===M;)M=this.buffer[--N];if(M===`
`&&N>=this.pos&&N+1+n>es)t=N;else break}return yield"\x1f",yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let t=this.flowLevel>0,n=this.pos-1,N=this.pos-1,M;for(;M=this.buffer[++N];)if(":"===M){let M=this.buffer[N+1];if(en(M)||t&&","===M)break;n=N}else if(en(M)){let es=this.buffer[N+1];if("\r"===M&&(es===`
`?(N+=1,M=`
`,es=this.buffer[N+1]):n=N),"#"===es||t&&e9.includes(es))break;if(M===`
`){let t=this.continueScalar(N+1);if(-1===t)break;N=Math.max(N,t-2)}}else{if(t&&e9.includes(M))break;n=N}return M||this.atEnd?(yield"\x1f",yield*this.pushToIndex(n+1,!0),t?"flow":"doc"):this.setNext("plain-scalar")}*pushCount(t){return t>0?(yield this.buffer.substr(this.pos,t),this.pos+=t,t):0}*pushToIndex(t,n){let N=this.buffer.slice(this.pos,t);return N?(yield N,this.pos+=N.length,N.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Vr))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let t=this.flowLevel>0,n=this.charAt(1);if(en(n)||t&&e9.includes(n))return t?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if("<"===this.charAt(1)){let t=this.pos+2,n=this.buffer[t];for(;!en(n)&&">"!==n;)n=this.buffer[++t];return yield*this.pushToIndex(">"===n?t+1:t,!1)}{let t=this.pos+1,n=this.buffer[t];for(;n;)if(e6.includes(n))n=this.buffer[++t];else if("%"===n&&e8.includes(this.buffer[t+1])&&e8.includes(this.buffer[t+2]))n=this.buffer[t+=3];else break;return yield*this.pushToIndex(t,!1)}}*pushNewline(){let t=this.buffer[this.pos];return t===`
`?yield*this.pushCount(1):"\r"===t&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(t){let n=this.pos-1,N;do N=this.buffer[++n];while(" "===N||t&&"	"===N);let M=n-this.pos;return M>0&&(yield this.buffer.substr(this.pos,M),this.pos=n),M}*pushUntil(t){let n=this.pos,N=this.buffer[n];for(;!t(N);)N=this.buffer[++n];return yield*this.pushToIndex(n,!1)}};let Ta=class Ta{constructor(){this.lineStarts=[],this.addNewLine=t=>this.lineStarts.push(t),this.linePos=t=>{let n=0,N=this.lineStarts.length;for(;n<N;){let M=n+N>>1;this.lineStarts[M]<t?n=M+1:N=M}if(this.lineStarts[n]===t)return{line:n+1,col:1};if(0===n)return{line:0,col:t};let M=this.lineStarts[n-1];return{line:n,col:t-M+1}}}};function sn(t,n){for(let N=0;N<t.length;++N)if(t[N].type===n)return!0;return!1}function Ps(t){for(let n=0;n<t.length;++n)switch(t[n].type){case"space":case"comment":case"newline":break;default:return n}return -1}function Ea(t){switch(null==t?void 0:t.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function er(t){switch(t.type){case"document":return t.start;case"block-map":{let n=t.items[t.items.length-1];return n.sep??n.start}case"block-seq":return t.items[t.items.length-1].start;default:return[]}}function An(t){var n;if(0===t.length)return[];let N=t.length;e:for(;--N>=0;)switch(t[N].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;(null==(n=t[++N])?void 0:n.type)==="space";);return t.splice(N,t.length)}function Ms(t){if("flow-seq-start"===t.start.type)for(let n of t.items)!n.sep||n.value||sn(n.start,"explicit-key-ind")||sn(n.sep,"map-value-ind")||(n.key&&(n.value=n.key),delete n.key,Ea(n.value)?n.value.end?Array.prototype.push.apply(n.value.end,n.sep):n.value.end=n.sep:Array.prototype.push.apply(n.start,n.sep),delete n.sep)}let hs=class hs{constructor(t){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Aa,this.onNewLine=t}*parse(t,n=!1){for(let N of(this.onNewLine&&0===this.offset&&this.onNewLine(0),this.lexer.lex(t,n)))yield*this.next(N);n||(yield*this.end())}*next(t){if(this.source=t,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=t.length;return}let n=xa(t);if(n){if("scalar"===n)this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+t.length);break;case"space":this.atNewLine&&" "===t[0]&&(this.indent+=t.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=t.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=t.length}}else{let n=`Not a YAML token: ${t}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:t}),this.offset+=t.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let t=this.peek(1);if("doc-end"===this.type&&(!t||"doc-end"!==t.type)){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!t)return yield*this.stream();switch(t.type){case"document":return yield*this.document(t);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(t);case"block-scalar":return yield*this.blockScalar(t);case"block-map":return yield*this.blockMap(t);case"block-seq":return yield*this.blockSequence(t);case"flow-collection":return yield*this.flowCollection(t);case"doc-end":return yield*this.documentEnd(t)}yield*this.pop()}peek(t){return this.stack[this.stack.length-t]}*pop(t){let n=t??this.stack.pop();if(n){if(0===this.stack.length)yield n;else{let t=this.peek(1);switch("block-scalar"===n.type?n.indent="indent"in t?t.indent:0:"flow-collection"===n.type&&"document"===t.type&&(n.indent=0),"flow-collection"===n.type&&Ms(n),t.type){case"document":t.value=n;break;case"block-scalar":t.props.push(n);break;case"block-map":{let N=t.items[t.items.length-1];if(N.value){t.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}if(N.sep)N.value=n;else{Object.assign(N,{key:n,sep:[]}),this.onKeyLine=!sn(N.start,"explicit-key-ind");return}break}case"block-seq":{let N=t.items[t.items.length-1];N.value?t.items.push({start:[],value:n}):N.value=n;break}case"flow-collection":{let N=t.items[t.items.length-1];!N||N.value?t.items.push({start:[],key:n,sep:[]}):N.sep?N.value=n:Object.assign(N,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if(("document"===t.type||"block-map"===t.type||"block-seq"===t.type)&&("block-map"===n.type||"block-seq"===n.type)){let N=n.items[n.items.length-1];N&&!N.sep&&!N.value&&N.start.length>0&&-1===Ps(N.start)&&(0===n.indent||N.start.every(t=>"comment"!==t.type||t.indent<n.indent))&&("document"===t.type?t.end=N.start:t.items.push({start:N.start}),n.items.splice(-1,1))}}}else yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let t={type:"document",offset:this.offset,start:[]};"doc-start"===this.type&&t.start.push(this.sourceToken),this.stack.push(t);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(t){if(t.value)return yield*this.lineEnd(t);switch(this.type){case"doc-start":-1!==Ps(t.start)?(yield*this.pop(),yield*this.step()):t.start.push(this.sourceToken);return;case"anchor":case"tag":case"space":case"comment":case"newline":t.start.push(this.sourceToken);return}let n=this.startBlockValue(t);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(t){if("map-value-ind"===this.type){let n;let N=er(this.peek(2)),M=An(N);t.end?((n=t.end).push(this.sourceToken),delete t.end):n=[this.sourceToken];let es={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:M,key:t,sep:n}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=es}else yield*this.lineEnd(t)}*blockScalar(t){switch(this.type){case"space":case"comment":case"newline":t.props.push(this.sourceToken);return;case"scalar":if(t.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;0!==t;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(t){var n;let N=t.items[t.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,N.value){let n="end"in N.value?N.value.end:void 0,M=Array.isArray(n)?n[n.length-1]:void 0;(null==M?void 0:M.type)==="comment"?null==n||n.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else N.sep?N.sep.push(this.sourceToken):N.start.push(this.sourceToken);return;case"space":case"comment":if(N.value)t.items.push({start:[this.sourceToken]});else if(N.sep)N.sep.push(this.sourceToken);else{if(this.atIndentedComment(N.start,t.indent)){let M=t.items[t.items.length-2],es=null==(n=null==M?void 0:M.value)?void 0:n.end;if(Array.isArray(es)){Array.prototype.push.apply(es,N.start),es.push(this.sourceToken),t.items.pop();return}}N.start.push(this.sourceToken)}return}if(this.indent>=t.indent){let n=!this.onKeyLine&&this.indent===t.indent&&N.sep,M=[];if(n&&N.sep&&!N.value){let n=[];for(let M=0;M<N.sep.length;++M){let es=N.sep[M];switch(es.type){case"newline":n.push(M);break;case"space":break;case"comment":es.indent>t.indent&&(n.length=0);break;default:n.length=0}}n.length>=2&&(M=N.sep.splice(n[1]))}switch(this.type){case"anchor":case"tag":n||N.value?(M.push(this.sourceToken),t.items.push({start:M}),this.onKeyLine=!0):N.sep?N.sep.push(this.sourceToken):N.start.push(this.sourceToken);return;case"explicit-key-ind":N.sep||sn(N.start,"explicit-key-ind")?n||N.value?(M.push(this.sourceToken),t.items.push({start:M})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}):N.start.push(this.sourceToken),this.onKeyLine=!0;return;case"map-value-ind":if(sn(N.start,"explicit-key-ind")){if(N.sep){if(N.value)t.items.push({start:[],key:null,sep:[this.sourceToken]});else if(sn(N.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:M,key:null,sep:[this.sourceToken]}]});else if(Ea(N.key)&&!sn(N.sep,"newline")){let t=An(N.start),n=N.key,M=N.sep;M.push(this.sourceToken),delete N.key,delete N.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:t,key:n,sep:M}]})}else M.length>0?N.sep=N.sep.concat(M,this.sourceToken):N.sep.push(this.sourceToken)}else if(sn(N.start,"newline"))Object.assign(N,{key:null,sep:[this.sourceToken]});else{let t=An(N.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:t,key:null,sep:[this.sourceToken]}]})}}else N.sep?N.value||n?t.items.push({start:M,key:null,sep:[this.sourceToken]}):sn(N.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):N.sep.push(this.sourceToken):Object.assign(N,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let es=this.flowScalar(this.type);n||N.value?(t.items.push({start:M,key:es,sep:[]}),this.onKeyLine=!0):N.sep?this.stack.push(es):(Object.assign(N,{key:es,sep:[]}),this.onKeyLine=!0);return}default:{let es=this.startBlockValue(t);if(es){n&&"block-seq"!==es.type&&sn(N.start,"explicit-key-ind")&&t.items.push({start:M}),this.stack.push(es);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(t){var n;let N=t.items[t.items.length-1];switch(this.type){case"newline":if(N.value){let n="end"in N.value?N.value.end:void 0,M=Array.isArray(n)?n[n.length-1]:void 0;(null==M?void 0:M.type)==="comment"?null==n||n.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else N.start.push(this.sourceToken);return;case"space":case"comment":if(N.value)t.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(N.start,t.indent)){let M=t.items[t.items.length-2],es=null==(n=null==M?void 0:M.value)?void 0:n.end;if(Array.isArray(es)){Array.prototype.push.apply(es,N.start),es.push(this.sourceToken),t.items.pop();return}}N.start.push(this.sourceToken)}return;case"anchor":case"tag":if(N.value||this.indent<=t.indent)break;N.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==t.indent)break;N.value||sn(N.start,"seq-item-ind")?t.items.push({start:[this.sourceToken]}):N.start.push(this.sourceToken);return}if(this.indent>t.indent){let n=this.startBlockValue(t);if(n){this.stack.push(n);return}}yield*this.pop(),yield*this.step()}*flowCollection(t){let n=t.items[t.items.length-1];if("flow-error-end"===this.type){let t;do yield*this.pop(),t=this.peek(1);while(t&&"flow-collection"===t.type)}else if(0===t.end.length){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?t.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?t.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?t.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let N=this.flowScalar(this.type);!n||n.value?t.items.push({start:[],key:N,sep:[]}):n.sep?this.stack.push(N):Object.assign(n,{key:N,sep:[]});return}case"flow-map-end":case"flow-seq-end":t.end.push(this.sourceToken);return}let N=this.startBlockValue(t);N?this.stack.push(N):(yield*this.pop(),yield*this.step())}else{let n=this.peek(2);if("block-map"!==n.type||("map-value-ind"!==this.type||n.indent!==t.indent)&&("newline"!==this.type||n.items[n.items.length-1].sep)){if("map-value-ind"===this.type&&"flow-collection"!==n.type){let N=er(n),M=An(N);Ms(t);let es=t.end.splice(1,t.end.length);es.push(this.sourceToken);let ea={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:M,key:t,sep:es}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=ea}else yield*this.lineEnd(t)}else yield*this.pop(),yield*this.step()}}flowScalar(t){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;0!==t;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:t,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(t){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let n=er(t),N=An(n);return N.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:N}]}}case"map-value-ind":{this.onKeyLine=!0;let n=er(t),N=An(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:N,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(t,n){return"comment"===this.type&&!(this.indent<=n)&&t.every(t=>"newline"===t.type||"space"===t.type)}*documentEnd(t){"doc-mode"!==this.type&&(t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop()))}*lineEnd(t){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;default:t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop())}}};function Oa(t){let n=!1!==t.prettyErrors;return{lineCounter:t.lineCounter||n&&new Ta||null,prettyErrors:n}}function Sa(t,n={}){let{lineCounter:N,prettyErrors:M}=Oa(n),es=new hs(null==N?void 0:N.addNewLine),ea=new fs(n),eo=null;for(let n of ea.compose(es.parse(t),!0,t.length))if(eo){if("silent"!==eo.options.logLevel){eo.errors.push(new yn(n.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}}else eo=n;return M&&N&&(eo.errors.forEach(fr(t,N)),eo.warnings.forEach(fr(t,N))),eo}let ta=Object.freeze(Object.defineProperty({__proto__:null,Alias:_r,CST:e4,Composer:fs,Document:Kn,Lexer:Aa,LineCounter:Ta,Pair:qe,Parser:hs,Scalar:Ue,Schema:Ar,YAMLError:us,YAMLMap:tn,YAMLParseError:yn,YAMLSeq:gn,YAMLWarning:da,isAlias:wn,isCollection:He,isDocument:Pn,isMap:Mn,isNode:ze,isPair:Fe,isScalar:Ve,isSeq:Bn,parse:function(t,n,N){let M;"function"==typeof n?M=n:void 0===N&&n&&"object"==typeof n&&(N=n);let es=Sa(t,N);if(!es)return null;if(es.warnings.forEach(t=>Zs(es.options.logLevel,t)),es.errors.length>0){if("silent"!==es.options.logLevel)throw es.errors[0];es.errors=[]}return es.toJS(Object.assign({reviver:M},N))},parseAllDocuments:function(t,n={}){let{lineCounter:N,prettyErrors:M}=Oa(n),es=new hs(null==N?void 0:N.addNewLine),ea=new fs(n),eo=Array.from(ea.compose(es.parse(t)));if(M&&N)for(let n of eo)n.errors.forEach(fr(t,N)),n.warnings.forEach(fr(t,N));return eo.length>0?eo:Object.assign([],{empty:!0},ea.streamInfo())},parseDocument:Sa,stringify:function(t,n,N){let M=null;if("function"==typeof n||Array.isArray(n)?M=n:void 0===N&&n&&(N=n),"string"==typeof N&&(N=N.length),"number"==typeof N){let t=Math.round(N);N=t<1?void 0:t>8?{indent:8}:{indent:t}}if(void 0===t){let{keepUndefined:t}=N??n??{};if(!t)return}return new Kn(t,M,N).toString(N)},visit:mn,visitAsync:dr},Symbol.toStringTag,{value:"Module"}));function Bs(t){let n={},N={exports:{boot:void 0}},M={context:Function("exports","module","define",t)(n,N,void 0)};return void 0!==n.boot?M.boot=n.boot:void 0!==N.exports.boot?M.boot=N.exports.boot:"object"===M.context&&void 0!==M.context.boot&&(M.boot=M.context.boot),M}function xo(t){return new Promise(async(n,N)=>{if(void 0!==t.header)return n(t.header);if(void 0===t.url)return N("failed to get header");let M=t.url.split("/").slice(-1)[0];M.endsWith(".yml")||M.endsWith(".yaml")||(M="header.yml"),console.log(`load header ${M}...`);let es=await t.gameServer.get(M);return t.header=ta.parse(es),n(t.header)})}function Ao(t){return new Promise(async n=>{if(void 0===t.boot)throw"no boot specified";if("function"==typeof t.boot)return n(t.boot);if("object"==typeof t.boot)return n(t.boot.boot);if(!t.boot.endsWith(".js")&&!t.boot.endsWith(".ts")){let N=window[t.boot];if(void 0===N)throw`boot module ${t.boot} not found`;if(void 0===N.boot)throw`no boot function found in module ${t.boot}`;return n(N.boot)}if(t.boot.startsWith("http")){let N=await fetch(t.boot);if(!N.ok)throw N.statusText;let M=await N.text(),es=Bs(M);if(void 0===es.boot)throw`no boot function found in ${t.boot}`;return t.context=es.context,n(es.boot)}let N=await t.gameServer.get(t.boot),M=Bs(N);if(void 0===M.boot)throw`no boot function found in ${t.boot}`;return t.context=M.context,n(M.boot)})}(es=ea||(ea={})).defaultPlugin=t=>({name:"default",loadHeader:xo,loadBoot:Ao}),es.injectHeader=t=>({name:"injectHeader",loadHeader:n=>new Promise((N,M)=>(n.header={...n.header??{},...t??{}},N(n.header)))});let To=class To{constructor(t){this._server=t}href(t){return this._server.href(t)}get(t){return this._server.get(t)}ready(t){this._server.ready(t)}close(t){this._server.close(t)}};let So=class So{constructor(t){this._isDone=!1,this._cancelRequested=!1,this.options=t}loadHeader(){return new Promise(async t=>{var n,N;console.log("start game server..."),this.gameServer=await (n=this.options.sdkConfig,N=this.options.url,new Promise(t=>{let M=function(t,n){if(n.endsWith(".zip"))return t.zipServer(n);if(n.endsWith(".yaml")||n.endsWith(".yml")){let t=n.lastIndexOf("/");n=t<0?"":n.substring(0,t)}return t.fileServer(n)}(n,N),es=new To(M);es.ready(()=>t(es))})),console.log("game server started"),console.log("load game header...");let M=await this.options.pluginDriver.hookReduceArg0("loadHeader",[{url:this.options.url,gameServer:this.gameServer}],(t,n,N)=>(null!==n&&(t.header=n),t));if(this.header=M.header,void 0===this.header)throw"could not load game header";return console.log("game header loaded",this.header),t()}).then(()=>{if(this._isDone=!0,this._cancelRequested){this.cancel();return}void 0!==this.options.onHeaderLoaded&&this.options.onHeaderLoaded(this)}).catch(t=>{this._isDone=!0,this.error=t,this.cancel(),void 0!==this.options.onHeaderError&&this.options.onHeaderError(this)})}loadGame(){return new Promise(async t=>{if(void 0===this.gameServer||void 0===this.header)throw"no game server or header";let n=this.options.boot??this.header.boot;if(void 0===n)throw"missing boot parameter in game header";console.log("load game boot...");let N={boot:n,gameServer:this.gameServer},M=await this.options.pluginDriver.hookReduceArg0("loadBoot",[N],(t,n,N)=>(null!==n&&(t.boot=n),t));if(!M||void 0===M.boot||"function"!=typeof M.boot)throw"could not load game boot";return console.log("game boot loaded",M.boot),this.context=M.context,this.boot=M.boot,console.log("boot the game..."),this.game=await M.boot({vm:this.options.vm}),console.log("game booted"),t()}).then(()=>{if(this._isDone=!0,this._cancelRequested){this.cancel();return}void 0!==this.options.onGameLoaded&&this.options.onGameLoaded(this)}).catch(t=>{this._isDone=!0,this.error=t,this.cancel(),void 0!==this.options.onGameError&&this.options.onGameError(this)})}cancel(){if(!this._isDone){this._cancelRequested=!0;return}void 0!==this.gameServer&&(this.gameServer.close(),this.gameServer=void 0)}};let Io=class Io{constructor(t,n,N){this._state=0,this._ui={},this._speed=1,this._physicsAccumulator=0,this._frame=0,this._time=0,this._sdkConfig=t,this._options=N,this._pluginDriver=new ci({player:this,vm:this},[ea.defaultPlugin(),...void 0!==this._options.plugins?this._options.plugins:[]]),this._controllerBus=new ti({inputController:t.inputController}),void 0!==N.agents&&N.agents.map((t,n)=>{let N=this._controllerBus.get(n);void 0!==N&&N.loadAgent(t)}),this._tickFromGame=this._tickFromGame.bind(this),void 0!==this._options.onReady&&(this._readyCallback=this._options.onReady),"dataset"in n&&(this._ui.element=n,this._options={...N},void 0===this._options.url&&void 0!==n.dataset.url&&(this._options.url=n.dataset.url),this._attach(),this.play({url:this._options.url}))}get isLoading(){return 1==this._state}get isPlaying(){return 3==this._state}get isPaused(){return 4==this._state}_attach(){if(void 0!==this._ui.element){{let t=document.createElement("div");this._ui.wrapper=t,t.addEventListener("mouseenter",()=>this._onMouseEnter()),t.addEventListener("mousemove",()=>this._onMouseMove()),t.addEventListener("mouseleave",()=>this._onMouseLeave()),t.style.width="100%",t.style.height="100%",t.style.backgroundPosition="center",t.style.backgroundSize="cover",t.style.backgroundColor="black",this._ui.element.appendChild(t)}{let t=document.createElement("div");this._ui.base=t,t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.display="flex",t.style.flexDirection="row",t.style.justifyContent="center",this._ui.wrapper.appendChild(t)}this.resize(),this._ui.overlay=new ai(this._ui.wrapper),this._ui.overlay.onPlay=()=>this.play(),this._ui.overlay.onSpeed=t=>this.speed=t,this._resizeListener=()=>this._onResize(),window.addEventListener("resize",this._resizeListener)}}_notifyReady(){void 0!==this._readyCallback&&this._readyCallback()}_loadHeader(t){var n,N;this._options.url=t.url,null==(n=this._loadGameTask)||n.cancel(),this.stop(),this._state=1,null==(N=this._ui.overlay)||N.loading(),this._loadGameTask=new So({url:this.url,sdkConfig:this._sdkConfig,pluginDriver:this._pluginDriver,vm:this,onHeaderLoaded:n=>{var N;this._gameServer=n.gameServer,this._header=n.header,this.resize(),void 0!==this._ui.wrapper&&(this._ui.wrapper.style.backgroundImage=void 0!==this._header.previewUrl?`url('${this._gameServer.href(this._header.previewUrl)}')`:""),(t.autoPlay??this._options.autoPlay)===!0?this._play():(this._state=0,null==(N=this._ui.overlay)||N.stopped())},onHeaderError:t=>{void 0!==t.error&&console.error(t.error)},onGameLoaded:t=>{this._game=t.game,this._game.ticker=this._tickFromGame,this.resize(),this._ready()},onGameError:t=>{void 0!==t.error&&console.error(t.error)}}),this._loadGameTask.loadHeader()}_play(){if(4===this._state){this._state=3,this._ui.overlay&&this._ui.overlay.playing(),void 0!==this._game&&this._game.play();return}if(void 0===this._loadGameTask)throw"player not ready for play";if(this._state=1,this._startLoadingDate=new Date,this._ui.overlay&&this._ui.overlay.loading(),void 0!==this._ui.wrapper&&(this._ui.wrapper.style.backgroundImage=""),void 0===this._ui.element)throw"no root HTML element";this._loadGameTask.loadGame()}_onMouseEnter(){this._ui.overlay&&this._ui.overlay.mouseEnter()}_onMouseMove(){this._ui.overlay&&this._ui.overlay.mouseMove()}_onMouseLeave(){this._ui.overlay&&this._ui.overlay.mouseLeave()}get player(){return this}get vm(){return this}get root(){return this._ui.base}get gameServer(){var t;return null==(t=this._loadGameTask)?void 0:t.gameServer}_nativeGameSize(){var t,n,N;let M=null==(t=this._header)?void 0:t.width,es=null==(n=this._header)?void 0:n.height;if(void 0!==M&&void 0!==es)return{width:M,height:es};let ea=(null==(N=this.header)?void 0:N.aspectRatio)??"1/1",[eo,el]=ea.split("/").map(t=>parseInt(t));return void 0!==M?{width:M,height:M*el/eo}:void 0!==es?{width:es*eo/el,height:es}:{width:256,height:256}}_optimalPlayerSize(){let t=this._nativeGameSize(),n=this.scale/this.gameScale;return{width:t.width*n,height:t.height*n}}resize(t,n){if(void 0!==t){"object"==typeof t?(this._options.width=t.width,this._options.height=t.height):(this._options.width=t,this._options.height=n),this.resize();return}if(void 0===this._ui.wrapper)return;let N=this._optimalPlayerSize();this._ui.wrapper.style.aspectRatio=`${N.width}/${N.height}`;let M=this._ui.element,es=this._options.width,ea=this._options.height;"number"==typeof es?M.style.width=`${Math.round(es)}px`:"string"==typeof es&&(M.style.width=es),"number"==typeof ea?M.style.height=`${Math.round(ea)}px`:"string"==typeof ea&&(M.style.height=ea),this._onResize()}_onResize(){void 0!==this._game&&this._game.resize()}get onReady(){return this._readyCallback}set onReady(t){this._readyCallback=t,this.isPlaying&&this._notifyReady()}_ready(){if(1!=this._state)return;this._state=2;let t=1e3-(+new Date-+this._startLoadingDate);if(t>0){setTimeout(()=>this._ready_after_loading(),t);return}this._ready_after_loading()}_ready_after_loading(){2===this._state&&(this._state=3,void 0!==this._game&&(this.scale=this._options.scale??1),this._ui.overlay&&this._ui.overlay.playing(),this._game&&this._game.play(),this._notifyReady())}getController(t){return this._controllerBus.get(t)}get width(){return this._ui.wrapper?this._ui.wrapper.clientWidth:0}set width(t){this.resize({width:t})}get height(){return this._ui.wrapper?this._ui.wrapper.clientHeight:0}set height(t){this.resize({height:t})}get scale(){return this._options.scale??1}set scale(t){this._options.scale=t,this.resize()}get gameWidth(){return this._nativeGameSize().width}get gameHeight(){return this._nativeGameSize().height}get gameScale(){var t;return(null==(t=this._header)?void 0:t.scale)??1}get gameAspectRatio(){var t;return(null==(t=this._header)?void 0:t.aspectRatio)??"1/1"}get resizable(){return!0===this._options.resizable}set resizable(t){this._options.resizable=t}get speed(){return this._speed}set speed(t){this._speed=t}get url(){return this._options.url}set url(t){this._loadHeader({url:t})}get boot(){return this._options.boot}set boot(t){this._options.boot=t}get header(){var t;return null==(t=this._loadGameTask)?void 0:t.header}get autoPlay(){return!0===this._options.autoPlay}set autoPlay(t){this._options.autoPlay=t}get simulated(){return!0===this._options.simulated}set simulated(t){this._options.simulated=t}get frame(){return this._frame}get time(){return this._time}play(t){if("object"==typeof t){this._loadHeader({url:t.url,autoPlay:t.autoPlay});return}if(void 0!==t){this._loadHeader({url:t});return}this._play()}pause(){this.isPlaying&&(void 0!==this._game&&this._game.pause(),this._ui.overlay&&this._ui.overlay.paused(),this._state=4)}stop(){void 0!==this._game&&(this._game.stop(),this._game=void 0),this._ui.overlay&&this._ui.overlay.stopped(),void 0!==this._gameServer&&(this._gameServer.close(),this._gameServer=void 0),this._loadGameTask=void 0,this._speed=1,this._state=0}reload(){this.stop(),this.play()}remove(){this.stop(),void 0!==this._resizeListener&&window.removeEventListener("resize",this._resizeListener),this._ui.overlay&&(this._ui.overlay.remove(),this._ui.overlay=void 0),this._ui.wrapper&&(this._ui.wrapper.remove(),this._ui.wrapper=void 0)}saveState(){return{physicsAccumulator:this._physicsAccumulator,game:void 0!==this._game?this._game.saveState():{},controllers:this._controllerBus.saveState()}}loadState(t){this._physicsAccumulator=void 0!==t.physicsAccumulator?t.physicsAccumulator:0,void 0!==this._game&&this._game.loadState(void 0!==t.game?t.game:{}),this._controllerBus.loadState(void 0!==t.controllers?t.controllers:[{},{}])}_tickFromGame(t){if(void 0!==this.ticker){this.ticker(t);return}this.simulated||this.tick(t)}tick(t){if(void 0!==this._game){for(this._physicsAccumulator+=t*this.speed;this._physicsAccumulator>.01;)this._tickOneFrame(.01,!1),this._physicsAccumulator-=.01;this._tickOneFrame(.01,!0)}}_tickOneFrame(t,n){this._time+=t,this._frame++;let N=this._game.getStateForAgent();this._game.tick(this._controllerBus.inputs(N),t,n)}};function Ra(t){return"length"in t}let Po=class Po{constructor(){this._inputs={left:!1,right:!1,up:!1,down:!1},this._keyDownListener=t=>this._onKey(t,!0),this._keyUpListener=t=>this._onKey(t,!1),document.addEventListener("keydown",this._keyDownListener,!1),document.addEventListener("keyup",this._keyUpListener,!1)}_onKey(t,n){"ArrowDown"===t.code||"KeyS"===t.code?("ArrowDown"===t.code&&t.preventDefault(),this._inputs.down=n):"ArrowUp"===t.code||"KeyW"===t.code?("ArrowUp"===t.code&&t.preventDefault(),this._inputs.up=n):"ArrowLeft"===t.code||"KeyA"===t.code?("ArrowLeft"===t.code&&t.preventDefault(),this._inputs.left=n):("ArrowRight"===t.code||"KeyD"===t.code)&&("ArrowRight"===t.code&&t.preventDefault(),this._inputs.right=n)}remove(){document.removeEventListener("keydown",this._keyDownListener),document.removeEventListener("keyup",this._keyUpListener)}get inputs(){return this._inputs}};var to="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof N.g?N.g:"u">typeof self?self:{};function sr(t){throw Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var tl={exports:{}};tl.exports=(function e(t,n,N){function i(es,ea){if(!n[es]){if(!t[es]){if(!ea&&sr)return sr(es,!0);if(M)return M(es,!0);var eo=Error("Cannot find module '"+es+"'");throw eo.code="MODULE_NOT_FOUND",eo}var el=n[es]={exports:{}};t[es][0].call(el.exports,function(n){return i(t[es][1][n]||n)},el,el.exports,e,t,n,N)}return n[es].exports}for(var M=sr,es=0;es<N.length;es++)i(N[es]);return i})({1:[function(t,n,N){var M=t("./utils"),es=t("./support"),ea="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";N.encode=function(t){for(var n,N,es,eo,el,eu,ec,ef=[],eh=0,ep=t.length,ed=ep,e_="string"!==M.getTypeOf(t);eh<t.length;)ed=ep-eh,es=e_?(n=t[eh++],N=eh<ep?t[eh++]:0,eh<ep?t[eh++]:0):(n=t.charCodeAt(eh++),N=eh<ep?t.charCodeAt(eh++):0,eh<ep?t.charCodeAt(eh++):0),eo=n>>2,el=(3&n)<<4|N>>4,eu=1<ed?(15&N)<<2|es>>6:64,ec=2<ed?63&es:64,ef.push(ea.charAt(eo)+ea.charAt(el)+ea.charAt(eu)+ea.charAt(ec));return ef.join("")},N.decode=function(t){var n,N,M,eo,el,eu,ec=0,ef=0,eh="data:";if(t.substr(0,eh.length)===eh)throw Error("Invalid base64 input, it looks like a data url.");var ep,ed=3*(t=t.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(t.charAt(t.length-1)===ea.charAt(64)&&ed--,t.charAt(t.length-2)===ea.charAt(64)&&ed--,ed%1!=0)throw Error("Invalid base64 input, bad content length.");for(ep=es.uint8array?new Uint8Array(0|ed):Array(0|ed);ec<t.length;)n=ea.indexOf(t.charAt(ec++))<<2|(eo=ea.indexOf(t.charAt(ec++)))>>4,N=(15&eo)<<4|(el=ea.indexOf(t.charAt(ec++)))>>2,M=(3&el)<<6|(eu=ea.indexOf(t.charAt(ec++))),ep[ef++]=n,64!==el&&(ep[ef++]=N),64!==eu&&(ep[ef++]=M);return ep}},{"./support":30,"./utils":32}],2:[function(t,n,N){var M=t("./external"),es=t("./stream/DataWorker"),ea=t("./stream/Crc32Probe"),eo=t("./stream/DataLengthProbe");function p(t,n,N,M,es){this.compressedSize=t,this.uncompressedSize=n,this.crc32=N,this.compression=M,this.compressedContent=es}p.prototype={getContentWorker:function(){var t=new es(M.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new eo("data_length")),n=this;return t.on("end",function(){if(this.streamInfo.data_length!==n.uncompressedSize)throw Error("Bug : uncompressed data size mismatch")}),t},getCompressedWorker:function(){return new es(M.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},p.createWorkerFrom=function(t,n,N){return t.pipe(new ea).pipe(new eo("uncompressedSize")).pipe(n.compressWorker(N)).pipe(new eo("compressedSize")).withStreamInfo("compression",n)},n.exports=p},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,N){var M=t("./stream/GenericWorker");N.STORE={magic:"\x00\x00",compressWorker:function(){return new M("STORE compression")},uncompressWorker:function(){return new M("STORE decompression")}},N.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,N){var M=t("./utils"),es=function(){for(var t,n=[],N=0;N<256;N++){t=N;for(var M=0;M<8;M++)t=1&t?3988292384^t>>>1:t>>>1;n[N]=t}return n}();n.exports=function(t,n){return void 0!==t&&t.length?"string"!==M.getTypeOf(t)?function(t,n,N,M){var ea=M+N;t^=-1;for(var eo=M;eo<ea;eo++)t=t>>>8^es[255&(t^n[eo])];return -1^t}(0|n,t,t.length,0):function(t,n,N,M){var ea=M+N;t^=-1;for(var eo=M;eo<ea;eo++)t=t>>>8^es[255&(t^n.charCodeAt(eo))];return -1^t}(0|n,t,t.length,0):0}},{"./utils":32}],5:[function(t,n,N){N.base64=!1,N.binary=!1,N.dir=!1,N.createFolders=!0,N.date=null,N.compression=null,N.compressionOptions=null,N.comment=null,N.unixPermissions=null,N.dosPermissions=null},{}],6:[function(t,n,N){var M=null;M="u">typeof Promise?Promise:t("lie"),n.exports={Promise:M}},{lie:37}],7:[function(t,n,N){var M="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Uint32Array,es=t("pako"),ea=t("./utils"),eo=t("./stream/GenericWorker"),el=M?"uint8array":"array";function T(t,n){eo.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=n,this.meta={}}N.magic="\b\x00",ea.inherits(T,eo),T.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(ea.transformTo(el,t.data),!1)},T.prototype.flush=function(){eo.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},T.prototype.cleanUp=function(){eo.prototype.cleanUp.call(this),this._pako=null},T.prototype._createPako=function(){this._pako=new es[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(n){t.push({data:n,meta:t.meta})}},N.compressWorker=function(t){return new T("Deflate",t)},N.uncompressWorker=function(){return new T("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,N){function a(t,n){var N,M="";for(N=0;N<n;N++)M+=String.fromCharCode(255&t),t>>>=8;return M}function i(t,n,N,es,eu,ec){var ef,eh,ep,ed,e_=t.file,eg=t.compression,em=ec!==ea.utf8encode,eb=M.transformTo("string",ec(e_.name)),ey=M.transformTo("string",ea.utf8encode(e_.name)),ev=e_.comment,ek=M.transformTo("string",ec(ev)),eL=M.transformTo("string",ea.utf8encode(ev)),eA=ey.length!==e_.name.length,ex=eL.length!==ev.length,ew="",eT="",eO="",eE=e_.dir,eS=e_.date,eN={crc32:0,compressedSize:0,uncompressedSize:0};n&&!N||(eN.crc32=t.crc32,eN.compressedSize=t.compressedSize,eN.uncompressedSize=t.uncompressedSize);var eU=0;n&&(eU|=8),!em&&(eA||ex)&&(eU|=2048);var eI=0,eR=0;eE&&(eI|=16),"UNIX"===eu?(eR=798,eI|=(eh=ef=e_.unixPermissions,ef||(eh=eE?16893:33204),(65535&eh)<<16)):(eR=20,eI|=63&(e_.dosPermissions||0)),ep=(eS.getUTCHours()<<6|eS.getUTCMinutes())<<5|eS.getUTCSeconds()/2,ed=(eS.getUTCFullYear()-1980<<4|eS.getUTCMonth()+1)<<5|eS.getUTCDate(),eA&&(eT=a(1,1)+a(eo(eb),4)+ey,ew+="up"+a(eT.length,2)+eT),ex&&(eO=a(1,1)+a(eo(ek),4)+eL,ew+="uc"+a(eO.length,2)+eO);var eC="";return eC+=`
\0`+a(eU,2)+eg.magic+a(ep,2)+a(ed,2)+a(eN.crc32,4)+a(eN.compressedSize,4)+a(eN.uncompressedSize,4)+a(eb.length,2)+a(ew.length,2),{fileRecord:el.LOCAL_FILE_HEADER+eC+eb+ew,dirRecord:el.CENTRAL_FILE_HEADER+a(eR,2)+eC+a(ek.length,2)+"\x00\x00\x00\x00"+a(eI,4)+a(es,4)+eb+ew+ek}}var M=t("../utils"),es=t("../stream/GenericWorker"),ea=t("../utf8"),eo=t("../crc32"),el=t("../signature");function L(t,n,N,M){es.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=n,this.zipPlatform=N,this.encodeFileName=M,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}M.inherits(L,es),L.prototype.push=function(t){var n=t.meta.percent||0,N=this.entriesCount,M=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,es.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:N?(n+100*(N-M-1))/N:100}}))},L.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var n=this.streamFiles&&!t.file.dir;if(n){var N=i(t,n,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:N.fileRecord,meta:{percent:0}})}else this.accumulate=!0},L.prototype.closedSource=function(t){this.accumulate=!1;var n=this.streamFiles&&!t.file.dir,N=i(t,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(N.dirRecord),n)this.push({data:el.DATA_DESCRIPTOR+a(t.crc32,4)+a(t.compressedSize,4)+a(t.uncompressedSize,4),meta:{percent:100}});else for(this.push({data:N.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},L.prototype.flush=function(){for(var t,n,N,es,ea=this.bytesWritten,eo=0;eo<this.dirRecords.length;eo++)this.push({data:this.dirRecords[eo],meta:{percent:100}});var eu=this.bytesWritten-ea,ec=(t=this.dirRecords.length,n=this.zipComment,N=this.encodeFileName,es=M.transformTo("string",N(n)),el.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+a(t,2)+a(t,2)+a(eu,4)+a(ea,4)+a(es.length,2)+es);this.push({data:ec,meta:{percent:100}})},L.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},L.prototype.registerPrevious=function(t){this._sources.push(t);var n=this;return t.on("data",function(t){n.processChunk(t)}),t.on("end",function(){n.closedSource(n.previous.streamInfo),n._sources.length?n.prepareNextSource():n.end()}),t.on("error",function(t){n.error(t)}),this},L.prototype.resume=function(){return!!es.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},L.prototype.error=function(t){var n=this._sources;if(!es.prototype.error.call(this,t))return!1;for(var N=0;N<n.length;N++)try{n[N].error(t)}catch{}return!0},L.prototype.lock=function(){es.prototype.lock.call(this);for(var t=this._sources,n=0;n<t.length;n++)t[n].lock()},n.exports=L},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,N){var M=t("../compressions"),es=t("./ZipFileWorker");N.generateWorker=function(t,n,N){var ea=new es(n.streamFiles,N,n.platform,n.encodeFileName),eo=0;try{t.forEach(function(t,N){eo++;var es=function(t,n){var N=t||n,es=M[N];if(!es)throw Error(N+" is not a valid compression method !");return es}(N.options.compression,n.compression),el=N.options.compressionOptions||n.compressionOptions||{},eu=N.dir,ec=N.date;N._compressWorker(es,el).withStreamInfo("file",{name:t,dir:eu,date:ec,comment:N.comment||"",unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions}).pipe(ea)}),ea.entriesCount=eo}catch(t){ea.error(t)}return ea}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,N){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new a;for(var n in this)"function"!=typeof this[n]&&(t[n]=this[n]);return t}}(a.prototype=t("./object")).loadAsync=t("./load"),a.support=t("./support"),a.defaults=t("./defaults"),a.version="3.10.1",a.loadAsync=function(t,n){return new a().loadAsync(t,n)},a.external=t("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,N){var M=t("./utils"),es=t("./external"),ea=t("./utf8"),eo=t("./zipEntries"),el=t("./stream/Crc32Probe"),eu=t("./nodejsUtils");n.exports=function(t,n){var N=this;return n=M.extend(n||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:ea.utf8decode}),eu.isNode&&eu.isStream(t)?es.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):M.prepareContent("the loaded zip file",t,!0,n.optimizedBinaryString,n.base64).then(function(t){var N=new eo(n);return N.load(t),N}).then(function(t){var N=[es.Promise.resolve(t)],M=t.files;if(n.checkCRC32)for(var ea=0;ea<M.length;ea++)N.push(function(t){return new es.Promise(function(n,N){var M=t.decompressed.getContentWorker().pipe(new el);M.on("error",function(t){N(t)}).on("end",function(){M.streamInfo.crc32!==t.decompressed.crc32?N(Error("Corrupted zip : CRC32 mismatch")):n()}).resume()})}(M[ea]));return es.Promise.all(N)}).then(function(t){for(var es=t.shift(),ea=es.files,eo=0;eo<ea.length;eo++){var el=ea[eo],eu=el.fileNameStr,ec=M.resolve(el.fileNameStr);N.file(ec,el.decompressed,{binary:!0,optimizedBinaryString:!0,date:el.date,dir:el.dir,comment:el.fileCommentStr.length?el.fileCommentStr:null,unixPermissions:el.unixPermissions,dosPermissions:el.dosPermissions,createFolders:n.createFolders}),el.dir||(N.file(ec).unsafeOriginalName=eu)}return es.zipComment.length&&(N.comment=es.zipComment),N})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,N){var M=t("../utils"),es=t("../stream/GenericWorker");function l(t,n){es.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(n)}M.inherits(l,es),l.prototype._bindStream=function(t){var n=this;(this._stream=t).pause(),t.on("data",function(t){n.push({data:t,meta:{percent:0}})}).on("error",function(t){n.isPaused?this.generatedError=t:n.error(t)}).on("end",function(){n.isPaused?n._upstreamEnded=!0:n.end()})},l.prototype.pause=function(){return!!es.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!es.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,N){var M=t("readable-stream").Readable;function i(t,n,N){M.call(this,n),this._helper=t;var es=this;t.on("data",function(t,n){es.push(t)||es._helper.pause(),N&&N(n)}).on("error",function(t){es.emit("error",t)}).on("end",function(){es.push(null)})}t("../utils").inherits(i,M),i.prototype._read=function(){this._helper.resume()},n.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,n,N){n.exports={isNode:"u">typeof el,newBufferFrom:function(t,n){if(el.from&&el.from!==Uint8Array.from)return el.from(t,n);if("number"==typeof t)throw Error('The "data" argument must not be a number');return new el(t,n)},allocBuffer:function(t){if(el.alloc)return el.alloc(t);var n=new el(t);return n.fill(0),n},isBuffer:function(t){return el.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,n,N){function a(t,n,N){var M,eo=es.getTypeOf(n),ef=es.extend(N||{},el);ef.date=ef.date||new Date,null!==ef.compression&&(ef.compression=ef.compression.toUpperCase()),"string"==typeof ef.unixPermissions&&(ef.unixPermissions=parseInt(ef.unixPermissions,8)),ef.unixPermissions&&16384&ef.unixPermissions&&(ef.dir=!0),ef.dosPermissions&&16&ef.dosPermissions&&(ef.dir=!0),ef.dir&&(t=v(t)),ef.createFolders&&(M=g(t))&&R.call(this,M,!0);var ed="string"===eo&&!1===ef.binary&&!1===ef.base64;N&&void 0!==N.binary||(ef.binary=!ed),(n instanceof eu&&0===n.uncompressedSize||ef.dir||!n||0===n.length)&&(ef.base64=!1,ef.binary=!0,n="",ef.compression="STORE",eo="string");var e_=null;e_=n instanceof eu||n instanceof ea?n:eh.isNode&&eh.isStream(n)?new ep(t,n):es.prepareContent(t,n,ef.binary,ef.optimizedBinaryString,ef.base64);var eg=new ec(t,e_,ef);this.files[t]=eg}var M=t("./utf8"),es=t("./utils"),ea=t("./stream/GenericWorker"),eo=t("./stream/StreamHelper"),el=t("./defaults"),eu=t("./compressedObject"),ec=t("./zipObject"),ef=t("./generate"),eh=t("./nodejsUtils"),ep=t("./nodejs/NodejsStreamInputAdapter"),g=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var n=t.lastIndexOf("/");return 0<n?t.substring(0,n):""},v=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},R=function(t,n){return n=void 0!==n?n:el.createFolders,t=v(t),this.files[t]||a.call(this,t,null,{dir:!0,createFolders:n}),this.files[t]};function B(t){return"[object RegExp]"===Object.prototype.toString.call(t)}n.exports={load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var n,N,M;for(n in this.files)M=this.files[n],(N=n.slice(this.root.length,n.length))&&n.slice(0,this.root.length)===this.root&&t(N,M)},filter:function(t){var n=[];return this.forEach(function(N,M){t(N,M)&&n.push(M)}),n},file:function(t,n,N){if(1!=arguments.length)return t=this.root+t,a.call(this,t,n,N),this;if(B(t)){var M=t;return this.filter(function(t,n){return!n.dir&&M.test(t)})}var es=this.files[this.root+t];return es&&!es.dir?es:null},folder:function(t){if(!t)return this;if(B(t))return this.filter(function(n,N){return N.dir&&t.test(n)});var n=this.root+t,N=R.call(this,n),M=this.clone();return M.root=N.name,M},remove:function(t){t=this.root+t;var n=this.files[t];if(n||("/"!==t.slice(-1)&&(t+="/"),n=this.files[t]),n&&!n.dir)delete this.files[t];else for(var N=this.filter(function(n,N){return N.name.slice(0,t.length)===t}),M=0;M<N.length;M++)delete this.files[N[M].name];return this},generate:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var n,N={};try{if((N=es.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:M.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),"binarystring"===N.type&&(N.type="string"),!N.type)throw Error("No output type specified.");es.checkSupport(N.type),"darwin"!==N.platform&&"freebsd"!==N.platform&&"linux"!==N.platform&&"sunos"!==N.platform||(N.platform="UNIX"),"win32"===N.platform&&(N.platform="DOS");var el=N.comment||this.comment||"";n=ef.generateWorker(this,N,el)}catch(t){(n=new ea("error")).error(t)}return new eo(n,N.type||"string",N.mimeType)},generateAsync:function(t,n){return this.generateInternalStream(t).accumulate(n)},generateNodeStream:function(t,n){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(n)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,N){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,N){var M=t("./DataReader");function i(t){M.call(this,t);for(var n=0;n<this.data.length;n++)t[n]=255&t[n]}t("../utils").inherits(i,M),i.prototype.byteAt=function(t){return this.data[this.zero+t]},i.prototype.lastIndexOfSignature=function(t){for(var n=t.charCodeAt(0),N=t.charCodeAt(1),M=t.charCodeAt(2),es=t.charCodeAt(3),ea=this.length-4;0<=ea;--ea)if(this.data[ea]===n&&this.data[ea+1]===N&&this.data[ea+2]===M&&this.data[ea+3]===es)return ea-this.zero;return -1},i.prototype.readAndCheckSignature=function(t){var n=t.charCodeAt(0),N=t.charCodeAt(1),M=t.charCodeAt(2),es=t.charCodeAt(3),ea=this.readData(4);return n===ea[0]&&N===ea[1]&&M===ea[2]&&es===ea[3]},i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var n=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,n},n.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,n,N){var M=t("../utils");function i(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var n,N=0;for(this.checkOffset(t),n=this.index+t-1;n>=this.index;n--)N=(N<<8)+this.byteAt(n);return this.index+=t,N},readString:function(t){return M.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},n.exports=i},{"../utils":32}],19:[function(t,n,N){var M=t("./Uint8ArrayReader");function i(t){M.call(this,t)}t("../utils").inherits(i,M),i.prototype.readData=function(t){this.checkOffset(t);var n=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,n},n.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,N){var M=t("./DataReader");function i(t){M.call(this,t)}t("../utils").inherits(i,M),i.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},i.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},i.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},i.prototype.readData=function(t){this.checkOffset(t);var n=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,n},n.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,n,N){var M=t("./ArrayReader");function i(t){M.call(this,t)}t("../utils").inherits(i,M),i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var n=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,n},n.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,N){var M=t("../utils"),es=t("../support"),ea=t("./ArrayReader"),eo=t("./StringReader"),el=t("./NodeBufferReader"),eu=t("./Uint8ArrayReader");n.exports=function(t){var n=M.getTypeOf(t);return M.checkSupport(n),"string"!==n||es.uint8array?"nodebuffer"===n?new el(t):es.uint8array?new eu(M.transformTo("uint8array",t)):new ea(M.transformTo("array",t)):new eo(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,N){N.LOCAL_FILE_HEADER="PK\x03\x04",N.CENTRAL_FILE_HEADER="PK\x01\x02",N.CENTRAL_DIRECTORY_END="PK\x05\x06",N.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",N.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",N.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,N){var M=t("./GenericWorker"),es=t("../utils");function l(t){M.call(this,"ConvertWorker to "+t),this.destType=t}es.inherits(l,M),l.prototype.processChunk=function(t){this.push({data:es.transformTo(this.destType,t.data),meta:t.meta})},n.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,N){var M=t("./GenericWorker"),es=t("../crc32");function l(){M.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(l,M),l.prototype.processChunk=function(t){this.streamInfo.crc32=es(t.data,this.streamInfo.crc32||0),this.push(t)},n.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,N){var M=t("../utils"),es=t("./GenericWorker");function l(t){es.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}M.inherits(l,es),l.prototype.processChunk=function(t){if(t){var n=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=n+t.data.length}es.prototype.processChunk.call(this,t)},n.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,N){var M=t("../utils"),es=t("./GenericWorker");function l(t){es.call(this,"DataWorker");var n=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then(function(t){n.dataIsReady=!0,n.data=t,n.max=t&&t.length||0,n.type=M.getTypeOf(t),n.isPaused||n._tickAndRepeat()},function(t){n.error(t)})}M.inherits(l,es),l.prototype.cleanUp=function(){es.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!es.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,M.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(M.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,n=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,n);break;case"uint8array":t=this.data.subarray(this.index,n);break;case"array":case"nodebuffer":t=this.data.slice(this.index,n)}return this.index=n,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,N){function a(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,n){return this._listeners[t].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,n){if(this._listeners[t])for(var N=0;N<this._listeners[t].length;N++)this._listeners[t][N].call(this,n)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var n=this;return t.on("data",function(t){n.processChunk(t)}),t.on("end",function(){n.end()}),t.on("error",function(t){n.error(t)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,n){return this.extraStreamInfo[t]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},n.exports=a},{}],29:[function(t,n,N){var M=t("../utils"),es=t("./ConvertWorker"),ea=t("./GenericWorker"),eo=t("../base64"),eu=t("../support"),ec=t("../external"),ef=null;if(eu.nodestream)try{ef=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(t,n,N){var eo=n;switch(n){case"blob":case"arraybuffer":eo="uint8array";break;case"base64":eo="string"}try{this._internalType=eo,this._outputType=n,this._mimeType=N,M.checkSupport(eo),this._worker=t.pipe(new es(eo)),t.lock()}catch(t){this._worker=new ea("error"),this._worker.error(t)}}d.prototype={accumulate:function(t){var n;return n=this,new ec.Promise(function(N,es){var ea=[],eu=n._internalType,ec=n._outputType,ef=n._mimeType;n.on("data",function(n,N){ea.push(n),t&&t(N)}).on("error",function(t){ea=[],es(t)}).on("end",function(){try{var t=function(t,n,N){switch(t){case"blob":return M.newBlob(M.transformTo("arraybuffer",n),N);case"base64":return eo.encode(n);default:return M.transformTo(t,n)}}(ec,function(t,n){var N,M=0,es=null,ea=0;for(N=0;N<n.length;N++)ea+=n[N].length;switch(t){case"string":return n.join("");case"array":return Array.prototype.concat.apply([],n);case"uint8array":for(es=new Uint8Array(ea),N=0;N<n.length;N++)es.set(n[N],M),M+=n[N].length;return es;case"nodebuffer":return el.concat(n);default:throw Error("concat : unsupported type '"+t+"'")}}(eu,ea),ef);N(t)}catch(t){es(t)}ea=[]}).resume()})},on:function(t,n){var N=this;return"data"===t?this._worker.on(t,function(t){n.call(N,t.data,t.meta)}):this._worker.on(t,function(){M.delay(n,arguments,N)}),this},resume:function(){return M.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(M.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+" is not supported by this method");return new ef(this,{objectMode:"nodebuffer"!==this._outputType},t)}},n.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,N){if(N.base64=!0,N.array=!0,N.string=!0,N.arraybuffer="u">typeof ArrayBuffer&&"u">typeof Uint8Array,N.nodebuffer="u">typeof el,N.uint8array="u">typeof Uint8Array,typeof ArrayBuffer>"u")N.blob=!1;else{var M=new ArrayBuffer(0);try{N.blob=0===new Blob([M],{type:"application/zip"}).size}catch{try{var es=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);es.append(M),N.blob=0===es.getBlob("application/zip").size}catch{N.blob=!1}}}try{N.nodestream=!!t("readable-stream").Readable}catch{N.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,N){for(var M=t("./utils"),es=t("./support"),ea=t("./nodejsUtils"),eo=t("./stream/GenericWorker"),el=Array(256),eu=0;eu<256;eu++)el[eu]=252<=eu?6:248<=eu?5:240<=eu?4:224<=eu?3:192<=eu?2:1;function _(){eo.call(this,"utf-8 decode"),this.leftOver=null}function L(){eo.call(this,"utf-8 encode")}el[254]=el[254]=1,N.utf8encode=function(t){return es.nodebuffer?ea.newBufferFrom(t,"utf-8"):function(t){var n,N,M,ea,eo,el=t.length,eu=0;for(ea=0;ea<el;ea++)(64512&(N=t.charCodeAt(ea)))==55296&&ea+1<el&&(64512&(M=t.charCodeAt(ea+1)))==56320&&(N=65536+(N-55296<<10)+(M-56320),ea++),eu+=N<128?1:N<2048?2:N<65536?3:4;for(n=es.uint8array?new Uint8Array(eu):Array(eu),ea=eo=0;eo<eu;ea++)(64512&(N=t.charCodeAt(ea)))==55296&&ea+1<el&&(64512&(M=t.charCodeAt(ea+1)))==56320&&(N=65536+(N-55296<<10)+(M-56320),ea++),N<128?n[eo++]=N:(N<2048?n[eo++]=192|N>>>6:(N<65536?n[eo++]=224|N>>>12:(n[eo++]=240|N>>>18,n[eo++]=128|N>>>12&63),n[eo++]=128|N>>>6&63),n[eo++]=128|63&N);return n}(t)},N.utf8decode=function(t){return es.nodebuffer?M.transformTo("nodebuffer",t).toString("utf-8"):function(t){var n,N,es,ea,eo=t.length,eu=Array(2*eo);for(n=N=0;n<eo;)if((es=t[n++])<128)eu[N++]=es;else if(4<(ea=el[es]))eu[N++]=65533,n+=ea-1;else{for(es&=2===ea?31:3===ea?15:7;1<ea&&n<eo;)es=es<<6|63&t[n++],ea--;1<ea?eu[N++]=65533:es<65536?eu[N++]=es:(es-=65536,eu[N++]=55296|es>>10&1023,eu[N++]=56320|1023&es)}return eu.length!==N&&(eu.subarray?eu=eu.subarray(0,N):eu.length=N),M.applyFromCharCode(eu)}(t=M.transformTo(es.uint8array?"uint8array":"array",t))},M.inherits(_,eo),_.prototype.processChunk=function(t){var n=M.transformTo(es.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(es.uint8array){var ea=n;(n=new Uint8Array(ea.length+this.leftOver.length)).set(this.leftOver,0),n.set(ea,this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}var eo=function(t,n){var N;for((n=n||t.length)>t.length&&(n=t.length),N=n-1;0<=N&&(192&t[N])==128;)N--;return N<0||0===N?n:N+el[t[N]]>n?N:n}(n),eu=n;eo!==n.length&&(es.uint8array?(eu=n.subarray(0,eo),this.leftOver=n.subarray(eo,n.length)):(eu=n.slice(0,eo),this.leftOver=n.slice(eo,n.length))),this.push({data:N.utf8decode(eu),meta:t.meta})},_.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:N.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},N.Utf8DecodeWorker=_,M.inherits(L,eo),L.prototype.processChunk=function(t){this.push({data:N.utf8encode(t.data),meta:t.meta})},N.Utf8EncodeWorker=L},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,N){var M=t("./support"),es=t("./base64"),ea=t("./nodejsUtils"),eo=t("./external");function p(t){return t}function T(t,n){for(var N=0;N<t.length;++N)n[N]=255&t.charCodeAt(N);return n}t("setimmediate"),N.newBlob=function(t,n){N.checkSupport("blob");try{return new Blob([t],{type:n})}catch{try{var M=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return M.append(t),M.getBlob(n)}catch{throw Error("Bug : can't construct the Blob.")}}};var el={stringifyByChunk:function(t,n,N){var M=[],es=0,ea=t.length;if(ea<=N)return String.fromCharCode.apply(null,t);for(;es<ea;)"array"===n||"nodebuffer"===n?M.push(String.fromCharCode.apply(null,t.slice(es,Math.min(es+N,ea)))):M.push(String.fromCharCode.apply(null,t.subarray(es,Math.min(es+N,ea)))),es+=N;return M.join("")},stringifyByChar:function(t){for(var n="",N=0;N<t.length;N++)n+=String.fromCharCode(t[N]);return n},applyCanBeUsed:{uint8array:function(){try{return M.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return M.nodebuffer&&1===String.fromCharCode.apply(null,ea.allocBuffer(1)).length}catch{return!1}}()}};function L(t){var n=65536,M=N.getTypeOf(t),es=!0;if("uint8array"===M?es=el.applyCanBeUsed.uint8array:"nodebuffer"===M&&(es=el.applyCanBeUsed.nodebuffer),es)for(;1<n;)try{return el.stringifyByChunk(t,M,n)}catch{n=Math.floor(n/2)}return el.stringifyByChar(t)}function d(t,n){for(var N=0;N<t.length;N++)n[N]=t[N];return n}N.applyFromCharCode=L;var eu={};eu.string={string:p,array:function(t){return T(t,Array(t.length))},arraybuffer:function(t){return eu.string.uint8array(t).buffer},uint8array:function(t){return T(t,new Uint8Array(t.length))},nodebuffer:function(t){return T(t,ea.allocBuffer(t.length))}},eu.array={string:L,array:p,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return ea.newBufferFrom(t)}},eu.arraybuffer={string:function(t){return L(new Uint8Array(t))},array:function(t){return d(new Uint8Array(t),Array(t.byteLength))},arraybuffer:p,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return ea.newBufferFrom(new Uint8Array(t))}},eu.uint8array={string:L,array:function(t){return d(t,Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:p,nodebuffer:function(t){return ea.newBufferFrom(t)}},eu.nodebuffer={string:L,array:function(t){return d(t,Array(t.length))},arraybuffer:function(t){return eu.nodebuffer.uint8array(t).buffer},uint8array:function(t){return d(t,new Uint8Array(t.length))},nodebuffer:p},N.transformTo=function(t,n){return(n=n||"",t)?(N.checkSupport(t),eu[N.getTypeOf(n)][t](n)):n},N.resolve=function(t){for(var n=t.split("/"),N=[],M=0;M<n.length;M++){var es=n[M];"."===es||""===es&&0!==M&&M!==n.length-1||(".."===es?N.pop():N.push(es))}return N.join("/")},N.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":M.nodebuffer&&ea.isBuffer(t)?"nodebuffer":M.uint8array&&t instanceof Uint8Array?"uint8array":M.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},N.checkSupport=function(t){if(!M[t.toLowerCase()])throw Error(t+" is not supported by this platform")},N.MAX_VALUE_16BITS=65535,N.MAX_VALUE_32BITS=-1,N.pretty=function(t){var n,N,M="";for(N=0;N<(t||"").length;N++)M+="\\x"+((n=t.charCodeAt(N))<16?"0":"")+n.toString(16).toUpperCase();return M},N.delay=function(t,n,N){setImmediate(function(){t.apply(N||null,n||[])})},N.inherits=function(t,n){function v(){}v.prototype=n.prototype,t.prototype=new v},N.extend=function(){var t,n,N={};for(t=0;t<arguments.length;t++)for(n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&void 0===N[n]&&(N[n]=arguments[t][n]);return N},N.prepareContent=function(t,n,ea,el,eu){return eo.Promise.resolve(n).then(function(t){return M.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"u">typeof FileReader?new eo.Promise(function(n,N){var M=new FileReader;M.onload=function(t){n(t.target.result)},M.onerror=function(t){N(t.target.error)},M.readAsArrayBuffer(t)}):t}).then(function(n){var ec,ef=N.getTypeOf(n);return ef?("arraybuffer"===ef?n=N.transformTo("uint8array",n):"string"===ef&&(eu?n=es.decode(n):ea&&!0!==el&&(n=T(ec=n,M.uint8array?new Uint8Array(ec.length):Array(ec.length)))),n):eo.Promise.reject(Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,N){var M=t("./reader/readerFor"),es=t("./utils"),ea=t("./signature"),eo=t("./zipEntry"),el=t("./support");function T(t){this.files=[],this.loadOptions=t}T.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var n=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+es.pretty(n)+", expected "+es.pretty(t)+")")}},isSignature:function(t,n){var N=this.reader.index;this.reader.setIndex(t);var M=this.reader.readString(4)===n;return this.reader.setIndex(N),M},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),n=el.uint8array?"uint8array":"array",N=es.transformTo(n,t);this.zipComment=this.loadOptions.decodeFileName(N)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,n,N,M=this.zip64EndOfCentralSize-44;0<M;)t=this.reader.readInt(2),n=this.reader.readInt(4),N=this.reader.readData(n),this.zip64ExtensibleData[t]={id:t,length:n,value:N}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,n;for(t=0;t<this.files.length;t++)n=this.files[t],this.reader.setIndex(n.localHeaderOffset),this.checkSignature(ea.LOCAL_FILE_HEADER),n.readLocalPart(this.reader),n.handleUTF8(),n.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(ea.CENTRAL_FILE_HEADER);)(t=new eo({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(ea.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,ea.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var n=t;if(this.checkSignature(ea.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===es.MAX_VALUE_16BITS||this.diskWithCentralDirStart===es.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===es.MAX_VALUE_16BITS||this.centralDirRecords===es.MAX_VALUE_16BITS||this.centralDirSize===es.MAX_VALUE_32BITS||this.centralDirOffset===es.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(ea.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(ea.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,ea.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(ea.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(ea.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var N=this.centralDirOffset+this.centralDirSize;this.zip64&&(N+=20+(12+this.zip64EndOfCentralSize));var M=n-N;if(0<M)this.isSignature(n,ea.CENTRAL_FILE_HEADER)||(this.reader.zero=M);else if(M<0)throw Error("Corrupted zip: missing "+Math.abs(M)+" bytes.")},prepareReader:function(t){this.reader=M(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=T},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,N){var M=t("./reader/readerFor"),es=t("./utils"),ea=t("./compressedObject"),eo=t("./crc32"),el=t("./utf8"),eu=t("./compressions"),ec=t("./support");function L(t,n){this.options=t,this.loadOptions=n}L.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(t){var n,N;if(t.skip(22),this.fileNameLength=t.readInt(2),N=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(N),-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(n=function(t){for(var n in eu)if(Object.prototype.hasOwnProperty.call(eu,n)&&eu[n].magic===t)return eu[n];return null}(this.compressionMethod)))throw Error("Corrupted zip : compression "+es.pretty(this.compressionMethod)+" unknown (inner file : "+es.transformTo("string",this.fileName)+")");this.decompressed=new ea(this.compressedSize,this.uncompressedSize,this.crc32,n,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var n=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");t.skip(n),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=M(this.extraFields[1].value);this.uncompressedSize===es.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===es.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===es.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===es.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var n,N,M,es=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<es;)n=t.readInt(2),N=t.readInt(2),M=t.readData(N),this.extraFields[n]={id:n,length:N,value:M};t.setIndex(es)},handleUTF8:function(){var t=ec.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=el.utf8decode(this.fileName),this.fileCommentStr=el.utf8decode(this.fileComment);else{var n=this.findExtraFieldUnicodePath();if(null!==n)this.fileNameStr=n;else{var N=es.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(N)}var M=this.findExtraFieldUnicodeComment();if(null!==M)this.fileCommentStr=M;else{var ea=es.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(ea)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var n=M(t.value);return 1!==n.readInt(1)||eo(this.fileName)!==n.readInt(4)?null:el.utf8decode(n.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var n=M(t.value);return 1!==n.readInt(1)||eo(this.fileComment)!==n.readInt(4)?null:el.utf8decode(n.readData(t.length-5))}return null}},n.exports=L},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,N){function a(t,n,N){this.name=t,this.dir=N.dir,this.date=N.date,this.comment=N.comment,this.unixPermissions=N.unixPermissions,this.dosPermissions=N.dosPermissions,this._data=n,this._dataBinary=N.binary,this.options={compression:N.compression,compressionOptions:N.compressionOptions}}var M=t("./stream/StreamHelper"),es=t("./stream/DataWorker"),ea=t("./utf8"),eo=t("./compressedObject"),el=t("./stream/GenericWorker");a.prototype={internalStream:function(t){var n=null,N="string";try{if(!t)throw Error("No output type specified.");var es="string"===(N=t.toLowerCase())||"text"===N;"binarystring"!==N&&"text"!==N||(N="string"),n=this._decompressWorker();var eo=!this._dataBinary;eo&&!es&&(n=n.pipe(new ea.Utf8EncodeWorker)),!eo&&es&&(n=n.pipe(new ea.Utf8DecodeWorker))}catch(t){(n=new el("error")).error(t)}return new M(n,N,"")},async:function(t,n){return this.internalStream(t).accumulate(n)},nodeStream:function(t,n){return this.internalStream(t||"nodebuffer").toNodejsStream(n)},_compressWorker:function(t,n){if(this._data instanceof eo&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var N=this._decompressWorker();return this._dataBinary||(N=N.pipe(new ea.Utf8EncodeWorker)),eo.createWorkerFrom(N,t,n)},_decompressWorker:function(){return this._data instanceof eo?this._data.getContentWorker():this._data instanceof el?this._data:new es(this._data)}};for(var eu=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],L=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},ec=0;ec<eu.length;ec++)a.prototype[eu[ec]]=L;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,N){(function(t){var N,M,es=t.MutationObserver||t.WebKitMutationObserver;if(es){var ea=0,eo=new es(E),el=t.document.createTextNode("");eo.observe(el,{characterData:!0}),N=function(){el.data=ea=++ea%2}}else if(t.setImmediate||void 0===t.MessageChannel)N="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var n=t.document.createElement("script");n.onreadystatechange=function(){E(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n)}:function(){setTimeout(E,0)};else{var eu=new t.MessageChannel;eu.port1.onmessage=E,N=function(){eu.port2.postMessage(0)}}var ec=[];function E(){var t,n;M=!0;for(var N=ec.length;N;){for(n=ec,ec=[],t=-1;++t<N;)n[t]();N=ec.length}M=!1}n.exports=function(t){1!==ec.push(t)||M||N()}}).call(this,"u">typeof to?to:"u">typeof self?self:"u">typeof window?window:{})},{}],37:[function(t,n,N){var M=t("immediate");function i(){}var es={},ea=["REJECTED"],eo=["FULFILLED"],el=["PENDING"];function _(t){if("function"!=typeof t)throw TypeError("resolver must be a function");this.state=el,this.queue=[],this.outcome=void 0,t!==i&&f(this,t)}function L(t,n,N){this.promise=t,"function"==typeof n&&(this.onFulfilled=n,this.callFulfilled=this.otherCallFulfilled),"function"==typeof N&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function d(t,n,N){M(function(){var M;try{M=n(N)}catch(n){return es.reject(t,n)}M===t?es.reject(t,TypeError("Cannot resolve promise with itself")):es.resolve(t,M)})}function E(t){var n=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof n)return function(){n.apply(t,arguments)}}function f(t,n){var N=!1;function j(n){N||(N=!0,es.reject(t,n))}function F(n){N||(N=!0,es.resolve(t,n))}var M=g(function(){n(F,j)});"error"===M.status&&j(M.value)}function g(t,n){var N={};try{N.value=t(n),N.status="success"}catch(t){N.status="error",N.value=t}return N}(n.exports=_).prototype.finally=function(t){if("function"!=typeof t)return this;var n=this.constructor;return this.then(function(N){return n.resolve(t()).then(function(){return N})},function(N){return n.resolve(t()).then(function(){throw N})})},_.prototype.catch=function(t){return this.then(null,t)},_.prototype.then=function(t,n){if("function"!=typeof t&&this.state===eo||"function"!=typeof n&&this.state===ea)return this;var N=new this.constructor(i);return this.state!==el?d(N,this.state===eo?t:n,this.outcome):this.queue.push(new L(N,t,n)),N},L.prototype.callFulfilled=function(t){es.resolve(this.promise,t)},L.prototype.otherCallFulfilled=function(t){d(this.promise,this.onFulfilled,t)},L.prototype.callRejected=function(t){es.reject(this.promise,t)},L.prototype.otherCallRejected=function(t){d(this.promise,this.onRejected,t)},es.resolve=function(t,n){var N=g(E,n);if("error"===N.status)return es.reject(t,N.value);var M=N.value;if(M)f(t,M);else{t.state=eo,t.outcome=n;for(var ea=-1,el=t.queue.length;++ea<el;)t.queue[ea].callFulfilled(n)}return t},es.reject=function(t,n){t.state=ea,t.outcome=n;for(var N=-1,M=t.queue.length;++N<M;)t.queue[N].callRejected(n);return t},_.resolve=function(t){return t instanceof this?t:es.resolve(new this(i),t)},_.reject=function(t){var n=new this(i);return es.reject(n,t)},_.all=function(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(TypeError("must be an array"));var N=t.length,M=!1;if(!N)return this.resolve([]);for(var ea=Array(N),eo=0,el=-1,eu=new this(i);++el<N;)(function(t,el){n.resolve(t).then(function(t){ea[el]=t,++eo!==N||M||(M=!0,es.resolve(eu,ea))},function(t){M||(M=!0,es.reject(eu,t))})})(t[el],el);return eu},_.race=function(t){if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(TypeError("must be an array"));var n,N=t.length,M=!1;if(!N)return this.resolve([]);for(var ea=-1,eo=new this(i);++ea<N;)n=t[ea],this.resolve(n).then(function(t){M||(M=!0,es.resolve(eo,t))},function(t){M||(M=!0,es.reject(eo,t))});return eo}},{immediate:36}],38:[function(t,n,N){var M={};(0,t("./lib/utils/common").assign)(M,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=M},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,N){var M=t("./zlib/deflate"),es=t("./utils/common"),ea=t("./utils/strings"),eo=t("./zlib/messages"),el=t("./zlib/zstream"),eu=Object.prototype.toString;function f(t){if(!(this instanceof f))return new f(t);this.options=es.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var n,N=this.options;N.raw&&0<N.windowBits?N.windowBits=-N.windowBits:N.gzip&&0<N.windowBits&&N.windowBits<16&&(N.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new el,this.strm.avail_out=0;var ec=M.deflateInit2(this.strm,N.level,N.method,N.windowBits,N.memLevel,N.strategy);if(0!==ec)throw Error(eo[ec]);if(N.header&&M.deflateSetHeader(this.strm,N.header),N.dictionary){if(n="string"==typeof N.dictionary?ea.string2buf(N.dictionary):"[object ArrayBuffer]"===eu.call(N.dictionary)?new Uint8Array(N.dictionary):N.dictionary,0!==(ec=M.deflateSetDictionary(this.strm,n)))throw Error(eo[ec]);this._dict_set=!0}}function g(t,n){var N=new f(n);if(N.push(t,!0),N.err)throw N.msg||eo[N.err];return N.result}f.prototype.push=function(t,n){var N,eo,el=this.strm,ec=this.options.chunkSize;if(this.ended)return!1;eo=n===~~n?n:!0===n?4:0,"string"==typeof t?el.input=ea.string2buf(t):"[object ArrayBuffer]"===eu.call(t)?el.input=new Uint8Array(t):el.input=t,el.next_in=0,el.avail_in=el.input.length;do{if(0===el.avail_out&&(el.output=new es.Buf8(ec),el.next_out=0,el.avail_out=ec),1!==(N=M.deflate(el,eo))&&0!==N)return this.onEnd(N),this.ended=!0,!1;0!==el.avail_out&&(0!==el.avail_in||4!==eo&&2!==eo)||("string"===this.options.to?this.onData(ea.buf2binstring(es.shrinkBuf(el.output,el.next_out))):this.onData(es.shrinkBuf(el.output,el.next_out)))}while((0<el.avail_in||0===el.avail_out)&&1!==N);return 4===eo?(N=M.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,0===N):2!==eo||(this.onEnd(0),el.avail_out=0,!0)},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=es.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},N.Deflate=f,N.deflate=g,N.deflateRaw=function(t,n){return(n=n||{}).raw=!0,g(t,n)},N.gzip=function(t,n){return(n=n||{}).gzip=!0,g(t,n)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,N){var M=t("./zlib/inflate"),es=t("./utils/common"),ea=t("./utils/strings"),eo=t("./zlib/constants"),el=t("./zlib/messages"),eu=t("./zlib/zstream"),ec=t("./zlib/gzheader"),ef=Object.prototype.toString;function d(t){if(!(this instanceof d))return new d(t);this.options=es.assign({chunkSize:16384,windowBits:0,to:""},t||{});var n=this.options;n.raw&&0<=n.windowBits&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),!(0<=n.windowBits&&n.windowBits<16)||t&&t.windowBits||(n.windowBits+=32),15<n.windowBits&&n.windowBits<48&&!(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eu,this.strm.avail_out=0;var N=M.inflateInit2(this.strm,n.windowBits);if(N!==eo.Z_OK)throw Error(el[N]);this.header=new ec,M.inflateGetHeader(this.strm,this.header)}function E(t,n){var N=new d(n);if(N.push(t,!0),N.err)throw N.msg||el[N.err];return N.result}d.prototype.push=function(t,n){var N,el,eu,ec,eh,ep,ed=this.strm,e_=this.options.chunkSize,eg=this.options.dictionary,em=!1;if(this.ended)return!1;el=n===~~n?n:!0===n?eo.Z_FINISH:eo.Z_NO_FLUSH,"string"==typeof t?ed.input=ea.binstring2buf(t):"[object ArrayBuffer]"===ef.call(t)?ed.input=new Uint8Array(t):ed.input=t,ed.next_in=0,ed.avail_in=ed.input.length;do{if(0===ed.avail_out&&(ed.output=new es.Buf8(e_),ed.next_out=0,ed.avail_out=e_),(N=M.inflate(ed,eo.Z_NO_FLUSH))===eo.Z_NEED_DICT&&eg&&(ep="string"==typeof eg?ea.string2buf(eg):"[object ArrayBuffer]"===ef.call(eg)?new Uint8Array(eg):eg,N=M.inflateSetDictionary(this.strm,ep)),N===eo.Z_BUF_ERROR&&!0===em&&(N=eo.Z_OK,em=!1),N!==eo.Z_STREAM_END&&N!==eo.Z_OK)return this.onEnd(N),this.ended=!0,!1;ed.next_out&&(0!==ed.avail_out&&N!==eo.Z_STREAM_END&&(0!==ed.avail_in||el!==eo.Z_FINISH&&el!==eo.Z_SYNC_FLUSH)||("string"===this.options.to?(eu=ea.utf8border(ed.output,ed.next_out),ec=ed.next_out-eu,eh=ea.buf2string(ed.output,eu),ed.next_out=ec,ed.avail_out=e_-ec,ec&&es.arraySet(ed.output,ed.output,eu,ec,0),this.onData(eh)):this.onData(es.shrinkBuf(ed.output,ed.next_out)))),0===ed.avail_in&&0===ed.avail_out&&(em=!0)}while((0<ed.avail_in||0===ed.avail_out)&&N!==eo.Z_STREAM_END);return N===eo.Z_STREAM_END&&(el=eo.Z_FINISH),el===eo.Z_FINISH?(N=M.inflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===eo.Z_OK):el!==eo.Z_SYNC_FLUSH||(this.onEnd(eo.Z_OK),ed.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===eo.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=es.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},N.Inflate=d,N.inflate=E,N.inflateRaw=function(t,n){return(n=n||{}).raw=!0,E(t,n)},N.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,N){var M="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Int32Array;N.assign=function(t){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var N=n.shift();if(N){if("object"!=typeof N)throw TypeError(N+"must be non-object");for(var M in N)N.hasOwnProperty(M)&&(t[M]=N[M])}}return t},N.shrinkBuf=function(t,n){return t.length===n?t:t.subarray?t.subarray(0,n):(t.length=n,t)};var es={arraySet:function(t,n,N,M,es){if(n.subarray&&t.subarray)t.set(n.subarray(N,N+M),es);else for(var ea=0;ea<M;ea++)t[es+ea]=n[N+ea]},flattenChunks:function(t){var n,N,M,es,ea,eo;for(n=M=0,N=t.length;n<N;n++)M+=t[n].length;for(eo=new Uint8Array(M),n=es=0,N=t.length;n<N;n++)ea=t[n],eo.set(ea,es),es+=ea.length;return eo}},ea={arraySet:function(t,n,N,M,es){for(var ea=0;ea<M;ea++)t[es+ea]=n[N+ea]},flattenChunks:function(t){return[].concat.apply([],t)}};N.setTyped=function(t){t?(N.Buf8=Uint8Array,N.Buf16=Uint16Array,N.Buf32=Int32Array,N.assign(N,es)):(N.Buf8=Array,N.Buf16=Array,N.Buf32=Array,N.assign(N,ea))},N.setTyped(M)},{}],42:[function(t,n,N){var M=t("./common"),es=!0,ea=!0;try{String.fromCharCode.apply(null,[0])}catch{es=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ea=!1}for(var eo=new M.Buf8(256),el=0;el<256;el++)eo[el]=252<=el?6:248<=el?5:240<=el?4:224<=el?3:192<=el?2:1;function T(t,n){if(n<65537&&(t.subarray&&ea||!t.subarray&&es))return String.fromCharCode.apply(null,M.shrinkBuf(t,n));for(var N="",eo=0;eo<n;eo++)N+=String.fromCharCode(t[eo]);return N}eo[254]=eo[254]=1,N.string2buf=function(t){var n,N,es,ea,eo,el=t.length,eu=0;for(ea=0;ea<el;ea++)(64512&(N=t.charCodeAt(ea)))==55296&&ea+1<el&&(64512&(es=t.charCodeAt(ea+1)))==56320&&(N=65536+(N-55296<<10)+(es-56320),ea++),eu+=N<128?1:N<2048?2:N<65536?3:4;for(n=new M.Buf8(eu),ea=eo=0;eo<eu;ea++)(64512&(N=t.charCodeAt(ea)))==55296&&ea+1<el&&(64512&(es=t.charCodeAt(ea+1)))==56320&&(N=65536+(N-55296<<10)+(es-56320),ea++),N<128?n[eo++]=N:(N<2048?n[eo++]=192|N>>>6:(N<65536?n[eo++]=224|N>>>12:(n[eo++]=240|N>>>18,n[eo++]=128|N>>>12&63),n[eo++]=128|N>>>6&63),n[eo++]=128|63&N);return n},N.buf2binstring=function(t){return T(t,t.length)},N.binstring2buf=function(t){for(var n=new M.Buf8(t.length),N=0,es=n.length;N<es;N++)n[N]=t.charCodeAt(N);return n},N.buf2string=function(t,n){var N,M,es,ea,el=n||t.length,eu=Array(2*el);for(N=M=0;N<el;)if((es=t[N++])<128)eu[M++]=es;else if(4<(ea=eo[es]))eu[M++]=65533,N+=ea-1;else{for(es&=2===ea?31:3===ea?15:7;1<ea&&N<el;)es=es<<6|63&t[N++],ea--;1<ea?eu[M++]=65533:es<65536?eu[M++]=es:(es-=65536,eu[M++]=55296|es>>10&1023,eu[M++]=56320|1023&es)}return T(eu,M)},N.utf8border=function(t,n){var N;for((n=n||t.length)>t.length&&(n=t.length),N=n-1;0<=N&&(192&t[N])==128;)N--;return N<0||0===N?n:N+eo[t[N]]>n?N:n}},{"./common":41}],43:[function(t,n,N){n.exports=function(t,n,N,M){for(var es=65535&t|0,ea=t>>>16&65535|0,eo=0;0!==N;){for(N-=eo=2e3<N?2e3:N;ea=ea+(es=es+n[M++]|0)|0,--eo;);es%=65521,ea%=65521}return es|ea<<16|0}},{}],44:[function(t,n,N){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,N){var M=function(){for(var t,n=[],N=0;N<256;N++){t=N;for(var M=0;M<8;M++)t=1&t?3988292384^t>>>1:t>>>1;n[N]=t}return n}();n.exports=function(t,n,N,es){var ea=es+N;t^=-1;for(var eo=es;eo<ea;eo++)t=t>>>8^M[255&(t^n[eo])];return -1^t}},{}],46:[function(t,n,N){var M,es=t("../utils/common"),ea=t("./trees"),eo=t("./adler32"),el=t("./crc32"),eu=t("./messages");function dt(t,n){return t.msg=eu[n],n}function mt(t){return(t<<1)-(4<t?9:0)}function V(t){for(var n=t.length;0<=--n;)t[n]=0}function U(t){var n=t.state,N=n.pending;N>t.avail_out&&(N=t.avail_out),0!==N&&(es.arraySet(t.output,n.pending_buf,n.pending_out,N,t.next_out),t.next_out+=N,n.pending_out+=N,t.total_out+=N,t.avail_out-=N,n.pending-=N,0===n.pending&&(n.pending_out=0))}function P(t,n){ea._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,U(t.strm)}function gt(t,n){t.pending_buf[t.pending++]=n}function _t(t,n){t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n}function St(t,n){var N,M,es=t.max_chain_length,ea=t.strstart,eo=t.prev_length,el=t.nice_match,eu=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,ec=t.window,ef=t.w_mask,eh=t.prev,ep=t.strstart+258,ed=ec[ea+eo-1],e_=ec[ea+eo];t.prev_length>=t.good_match&&(es>>=2),el>t.lookahead&&(el=t.lookahead);do if(ec[(N=n)+eo]===e_&&ec[N+eo-1]===ed&&ec[N]===ec[ea]&&ec[++N]===ec[ea+1]){ea+=2,N++;do;while(ec[++ea]===ec[++N]&&ec[++ea]===ec[++N]&&ec[++ea]===ec[++N]&&ec[++ea]===ec[++N]&&ec[++ea]===ec[++N]&&ec[++ea]===ec[++N]&&ec[++ea]===ec[++N]&&ec[++ea]===ec[++N]&&ea<ep);if(M=258-(ep-ea),ea=ep-258,eo<M){if(t.match_start=n,el<=(eo=M))break;ed=ec[ea+eo-1],e_=ec[ea+eo]}}while((n=eh[n&ef])>eu&&0!=--es);return eo<=t.lookahead?eo:t.lookahead}function Xt(t){var n,N,M,ea,eu,ec,ef,eh,ep,ed,e_=t.w_size;do{if(ea=t.window_size-t.lookahead-t.strstart,t.strstart>=e_+(e_-262)){for(es.arraySet(t.window,t.window,e_,e_,0),t.match_start-=e_,t.strstart-=e_,t.block_start-=e_,n=N=t.hash_size;M=t.head[--n],t.head[n]=e_<=M?M-e_:0,--N;);for(n=N=e_;M=t.prev[--n],t.prev[n]=e_<=M?M-e_:0,--N;);ea+=e_}if(0===t.strm.avail_in)break;if(ec=t.strm,ef=t.window,eh=t.strstart+t.lookahead,ed=void 0,(ep=ea)<(ed=ec.avail_in)&&(ed=ep),N=0===ed?0:(ec.avail_in-=ed,es.arraySet(ef,ec.input,ec.next_in,ed,eh),1===ec.state.wrap?ec.adler=eo(ec.adler,ef,ed,eh):2===ec.state.wrap&&(ec.adler=el(ec.adler,ef,ed,eh)),ec.next_in+=ed,ec.total_in+=ed,ed),t.lookahead+=N,t.lookahead+t.insert>=3)for(eu=t.strstart-t.insert,t.ins_h=t.window[eu],t.ins_h=(t.ins_h<<t.hash_shift^t.window[eu+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[eu+3-1])&t.hash_mask,t.prev[eu&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=eu,eu++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function ee(t,n){for(var N,M;;){if(t.lookahead<262){if(Xt(t),t.lookahead<262&&0===n)return 1;if(0===t.lookahead)break}if(N=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,N=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==N&&t.strstart-N<=t.w_size-262&&(t.match_length=St(t,N)),t.match_length>=3){if(M=ea._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,N=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask}else M=ea._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(M&&(P(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===n?(P(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(P(t,!1),0===t.strm.avail_out)?1:2}function Yt(t,n){for(var N,M,es;;){if(t.lookahead<262){if(Xt(t),t.lookahead<262&&0===n)return 1;if(0===t.lookahead)break}if(N=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,N=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==N&&t.prev_length<t.max_lazy_match&&t.strstart-N<=t.w_size-262&&(t.match_length=St(t,N),t.match_length<=5&&(1===t.strategy||3===t.match_length&&4096<t.strstart-t.match_start)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){for(es=t.strstart+t.lookahead-3,M=ea._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=es&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,N=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=2,t.strstart++,M&&(P(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((M=ea._tr_tally(t,0,t.window[t.strstart-1]))&&P(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(M=ea._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===n?(P(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(P(t,!1),0===t.strm.avail_out)?1:2}function rt(t,n,N,M,es){this.good_length=t,this.max_lazy=n,this.nice_length=N,this.max_chain=M,this.func=es}function ot(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new es.Buf16(1146),this.dyn_dtree=new es.Buf16(122),this.bl_tree=new es.Buf16(78),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new es.Buf16(16),this.heap=new es.Buf16(573),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new es.Buf16(573),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function It(t){var n;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(n=t.state).pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=0,ea._tr_init(n),0):dt(t,-2)}function xt(t){var n,N=It(t);return 0===N&&((n=t.state).window_size=2*n.w_size,V(n.head),n.max_lazy_match=M[n.level].max_lazy,n.good_match=M[n.level].good_length,n.nice_match=M[n.level].nice_length,n.max_chain_length=M[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),N}function Kt(t,n,N,M,ea,eo){if(!t)return -2;var el=1;if(-1===n&&(n=6),M<0?(el=0,M=-M):15<M&&(el=2,M-=16),ea<1||9<ea||8!==N||M<8||15<M||n<0||9<n||eo<0||4<eo)return dt(t,-2);8===M&&(M=9);var eu=new ot;return(t.state=eu).strm=t,eu.wrap=el,eu.gzhead=null,eu.w_bits=M,eu.w_size=1<<eu.w_bits,eu.w_mask=eu.w_size-1,eu.hash_bits=ea+7,eu.hash_size=1<<eu.hash_bits,eu.hash_mask=eu.hash_size-1,eu.hash_shift=~~((eu.hash_bits+3-1)/3),eu.window=new es.Buf8(2*eu.w_size),eu.head=new es.Buf16(eu.hash_size),eu.prev=new es.Buf16(eu.w_size),eu.lit_bufsize=1<<ea+6,eu.pending_buf_size=4*eu.lit_bufsize,eu.pending_buf=new es.Buf8(eu.pending_buf_size),eu.d_buf=1*eu.lit_bufsize,eu.l_buf=3*eu.lit_bufsize,eu.level=n,eu.strategy=eo,eu.method=N,xt(t)}M=[new rt(0,0,0,0,function(t,n){var N=65535;for(65535>t.pending_buf_size-5&&(N=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Xt(t),0===t.lookahead&&0===n)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var M=t.block_start+N;if((0===t.strstart||t.strstart>=M)&&(t.lookahead=t.strstart-M,t.strstart=M,P(t,!1),0===t.strm.avail_out)||t.strstart-t.block_start>=t.w_size-262&&(P(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===n?(P(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(P(t,!1),t.strm.avail_out),1)}),new rt(4,4,8,4,ee),new rt(4,5,16,8,ee),new rt(4,6,32,32,ee),new rt(4,4,16,16,Yt),new rt(8,16,32,32,Yt),new rt(8,16,128,128,Yt),new rt(8,32,128,256,Yt),new rt(32,128,258,1024,Yt),new rt(32,258,258,4096,Yt)],N.deflateInit=function(t,n){return Kt(t,n,8,15,8,0)},N.deflateInit2=Kt,N.deflateReset=xt,N.deflateResetKeep=It,N.deflateSetHeader=function(t,n){return t&&t.state?2!==t.state.wrap?-2:(t.state.gzhead=n,0):-2},N.deflate=function(t,n){var N,es,eo,eu;if(!t||!t.state||5<n||n<0)return t?dt(t,-2):-2;if(es=t.state,!t.output||!t.input&&0!==t.avail_in||666===es.status&&4!==n)return dt(t,0===t.avail_out?-5:-2);if(es.strm=t,N=es.last_flush,es.last_flush=n,42===es.status){if(2===es.wrap)t.adler=0,gt(es,31),gt(es,139),gt(es,8),es.gzhead?(gt(es,(es.gzhead.text?1:0)+(es.gzhead.hcrc?2:0)+(es.gzhead.extra?4:0)+(es.gzhead.name?8:0)+(es.gzhead.comment?16:0)),gt(es,255&es.gzhead.time),gt(es,es.gzhead.time>>8&255),gt(es,es.gzhead.time>>16&255),gt(es,es.gzhead.time>>24&255),gt(es,9===es.level?2:2<=es.strategy||es.level<2?4:0),gt(es,255&es.gzhead.os),es.gzhead.extra&&es.gzhead.extra.length&&(gt(es,255&es.gzhead.extra.length),gt(es,es.gzhead.extra.length>>8&255)),es.gzhead.hcrc&&(t.adler=el(t.adler,es.pending_buf,es.pending,0)),es.gzindex=0,es.status=69):(gt(es,0),gt(es,0),gt(es,0),gt(es,0),gt(es,0),gt(es,9===es.level?2:2<=es.strategy||es.level<2?4:0),gt(es,3),es.status=113);else{var ec=8+(es.w_bits-8<<4)<<8;ec|=(2<=es.strategy||es.level<2?0:es.level<6?1:6===es.level?2:3)<<6,0!==es.strstart&&(ec|=32),ec+=31-ec%31,es.status=113,_t(es,ec),0!==es.strstart&&(_t(es,t.adler>>>16),_t(es,65535&t.adler)),t.adler=1}}if(69===es.status){if(es.gzhead.extra){for(eo=es.pending;es.gzindex<(65535&es.gzhead.extra.length)&&(es.pending!==es.pending_buf_size||(es.gzhead.hcrc&&es.pending>eo&&(t.adler=el(t.adler,es.pending_buf,es.pending-eo,eo)),U(t),eo=es.pending,es.pending!==es.pending_buf_size));)gt(es,255&es.gzhead.extra[es.gzindex]),es.gzindex++;es.gzhead.hcrc&&es.pending>eo&&(t.adler=el(t.adler,es.pending_buf,es.pending-eo,eo)),es.gzindex===es.gzhead.extra.length&&(es.gzindex=0,es.status=73)}else es.status=73}if(73===es.status){if(es.gzhead.name){eo=es.pending;do{if(es.pending===es.pending_buf_size&&(es.gzhead.hcrc&&es.pending>eo&&(t.adler=el(t.adler,es.pending_buf,es.pending-eo,eo)),U(t),eo=es.pending,es.pending===es.pending_buf_size)){eu=1;break}eu=es.gzindex<es.gzhead.name.length?255&es.gzhead.name.charCodeAt(es.gzindex++):0,gt(es,eu)}while(0!==eu);es.gzhead.hcrc&&es.pending>eo&&(t.adler=el(t.adler,es.pending_buf,es.pending-eo,eo)),0===eu&&(es.gzindex=0,es.status=91)}else es.status=91}if(91===es.status){if(es.gzhead.comment){eo=es.pending;do{if(es.pending===es.pending_buf_size&&(es.gzhead.hcrc&&es.pending>eo&&(t.adler=el(t.adler,es.pending_buf,es.pending-eo,eo)),U(t),eo=es.pending,es.pending===es.pending_buf_size)){eu=1;break}eu=es.gzindex<es.gzhead.comment.length?255&es.gzhead.comment.charCodeAt(es.gzindex++):0,gt(es,eu)}while(0!==eu);es.gzhead.hcrc&&es.pending>eo&&(t.adler=el(t.adler,es.pending_buf,es.pending-eo,eo)),0===eu&&(es.status=103)}else es.status=103}if(103===es.status&&(es.gzhead.hcrc?(es.pending+2>es.pending_buf_size&&U(t),es.pending+2<=es.pending_buf_size&&(gt(es,255&t.adler),gt(es,t.adler>>8&255),t.adler=0,es.status=113)):es.status=113),0!==es.pending){if(U(t),0===t.avail_out)return es.last_flush=-1,0}else if(0===t.avail_in&&mt(n)<=mt(N)&&4!==n)return dt(t,-5);if(666===es.status&&0!==t.avail_in)return dt(t,-5);if(0!==t.avail_in||0!==es.lookahead||0!==n&&666!==es.status){var ef=2===es.strategy?function(t,n){for(var N;;){if(0===t.lookahead&&(Xt(t),0===t.lookahead)){if(0===n)return 1;break}if(t.match_length=0,N=ea._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,N&&(P(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===n?(P(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(P(t,!1),0===t.strm.avail_out)?1:2}(es,n):3===es.strategy?function(t,n){for(var N,M,es,eo,el=t.window;;){if(t.lookahead<=258){if(Xt(t),t.lookahead<=258&&0===n)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&0<t.strstart&&(M=el[es=t.strstart-1])===el[++es]&&M===el[++es]&&M===el[++es]){eo=t.strstart+258;do;while(M===el[++es]&&M===el[++es]&&M===el[++es]&&M===el[++es]&&M===el[++es]&&M===el[++es]&&M===el[++es]&&M===el[++es]&&es<eo);t.match_length=258-(eo-es),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(N=ea._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(N=ea._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),N&&(P(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===n?(P(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(P(t,!1),0===t.strm.avail_out)?1:2}(es,n):M[es.level].func(es,n);if(3!==ef&&4!==ef||(es.status=666),1===ef||3===ef)return 0===t.avail_out&&(es.last_flush=-1),0;if(2===ef&&(1===n?ea._tr_align(es):5!==n&&(ea._tr_stored_block(es,0,0,!1),3===n&&(V(es.head),0===es.lookahead&&(es.strstart=0,es.block_start=0,es.insert=0))),U(t),0===t.avail_out))return es.last_flush=-1,0}return 4!==n?0:es.wrap<=0?1:(2===es.wrap?(gt(es,255&t.adler),gt(es,t.adler>>8&255),gt(es,t.adler>>16&255),gt(es,t.adler>>24&255),gt(es,255&t.total_in),gt(es,t.total_in>>8&255),gt(es,t.total_in>>16&255),gt(es,t.total_in>>24&255)):(_t(es,t.adler>>>16),_t(es,65535&t.adler)),U(t),0<es.wrap&&(es.wrap=-es.wrap),0!==es.pending?0:1)},N.deflateEnd=function(t){var n;return t&&t.state?42!==(n=t.state.status)&&69!==n&&73!==n&&91!==n&&103!==n&&113!==n&&666!==n?dt(t,-2):(t.state=null,113===n?dt(t,-3):0):-2},N.deflateSetDictionary=function(t,n){var N,M,ea,el,eu,ec,ef,eh,ep=n.length;if(!t||!t.state||2===(el=(N=t.state).wrap)||1===el&&42!==N.status||N.lookahead)return -2;for(1===el&&(t.adler=eo(t.adler,n,ep,0)),N.wrap=0,ep>=N.w_size&&(0===el&&(V(N.head),N.strstart=0,N.block_start=0,N.insert=0),eh=new es.Buf8(N.w_size),es.arraySet(eh,n,ep-N.w_size,N.w_size,0),n=eh,ep=N.w_size),eu=t.avail_in,ec=t.next_in,ef=t.input,t.avail_in=ep,t.next_in=0,t.input=n,Xt(N);N.lookahead>=3;){for(M=N.strstart,ea=N.lookahead-2;N.ins_h=(N.ins_h<<N.hash_shift^N.window[M+3-1])&N.hash_mask,N.prev[M&N.w_mask]=N.head[N.ins_h],N.head[N.ins_h]=M,M++,--ea;);N.strstart=M,N.lookahead=2,Xt(N)}return N.strstart+=N.lookahead,N.block_start=N.strstart,N.insert=N.lookahead,N.lookahead=0,N.match_length=N.prev_length=2,N.match_available=0,t.next_in=ec,t.input=ef,t.avail_in=eu,N.wrap=el,0},N.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,N){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,N){n.exports=function(t,n){var N,M,es,ea,eo,el,eu,ec,ef,eh,ep,ed,e_,eg,em,eb,ey,ev,ek,eL,eA,ex,ew,eT,eO;N=t.state,M=t.next_in,eT=t.input,es=M+(t.avail_in-5),ea=t.next_out,eO=t.output,eo=ea-(n-t.avail_out),el=ea+(t.avail_out-257),eu=N.dmax,ec=N.wsize,ef=N.whave,eh=N.wnext,ep=N.window,ed=N.hold,e_=N.bits,eg=N.lencode,em=N.distcode,eb=(1<<N.lenbits)-1,ey=(1<<N.distbits)-1;e:do for(e_<15&&(ed+=eT[M++]<<e_,e_+=8,ed+=eT[M++]<<e_,e_+=8),ev=eg[ed&eb];;){if(ed>>>=ek=ev>>>24,e_-=ek,0==(ek=ev>>>16&255))eO[ea++]=65535&ev;else{if(!(16&ek)){if(!(64&ek)){ev=eg[(65535&ev)+(ed&(1<<ek)-1)];continue}if(32&ek){N.mode=12;break e}t.msg="invalid literal/length code",N.mode=30;break e}for(eL=65535&ev,(ek&=15)&&(e_<ek&&(ed+=eT[M++]<<e_,e_+=8),eL+=ed&(1<<ek)-1,ed>>>=ek,e_-=ek),e_<15&&(ed+=eT[M++]<<e_,e_+=8,ed+=eT[M++]<<e_,e_+=8),ev=em[ed&ey];;){if(ed>>>=ek=ev>>>24,e_-=ek,!(16&(ek=ev>>>16&255))){if(!(64&ek)){ev=em[(65535&ev)+(ed&(1<<ek)-1)];continue}t.msg="invalid distance code",N.mode=30;break e}if(eA=65535&ev,e_<(ek&=15)&&(ed+=eT[M++]<<e_,(e_+=8)<ek&&(ed+=eT[M++]<<e_,e_+=8)),eu<(eA+=ed&(1<<ek)-1)){t.msg="invalid distance too far back",N.mode=30;break e}if(ed>>>=ek,e_-=ek,(ek=ea-eo)<eA){if(ef<(ek=eA-ek)&&N.sane){t.msg="invalid distance too far back",N.mode=30;break e}if(ew=ep,(ex=0)===eh){if(ex+=ec-ek,ek<eL){for(eL-=ek;eO[ea++]=ep[ex++],--ek;);ex=ea-eA,ew=eO}}else if(eh<ek){if(ex+=ec+eh-ek,(ek-=eh)<eL){for(eL-=ek;eO[ea++]=ep[ex++],--ek;);if(ex=0,eh<eL){for(eL-=ek=eh;eO[ea++]=ep[ex++],--ek;);ex=ea-eA,ew=eO}}}else if(ex+=eh-ek,ek<eL){for(eL-=ek;eO[ea++]=ep[ex++],--ek;);ex=ea-eA,ew=eO}for(;2<eL;)eO[ea++]=ew[ex++],eO[ea++]=ew[ex++],eO[ea++]=ew[ex++],eL-=3;eL&&(eO[ea++]=ew[ex++],1<eL&&(eO[ea++]=ew[ex++]))}else{for(ex=ea-eA;eO[ea++]=eO[ex++],eO[ea++]=eO[ex++],eO[ea++]=eO[ex++],2<(eL-=3););eL&&(eO[ea++]=eO[ex++],1<eL&&(eO[ea++]=eO[ex++]))}break}}break}while(M<es&&ea<el);M-=eL=e_>>3,ed&=(1<<(e_-=eL<<3))-1,t.next_in=M,t.next_out=ea,t.avail_in=M<es?es-M+5:5-(M-es),t.avail_out=ea<el?el-ea+257:257-(ea-el),N.hold=ed,N.bits=e_}},{}],49:[function(t,n,N){var M=t("../utils/common"),es=t("./adler32"),ea=t("./crc32"),eo=t("./inffast"),el=t("./inftrees");function v(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new M.Buf16(320),this.work=new M.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function B(t){var n;return t&&t.state?(n=t.state,t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new M.Buf32(852),n.distcode=n.distdyn=new M.Buf32(592),n.sane=1,n.back=-1,0):-2}function j(t){var n;return t&&t.state?((n=t.state).wsize=0,n.whave=0,n.wnext=0,B(t)):-2}function F(t,n){var N,M;return t&&t.state?(M=t.state,n<0?(N=0,n=-n):(N=1+(n>>4),n<48&&(n&=15)),n&&(n<8||15<n)?-2:(null!==M.window&&M.wbits!==n&&(M.window=null),M.wrap=N,M.wbits=n,j(t))):-2}function Z(t,n){var N,M;return t?(M=new R,(t.state=M).window=null,0!==(N=F(t,n))&&(t.state=null),N):-2}var eu,ec,ef=!0;function ut(t,n,N,es){var ea,eo=t.state;return null===eo.window&&(eo.wsize=1<<eo.wbits,eo.wnext=0,eo.whave=0,eo.window=new M.Buf8(eo.wsize)),es>=eo.wsize?(M.arraySet(eo.window,n,N-eo.wsize,eo.wsize,0),eo.wnext=0,eo.whave=eo.wsize):(es<(ea=eo.wsize-eo.wnext)&&(ea=es),M.arraySet(eo.window,n,N-es,ea,eo.wnext),(es-=ea)?(M.arraySet(eo.window,n,N-es,es,0),eo.wnext=es,eo.whave=eo.wsize):(eo.wnext+=ea,eo.wnext===eo.wsize&&(eo.wnext=0),eo.whave<eo.wsize&&(eo.whave+=ea))),0}N.inflateReset=j,N.inflateReset2=F,N.inflateResetKeep=B,N.inflateInit=function(t){return Z(t,15)},N.inflateInit2=Z,N.inflate=function(t,n){var N,eh,ep,ed,e_,eg,em,eb,ey,ev,ek,eL,eA,ex,ew,eT,eO,eE,eS,eN,eU,eI,eR,eC,eP=0,eM=new M.Buf8(4),eB=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return -2;12===(N=t.state).mode&&(N.mode=13),e_=t.next_out,ep=t.output,em=t.avail_out,ed=t.next_in,eh=t.input,eg=t.avail_in,eb=N.hold,ey=N.bits,ev=eg,ek=em,eI=0;e:for(;;)switch(N.mode){case 1:if(0===N.wrap){N.mode=13;break}for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(2&N.wrap&&35615===eb){eM[N.check=0]=255&eb,eM[1]=eb>>>8&255,N.check=ea(N.check,eM,2,0),ey=eb=0,N.mode=2;break}if(N.flags=0,N.head&&(N.head.done=!1),!(1&N.wrap)||(((255&eb)<<8)+(eb>>8))%31){t.msg="incorrect header check",N.mode=30;break}if((15&eb)!=8){t.msg="unknown compression method",N.mode=30;break}if(ey-=4,eU=8+(15&(eb>>>=4)),0===N.wbits)N.wbits=eU;else if(eU>N.wbits){t.msg="invalid window size",N.mode=30;break}N.dmax=1<<eU,t.adler=N.check=1,N.mode=512&eb?10:12,ey=eb=0;break;case 2:for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(N.flags=eb,(255&N.flags)!=8){t.msg="unknown compression method",N.mode=30;break}if(57344&N.flags){t.msg="unknown header flags set",N.mode=30;break}N.head&&(N.head.text=eb>>8&1),512&N.flags&&(eM[0]=255&eb,eM[1]=eb>>>8&255,N.check=ea(N.check,eM,2,0)),ey=eb=0,N.mode=3;case 3:for(;ey<32;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.head&&(N.head.time=eb),512&N.flags&&(eM[0]=255&eb,eM[1]=eb>>>8&255,eM[2]=eb>>>16&255,eM[3]=eb>>>24&255,N.check=ea(N.check,eM,4,0)),ey=eb=0,N.mode=4;case 4:for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.head&&(N.head.xflags=255&eb,N.head.os=eb>>8),512&N.flags&&(eM[0]=255&eb,eM[1]=eb>>>8&255,N.check=ea(N.check,eM,2,0)),ey=eb=0,N.mode=5;case 5:if(1024&N.flags){for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.length=eb,N.head&&(N.head.extra_len=eb),512&N.flags&&(eM[0]=255&eb,eM[1]=eb>>>8&255,N.check=ea(N.check,eM,2,0)),ey=eb=0}else N.head&&(N.head.extra=null);N.mode=6;case 6:if(1024&N.flags&&(eg<(eL=N.length)&&(eL=eg),eL&&(N.head&&(eU=N.head.extra_len-N.length,N.head.extra||(N.head.extra=Array(N.head.extra_len)),M.arraySet(N.head.extra,eh,ed,eL,eU)),512&N.flags&&(N.check=ea(N.check,eh,eL,ed)),eg-=eL,ed+=eL,N.length-=eL),N.length))break e;N.length=0,N.mode=7;case 7:if(2048&N.flags){if(0===eg)break e;for(eL=0;eU=eh[ed+eL++],N.head&&eU&&N.length<65536&&(N.head.name+=String.fromCharCode(eU)),eU&&eL<eg;);if(512&N.flags&&(N.check=ea(N.check,eh,eL,ed)),eg-=eL,ed+=eL,eU)break e}else N.head&&(N.head.name=null);N.length=0,N.mode=8;case 8:if(4096&N.flags){if(0===eg)break e;for(eL=0;eU=eh[ed+eL++],N.head&&eU&&N.length<65536&&(N.head.comment+=String.fromCharCode(eU)),eU&&eL<eg;);if(512&N.flags&&(N.check=ea(N.check,eh,eL,ed)),eg-=eL,ed+=eL,eU)break e}else N.head&&(N.head.comment=null);N.mode=9;case 9:if(512&N.flags){for(;ey<16;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eb!==(65535&N.check)){t.msg="header crc mismatch",N.mode=30;break}ey=eb=0}N.head&&(N.head.hcrc=N.flags>>9&1,N.head.done=!0),t.adler=N.check=0,N.mode=12;break;case 10:for(;ey<32;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}t.adler=N.check=v(eb),ey=eb=0,N.mode=11;case 11:if(0===N.havedict)return t.next_out=e_,t.avail_out=em,t.next_in=ed,t.avail_in=eg,N.hold=eb,N.bits=ey,2;t.adler=N.check=1,N.mode=12;case 12:if(5===n||6===n)break e;case 13:if(N.last){eb>>>=7&ey,ey-=7&ey,N.mode=27;break}for(;ey<3;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}switch(N.last=1&eb,ey-=1,3&(eb>>>=1)){case 0:N.mode=14;break;case 1:if(function(t){if(ef){var n;for(eu=new M.Buf32(512),ec=new M.Buf32(32),n=0;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(el(1,t.lens,0,288,eu,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;el(2,t.lens,0,32,ec,0,t.work,{bits:5}),ef=!1}t.lencode=eu,t.lenbits=9,t.distcode=ec,t.distbits=5}(N),N.mode=20,6!==n)break;eb>>>=2,ey-=2;break e;case 2:N.mode=17;break;case 3:t.msg="invalid block type",N.mode=30}eb>>>=2,ey-=2;break;case 14:for(eb>>>=7&ey,ey-=7&ey;ey<32;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if((65535&eb)!=(eb>>>16^65535)){t.msg="invalid stored block lengths",N.mode=30;break}if(N.length=65535&eb,ey=eb=0,N.mode=15,6===n)break e;case 15:N.mode=16;case 16:if(eL=N.length){if(eg<eL&&(eL=eg),em<eL&&(eL=em),0===eL)break e;M.arraySet(ep,eh,ed,eL,e_),eg-=eL,ed+=eL,em-=eL,e_+=eL,N.length-=eL;break}N.mode=12;break;case 17:for(;ey<14;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(N.nlen=257+(31&eb),eb>>>=5,ey-=5,N.ndist=1+(31&eb),eb>>>=5,ey-=5,N.ncode=4+(15&eb),eb>>>=4,ey-=4,286<N.nlen||30<N.ndist){t.msg="too many length or distance symbols",N.mode=30;break}N.have=0,N.mode=18;case 18:for(;N.have<N.ncode;){for(;ey<3;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.lens[eB[N.have++]]=7&eb,eb>>>=3,ey-=3}for(;N.have<19;)N.lens[eB[N.have++]]=0;if(N.lencode=N.lendyn,N.lenbits=7,eR={bits:N.lenbits},eI=el(0,N.lens,0,19,N.lencode,0,N.work,eR),N.lenbits=eR.bits,eI){t.msg="invalid code lengths set",N.mode=30;break}N.have=0,N.mode=19;case 19:for(;N.have<N.nlen+N.ndist;){for(;eT=(eP=N.lencode[eb&(1<<N.lenbits)-1])>>>16&255,eO=65535&eP,!((ew=eP>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eO<16)eb>>>=ew,ey-=ew,N.lens[N.have++]=eO;else{if(16===eO){for(eC=ew+2;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eb>>>=ew,ey-=ew,0===N.have){t.msg="invalid bit length repeat",N.mode=30;break}eU=N.lens[N.have-1],eL=3+(3&eb),eb>>>=2,ey-=2}else if(17===eO){for(eC=ew+3;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}ey-=ew,eU=0,eL=3+(7&(eb>>>=ew)),eb>>>=3,ey-=3}else{for(eC=ew+7;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}ey-=ew,eU=0,eL=11+(127&(eb>>>=ew)),eb>>>=7,ey-=7}if(N.have+eL>N.nlen+N.ndist){t.msg="invalid bit length repeat",N.mode=30;break}for(;eL--;)N.lens[N.have++]=eU}}if(30===N.mode)break;if(0===N.lens[256]){t.msg="invalid code -- missing end-of-block",N.mode=30;break}if(N.lenbits=9,eR={bits:N.lenbits},eI=el(1,N.lens,0,N.nlen,N.lencode,0,N.work,eR),N.lenbits=eR.bits,eI){t.msg="invalid literal/lengths set",N.mode=30;break}if(N.distbits=6,N.distcode=N.distdyn,eR={bits:N.distbits},eI=el(2,N.lens,N.nlen,N.ndist,N.distcode,0,N.work,eR),N.distbits=eR.bits,eI){t.msg="invalid distances set",N.mode=30;break}if(N.mode=20,6===n)break e;case 20:N.mode=21;case 21:if(6<=eg&&258<=em){t.next_out=e_,t.avail_out=em,t.next_in=ed,t.avail_in=eg,N.hold=eb,N.bits=ey,eo(t,ek),e_=t.next_out,ep=t.output,em=t.avail_out,ed=t.next_in,eh=t.input,eg=t.avail_in,eb=N.hold,ey=N.bits,12===N.mode&&(N.back=-1);break}for(N.back=0;eT=(eP=N.lencode[eb&(1<<N.lenbits)-1])>>>16&255,eO=65535&eP,!((ew=eP>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eT&&!(240&eT)){for(eE=ew,eS=eT,eN=eO;eT=(eP=N.lencode[eN+((eb&(1<<eE+eS)-1)>>eE)])>>>16&255,eO=65535&eP,!(eE+(ew=eP>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}eb>>>=eE,ey-=eE,N.back+=eE}if(eb>>>=ew,ey-=ew,N.back+=ew,N.length=eO,0===eT){N.mode=26;break}if(32&eT){N.back=-1,N.mode=12;break}if(64&eT){t.msg="invalid literal/length code",N.mode=30;break}N.extra=15&eT,N.mode=22;case 22:if(N.extra){for(eC=N.extra;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.length+=eb&(1<<N.extra)-1,eb>>>=N.extra,ey-=N.extra,N.back+=N.extra}N.was=N.length,N.mode=23;case 23:for(;eT=(eP=N.distcode[eb&(1<<N.distbits)-1])>>>16&255,eO=65535&eP,!((ew=eP>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(!(240&eT)){for(eE=ew,eS=eT,eN=eO;eT=(eP=N.distcode[eN+((eb&(1<<eE+eS)-1)>>eE)])>>>16&255,eO=65535&eP,!(eE+(ew=eP>>>24)<=ey);){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}eb>>>=eE,ey-=eE,N.back+=eE}if(eb>>>=ew,ey-=ew,N.back+=ew,64&eT){t.msg="invalid distance code",N.mode=30;break}N.offset=eO,N.extra=15&eT,N.mode=24;case 24:if(N.extra){for(eC=N.extra;ey<eC;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}N.offset+=eb&(1<<N.extra)-1,eb>>>=N.extra,ey-=N.extra,N.back+=N.extra}if(N.offset>N.dmax){t.msg="invalid distance too far back",N.mode=30;break}N.mode=25;case 25:if(0===em)break e;if(eL=ek-em,N.offset>eL){if((eL=N.offset-eL)>N.whave&&N.sane){t.msg="invalid distance too far back",N.mode=30;break}eA=eL>N.wnext?(eL-=N.wnext,N.wsize-eL):N.wnext-eL,eL>N.length&&(eL=N.length),ex=N.window}else ex=ep,eA=e_-N.offset,eL=N.length;for(em<eL&&(eL=em),em-=eL,N.length-=eL;ep[e_++]=ex[eA++],--eL;);0===N.length&&(N.mode=21);break;case 26:if(0===em)break e;ep[e_++]=N.length,em--,N.mode=21;break;case 27:if(N.wrap){for(;ey<32;){if(0===eg)break e;eg--,eb|=eh[ed++]<<ey,ey+=8}if(ek-=em,t.total_out+=ek,N.total+=ek,ek&&(t.adler=N.check=N.flags?ea(N.check,ep,ek,e_-ek):es(N.check,ep,ek,e_-ek)),ek=em,(N.flags?eb:v(eb))!==N.check){t.msg="incorrect data check",N.mode=30;break}ey=eb=0}N.mode=28;case 28:if(N.wrap&&N.flags){for(;ey<32;){if(0===eg)break e;eg--,eb+=eh[ed++]<<ey,ey+=8}if(eb!==(4294967295&N.total)){t.msg="incorrect length check",N.mode=30;break}ey=eb=0}N.mode=29;case 29:eI=1;break e;case 30:eI=-3;break e;case 31:return -4;default:return -2}return t.next_out=e_,t.avail_out=em,t.next_in=ed,t.avail_in=eg,N.hold=eb,N.bits=ey,(N.wsize||ek!==t.avail_out&&N.mode<30&&(N.mode<27||4!==n))&&ut(t,t.output,t.next_out,ek-t.avail_out)?(N.mode=31,-4):(ev-=t.avail_in,ek-=t.avail_out,t.total_in+=ev,t.total_out+=ek,N.total+=ek,N.wrap&&ek&&(t.adler=N.check=N.flags?ea(N.check,ep,ek,t.next_out-ek):es(N.check,ep,ek,t.next_out-ek)),t.data_type=N.bits+(N.last?64:0)+(12===N.mode?128:0)+(20===N.mode||15===N.mode?256:0),(0==ev&&0===ek||4===n)&&0===eI&&(eI=-5),eI)},N.inflateEnd=function(t){if(!t||!t.state)return -2;var n=t.state;return n.window&&(n.window=null),t.state=null,0},N.inflateGetHeader=function(t,n){var N;return t&&t.state&&2&(N=t.state).wrap?((N.head=n).done=!1,0):-2},N.inflateSetDictionary=function(t,n){var N,M=n.length;return t&&t.state?0!==(N=t.state).wrap&&11!==N.mode?-2:11===N.mode&&es(1,n,M,0)!==N.check?-3:ut(t,n,M,M)?(N.mode=31,-4):(N.havedict=1,0):-2},N.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,N){var M=t("../utils/common"),es=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ea=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],eo=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],el=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(t,n,N,eu,ec,ef,eh,ep){var ed,e_,eg,em,eb,ey,ev,ek,eL,eA=ep.bits,ex=0,ew=0,eT=0,eO=0,eE=0,eS=0,eN=0,eU=0,eI=0,eR=0,eC=null,eP=0,eM=new M.Buf16(16),eB=new M.Buf16(16),eD=null,eK=0;for(ex=0;ex<=15;ex++)eM[ex]=0;for(ew=0;ew<eu;ew++)eM[n[N+ew]]++;for(eE=eA,eO=15;1<=eO&&0===eM[eO];eO--);if(eO<eE&&(eE=eO),0===eO)return ec[ef++]=20971520,ec[ef++]=20971520,ep.bits=1,0;for(eT=1;eT<eO&&0===eM[eT];eT++);for(eE<eT&&(eE=eT),ex=eU=1;ex<=15;ex++)if(eU<<=1,(eU-=eM[ex])<0)return -1;if(0<eU&&(0===t||1!==eO))return -1;for(eB[1]=0,ex=1;ex<15;ex++)eB[ex+1]=eB[ex]+eM[ex];for(ew=0;ew<eu;ew++)0!==n[N+ew]&&(eh[eB[n[N+ew]]++]=ew);if(ey=0===t?(eC=eD=eh,19):1===t?(eC=es,eP-=257,eD=ea,eK-=257,256):(eC=eo,eD=el,-1),ex=eT,eb=ef,eN=ew=eR=0,eg=-1,em=(eI=1<<(eS=eE))-1,1===t&&852<eI||2===t&&592<eI)return 1;for(;;){for(ev=ex-eN,eL=eh[ew]<ey?(ek=0,eh[ew]):eh[ew]>ey?(ek=eD[eK+eh[ew]],eC[eP+eh[ew]]):(ek=96,0),ed=1<<ex-eN,eT=e_=1<<eS;ec[eb+(eR>>eN)+(e_-=ed)]=ev<<24|ek<<16|eL|0,0!==e_;);for(ed=1<<ex-1;eR&ed;)ed>>=1;if(0!==ed?(eR&=ed-1,eR+=ed):eR=0,ew++,0==--eM[ex]){if(ex===eO)break;ex=n[N+eh[ew]]}if(eE<ex&&(eR&em)!==eg){for(0===eN&&(eN=eE),eb+=eT,eU=1<<(eS=ex-eN);eS+eN<eO&&!((eU-=eM[eS+eN])<=0);)eS++,eU<<=1;if(eI+=1<<eS,1===t&&852<eI||2===t&&592<eI)return 1;ec[eg=eR&em]=eE<<24|eS<<16|eb-ef|0}}return 0!==eR&&(ec[eb+eR]=ex-eN<<24|4194304),ep.bits=eE,0}},{"../utils/common":41}],51:[function(t,n,N){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,N){var M=t("../utils/common");function c(t){for(var n=t.length;0<=--n;)t[n]=0}var es=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ea=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],eo=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],el=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],eu=Array(576);c(eu);var ec=Array(60);c(ec);var ef=Array(512);c(ef);var eh=Array(256);c(eh);var ep=Array(29);c(ep);var ed,e_,eg,em=Array(30);function V(t,n,N,M,es){this.static_tree=t,this.extra_bits=n,this.extra_base=N,this.elems=M,this.max_length=es,this.has_stree=t&&t.length}function U(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}function P(t){return t<256?ef[t]:ef[256+(t>>>7)]}function gt(t,n){t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255}function _t(t,n,N){t.bi_valid>16-N?(t.bi_buf|=n<<t.bi_valid&65535,gt(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=N-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=N)}function St(t,n,N){_t(t,N[2*n],N[2*n+1])}function Xt(t,n){for(var N=0;N|=1&t,t>>>=1,N<<=1,0<--n;);return N>>>1}function ee(t,n,N){var M,es,ea=Array(16),eo=0;for(M=1;M<=15;M++)ea[M]=eo=eo+N[M-1]<<1;for(es=0;es<=n;es++){var el=t[2*es+1];0!==el&&(t[2*es]=Xt(ea[el]++,el))}}function Yt(t){var n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function rt(t){8<t.bi_valid?gt(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function ot(t,n,N,M){var es=2*n,ea=2*N;return t[es]<t[ea]||t[es]===t[ea]&&M[n]<=M[N]}function It(t,n,N){for(var M=t.heap[N],es=N<<1;es<=t.heap_len&&(es<t.heap_len&&ot(n,t.heap[es+1],t.heap[es],t.depth)&&es++,!ot(n,M,t.heap[es],t.depth));)t.heap[N]=t.heap[es],N=es,es<<=1;t.heap[N]=M}function xt(t,n,N){var M,eo,el,eu,ec=0;if(0!==t.last_lit)for(;M=t.pending_buf[t.d_buf+2*ec]<<8|t.pending_buf[t.d_buf+2*ec+1],eo=t.pending_buf[t.l_buf+ec],ec++,0===M?St(t,eo,n):(St(t,(el=eh[eo])+256+1,n),0!==(eu=es[el])&&_t(t,eo-=ep[el],eu),St(t,el=P(--M),N),0!==(eu=ea[el])&&_t(t,M-=em[el],eu)),ec<t.last_lit;);St(t,256,n)}function Kt(t,n){var N,M,es,ea=n.dyn_tree,eo=n.stat_desc.static_tree,el=n.stat_desc.has_stree,eu=n.stat_desc.elems,ec=-1;for(t.heap_len=0,t.heap_max=573,N=0;N<eu;N++)0!==ea[2*N]?(t.heap[++t.heap_len]=ec=N,t.depth[N]=0):ea[2*N+1]=0;for(;t.heap_len<2;)ea[2*(es=t.heap[++t.heap_len]=ec<2?++ec:0)]=1,t.depth[es]=0,t.opt_len--,el&&(t.static_len-=eo[2*es+1]);for(n.max_code=ec,N=t.heap_len>>1;1<=N;N--)It(t,ea,N);for(es=eu;N=t.heap[1],t.heap[1]=t.heap[t.heap_len--],It(t,ea,1),M=t.heap[1],t.heap[--t.heap_max]=N,t.heap[--t.heap_max]=M,ea[2*es]=ea[2*N]+ea[2*M],t.depth[es]=(t.depth[N]>=t.depth[M]?t.depth[N]:t.depth[M])+1,ea[2*N+1]=ea[2*M+1]=es,t.heap[1]=es++,It(t,ea,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,n){var N,M,es,ea,eo,el,eu=n.dyn_tree,ec=n.max_code,ef=n.stat_desc.static_tree,eh=n.stat_desc.has_stree,ep=n.stat_desc.extra_bits,ed=n.stat_desc.extra_base,e_=n.stat_desc.max_length,eg=0;for(ea=0;ea<=15;ea++)t.bl_count[ea]=0;for(eu[2*t.heap[t.heap_max]+1]=0,N=t.heap_max+1;N<573;N++)e_<(ea=eu[2*eu[2*(M=t.heap[N])+1]+1]+1)&&(ea=e_,eg++),eu[2*M+1]=ea,ec<M||(t.bl_count[ea]++,eo=0,ed<=M&&(eo=ep[M-ed]),el=eu[2*M],t.opt_len+=el*(ea+eo),eh&&(t.static_len+=el*(ef[2*M+1]+eo)));if(0!==eg){do{for(ea=e_-1;0===t.bl_count[ea];)ea--;t.bl_count[ea]--,t.bl_count[ea+1]+=2,t.bl_count[e_]--,eg-=2}while(0<eg);for(ea=e_;0!==ea;ea--)for(M=t.bl_count[ea];0!==M;)ec<(es=t.heap[--N])||(eu[2*es+1]!==ea&&(t.opt_len+=(ea-eu[2*es+1])*eu[2*es],eu[2*es+1]=ea),M--)}}(t,n),ee(ea,ec,t.bl_count)}function m(t,n,N){var M,es,ea=-1,eo=n[1],el=0,eu=7,ec=4;for(0===eo&&(eu=138,ec=3),n[2*(N+1)+1]=65535,M=0;M<=N;M++)es=eo,eo=n[2*(M+1)+1],++el<eu&&es===eo||(el<ec?t.bl_tree[2*es]+=el:0!==es?(es!==ea&&t.bl_tree[2*es]++,t.bl_tree[32]++):el<=10?t.bl_tree[34]++:t.bl_tree[36]++,ea=es,ec=(el=0)===eo?(eu=138,3):es===eo?(eu=6,3):(eu=7,4))}function pt(t,n,N){var M,es,ea=-1,eo=n[1],el=0,eu=7,ec=4;for(0===eo&&(eu=138,ec=3),M=0;M<=N;M++)if(es=eo,eo=n[2*(M+1)+1],!(++el<eu&&es===eo)){if(el<ec)for(;St(t,es,t.bl_tree),0!=--el;);else 0!==es?(es!==ea&&(St(t,es,t.bl_tree),el--),St(t,16,t.bl_tree),_t(t,el-3,2)):el<=10?(St(t,17,t.bl_tree),_t(t,el-3,3)):(St(t,18,t.bl_tree),_t(t,el-11,7));ea=es,ec=(el=0)===eo?(eu=138,3):es===eo?(eu=6,3):(eu=7,4)}}c(em);var eb=!1;function w(t,n,N,es){_t(t,0+(es?1:0),3),rt(t),gt(t,N),gt(t,~N),M.arraySet(t.pending_buf,t.window,n,N,t.pending),t.pending+=N}N._tr_init=function(t){eb||(function(){var t,n,N,M,el,eb=Array(16);for(M=N=0;M<28;M++)for(ep[M]=N,t=0;t<1<<es[M];t++)eh[N++]=M;for(eh[N-1]=M,M=el=0;M<16;M++)for(em[M]=el,t=0;t<1<<ea[M];t++)ef[el++]=M;for(el>>=7;M<30;M++)for(em[M]=el<<7,t=0;t<1<<ea[M]-7;t++)ef[256+el++]=M;for(n=0;n<=15;n++)eb[n]=0;for(t=0;t<=143;)eu[2*t+1]=8,t++,eb[8]++;for(;t<=255;)eu[2*t+1]=9,t++,eb[9]++;for(;t<=279;)eu[2*t+1]=7,t++,eb[7]++;for(;t<=287;)eu[2*t+1]=8,t++,eb[8]++;for(ee(eu,287,eb),t=0;t<30;t++)ec[2*t+1]=5,ec[2*t]=Xt(t,5);ed=new V(eu,es,257,286,15),e_=new V(ec,ea,0,30,15),eg=new V([],eo,0,19,7)}(),eb=!0),t.l_desc=new U(t.dyn_ltree,ed),t.d_desc=new U(t.dyn_dtree,e_),t.bl_desc=new U(t.bl_tree,eg),t.bi_buf=0,t.bi_valid=0,Yt(t)},N._tr_stored_block=w,N._tr_flush_block=function(t,n,N,M){var es,ea,eo=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var n,N=4093624447;for(n=0;n<=31;n++,N>>>=1)if(1&N&&0!==t.dyn_ltree[2*n])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==t.dyn_ltree[2*n])return 1;return 0}(t)),Kt(t,t.l_desc),Kt(t,t.d_desc),eo=function(t){var n;for(m(t,t.dyn_ltree,t.l_desc.max_code),m(t,t.dyn_dtree,t.d_desc.max_code),Kt(t,t.bl_desc),n=18;3<=n&&0===t.bl_tree[2*el[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n}(t),es=t.opt_len+3+7>>>3,(ea=t.static_len+3+7>>>3)<=es&&(es=ea)):es=ea=N+5,N+4<=es&&-1!==n?w(t,n,N,M):4===t.strategy||ea===es?(_t(t,2+(M?1:0),3),xt(t,eu,ec)):(_t(t,4+(M?1:0),3),function(t,n,N,M){var es;for(_t(t,n-257,5),_t(t,N-1,5),_t(t,M-4,4),es=0;es<M;es++)_t(t,t.bl_tree[2*el[es]+1],3);pt(t,t.dyn_ltree,n-1),pt(t,t.dyn_dtree,N-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,eo+1),xt(t,t.dyn_ltree,t.dyn_dtree)),Yt(t),M&&rt(t)},N._tr_tally=function(t,n,N){return t.pending_buf[t.d_buf+2*t.last_lit]=n>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&n,t.pending_buf[t.l_buf+t.last_lit]=255&N,t.last_lit++,0===n?t.dyn_ltree[2*N]++:(t.matches++,n--,t.dyn_ltree[2*(eh[N]+256+1)]++,t.dyn_dtree[2*P(n)]++),t.last_lit===t.lit_bufsize-1},N._tr_align=function(t){_t(t,2,3),St(t,256,eu),16===t.bi_valid?(gt(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(t,n,N){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,N){(function(t){!function(t,n){if(!t.setImmediate){var N,M,es,ea,el=1,eu={},ec=!1,ef=t.document,eh=Object.getPrototypeOf&&Object.getPrototypeOf(t);eh=eh&&eh.setTimeout?eh:t,N="[object process]"===({}).toString.call(t.process)?function(t){eo.nextTick(function(){R(t)})}:!function(){if(t.postMessage&&!t.importScripts){var n=!0,N=t.onmessage;return t.onmessage=function(){n=!1},t.postMessage("","*"),t.onmessage=N,n}}()?t.MessageChannel?((es=new MessageChannel).port1.onmessage=function(t){R(t.data)},function(t){es.port2.postMessage(t)}):ef&&"onreadystatechange"in ef.createElement("script")?(M=ef.documentElement,function(t){var n=ef.createElement("script");n.onreadystatechange=function(){R(t),n.onreadystatechange=null,M.removeChild(n),n=null},M.appendChild(n)}):function(t){setTimeout(R,0,t)}:(ea="setImmediate$"+Math.random()+"$",t.addEventListener?t.addEventListener("message",B,!1):t.attachEvent("onmessage",B),function(n){t.postMessage(ea+n,"*")}),eh.setImmediate=function(t){"function"!=typeof t&&(t=Function(""+t));for(var n=Array(arguments.length-1),M=0;M<n.length;M++)n[M]=arguments[M+1];var es={callback:t,args:n};return eu[el]=es,N(el),el++},eh.clearImmediate=v}function v(t){delete eu[t]}function R(t){if(ec)setTimeout(R,0,t);else{var n=eu[t];if(n){ec=!0;try{!function(t){var n=t.callback,N=t.args;switch(N.length){case 0:n();break;case 1:n(N[0]);break;case 2:n(N[0],N[1]);break;case 3:n(N[0],N[1],N[2]);break;default:n.apply(void 0,N)}}(n)}finally{v(t),ec=!1}}}}function B(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(ea)&&R(+n.data.slice(ea.length))}}(typeof self>"u"?void 0===t?this:t:self)}).call(this,"u">typeof to?to:"u">typeof self?self:"u">typeof window?window:{})},{}]},{},[10])(10);var tu=tl.exports;let tc=tu&&tu.__esModule&&Object.prototype.hasOwnProperty.call(tu,"default")?tu.default:tu;function Ua(t){return fetch(t).then(t=>t.ok?t.blob():Promise.reject(t.status)).then(t=>t.text())}let Go=class Go{constructor(t){this.baseUrl=t}href(t){return`${this.baseUrl}/${t}`}get(t){return Ua(this.href(t))}ready(t){t&&t()}close(t){t&&t(null)}};let Ko=class Ko{ready(t){throw Error("Method not implemented.")}close(t){throw Error("Method not implemented.")}};let Vo=class Vo extends Ko{constructor(t){super(),this._zip=void 0,this._isClosed=!1,this._task=Ua(t).then(tc.loadAsync).then(t=>{this._isClosed||(this._zip=t,this._task=void 0,this._notifyReady())})}href(t){return t}get(t){return new Promise((n,N)=>{if(void 0===this._zip){N(void 0);return}let M=this._zip.file(t);if(!M){N(void 0);return}M.async("string").then(t=>{n(t)}).catch(N)})}ready(t){this._readyCallback=t,void 0===this._task&&this._notifyReady()}_notifyReady(){void 0!==this._readyCallback&&this._readyCallback()}close(t){this._isClosed=!0,this._task=void 0,this._zip=void 0,void 0!==t&&t(null)}};let tf={inputController:()=>new Po,fileServer:t=>new Go(t),zipServer:t=>new Vo(t)};function $o(t,n){var N,M,es;let ea,eo;return N=n,eo={url:"",resizable:!0,speed:1},void 0===t||Ra(t)||"className"in t?ea=t:N=t,void 0!==N&&(eo={...eo,...N}),null==ea&&(ea=void 0!==eo.element?eo.element:document.getElementsByClassName("moroboxai-player")),Ra(ea)?Array.prototype.map.call(ea,t=>{var n;return n=eo,new Io(tf,t,n)}):(M=ea,es=eo,new Io(tf,M,es))}}}]);